MP2COD 4.1, COFF to COD File Converter
Copyright (c) 2006 Microchip Technology Inc.
Listing File Generated: Mon Jun 04 17:24:52 2007


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           //*;###########################################################################  C:\fw\midicontroller\x014\main.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\main.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x014\main.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x014\main.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x014\main.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\main.c
                                           //;############################################################################  C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\main.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           unsigned char	ADC_CONVERSION(unsigned char Channel);                             C:\fw\midicontroller\x014\main.c
                                           void	ServiceUSB(void);                                                           C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           //#define	RX_TRIS_BIT		TRISCbits.TRISC7		// Receive direction bit                C:\fw\midicontroller\x014\main.c
                                           //#define	TX_TRIS_BIT		TRISCbits.TRISC6		// Transmit direction bit               C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           #pragma code	main_code=0xA2A                                                     C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
000a2a   cfd9     MOVFF     0xfd9,0xfe6    void main() {                                                                    C:\fw\midicontroller\x014\main.c
000a2c   ffe6                                                                                                               
000a2e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000a30   ffd9                                                                                                               
000a32   0e06     MOVLW     0x6                                                                                             
000a34   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char chars[5], index;                                                  C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
000a36   ecaf     CALL      0x335e,0x0     	init();                                                                         C:\fw\midicontroller\x014\main.c
000a38   f019                                                                                                               
                                           //	controllerinit();                                                             C:\fw\midicontroller\x014\main.c
                                           	                                                                                C:\fw\midicontroller\x014\main.c
000a3a   0e20     MOVLW     0x20           	chars[0] = ' ';                                                                 C:\fw\midicontroller\x014\main.c
000a3c   6edf     MOVWF     0xdf,0x0                                                                                        
000a3e   52de     MOVF      0xde,0x1,0x0   	chars[1] = 'p';                                                                 C:\fw\midicontroller\x014\main.c
000a40   0e70     MOVLW     0x70                                                                                            
000a42   6edd     MOVWF     0xdd,0x0                                                                                        
000a44   0e61     MOVLW     0x61           	chars[2] = 'a';                                                                 C:\fw\midicontroller\x014\main.c
000a46   6ef3     MOVWF     0xf3,0x0                                                                                        
000a48   0e02     MOVLW     0x2                                                                                             
000a4a   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a4c   ffdb                                                                                                               
000a4e   0e72     MOVLW     0x72           	chars[3] = 'r';                                                                 C:\fw\midicontroller\x014\main.c
000a50   6ef3     MOVWF     0xf3,0x0                                                                                        
000a52   0e03     MOVLW     0x3                                                                                             
000a54   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a56   ffdb                                                                                                               
000a58   0e63     MOVLW     0x63           	chars[4] = 'c';                                                                 C:\fw\midicontroller\x014\main.c
000a5a   6ef3     MOVWF     0xf3,0x0                                                                                        
000a5c   0e04     MOVLW     0x4                                                                                             
000a5e   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a60   ffdb                                                                                                               
000a62   cfd9     MOVFF     0xfd9,0xfe6    	SetDispAscii(chars);                                                            C:\fw\midicontroller\x014\main.c
000a64   ffe6                                                                                                               
000a66   cfda     MOVFF     0xfda,0xfe6                                                                                     
000a68   ffe6                                                                                                               
000a6a   ec42     CALL      0x2884,0x0                                                                                      
000a6c   f014                                                                                                               
000a6e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a70   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a72   0eaa     MOVLW     0xaa           	SendDataToShiftReg(0xAA);                                                       C:\fw\midicontroller\x014\main.c
000a74   6ee6     MOVWF     0xe6,0x0                                                                                        
000a76   ec55     CALL      0x24aa,0x0                                                                                      
000a78   f012                                                                                                               
000a7a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           /*                                                                               C:\fw\midicontroller\x014\main.c
                                           	ProgMemAddr.s_form = 0x4000;                                                    C:\fw\midicontroller\x014\main.c
                                           	                                                                                C:\fw\midicontroller\x014\main.c
                                           	USBEP0DataInBuffer[4] = 0xAA;                                                   C:\fw\midicontroller\x014\main.c
                                           	USBEP0DataInBuffer[5] = 0x65;                                                   C:\fw\midicontroller\x014\main.c
                                           	USBEP0DataInBuffer[6] = 0x75;                                                   C:\fw\midicontroller\x014\main.c
                                           	USBEP0DataInBuffer[7] = 0x85;                                                   C:\fw\midicontroller\x014\main.c
                                           	USBEP0DataInBuffer[8] = 0x95;                                                   C:\fw\midicontroller\x014\main.c
                                           	                                                                                C:\fw\midicontroller\x014\main.c
                                           	for (index=0;index<32;index++)                                                  C:\fw\midicontroller\x014\main.c
                                           	ProgmemBuffer[index] = USBEP0DataInBuffer[index+4];                             C:\fw\midicontroller\x014\main.c
                                           	                                                                                C:\fw\midicontroller\x014\main.c
                                           	EraseProgMem();	//uses global ProgMemAddr                                       C:\fw\midicontroller\x014\main.c
                                           	                                                                                C:\fw\midicontroller\x014\main.c
                                           	WriteProgMem();	//uses global ProgMemAddr and ProgmemBuffer[]                   C:\fw\midicontroller\x014\main.c
                                           */                                                                               C:\fw\midicontroller\x014\main.c
                                                                                                                            C:\fw\midicontroller\x014\main.c
000a8c   d7f7     BRA       0xa7c          	for(;;) {                                                                       C:\fw\midicontroller\x014\main.c
000a7c   0100     MOVLB     0x0            		if (Systick) {                                                                 C:\fw\midicontroller\x014\main.c
000a7e   a160     BTFSS     0x60,0x0,0x1                                                                                    
000a80   d004     BRA       0xa8a                                                                                           
                                                                                                                            C:\fw\midicontroller\x014\main.c
000a82   ec7d     CALL      0x24fa,0x0     			ReadButtons();                                                                C:\fw\midicontroller\x014\main.c
000a84   f012                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           //			ProcessControl();                                                           C:\fw\midicontroller\x014\main.c
                                           //			if (LATE == 0x05) LATE = 0x2;                                               C:\fw\midicontroller\x014\main.c
                                           //			else LATE = 0x05;                                                           C:\fw\midicontroller\x014\main.c
000a86   ecac     CALL      0x2758,0x0     			ProcessLeds();                                                                C:\fw\midicontroller\x014\main.c
000a88   f013                                                                                                               
                                           			//ServiceRequests();                                                          C:\fw\midicontroller\x014\main.c
                                           			                                                                              C:\fw\midicontroller\x014\main.c
                                           		}                                                                              C:\fw\midicontroller\x014\main.c
000a8a   d80b     RCALL     0xaa2          		ServiceUSB();                                                                  C:\fw\midicontroller\x014\main.c
                                           	}                                                                               C:\fw\midicontroller\x014\main.c
000a8e   0e06     MOVLW     0x6            }                                                                                C:\fw\midicontroller\x014\main.c
000a90   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000a92   e202     BC        0xa98                                                                                           
000a94   6ae1     CLRF      0xe1,0x0                                                                                        
000a96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a98   6ee1     MOVWF     0xe1,0x0                                                                                        
000a9a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a9c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000a9e   ffd9                                                                                                               
000aa0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\main.c
                                           void	ServiceUSB(void) {                                                          C:\fw\midicontroller\x014\main.c
000aa2   ec76     CALL      0x22ec,0x0     	USBCheckBusStatus();                    // Must use polling method              C:\fw\midicontroller\x014\main.c
000aa4   f011                                                                                                               
000aa6   be6f     BTFSC     0x6f,0x7,0x0       if(UCFGbits.UTEYE!=1) {                                                      C:\fw\midicontroller\x014\main.c
000aa8   d002     BRA       0xaae                                                                                           
000aaa   ec95     CALL      0x232a,0x0             USBDriverService();                 // Interrupt or polling method       C:\fw\midicontroller\x014\main.c
000aac   f011                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x014\main.c
000aae   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\main.c
                                           /* $Id: c018.c,v 1.2.14.1 2006/01/24 14:50:12 rhinec Exp $ */                    C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
                                           /* Copyright (c)1999 Microchip Technology */                                     C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
                                           /* MPLAB-C18 startup code */                                                     C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
                                           /* external reference to the user's main routine */                              C:\fw\midicontroller\x014\startup.c
                                           extern void main (void);                                                         C:\fw\midicontroller\x014\startup.c
                                           /* prototype for the startup function */                                         C:\fw\midicontroller\x014\startup.c
                                           void _entry (void);                                                              C:\fw\midicontroller\x014\startup.c
                                           void _startup (void);                                                            C:\fw\midicontroller\x014\startup.c
                                           extern near char __FPFLAGS;                                                      C:\fw\midicontroller\x014\startup.c
                                           #define RND 6                                                                    C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
                                           #pragma code _entry_scn=0x000A00                                                 C:\fw\midicontroller\x014\startup.c
                                           void                                                                             C:\fw\midicontroller\x014\startup.c
                                           _entry (void)                                                                    C:\fw\midicontroller\x014\startup.c
                                           {                                                                                C:\fw\midicontroller\x014\startup.c
000a00   ef3c     GOTO      0x3478         _asm goto _startup _endasm                                                       C:\fw\midicontroller\x014\startup.c
000a02   f01a                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\startup.c
000a04   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
                                           #pragma code _startup_scn                                                        C:\fw\midicontroller\x014\startup.c
                                           void                                                                             C:\fw\midicontroller\x014\startup.c
                                           _startup (void)                                                                  C:\fw\midicontroller\x014\startup.c
                                           {                                                                                C:\fw\midicontroller\x014\startup.c
                                             _asm                                                                           C:\fw\midicontroller\x014\startup.c
                                               // Initialize the stack pointer                                              C:\fw\midicontroller\x014\startup.c
003478   ee17     LFSR      0x1,0x700          lfsr 1, _stack                                                               C:\fw\midicontroller\x014\startup.c
00347a   f000                                                                                                               
00347c   ee27     LFSR      0x2,0x700          lfsr 2, _stack                                                               C:\fw\midicontroller\x014\startup.c
00347e   f000                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\startup.c
003480   6af8     CLRF      0xf8,0x0           clrf TBLPTRU, 0 // 1st silicon doesn't do this on POR                        C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
003482   9c0f     BCF       0xf,0x6,0x0        bcf __FPFLAGS,RND,0 // Initalize rounding flag for floating point libs       C:\fw\midicontroller\x014\startup.c
                                           _endasm loop:                                                                    C:\fw\midicontroller\x014\startup.c
                                                                                                                            C:\fw\midicontroller\x014\startup.c
                                             // Call the user's main routine                                                C:\fw\midicontroller\x014\startup.c
003484   ec15     CALL      0xa2a,0x0        main ();                                                                       C:\fw\midicontroller\x014\startup.c
003486   f005                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\startup.c
003488   d7fd     BRA       0x3484           goto loop;                                                                     C:\fw\midicontroller\x014\startup.c
00348a   0012     RETURN    0x0            }                               /* end _startup() */                             C:\fw\midicontroller\x014\startup.c
                                           /*********************************************************************           C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *********************************************************************           C:\fw\midicontroller\x014\usb.c
                                            * FileName:        usb9.c                                                       C:\fw\midicontroller\x014\usb.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x014\usb.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x014\usb.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x014\usb.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x014\usb.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x014\usb.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x014\usb.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x014\usb.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x014\usb.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x014\usb.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x014\usb.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x014\usb.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x014\usb.c
                                            * license.                                                                      C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x014\usb.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x014\usb.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x014\usb.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x014\usb.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x014\usb.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Author               Date        Comment                                      C:\fw\midicontroller\x014\usb.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\fw\midicontroller\x014\usb.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\fw\midicontroller\x014\usb.c
                                            ********************************************************************/           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\usb.c
                                           //#include "io_cfg.h"                     // Required for self_power status      C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBStdGetDscHandler(void);                                                  C:\fw\midicontroller\x014\usb.c
                                           void USBStdSetCfgHandler(void);                                                  C:\fw\midicontroller\x014\usb.c
                                           void USBStdGetStatusHandler(void);                                               C:\fw\midicontroller\x014\usb.c
                                           void USBStdFeatureReqHandler(void);                                              C:\fw\midicontroller\x014\usb.c
                                           void HIDSetReportHandler(void);                                                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCheckStdRequest(void)                                C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\fw\midicontroller\x014\usb.c
                                            *                  knows how to handle it                                       C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCheckStdRequest(void)                                                    C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
001d10   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 C:\fw\midicontroller\x014\usb.c
001d12   5110     MOVF      0x10,0x0,0x1                                                                                    
001d14   0b60     ANDLW     0x60                                                                                            
001d16   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d18   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d1a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d1c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d1e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d20   0900     IORLW     0x0                                                                                             
001d22   e001     BZ        0x1d26                                                                                          
001d24   d04f     BRA       0x1dc4                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001d26   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\fw\midicontroller\x014\usb.c
001d28   0a07     XORLW     0x7                                                                                             
001d2a   e04b     BZ        0x1dc2                                                                                          
001d2c   0a0b     XORLW     0xb                                                                                             
001d2e   e049     BZ        0x1dc2                                                                                          
001d30   0a07     XORLW     0x7                                                                                             
001d32   e03a     BZ        0x1da8                                                                                          
001d34   0a01     XORLW     0x1                                                                                             
001d36   e028     BZ        0x1d88                                                                                          
001d38   0a0b     XORLW     0xb                                                                                             
001d3a   e024     BZ        0x1d84                                                                                          
001d3c   0a02     XORLW     0x2                                                                                             
001d3e   e022     BZ        0x1d84                                                                                          
001d40   0a03     XORLW     0x3                                                                                             
001d42   e01e     BZ        0x1d80                                                                                          
001d44   0a08     XORLW     0x8                                                                                             
001d46   e011     BZ        0x1d6a                                                                                          
001d48   0a01     XORLW     0x1                                                                                             
001d4a   e00d     BZ        0x1d66                                                                                          
001d4c   0a0f     XORLW     0xf                                                                                             
001d4e   e009     BZ        0x1d62                                                                                          
001d50   0a03     XORLW     0x3                                                                                             
001d52   e001     BZ        0x1d56                                                                                          
001d54   d036     BRA       0x1dc2                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
                                                   case SET_ADR:                                                            C:\fw\midicontroller\x014\usb.c
001d56   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x014\usb.c
001d58   0e01     MOVLW     0x1                                                                                             
001d5a   6f27     MOVWF     0x27,0x1                                                                                        
001d5c   0e04     MOVLW     0x4                        usb_device_state = ADR_PENDING_STATE;       // Update state only     C:\fw\midicontroller\x014\usb.c
001d5e   6f22     MOVWF     0x22,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    C:\fw\midicontroller\x014\usb.c
001d60   d031     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case GET_DSC:                                                            C:\fw\midicontroller\x014\usb.c
001d62   d831     RCALL     0x1dc6                     USBStdGetDscHandler();                                               C:\fw\midicontroller\x014\usb.c
001d64   d02f     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case SET_CFG:                                                            C:\fw\midicontroller\x014\usb.c
001d66   d890     RCALL     0x1e88                     USBStdSetCfgHandler();                                               C:\fw\midicontroller\x014\usb.c
001d68   d02d     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case GET_CFG:                                                            C:\fw\midicontroller\x014\usb.c
001d6a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x014\usb.c
001d6c   0e01     MOVLW     0x1                                                                                             
001d6e   6f27     MOVWF     0x27,0x1                                                                                        
001d70   0e24     MOVLW     0x24                       pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            C:\fw\midicontroller\x014\usb.c
001d72   6f28     MOVWF     0x28,0x1                                                                                        
001d74   0e01     MOVLW     0x1                                                                                             
001d76   6f29     MOVWF     0x29,0x1                                                                                        
001d78   9323     BCF       0x23,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\fw\midicontroller\x014\usb.c
001d7a   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        C:\fw\midicontroller\x014\usb.c
001d7c   6f2c     MOVWF     0x2c,0x1                                                                                        
001d7e   d022     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case GET_STATUS:                                                         C:\fw\midicontroller\x014\usb.c
001d80   d8a9     RCALL     0x1ed4                     USBStdGetStatusHandler();                                            C:\fw\midicontroller\x014\usb.c
001d82   d020     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case CLR_FEATURE:                                                        C:\fw\midicontroller\x014\usb.c
                                                   case SET_FEATURE:                                                        C:\fw\midicontroller\x014\usb.c
001d84   d8f1     RCALL     0x1f68                     USBStdFeatureReqHandler();                                           C:\fw\midicontroller\x014\usb.c
001d86   d01e     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case GET_INTF:                                                           C:\fw\midicontroller\x014\usb.c
001d88   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x014\usb.c
001d8a   0e01     MOVLW     0x1                                                                                             
001d8c   6f27     MOVWF     0x27,0x1                                                                                        
001d8e   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    C:\fw\midicontroller\x014\usb.c
001d90   5114     MOVF      0x14,0x0,0x1                                                                                    
001d92   0101     MOVLB     0x1                                                                                             
001d94   6f28     MOVWF     0x28,0x1                                                                                        
001d96   6b29     CLRF      0x29,0x1                                                                                        
001d98   0e25     MOVLW     0x25                                                                                            
001d9a   2728     ADDWF     0x28,0x1,0x1                                                                                    
001d9c   0e01     MOVLW     0x1                                                                                             
001d9e   2329     ADDWFC    0x29,0x1,0x1                                                                                    
001da0   9323     BCF       0x23,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\fw\midicontroller\x014\usb.c
001da2   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        C:\fw\midicontroller\x014\usb.c
001da4   6f2c     MOVWF     0x2c,0x1                                                                                        
001da6   d00e     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case SET_INTF:                                                           C:\fw\midicontroller\x014\usb.c
001da8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x014\usb.c
001daa   0e01     MOVLW     0x1                                                                                             
001dac   6f27     MOVWF     0x27,0x1                                                                                        
001dae   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    C:\fw\midicontroller\x014\usb.c
001db0   5114     MOVF      0x14,0x0,0x1                                                                                    
001db2   6aea     CLRF      0xea,0x0                                                                                        
001db4   0f25     ADDLW     0x25                                                                                            
001db6   6ee9     MOVWF     0xe9,0x0                                                                                        
001db8   0e01     MOVLW     0x1                                                                                             
001dba   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001dbc   c412     MOVFF     0x412,0xfef                                                                                     
001dbe   ffef                                                                                                               
001dc0   d001     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case SET_DSC:                                                            C:\fw\midicontroller\x014\usb.c
                                                   case SYNCH_FRAME:                                                        C:\fw\midicontroller\x014\usb.c
                                                   default:                                                                 C:\fw\midicontroller\x014\usb.c
001dc2   d000     BRA       0x1dc4                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                               }//end switch                                                                C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001dc4   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBStdGetDscHandler(void)                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    C:\fw\midicontroller\x014\usb.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     C:\fw\midicontroller\x014\usb.c
                                            *                  This routine should never have to be modified if the tables  C:\fw\midicontroller\x014\usb.c
                                            *                  in usbdsc.c are declared correctly.                          C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBStdGetDscHandler(void)                                                   C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
001dc6   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           C:\fw\midicontroller\x014\usb.c
001dc8   0104     MOVLB     0x4                                                                                             
001dca   5d10     SUBWF     0x10,0x0,0x1                                                                                    
001dcc   e15c     BNZ       0x1e86                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
001dce   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\fw\midicontroller\x014\usb.c
001dd0   0a03     XORLW     0x3                                                                                             
001dd2   e032     BZ        0x1e38                                                                                          
001dd4   0a01     XORLW     0x1                                                                                             
001dd6   e00e     BZ        0x1df4                                                                                          
001dd8   0a03     XORLW     0x3                                                                                             
001dda   e001     BZ        0x1dde                                                                                          
001ddc   d04b     BRA       0x1e74                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
                                                       case DSC_DEV:                                                        C:\fw\midicontroller\x014\usb.c
001dde   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x014\usb.c
001de0   0e01     MOVLW     0x1                                                                                             
001de2   6f27     MOVWF     0x27,0x1                                                                                        
001de4   0e70     MOVLW     0x70                           pSrc.bRom = (rom byte*)&device_dsc;                              C:\fw\midicontroller\x014\usb.c
001de6   6f28     MOVWF     0x28,0x1                                                                                        
001de8   0e30     MOVLW     0x30                                                                                            
001dea   6f29     MOVWF     0x29,0x1                                                                                        
001dec   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    C:\fw\midicontroller\x014\usb.c
001dee   6f2c     MOVWF     0x2c,0x1                                                                                        
001df0   6b2d     CLRF      0x2d,0x1                                                                                        
001df2   d040     BRA       0x1e74                         break;                                                           C:\fw\midicontroller\x014\usb.c
                                                       case DSC_CFG:                                                        C:\fw\midicontroller\x014\usb.c
001df4   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x014\usb.c
001df6   0e01     MOVLW     0x1                                                                                             
001df8   6f27     MOVWF     0x27,0x1                                                                                        
001dfa   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    C:\fw\midicontroller\x014\usb.c
001dfc   5112     MOVF      0x12,0x0,0x1                                                                                    
001dfe   6ef6     MOVWF     0xf6,0x0                                                                                        
001e00   6af7     CLRF      0xf7,0x0                                                                                        
001e02   90d8     BCF       0xd8,0x0,0x0                                                                                    
001e04   36f6     RLCF      0xf6,0x1,0x0                                                                                    
001e06   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001e08   0e8a     MOVLW     0x8a                                                                                            
001e0a   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001e0c   0e31     MOVLW     0x31                                                                                            
001e0e   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e10   0009     TBLRDPOSTINC                                                                                              
001e12   cff5     MOVFF     0xff5,0x128                                                                                     
001e14   f128                                                                                                               
001e16   000a     TBLRDPOSTDEC                                                                                              
001e18   cff5     MOVFF     0xff5,0x129                                                                                     
001e1a   f129                                                                                                               
001e1c   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    C:\fw\midicontroller\x014\usb.c
001e1e   0101     MOVLB     0x1                                                                                             
001e20   6af7     CLRF      0xf7,0x0                                                                                        
001e22   2528     ADDWF     0x28,0x0,0x1                                                                                    
001e24   6ef6     MOVWF     0xf6,0x0                                                                                        
001e26   5129     MOVF      0x29,0x0,0x1                                                                                    
001e28   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e2a   0009     TBLRDPOSTINC                                                                                              
001e2c   cff5     MOVFF     0xff5,0x12c                                                                                     
001e2e   f12c                                                                                                               
001e30   000a     TBLRDPOSTDEC                                                                                              
001e32   cff5     MOVFF     0xff5,0x12d                                                                                     
001e34   f12d                                                                                                               
001e36   d01e     BRA       0x1e74                         break;                                                           C:\fw\midicontroller\x014\usb.c
                                                       case DSC_STR:                                                        C:\fw\midicontroller\x014\usb.c
001e38   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x014\usb.c
001e3a   0e01     MOVLW     0x1                                                                                             
001e3c   6f27     MOVWF     0x27,0x1                                                                                        
001e3e   0104     MOVLB     0x4            				pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                                C:\fw\midicontroller\x014\usb.c
001e40   5112     MOVF      0x12,0x0,0x1                                                                                    
001e42   6ef6     MOVWF     0xf6,0x0                                                                                        
001e44   6af7     CLRF      0xf7,0x0                                                                                        
001e46   90d8     BCF       0xd8,0x0,0x0                                                                                    
001e48   36f6     RLCF      0xf6,0x1,0x0                                                                                    
001e4a   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001e4c   0e8e     MOVLW     0x8e                                                                                            
001e4e   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001e50   0e31     MOVLW     0x31                                                                                            
001e52   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e54   0009     TBLRDPOSTINC                                                                                              
001e56   cff5     MOVFF     0xff5,0x128                                                                                     
001e58   f128                                                                                                               
001e5a   000a     TBLRDPOSTDEC                                                                                              
001e5c   cff5     MOVFF     0xff5,0x129                                                                                     
001e5e   f129                                                                                                               
001e60   c128     MOVFF     0x128,0xff6    				wCount._word = *pSrc.bRom;                  // Set data count                C:\fw\midicontroller\x014\usb.c
001e62   fff6                                                                                                               
001e64   c129     MOVFF     0x129,0xff7                                                                                     
001e66   fff7                                                                                                               
001e68   0008     TBLRD                                                                                                     
001e6a   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001e6c   0101     MOVLB     0x1                                                                                             
001e6e   6f2c     MOVWF     0x2c,0x1                                                                                        
001e70   6b2d     CLRF      0x2d,0x1                                                                                        
001e72   d000     BRA       0x1e74                         break;                                                           C:\fw\midicontroller\x014\usb.c
                                                   }//end switch                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001e74   0e02     MOVLW     0x2            		if (SetupPkt.bDscIndex != INDEX_NAME && SetupPkt.bDscIndex != INDEX_SERIALNUM) { //handle as NVR (or ram) read C:\fw\midicontroller\x014\usb.c
001e76   0104     MOVLB     0x4                                                                                             
001e78   5d12     SUBWF     0x12,0x0,0x1                                                                                    
001e7a   e005     BZ        0x1e86                                                                                          
001e7c   0e03     MOVLW     0x3                                                                                             
001e7e   5d12     SUBWF     0x12,0x0,0x1                                                                                    
001e80   e002     BZ        0x1e86                                                                                          
001e82   0101     MOVLB     0x1                    	usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type  C:\fw\midicontroller\x014\usb.c
001e84   8323     BSF       0x23,0x1,0x1                                                                                    
                                                   }                                                                        C:\fw\midicontroller\x014\usb.c
                                               }//end if                                                                    C:\fw\midicontroller\x014\usb.c
001e86   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBStdSetCfgHandler(void)                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine first disables all endpoints by clearing        C:\fw\midicontroller\x014\usb.c
                                            *                  UEP registers. It then configures (initializes) endpoints    C:\fw\midicontroller\x014\usb.c
                                            *                  specified in the modifiable section.                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBStdSetCfgHandler(void)                                                   C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
001e88   0101     MOVLB     0x1                ctrl_trf_session_owner = MUID_USB9;                                          C:\fw\midicontroller\x014\usb.c
001e8a   0e01     MOVLW     0x1                                                                                             
001e8c   6f27     MOVWF     0x27,0x1                                                                                        
001e8e   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  C:\fw\midicontroller\x014\usb.c
001e90   6ee6     MOVWF     0xe6,0x0                                                                                        
001e92   0e71     MOVLW     0x71                                                                                            
001e94   6ee6     MOVWF     0xe6,0x0                                                                                        
001e96   0e0f     MOVLW     0xf                                                                                             
001e98   6ee6     MOVWF     0xe6,0x0                                                                                        
001e9a   dac9     RCALL     0x242e                                                                                          
001e9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001e9e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ea0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ea2   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                C:\fw\midicontroller\x014\usb.c
001ea4   6ee6     MOVWF     0xe6,0x0                                                                                        
001ea6   0e25     MOVLW     0x25                                                                                            
001ea8   6ee6     MOVWF     0xe6,0x0                                                                                        
001eaa   0e01     MOVLW     0x1                                                                                             
001eac   6ee6     MOVWF     0xe6,0x0                                                                                        
001eae   dabf     RCALL     0x242e                                                                                          
001eb0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001eb2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001eb4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001eb6   c412     MOVFF     0x412,0x124        usb_active_cfg = SetupPkt.bCfgValue;                                         C:\fw\midicontroller\x014\usb.c
001eb8   f124                                                                                                               
001eba   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  C:\fw\midicontroller\x014\usb.c
001ebc   5112     MOVF      0x12,0x0,0x1                                                                                    
001ebe   e104     BNZ       0x1ec8                                                                                          
001ec0   0101     MOVLB     0x1                    usb_device_state = ADDRESS_STATE;                                        C:\fw\midicontroller\x014\usb.c
001ec2   0e05     MOVLW     0x5                                                                                             
001ec4   6f22     MOVWF     0x22,0x1                                                                                        
001ec6   d005     BRA       0x1ed2             else                                                                         C:\fw\midicontroller\x014\usb.c
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
001ec8   0101     MOVLB     0x1                    usb_device_state = CONFIGURED_STATE;                                     C:\fw\midicontroller\x014\usb.c
001eca   0e06     MOVLW     0x6                                                                                             
001ecc   6f22     MOVWF     0x22,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /* Modifiable Section */                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   #if defined(USB_USE_HID)                // See autofiles\usbcfg.h        C:\fw\midicontroller\x014\usb.c
001ece   ecf7     CALL      0x2dee,0x0             HIDInitEP();                                                             C:\fw\midicontroller\x014\usb.c
001ed0   f016                                                                                                               
                                                   #endif                                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /* End modifiable section */                                             C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           C:\fw\midicontroller\x014\usb.c
001ed2   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBStdGetStatusHandler(void)                            C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine handles the standard GET_STATUS request         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBStdGetStatusHandler(void)                                                C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
001ed4   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        C:\fw\midicontroller\x014\usb.c
001ed6   6b50     CLRF      0x50,0x1                                                                                        
001ed8   6b51     CLRF      0x51,0x1           CtrlTrfData._byte1 = 0;                                                      C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001eda   5110     MOVF      0x10,0x0,0x1       switch(SetupPkt.Recipient)                                                   C:\fw\midicontroller\x014\usb.c
001edc   0b1f     ANDLW     0x1f                                                                                            
001ede   0a02     XORLW     0x2                                                                                             
001ee0   e014     BZ        0x1f0a                                                                                          
001ee2   0a03     XORLW     0x3                                                                                             
001ee4   e00e     BZ        0x1f02                                                                                          
001ee6   0a01     XORLW     0x1                                                                                             
001ee8   e001     BZ        0x1eec                                                                                          
001eea   d033     BRA       0x1f52                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
                                                   case RCPT_DEV:                                                           C:\fw\midicontroller\x014\usb.c
001eec   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x014\usb.c
001eee   0e01     MOVLW     0x1                                                                                             
001ef0   6f27     MOVWF     0x27,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered C:\fw\midicontroller\x014\usb.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     C:\fw\midicontroller\x014\usb.c
                                                        */                                                                  C:\fw\midicontroller\x014\usb.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h C:\fw\midicontroller\x014\usb.c
001ef2   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  C:\fw\midicontroller\x014\usb.c
001ef4   8150     BSF       0x50,0x0,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001ef6   0101     MOVLB     0x1                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c C:\fw\midicontroller\x014\usb.c
001ef8   a123     BTFSS     0x23,0x0,0x1                                                                                    
001efa   d002     BRA       0x1f00                                                                                          
001efc   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  C:\fw\midicontroller\x014\usb.c
001efe   8350     BSF       0x50,0x1,0x1                                                                                    
001f00   d028     BRA       0x1f52                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case RCPT_INTF:                                                          C:\fw\midicontroller\x014\usb.c
001f02   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         C:\fw\midicontroller\x014\usb.c
001f04   0e01     MOVLW     0x1                                                                                             
001f06   6f27     MOVWF     0x27,0x1                                                                                        
001f08   d024     BRA       0x1f52                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                                   case RCPT_EP:                                                            C:\fw\midicontroller\x014\usb.c
001f0a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x014\usb.c
001f0c   0e01     MOVLW     0x1                                                                                             
001f0e   6f27     MOVWF     0x27,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               C:\fw\midicontroller\x014\usb.c
                                                        */                                                                  C:\fw\midicontroller\x014\usb.c
001f10   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     C:\fw\midicontroller\x014\usb.c
001f12   5114     MOVF      0x14,0x0,0x1                                                                                    
001f14   0b0f     ANDLW     0xf                                                                                             
001f16   0d08     MULLW     0x8                                                                                             
001f18   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001f1a   6a11     CLRF      0x11,0x0                                                                                        
001f1c   0f00     ADDLW     0x0                                                                                             
001f1e   6e10     MOVWF     0x10,0x0                                                                                        
001f20   0e04     MOVLW     0x4                                                                                             
001f22   2211     ADDWFC    0x11,0x1,0x0                                                                                    
001f24   5114     MOVF      0x14,0x0,0x1                                                                                    
001f26   0b80     ANDLW     0x80                                                                                            
001f28   e001     BZ        0x1f2c                                                                                          
001f2a   0e01     MOVLW     0x1                                                                                             
001f2c   0d04     MULLW     0x4                                                                                             
001f2e   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001f30   0101     MOVLB     0x1                                                                                             
001f32   2410     ADDWF     0x10,0x0,0x0                                                                                    
001f34   6f2a     MOVWF     0x2a,0x1                                                                                        
001f36   0e00     MOVLW     0x0                                                                                             
001f38   2011     ADDWFC    0x11,0x0,0x0                                                                                    
001f3a   6f2b     MOVWF     0x2b,0x1                                                                                        
001f3c   c12a     MOVFF     0x12a,0xfe9                if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             C:\fw\midicontroller\x014\usb.c
001f3e   ffe9                                                                                                               
001f40   c12b     MOVFF     0x12b,0xfea                                                                                     
001f42   ffea                                                                                                               
001f44   50ef     MOVF      0xef,0x0,0x0                                                                                    
001f46   0b04     ANDLW     0x4                                                                                             
001f48   e003     BZ        0x1f50                                                                                          
001f4a   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              C:\fw\midicontroller\x014\usb.c
001f4c   0e01     MOVLW     0x1                                                                                             
001f4e   6f50     MOVWF     0x50,0x1                                                                                        
001f50   d000     BRA       0x1f52                     break;                                                               C:\fw\midicontroller\x014\usb.c
                                               }//end switch                                                                C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001f52   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_USB9)                                      C:\fw\midicontroller\x014\usb.c
001f54   0527     DECF      0x27,0x0,0x1                                                                                    
001f56   e107     BNZ       0x1f66                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
001f58   0e50     MOVLW     0x50                   pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                C:\fw\midicontroller\x014\usb.c
001f5a   6f28     MOVWF     0x28,0x1                                                                                        
001f5c   0e04     MOVLW     0x4                                                                                             
001f5e   6f29     MOVWF     0x29,0x1                                                                                        
001f60   9323     BCF       0x23,0x1,0x1           usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           C:\fw\midicontroller\x014\usb.c
001f62   0e02     MOVLW     0x2                    LSB(wCount) = 2;                            // Set data count            C:\fw\midicontroller\x014\usb.c
001f64   6f2c     MOVWF     0x2c,0x1                                                                                        
                                               }//end if(...)                                                               C:\fw\midicontroller\x014\usb.c
001f66   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       C:\fw\midicontroller\x014\usb.c
                                            *                  requests                                                     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBStdFeatureReqHandler(void)                                               C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
001f68   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             C:\fw\midicontroller\x014\usb.c
001f6a   0512     DECF      0x12,0x0,0x1                                                                                    
001f6c   e110     BNZ       0x1f8e                (SetupPkt.Recipient == RCPT_DEV))                                         C:\fw\midicontroller\x014\usb.c
001f6e   5110     MOVF      0x10,0x0,0x1                                                                                    
001f70   0b1f     ANDLW     0x1f                                                                                            
001f72   0900     IORLW     0x0                                                                                             
001f74   e10c     BNZ       0x1f8e                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
001f76   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      C:\fw\midicontroller\x014\usb.c
001f78   0e01     MOVLW     0x1                                                                                             
001f7a   6f27     MOVWF     0x27,0x1                                                                                        
001f7c   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\fw\midicontroller\x014\usb.c
001f7e   0104     MOVLB     0x4                                                                                             
001f80   5d11     SUBWF     0x11,0x0,0x1                                                                                    
001f82   e103     BNZ       0x1f8a                                                                                          
001f84   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 1;                                           C:\fw\midicontroller\x014\usb.c
001f86   8123     BSF       0x23,0x0,0x1                                                                                    
001f88   d002     BRA       0x1f8e                 else                                                                     C:\fw\midicontroller\x014\usb.c
001f8a   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 0;                                           C:\fw\midicontroller\x014\usb.c
001f8c   9123     BCF       0x23,0x0,0x1                                                                                    
                                               }//end if                                                                    C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001f8e   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    C:\fw\midicontroller\x014\usb.c
001f90   5112     MOVF      0x12,0x0,0x1                                                                                    
001f92   e13a     BNZ       0x2008                (SetupPkt.Recipient == RCPT_EP)&&                                         C:\fw\midicontroller\x014\usb.c
001f94   5110     MOVF      0x10,0x0,0x1                                                                                    
001f96   0b1f     ANDLW     0x1f                                                                                            
001f98   0802     SUBLW     0x2                                                                                             
001f9a   e136     BNZ       0x2008                                                                                          
001f9c   5114     MOVF      0x14,0x0,0x1          (SetupPkt.EPNum != 0))                                                    C:\fw\midicontroller\x014\usb.c
001f9e   0b0f     ANDLW     0xf                                                                                             
001fa0   0900     IORLW     0x0                                                                                             
001fa2   e032     BZ        0x2008                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
001fa4   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      C:\fw\midicontroller\x014\usb.c
001fa6   0e01     MOVLW     0x1                                                                                             
001fa8   6f27     MOVWF     0x27,0x1                                                                                        
                                                   /* Must do address calculation here */                                   C:\fw\midicontroller\x014\usb.c
001faa   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         C:\fw\midicontroller\x014\usb.c
001fac   5114     MOVF      0x14,0x0,0x1                                                                                    
001fae   0b0f     ANDLW     0xf                                                                                             
001fb0   0d08     MULLW     0x8                                                                                             
001fb2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001fb4   6a11     CLRF      0x11,0x0                                                                                        
001fb6   0f00     ADDLW     0x0                                                                                             
001fb8   6e10     MOVWF     0x10,0x0                                                                                        
001fba   0e04     MOVLW     0x4                                                                                             
001fbc   2211     ADDWFC    0x11,0x1,0x0                                                                                    
001fbe   5114     MOVF      0x14,0x0,0x1                                                                                    
001fc0   0b80     ANDLW     0x80                                                                                            
001fc2   e001     BZ        0x1fc6                                                                                          
001fc4   0e01     MOVLW     0x1                                                                                             
001fc6   0d04     MULLW     0x4                                                                                             
001fc8   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001fca   0101     MOVLB     0x1                                                                                             
001fcc   2410     ADDWF     0x10,0x0,0x0                                                                                    
001fce   6f2a     MOVWF     0x2a,0x1                                                                                        
001fd0   0e00     MOVLW     0x0                                                                                             
001fd2   2011     ADDWFC    0x11,0x0,0x0                                                                                    
001fd4   6f2b     MOVWF     0x2b,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
001fd6   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\fw\midicontroller\x014\usb.c
001fd8   0104     MOVLB     0x4                                                                                             
001fda   5d11     SUBWF     0x11,0x0,0x1                                                                                    
001fdc   e107     BNZ       0x1fec                                                                                          
001fde   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          C:\fw\midicontroller\x014\usb.c
001fe0   c12a     MOVFF     0x12a,0xfe9                                                                                     
001fe2   ffe9                                                                                                               
001fe4   c12b     MOVFF     0x12b,0xfea                                                                                     
001fe6   ffea                                                                                                               
001fe8   6eef     MOVWF     0xef,0x0                                                                                        
001fea   d00e     BRA       0x2008                 else                                                                     C:\fw\midicontroller\x014\usb.c
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
001fec   af14     BTFSS     0x14,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        C:\fw\midicontroller\x014\usb.c
001fee   d006     BRA       0x1ffc                                                                                          
001ff0   c12a     MOVFF     0x12a,0xfe9                    *pDst.bRam = _UCPU;                                              C:\fw\midicontroller\x014\usb.c
001ff2   ffe9                                                                                                               
001ff4   c12b     MOVFF     0x12b,0xfea                                                                                     
001ff6   ffea                                                                                                               
001ff8   6aef     CLRF      0xef,0x0                                                                                        
001ffa   d006     BRA       0x2008                     else                                                                 C:\fw\midicontroller\x014\usb.c
001ffc   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 C:\fw\midicontroller\x014\usb.c
001ffe   c12a     MOVFF     0x12a,0xfe9                                                                                     
002000   ffe9                                                                                                               
002002   c12b     MOVFF     0x12b,0xfea                                                                                     
002004   ffea                                                                                                               
002006   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                C:\fw\midicontroller\x014\usb.c
                                               }//end if                                                                    C:\fw\midicontroller\x014\usb.c
002008   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** EOF usb9.c ***************************************************************/  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           //usbmmap.c                                                                      C:\fw\midicontroller\x014\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x014\usb.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        C:\fw\midicontroller\x014\usb.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              C:\fw\midicontroller\x014\usb.c
                                           byte usb_active_cfg;            // Value of current configuration                C:\fw\midicontroller\x014\usb.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  C:\fw\midicontroller\x014\usb.c
                                                                           // setting for each interface ID                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  C:\fw\midicontroller\x014\usb.c
                                           //#pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) C:\fw\midicontroller\x014\usb.c
                                           #pragma udata overlay usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Section A: Buffer Descriptor Table                                            C:\fw\midicontroller\x014\usb.c
                                            * - 0x400 - 0x4FF(max)                                                          C:\fw\midicontroller\x014\usb.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              C:\fw\midicontroller\x014\usb.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            C:\fw\midicontroller\x014\usb.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Section B: EP0 Buffer Space                                                   C:\fw\midicontroller\x014\usb.c
                                            ******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * - Two buffer areas are defined:                                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *   A. CTRL_TRF_SETUP                                                           C:\fw\midicontroller\x014\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\fw\midicontroller\x014\usb.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *   B. CTRL_TRF_DATA                                                            C:\fw\midicontroller\x014\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\fw\midicontroller\x014\usb.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            C:\fw\midicontroller\x014\usb.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Section C: HID Buffer                                                         C:\fw\midicontroller\x014\usb.c
                                            ******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #if defined(USB_USE_HID)                                                         C:\fw\midicontroller\x014\usb.c
                                           volatile far unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];                  C:\fw\midicontroller\x014\usb.c
                                           volatile far unsigned char hid_report_in[HID_INT_IN_EP_SIZE];                    C:\fw\midicontroller\x014\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x014\usb.c
                                           /** EOF usbmmap.c ************************************************************/  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           //usbctrltrf.c                                                                   C:\fw\midicontroller\x014\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x014\usb.c
                                           byte ctrl_trf_state;                // Control Transfer State                    C:\fw\midicontroller\x014\usb.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           POINTER pSrc;                       // Data source pointer                       C:\fw\midicontroller\x014\usb.c
                                           POINTER pDst;                       // Data destination pointer                  C:\fw\midicontroller\x014\usb.c
                                           WORD wCount;                        // Data counter                              C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlTrfSetupHandler(void);                                               C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlTrfOutHandler(void);                                                 C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlTrfInHandler(void);                                                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlEPService(void)                                  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     C:\fw\midicontroller\x014\usb.c
                                            *                  it knows how to service and services them:                   C:\fw\midicontroller\x014\usb.c
                                            *                  1. EP0 SETUP                                                 C:\fw\midicontroller\x014\usb.c
                                            *                  2. EP0 OUT                                                   C:\fw\midicontroller\x014\usb.c
                                            *                  3. EP0 IN                                                    C:\fw\midicontroller\x014\usb.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlEPService(void)                                                      C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
00200a   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        C:\fw\midicontroller\x014\usb.c
00200c   e10b     BNZ       0x2024                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
00200e   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 C:\fw\midicontroller\x014\usb.c
002010   5100     MOVF      0x0,0x0,0x1                                                                                     
002012   0b3c     ANDLW     0x3c                                                                                            
002014   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002016   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002018   080d     SUBLW     0xd                                                                                             
00201a   e102     BNZ       0x2020                                                                                          
00201c   d808     RCALL     0x202e                     USBCtrlTrfSetupHandler();                                            C:\fw\midicontroller\x014\usb.c
00201e   d001     BRA       0x2022                 else                                        // EP0 OUT                   C:\fw\midicontroller\x014\usb.c
002020   d83b     RCALL     0x2098                     USBCtrlTrfOutHandler();                                              C:\fw\midicontroller\x014\usb.c
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
002022   d004     BRA       0x202c             else if(USTAT == EP00_IN)                       // EP0 IN                    C:\fw\midicontroller\x014\usb.c
002024   0e04     MOVLW     0x4                                                                                             
002026   5c6c     SUBWF     0x6c,0x0,0x0                                                                                    
002028   e101     BNZ       0x202c                                                                                          
00202a   d846     RCALL     0x20b8                 USBCtrlTrfInHandler();                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
00202c   0012     RETURN    0x0            }//end USBCtrlEPService                                                          C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          C:\fw\midicontroller\x014\usb.c
                                            *                  1. It initializes the control transfer state machine.        C:\fw\midicontroller\x014\usb.c
                                            *                  2. It calls on each of the module that may know how to       C:\fw\midicontroller\x014\usb.c
                                            *                     service the Setup Request from the host.                  C:\fw\midicontroller\x014\usb.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  C:\fw\midicontroller\x014\usb.c
                                            *                     As new classes are added, ClassReqHandler table in        C:\fw\midicontroller\x014\usb.c
                                            *                     usbdsc.c should be updated to call all available          C:\fw\midicontroller\x014\usb.c
                                            *                     class handlers.                                           C:\fw\midicontroller\x014\usb.c
                                            *                  3. Once each of the modules has had a chance to check if     C:\fw\midicontroller\x014\usb.c
                                            *                     it is responsible for servicing the request, stage 3      C:\fw\midicontroller\x014\usb.c
                                            *                     then checks direction of the transfer to determine how    C:\fw\midicontroller\x014\usb.c
                                            *                     to prepare EP0 for the control transfer.                  C:\fw\midicontroller\x014\usb.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            Microchip USB Firmware has three different states for        C:\fw\midicontroller\x014\usb.c
                                            *                  the control transfer state machine:                          C:\fw\midicontroller\x014\usb.c
                                            *                  1. WAIT_SETUP                                                C:\fw\midicontroller\x014\usb.c
                                            *                  2. CTRL_TRF_TX                                               C:\fw\midicontroller\x014\usb.c
                                            *                  3. CTRL_TRF_RX                                               C:\fw\midicontroller\x014\usb.c
                                            *                  Refer to firmware manual to find out how one state           C:\fw\midicontroller\x014\usb.c
                                            *                  is transitioned to another.                                  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                  A Control Transfer is composed of many USB transactions.     C:\fw\midicontroller\x014\usb.c
                                            *                  When transferring data over multiple transactions,           C:\fw\midicontroller\x014\usb.c
                                            *                  it is important to keep track of data source, data           C:\fw\midicontroller\x014\usb.c
                                            *                  destination, and data count. These three parameters are      C:\fw\midicontroller\x014\usb.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           C:\fw\midicontroller\x014\usb.c
                                            *                  note if the data source is from ROM or RAM.                  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
00202e   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                C:\fw\midicontroller\x014\usb.c
002030   ffe6                                                                                                               
002032   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002034   ffd9                                                                                                               
002036   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               byte i;                                                                      C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /* Stage 1 */                                                                C:\fw\midicontroller\x014\usb.c
002038   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;                                                 C:\fw\midicontroller\x014\usb.c
00203a   6b26     CLRF      0x26,0x1                                                                                        
00203c   6b27     CLRF      0x27,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 C:\fw\midicontroller\x014\usb.c
00203e   6b2c     CLRF      0x2c,0x1           wCount._word = 0;                                                            C:\fw\midicontroller\x014\usb.c
002040   6b2d     CLRF      0x2d,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /* Stage 2 */                                                                C:\fw\midicontroller\x014\usb.c
002042   de66     RCALL     0x1d10             USBCheckStdRequest();                   // See system\usb9\usb9.c            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /* Modifiable Section */                                                     C:\fw\midicontroller\x014\usb.c
002044   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     C:\fw\midicontroller\x014\usb.c
002046   50df     MOVF      0xdf,0x0,0x0                                                                                    
002048   6e10     MOVWF     0x10,0x0                                                                                        
00204a   6a11     CLRF      0x11,0x0                                                                                        
00204c   0e01     MOVLW     0x1                                                                                             
00204e   5c10     SUBWF     0x10,0x0,0x0                                                                                    
002050   0e00     MOVLW     0x0                                                                                             
002052   5811     SUBWFB    0x11,0x0,0x0                                                                                    
002054   e21b     BC        0x208c                                                                                          
002088   2adf     INCF      0xdf,0x1,0x0                                                                                    
00208a   d7dd     BRA       0x2046                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
002056   0101     MOVLB     0x1                    if(ctrl_trf_session_owner != MUID_NULL)break;                            C:\fw\midicontroller\x014\usb.c
002058   5127     MOVF      0x27,0x0,0x1                                                                                    
00205a   e001     BZ        0x205e                                                                                          
00205c   d017     BRA       0x208c                                                                                          
00205e   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            C:\fw\midicontroller\x014\usb.c
002060   34df     RLCF      0xdf,0x0,0x0                                                                                    
002062   0bfe     ANDLW     0xfe                                                                                            
002064   36f7     RLCF      0xf7,0x1,0x0                                                                                    
002066   6ef6     MOVWF     0xf6,0x0                                                                                        
002068   0e96     MOVLW     0x96                                                                                            
00206a   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
00206c   0e31     MOVLW     0x31                                                                                            
00206e   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002070   0009     TBLRDPOSTINC                                                                                              
002072   cff5     MOVFF     0xff5,0x10                                                                                      
002074   f010                                                                                                               
002076   0008     TBLRD                                                                                                     
002078   cff5     MOVFF     0xff5,0x11                                                                                      
00207a   f011                                                                                                               
00207c   d004     BRA       0x2086                                                                                          
00207e   c011     MOVFF     0x11,0xffa                                                                                      
002080   fffa                                                                                                               
002082   5010     MOVF      0x10,0x0,0x0                                                                                    
002084   6ef9     MOVWF     0xf9,0x0                                                                                        
002086   dffb     RCALL     0x207e                                                                                          
                                               }//end while                                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /* End Modifiable Section */                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /* Stage 3 */                                                                C:\fw\midicontroller\x014\usb.c
00208c   d8df     RCALL     0x224c             USBCtrlEPServiceComplete();                                                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
00208e   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    C:\fw\midicontroller\x014\usb.c
002090   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002092   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002094   ffd9                                                                                                               
002096   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine handles an OUT transaction according to         C:\fw\midicontroller\x014\usb.c
                                            *                  which control transfer state is currently active.            C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            Note that if the the control transfer was from               C:\fw\midicontroller\x014\usb.c
                                            *                  host to device, the session owner should be notified         C:\fw\midicontroller\x014\usb.c
                                            *                  at the end of each OUT transaction to service the            C:\fw\midicontroller\x014\usb.c
                                            *                  received data.                                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlTrfOutHandler(void)                                                  C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
002098   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            C:\fw\midicontroller\x014\usb.c
00209a   0101     MOVLB     0x1                                                                                             
00209c   5d26     SUBWF     0x26,0x0,0x1                                                                                    
00209e   e10a     BNZ       0x20b4                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
0020a0   d898     RCALL     0x21d2                 USBCtrlTrfRxService();                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x014\usb.c
                                                    * Don't have to worry about overwriting _KEEP bit                       C:\fw\midicontroller\x014\usb.c
                                                    * because if _KEEP was set, TRNIF would not have been                   C:\fw\midicontroller\x014\usb.c
                                                    * generated in the first place.                                         C:\fw\midicontroller\x014\usb.c
                                                    */                                                                      C:\fw\midicontroller\x014\usb.c
0020a2   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  C:\fw\midicontroller\x014\usb.c
0020a4   bd00     BTFSC     0x0,0x6,0x1                                                                                     
0020a6   d003     BRA       0x20ae                                                                                          
0020a8   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0020aa   6f00     MOVWF     0x0,0x1                                                                                         
0020ac   d002     BRA       0x20b2                 else                                                                     C:\fw\midicontroller\x014\usb.c
0020ae   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0020b0   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
0020b2   d001     BRA       0x20b6             else    // CTRL_TRF_TX                                                       C:\fw\midicontroller\x014\usb.c
0020b4   d90e     RCALL     0x22d2                 USBPrepareForNextSetupTrf();                                             C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0020b6   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine handles an IN transaction according to          C:\fw\midicontroller\x014\usb.c
                                            *                  which control transfer state is currently active.            C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            A Set Address Request must not change the acutal address     C:\fw\midicontroller\x014\usb.c
                                            *                  of the device until the completion of the control            C:\fw\midicontroller\x014\usb.c
                                            *                  transfer. The end of the control transfer for Set Address    C:\fw\midicontroller\x014\usb.c
                                            *                  Request is an IN transaction. Therefore it is necessary      C:\fw\midicontroller\x014\usb.c
                                            *                  to service this unique situation when the condition is       C:\fw\midicontroller\x014\usb.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          C:\fw\midicontroller\x014\usb.c
                                            *                  usb9.h and its function is to specifically service this      C:\fw\midicontroller\x014\usb.c
                                            *                  event.                                                       C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlTrfInHandler(void)                                                   C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
0020b8   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    C:\fw\midicontroller\x014\usb.c
0020ba   0101     MOVLB     0x1                                                                                             
0020bc   5d22     SUBWF     0x22,0x0,0x1                                                                                    
0020be   e10a     BNZ       0x20d4                                                                                          
0020c0   c412     MOVFF     0x412,0xf6e                                                                                     
0020c2   ff6e                                                                                                               
0020c4   506e     MOVF      0x6e,0x0,0x0                                                                                    
0020c6   0800     SUBLW     0x0                                                                                             
0020c8   e203     BC        0x20d0                                                                                          
0020ca   0e05     MOVLW     0x5                                                                                             
0020cc   6f22     MOVWF     0x22,0x1                                                                                        
0020ce   d002     BRA       0x20d4                                                                                          
0020d0   0e03     MOVLW     0x3                                                                                             
0020d2   6f22     MOVWF     0x22,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0020d4   0526     DECF      0x26,0x0,0x1       if(ctrl_trf_state == CTRL_TRF_TX)                                            C:\fw\midicontroller\x014\usb.c
0020d6   e10a     BNZ       0x20ec                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
0020d8   d811     RCALL     0x20fc                 USBCtrlTrfTxService();                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0020da   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  C:\fw\midicontroller\x014\usb.c
0020dc   bd04     BTFSC     0x4,0x6,0x1                                                                                     
0020de   d003     BRA       0x20e6                                                                                          
0020e0   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0020e2   6f04     MOVWF     0x4,0x1                                                                                         
0020e4   d002     BRA       0x20ea                 else                                                                     C:\fw\midicontroller\x014\usb.c
0020e6   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0020e8   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
0020ea   d007     BRA       0x20fa             else { // CTRL_TRF_RX                                                        C:\fw\midicontroller\x014\usb.c
                                           //Rawin's code change to handle setreport data:                                  C:\fw\midicontroller\x014\usb.c
0020ec   0e09     MOVLW     0x9            		if (SetupPkt.bRequest == SET_REPORT) {                                         C:\fw\midicontroller\x014\usb.c
0020ee   0104     MOVLB     0x4                                                                                             
0020f0   5d11     SUBWF     0x11,0x0,0x1                                                                                    
0020f2   e102     BNZ       0x20f8                                                                                          
0020f4   ec87     CALL      0x2f0e,0x0     			HIDSetReportHandler();                                                        C:\fw\midicontroller\x014\usb.c
0020f6   f017                                                                                                               
                                           		}                                                                              C:\fw\midicontroller\x014\usb.c
0020f8   d8ec     RCALL     0x22d2         		USBPrepareForNextSetupTrf();                                                   C:\fw\midicontroller\x014\usb.c
                                           	}                                                                               C:\fw\midicontroller\x014\usb.c
0020fa   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlTrfTxService(void)                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine should be called from only two places.          C:\fw\midicontroller\x014\usb.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             C:\fw\midicontroller\x014\usb.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           C:\fw\midicontroller\x014\usb.c
                                            *                  transfer over multiple USB transactions.                     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            This routine works with isochronous endpoint larger than     C:\fw\midicontroller\x014\usb.c
                                            *                  256 bytes and is shown here as an example of how to deal     C:\fw\midicontroller\x014\usb.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   C:\fw\midicontroller\x014\usb.c
                                            *                  be larger than 64 bytes.                                     C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
0020fc   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   C:\fw\midicontroller\x014\usb.c
0020fe   ffe6                                                                                                               
002100   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002102   ffd9                                                                                                               
002104   0e02     MOVLW     0x2                                                                                             
002106   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               WORD byte_to_send;                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * First, have to figure out how many byte of data to send.                  C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002108   0101     MOVLB     0x1                if(wCount._word < EP0_BUFF_SIZE)                                             C:\fw\midicontroller\x014\usb.c
00210a   0e40     MOVLW     0x40                                                                                            
00210c   5d2c     SUBWF     0x2c,0x0,0x1                                                                                    
00210e   0e00     MOVLW     0x0                                                                                             
002110   592d     SUBWFB    0x2d,0x0,0x1                                                                                    
002112   e205     BC        0x211e                                                                                          
002114   c12c     MOVFF     0x12c,0xfde            byte_to_send._word = wCount._word;                                       C:\fw\midicontroller\x014\usb.c
002116   ffde                                                                                                               
002118   c12d     MOVFF     0x12d,0xfdd                                                                                     
00211a   ffdd                                                                                                               
00211c   d003     BRA       0x2124             else                                                                         C:\fw\midicontroller\x014\usb.c
00211e   0e40     MOVLW     0x40                   byte_to_send._word = EP0_BUFF_SIZE;                                      C:\fw\midicontroller\x014\usb.c
002120   6ede     MOVWF     0xde,0x0                                                                                        
002122   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002124   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          C:\fw\midicontroller\x014\usb.c
002126   9304     BCF       0x4,0x1,0x1                                                                                     
002128   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          C:\fw\midicontroller\x014\usb.c
00212a   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       C:\fw\midicontroller\x014\usb.c
00212c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00212e   1304     IORWF     0x4,0x1,0x1                                                                                     
002130   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               C:\fw\midicontroller\x014\usb.c
002132   f405                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Subtract the number of bytes just about to be sent from the total.        C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002134   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            C:\fw\midicontroller\x014\usb.c
002136   50db     MOVF      0xdb,0x0,0x0                                                                                    
002138   0101     MOVLB     0x1                                                                                             
00213a   5f2c     SUBWF     0x2c,0x1,0x1                                                                                    
00213c   0e01     MOVLW     0x1                                                                                             
00213e   50db     MOVF      0xdb,0x0,0x0                                                                                    
002140   5b2d     SUBWFB    0x2d,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002142   0e50     MOVLW     0x50               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           C:\fw\midicontroller\x014\usb.c
002144   6f2a     MOVWF     0x2a,0x1                                                                                        
002146   0e04     MOVLW     0x4                                                                                             
002148   6f2b     MOVWF     0x2b,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
00214a   a323     BTFSS     0x23,0x1,0x1       if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   C:\fw\midicontroller\x014\usb.c
00214c   d01d     BRA       0x2188                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
00214e   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\fw\midicontroller\x014\usb.c
002150   ffe9                                                                                                               
002152   cfda     MOVFF     0xfda,0xfea                                                                                     
002154   ffea                                                                                                               
002156   50ee     MOVF      0xee,0x0,0x0                                                                                    
002158   10ed     IORWF     0xed,0x0,0x0                                                                                    
00215a   e015     BZ        0x2186                                                                                          
002184   d7e4     BRA       0x214e                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
00215c   c128     MOVFF     0x128,0xff6                *pDst.bRam = *pSrc.bRom;                                             C:\fw\midicontroller\x014\usb.c
00215e   fff6                                                                                                               
002160   c129     MOVFF     0x129,0xff7                                                                                     
002162   fff7                                                                                                               
002164   0008     TBLRD                                                                                                     
002166   50f5     MOVF      0xf5,0x0,0x0                                                                                    
002168   c12a     MOVFF     0x12a,0xfe9                                                                                     
00216a   ffe9                                                                                                               
00216c   c12b     MOVFF     0x12b,0xfea                                                                                     
00216e   ffea                                                                                                               
002170   6eef     MOVWF     0xef,0x0                                                                                        
002172   2b2a     INCF      0x2a,0x1,0x1               pDst.bRam++;                                                         C:\fw\midicontroller\x014\usb.c
002174   0e00     MOVLW     0x0                                                                                             
002176   232b     ADDWFC    0x2b,0x1,0x1                                                                                    
002178   2b28     INCF      0x28,0x1,0x1               pSrc.bRom++;                                                         C:\fw\midicontroller\x014\usb.c
00217a   2329     ADDWFC    0x29,0x1,0x1                                                                                    
00217c   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\fw\midicontroller\x014\usb.c
00217e   0e01     MOVLW     0x1                                                                                             
002180   e201     BC        0x2184                                                                                          
002182   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\fw\midicontroller\x014\usb.c
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
002186   d01b     BRA       0x21be             else // RAM                                                                  C:\fw\midicontroller\x014\usb.c
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
002188   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\fw\midicontroller\x014\usb.c
00218a   ffe9                                                                                                               
00218c   cfda     MOVFF     0xfda,0xfea                                                                                     
00218e   ffea                                                                                                               
002190   50ee     MOVF      0xee,0x0,0x0                                                                                    
002192   10ed     IORWF     0xed,0x0,0x0                                                                                    
002194   e014     BZ        0x21be                                                                                          
0021bc   d7e5     BRA       0x2188                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
002196   c128     MOVFF     0x128,0xfe9                *pDst.bRam = *pSrc.bRam;                                             C:\fw\midicontroller\x014\usb.c
002198   ffe9                                                                                                               
00219a   c129     MOVFF     0x129,0xfea                                                                                     
00219c   ffea                                                                                                               
00219e   50ef     MOVF      0xef,0x0,0x0                                                                                    
0021a0   c12a     MOVFF     0x12a,0xfe9                                                                                     
0021a2   ffe9                                                                                                               
0021a4   c12b     MOVFF     0x12b,0xfea                                                                                     
0021a6   ffea                                                                                                               
0021a8   6eef     MOVWF     0xef,0x0                                                                                        
0021aa   2b2a     INCF      0x2a,0x1,0x1               pDst.bRam++;                                                         C:\fw\midicontroller\x014\usb.c
0021ac   0e00     MOVLW     0x0                                                                                             
0021ae   232b     ADDWFC    0x2b,0x1,0x1                                                                                    
0021b0   2b28     INCF      0x28,0x1,0x1               pSrc.bRam++;                                                         C:\fw\midicontroller\x014\usb.c
0021b2   2329     ADDWFC    0x29,0x1,0x1                                                                                    
0021b4   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\fw\midicontroller\x014\usb.c
0021b6   0e01     MOVLW     0x1                                                                                             
0021b8   e201     BC        0x21bc                                                                                          
0021ba   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\fw\midicontroller\x014\usb.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0021be   0e02     MOVLW     0x2            }//end USBCtrlTrfTxService                                                       C:\fw\midicontroller\x014\usb.c
0021c0   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0021c2   e202     BC        0x21c8                                                                                          
0021c4   6ae1     CLRF      0xe1,0x0                                                                                        
0021c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0021c8   6ee1     MOVWF     0xe1,0x0                                                                                        
0021ca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0021cc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0021ce   ffd9                                                                                                               
0021d0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlTrfRxService(void)                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    pDst and wCount are setup properly.                          C:\fw\midicontroller\x014\usb.c
                                            *                  pSrc is always &CtrlTrfData                                  C:\fw\midicontroller\x014\usb.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        C:\fw\midicontroller\x014\usb.c
                                            *                  wCount should be set to 0 at the start of each control       C:\fw\midicontroller\x014\usb.c
                                            *                  transfer.                                                    C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        *** This routine is only partially complete. Check for       C:\fw\midicontroller\x014\usb.c
                                            *                  new version of the firmware.                                 C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
0021d2   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   C:\fw\midicontroller\x014\usb.c
0021d4   ffe6                                                                                                               
0021d6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0021d8   ffd9                                                                                                               
0021da   0e02     MOVLW     0x2                                                                                             
0021dc   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               WORD byte_to_read;                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0021de   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    C:\fw\midicontroller\x014\usb.c
0021e0   0104     MOVLB     0x4                                                                                             
0021e2   1500     ANDWF     0x0,0x0,0x1                                                                                     
0021e4   6ee7     MOVWF     0xe7,0x0                                                                                        
0021e6   0e01     MOVLW     0x1                                                                                             
0021e8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0021ea   ffdb                                                                                                               
0021ec   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               C:\fw\midicontroller\x014\usb.c
0021ee   ffdf                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Accumulate total number of bytes read                                     C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
0021f0   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            C:\fw\midicontroller\x014\usb.c
0021f2   0101     MOVLB     0x1                                                                                             
0021f4   272c     ADDWF     0x2c,0x1,0x1                                                                                    
0021f6   50dd     MOVF      0xdd,0x0,0x0                                                                                    
0021f8   232d     ADDWFC    0x2d,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0021fa   0e50     MOVLW     0x50               pSrc.bRam = (byte*)&CtrlTrfData;                                             C:\fw\midicontroller\x014\usb.c
0021fc   6f28     MOVWF     0x28,0x1                                                                                        
0021fe   0e04     MOVLW     0x4                                                                                             
002200   6f29     MOVWF     0x29,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002202   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    C:\fw\midicontroller\x014\usb.c
002204   ffe9                                                                                                               
002206   cfda     MOVFF     0xfda,0xfea                                                                                     
002208   ffea                                                                                                               
00220a   50ee     MOVF      0xee,0x0,0x0                                                                                    
00220c   10ed     IORWF     0xed,0x0,0x0                                                                                    
00220e   e014     BZ        0x2238                                                                                          
002236   d7e5     BRA       0x2202                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
002210   c128     MOVFF     0x128,0xfe9            *pDst.bRam = *pSrc.bRam;                                                 C:\fw\midicontroller\x014\usb.c
002212   ffe9                                                                                                               
002214   c129     MOVFF     0x129,0xfea                                                                                     
002216   ffea                                                                                                               
002218   50ef     MOVF      0xef,0x0,0x0                                                                                    
00221a   c12a     MOVFF     0x12a,0xfe9                                                                                     
00221c   ffe9                                                                                                               
00221e   c12b     MOVFF     0x12b,0xfea                                                                                     
002220   ffea                                                                                                               
002222   6eef     MOVWF     0xef,0x0                                                                                        
002224   2b2a     INCF      0x2a,0x1,0x1           pDst.bRam++;                                                             C:\fw\midicontroller\x014\usb.c
002226   0e00     MOVLW     0x0                                                                                             
002228   232b     ADDWFC    0x2b,0x1,0x1                                                                                    
00222a   2b28     INCF      0x28,0x1,0x1           pSrc.bRam++;                                                             C:\fw\midicontroller\x014\usb.c
00222c   2329     ADDWFC    0x29,0x1,0x1                                                                                    
00222e   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    C:\fw\midicontroller\x014\usb.c
002230   0e01     MOVLW     0x1                                                                                             
002232   e201     BC        0x2236                                                                                          
002234   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002238   0e02     MOVLW     0x2            }//end USBCtrlTrfRxService                                                       C:\fw\midicontroller\x014\usb.c
00223a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00223c   e202     BC        0x2242                                                                                          
00223e   6ae1     CLRF      0xe1,0x0                                                                                        
002240   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002242   6ee1     MOVWF     0xe1,0x0                                                                                        
002244   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002246   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002248   ffd9                                                                                                               
00224a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        C:\fw\midicontroller\x014\usb.c
                                            *                  a Setup Request. Its main task is to set the endpoint        C:\fw\midicontroller\x014\usb.c
                                            *                  controls appropriately for a given situation. See code       C:\fw\midicontroller\x014\usb.c
                                            *                  below.                                                       C:\fw\midicontroller\x014\usb.c
                                            *                  There are three main scenarios:                              C:\fw\midicontroller\x014\usb.c
                                            *                  a) There was no handler for the Request, in this case        C:\fw\midicontroller\x014\usb.c
                                            *                     a STALL should be sent out.                               C:\fw\midicontroller\x014\usb.c
                                            *                  b) The host has requested a read control transfer,           C:\fw\midicontroller\x014\usb.c
                                            *                     endpoints are required to be setup in a specific way.     C:\fw\midicontroller\x014\usb.c
                                            *                  c) The host has requested a write control transfer, or       C:\fw\midicontroller\x014\usb.c
                                            *                     a control data stage is not required, endpoints are       C:\fw\midicontroller\x014\usb.c
                                            *                     required to be setup in a specific way.                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCtrlEPServiceComplete(void)                                              C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
00224c   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_NULL)                                      C:\fw\midicontroller\x014\usb.c
00224e   5127     MOVF      0x27,0x0,0x1                                                                                    
002250   e10b     BNZ       0x2268                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x014\usb.c
                                                    * If no one knows how to service this request then stall.               C:\fw\midicontroller\x014\usb.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          C:\fw\midicontroller\x014\usb.c
                                                    */                                                                      C:\fw\midicontroller\x014\usb.c
002252   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               C:\fw\midicontroller\x014\usb.c
002254   0e40     MOVLW     0x40                                                                                            
002256   6f01     MOVWF     0x1,0x1                                                                                         
002258   0e10     MOVLW     0x10                   ep0Bo.ADR = (byte*)&SetupPkt;                                            C:\fw\midicontroller\x014\usb.c
00225a   6f02     MOVWF     0x2,0x1                                                                                         
00225c   0e04     MOVLW     0x4                                                                                             
00225e   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002260   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        C:\fw\midicontroller\x014\usb.c
002262   6f00     MOVWF     0x0,0x1                                                                                         
002264   6f04     MOVWF     0x4,0x1                ep0Bi.Stat._byte = _USIE|_BSTALL;                                        C:\fw\midicontroller\x014\usb.c
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
002266   d033     BRA       0x22ce             else    // A module has claimed ownership of the control transfer session.   C:\fw\midicontroller\x014\usb.c
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
002268   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      C:\fw\midicontroller\x014\usb.c
00226a   af10     BTFSS     0x10,0x7,0x1                                                                                    
00226c   d021     BRA       0x22b0                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
00226e   0101     MOVLB     0x1                        if(SetupPkt.wLength < wCount._word)                                  C:\fw\midicontroller\x014\usb.c
002270   512c     MOVF      0x2c,0x0,0x1                                                                                    
002272   0104     MOVLB     0x4                                                                                             
002274   5d16     SUBWF     0x16,0x0,0x1                                                                                    
002276   0101     MOVLB     0x1                                                                                             
002278   512d     MOVF      0x2d,0x0,0x1                                                                                    
00227a   0104     MOVLB     0x4                                                                                             
00227c   5917     SUBWFB    0x17,0x0,0x1                                                                                    
00227e   e204     BC        0x2288                                                                                          
002280   c416     MOVFF     0x416,0x12c                    wCount._word = SetupPkt.wLength;                                 C:\fw\midicontroller\x014\usb.c
002282   f12c                                                                                                               
002284   c417     MOVFF     0x417,0x12d                                                                                     
002286   f12d                                                                                                               
002288   df39     RCALL     0x20fc                     USBCtrlTrfTxService();                                               C:\fw\midicontroller\x014\usb.c
00228a   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_TX;                                        C:\fw\midicontroller\x014\usb.c
00228c   0e01     MOVLW     0x1                                                                                             
00228e   6f26     MOVWF     0x26,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * Control Read:                                                     C:\fw\midicontroller\x014\usb.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  C:\fw\midicontroller\x014\usb.c
                                                        * 1. Prepare OUT EP to respond to early termination                 C:\fw\midicontroller\x014\usb.c
                                                        *                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * NOTE:                                                             C:\fw\midicontroller\x014\usb.c
                                                        * If something went wrong during the control transfer,              C:\fw\midicontroller\x014\usb.c
                                                        * the last status stage may not be sent by the host.                C:\fw\midicontroller\x014\usb.c
                                                        * When this happens, two different things could happen              C:\fw\midicontroller\x014\usb.c
                                                        * depending on the host.                                            C:\fw\midicontroller\x014\usb.c
                                                        * a) The host could send out a RESET.                               C:\fw\midicontroller\x014\usb.c
                                                        * b) The host could send out a new SETUP transaction                C:\fw\midicontroller\x014\usb.c
                                                        *    without sending a RESET first.                                 C:\fw\midicontroller\x014\usb.c
                                                        * To properly handle case (b), the OUT EP must be setup             C:\fw\midicontroller\x014\usb.c
                                                        * to receive either a zero length OUT transaction, or a             C:\fw\midicontroller\x014\usb.c
                                                        * new SETUP transaction.                                            C:\fw\midicontroller\x014\usb.c
                                                        *                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * Since the SETUP transaction requires the DTS bit to be            C:\fw\midicontroller\x014\usb.c
                                                        * DAT0 while the zero length OUT status requires the DTS            C:\fw\midicontroller\x014\usb.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          C:\fw\midicontroller\x014\usb.c
                                                        * be disabled. This way the SIE could accept either of              C:\fw\midicontroller\x014\usb.c
                                                        * the two transactions.                                             C:\fw\midicontroller\x014\usb.c
                                                        *                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            C:\fw\midicontroller\x014\usb.c
                                                        * the SETUP data (8-byte or more), and the buffer address           C:\fw\midicontroller\x014\usb.c
                                                        * should be pointed to SetupPkt.                                    C:\fw\midicontroller\x014\usb.c
                                                        */                                                                  C:\fw\midicontroller\x014\usb.c
002290   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\fw\midicontroller\x014\usb.c
002292   0e40     MOVLW     0x40                                                                                            
002294   6f01     MOVWF     0x1,0x1                                                                                         
002296   0e10     MOVLW     0x10                       ep0Bo.ADR = (byte*)&SetupPkt;                                        C:\fw\midicontroller\x014\usb.c
002298   6f02     MOVWF     0x2,0x1                                                                                         
00229a   0e04     MOVLW     0x4                                                                                             
00229c   6f03     MOVWF     0x3,0x1                                                                                         
00229e   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             C:\fw\midicontroller\x014\usb.c
0022a0   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                       /*                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                C:\fw\midicontroller\x014\usb.c
                                                        *    been initialized by responsible request owner.                 C:\fw\midicontroller\x014\usb.c
                                                        */                                                                  C:\fw\midicontroller\x014\usb.c
0022a2   0e50     MOVLW     0x50                       ep0Bi.ADR = (byte*)&CtrlTrfData;                                     C:\fw\midicontroller\x014\usb.c
0022a4   6f06     MOVWF     0x6,0x1                                                                                         
0022a6   0e04     MOVLW     0x4                                                                                             
0022a8   6f07     MOVWF     0x7,0x1                                                                                         
0022aa   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0022ac   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        C:\fw\midicontroller\x014\usb.c
0022ae   d00f     BRA       0x22ce                 else    // (SetupPkt.DataDir == HOST_TO_DEV)                             C:\fw\midicontroller\x014\usb.c
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
0022b0   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_RX;                                        C:\fw\midicontroller\x014\usb.c
0022b2   0e02     MOVLW     0x2                                                                                             
0022b4   6f26     MOVWF     0x26,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * Control Write:                                                    C:\fw\midicontroller\x014\usb.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 C:\fw\midicontroller\x014\usb.c
                                                        *                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * 1. Prepare IN EP to respond to early termination                  C:\fw\midicontroller\x014\usb.c
                                                        *                                                                   C:\fw\midicontroller\x014\usb.c
                                                        *    This is the same as a Zero Length Packet Response              C:\fw\midicontroller\x014\usb.c
                                                        *    for control transfer without a data stage                      C:\fw\midicontroller\x014\usb.c
                                                        */                                                                  C:\fw\midicontroller\x014\usb.c
0022b6   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       C:\fw\midicontroller\x014\usb.c
0022b8   6b05     CLRF      0x5,0x1                                                                                         
0022ba   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0022bc   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                       /*                                                                   C:\fw\midicontroller\x014\usb.c
                                                        * 2. Prepare OUT EP to receive data.                                C:\fw\midicontroller\x014\usb.c
                                                        */                                                                  C:\fw\midicontroller\x014\usb.c
0022be   0e40     MOVLW     0x40                       ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\fw\midicontroller\x014\usb.c
0022c0   6f01     MOVWF     0x1,0x1                                                                                         
0022c2   0e50     MOVLW     0x50                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     C:\fw\midicontroller\x014\usb.c
0022c4   6f02     MOVWF     0x2,0x1                                                                                         
0022c6   0e04     MOVLW     0x4                                                                                             
0022c8   6f03     MOVWF     0x3,0x1                                                                                         
0022ca   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x014\usb.c
0022cc   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               C:\fw\midicontroller\x014\usb.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   C:\fw\midicontroller\x014\usb.c
                                                * Clear to resume packet processing.                                        C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
0022ce   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0022d0   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       C:\fw\midicontroller\x014\usb.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBPrepareForNextSetupTrf(void)                                             C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
0022d2   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  C:\fw\midicontroller\x014\usb.c
0022d4   6b26     CLRF      0x26,0x1                                                                                        
0022d6   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               C:\fw\midicontroller\x014\usb.c
0022d8   0e40     MOVLW     0x40                                                                                            
0022da   6f01     MOVWF     0x1,0x1                                                                                         
0022dc   0e10     MOVLW     0x10               ep0Bo.ADR = (byte*)&SetupPkt;                                                C:\fw\midicontroller\x014\usb.c
0022de   6f02     MOVWF     0x2,0x1                                                                                         
0022e0   0e04     MOVLW     0x4                                                                                             
0022e2   6f03     MOVWF     0x3,0x1                                                                                         
0022e4   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  C:\fw\midicontroller\x014\usb.c
0022e6   6f00     MOVWF     0x0,0x1                                                                                         
0022e8   6b04     CLRF      0x4,0x1            ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      C:\fw\midicontroller\x014\usb.c
0022ea   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** EOF usbctrltrf.c *********************************************************/  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           //usbdrv.c                                                                       C:\fw\midicontroller\x014\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\usb.c
                                           //#include "io_cfg.h"             // Required for USBCheckBusStatus()            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBModuleEnable(void);                                                      C:\fw\midicontroller\x014\usb.c
                                           void USBModuleDisable(void);                                                     C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           void USBSuspend(void);                                                           C:\fw\midicontroller\x014\usb.c
                                           void USBWakeFromSuspend(void);                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           void USBProtocolResetHandler(void);                                              C:\fw\midicontroller\x014\usb.c
                                           void USB_SOF_Handler(void);                                                      C:\fw\midicontroller\x014\usb.c
                                           void USBStallHandler(void);                                                      C:\fw\midicontroller\x014\usb.c
                                           void USBErrorHandler(void);                                                      C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x014\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBCheckBusStatus(void)                                 C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   C:\fw\midicontroller\x014\usb.c
                                            *                  the USB power signal.                                        C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBCheckBusStatus(void)                                                     C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               /**************************************************************************  C:\fw\midicontroller\x014\usb.c
                                                * Bus Attachment & Detachment Detection                                     C:\fw\midicontroller\x014\usb.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           C:\fw\midicontroller\x014\usb.c
                                                *************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                               #define USB_BUS_ATTACHED    1                                                C:\fw\midicontroller\x014\usb.c
                                               #define USB_BUS_DETACHED    0                                                C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          C:\fw\midicontroller\x014\usb.c
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
0022ec   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            C:\fw\midicontroller\x014\usb.c
0022ee   d80f     RCALL     0x230e                     USBModuleEnable();                  // Is off, enable it             C:\fw\midicontroller\x014\usb.c
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
0022f0   d002     BRA       0x22f6             else                                                                         C:\fw\midicontroller\x014\usb.c
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
0022f2   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             C:\fw\midicontroller\x014\usb.c
0022f4   d813     RCALL     0x231c                     USBModuleDisable();                 // Is on, disable it             C:\fw\midicontroller\x014\usb.c
                                               }//end if(usb_bus_sense...)                                                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * After enabling the USB module, it takes some time for the voltage         C:\fw\midicontroller\x014\usb.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. C:\fw\midicontroller\x014\usb.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is C:\fw\midicontroller\x014\usb.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     C:\fw\midicontroller\x014\usb.c
                                                * unique event as a USB bus reset from the USB host.                        C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
0022f6   0101     MOVLB     0x1                if(usb_device_state == ATTACHED_STATE)                                       C:\fw\midicontroller\x014\usb.c
0022f8   0522     DECF      0x22,0x0,0x1                                                                                    
0022fa   e108     BNZ       0x230c                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
0022fc   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        C:\fw\midicontroller\x014\usb.c
0022fe   d006     BRA       0x230c                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
002300   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          C:\fw\midicontroller\x014\usb.c
002302   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           C:\fw\midicontroller\x014\usb.c
002304   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            C:\fw\midicontroller\x014\usb.c
002306   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             C:\fw\midicontroller\x014\usb.c
002308   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    C:\fw\midicontroller\x014\usb.c
00230a   6f22     MOVWF     0x22,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
00230c   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBModuleEnable(void)                                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine enables the USB module.                         C:\fw\midicontroller\x014\usb.c
                                            *                  An end designer should never have to call this routine       C:\fw\midicontroller\x014\usb.c
                                            *                  manually. This routine should only be called from            C:\fw\midicontroller\x014\usb.c
                                            *                  USBCheckBusStatus().                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBModuleEnable(void)                                                       C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
00230e   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    C:\fw\midicontroller\x014\usb.c
002310   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\fw\midicontroller\x014\usb.c
002312   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     C:\fw\midicontroller\x014\usb.c
002314   0101     MOVLB     0x1                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         C:\fw\midicontroller\x014\usb.c
002316   0e01     MOVLW     0x1                                                                                             
002318   6f22     MOVWF     0x22,0x1                                                                                        
00231a   0012     RETURN    0x0            }//end USBModuleEnable                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBModuleDisable(void)                                  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine disables the USB module.                        C:\fw\midicontroller\x014\usb.c
                                            *                  An end designer should never have to call this routine       C:\fw\midicontroller\x014\usb.c
                                            *                  manually. This routine should only be called from            C:\fw\midicontroller\x014\usb.c
                                            *                  USBCheckBusStatus().                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBModuleDisable(void)                                                      C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
00231c   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  C:\fw\midicontroller\x014\usb.c
00231e   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\fw\midicontroller\x014\usb.c
002320   0101     MOVLB     0x1                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         C:\fw\midicontroller\x014\usb.c
002322   6b22     CLRF      0x22,0x1                                                                                        
002324   0012     RETURN    0x0            }//end USBModuleDisable                                                          C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBSoftDetach(void)                                     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       C:\fw\midicontroller\x014\usb.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      C:\fw\midicontroller\x014\usb.c
                                            *                  pull-up resistor. The pull-down resistors on the host        C:\fw\midicontroller\x014\usb.c
                                            *                  side will pull both differential signal lines low and        C:\fw\midicontroller\x014\usb.c
                                            *                  the host registers the event as a disconnect.                C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                  Since the USB cable is not physically disconnected, the      C:\fw\midicontroller\x014\usb.c
                                            *                  power supply through the cable can still be sensed by        C:\fw\midicontroller\x014\usb.c
                                            *                  the device. The next time USBCheckBusStatus() function       C:\fw\midicontroller\x014\usb.c
                                            *                  is called, it will reconnect the device back to the bus.     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBSoftDetach(void)                                                         C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
002326   ef8e     GOTO      0x231c             USBModuleDisable();                                                          C:\fw\midicontroller\x014\usb.c
002328   f011                                                                                                               
                                           }//end USBSoftDetach                                                             C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBDriverService(void)                                  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This routine is the heart of this firmware. It manages       C:\fw\midicontroller\x014\usb.c
                                            *                  all USB interrupts.                                          C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            Device state transitions through the following stages:       C:\fw\midicontroller\x014\usb.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                C:\fw\midicontroller\x014\usb.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBDriverService(void)                                                      C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Pointless to continue servicing if USB cable is not even attached.        C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
00232a   0101     MOVLB     0x1                if(usb_device_state == DETACHED_STATE) return;                               C:\fw\midicontroller\x014\usb.c
00232c   5122     MOVF      0x22,0x0,0x1                                                                                    
00232e   e101     BNZ       0x2332                                                                                          
002330   d039     BRA       0x23a4                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Task A: Service USB Activity Interrupt                                    C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002332   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                C:\fw\midicontroller\x014\usb.c
002334   0b04     ANDLW     0x4                                                                                             
002336   e004     BZ        0x2340                                                                                          
002338   5069     MOVF      0x69,0x0,0x0                                                                                    
00233a   0b04     ANDLW     0x4                                                                                             
00233c   e001     BZ        0x2340                                                                                          
00233e   d838     RCALL     0x23b0                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Pointless to continue servicing if the device is in suspend mode.         C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002340   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               C:\fw\midicontroller\x014\usb.c
002342   d030     BRA       0x23a4                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  C:\fw\midicontroller\x014\usb.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      C:\fw\midicontroller\x014\usb.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  C:\fw\midicontroller\x014\usb.c
                                                * This is why URSTIF is checked after ACTVIF.                               C:\fw\midicontroller\x014\usb.c
                                                *                                                                           C:\fw\midicontroller\x014\usb.c
                                                * The USB reset flag is masked when the USB state is in                     C:\fw\midicontroller\x014\usb.c
                                                * DETACHED_STATE or ATTACHED_STATE, and therefore cannot                    C:\fw\midicontroller\x014\usb.c
                                                * cause a USB reset event during these two states.                          C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002344   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           C:\fw\midicontroller\x014\usb.c
002346   0b01     ANDLW     0x1                                                                                             
002348   e004     BZ        0x2352                                                                                          
00234a   5069     MOVF      0x69,0x0,0x0                                                                                    
00234c   0b01     ANDLW     0x1                                                                                             
00234e   e001     BZ        0x2352                                                                                          
002350   d84f     RCALL     0x23f0                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Task C: Service other USB interrupts                                      C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002352   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        C:\fw\midicontroller\x014\usb.c
002354   0b10     ANDLW     0x10                                                                                            
002356   e004     BZ        0x2360                                                                                          
002358   5069     MOVF      0x69,0x0,0x0                                                                                    
00235a   0b10     ANDLW     0x10                                                                                            
00235c   e001     BZ        0x2360                                                                                          
00235e   d823     RCALL     0x23a6                                                                                          
002360   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   C:\fw\midicontroller\x014\usb.c
002362   0b40     ANDLW     0x40                                                                                            
002364   e004     BZ        0x236e                                                                                          
002366   5069     MOVF      0x69,0x0,0x0                                                                                    
002368   0b40     ANDLW     0x40                                                                                            
00236a   e001     BZ        0x236e                                                                                          
00236c   d837     RCALL     0x23dc                                                                                          
00236e   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   C:\fw\midicontroller\x014\usb.c
002370   0b20     ANDLW     0x20                                                                                            
002372   e004     BZ        0x237c                                                                                          
002374   5069     MOVF      0x69,0x0,0x0                                                                                    
002376   0b20     ANDLW     0x20                                                                                            
002378   e001     BZ        0x237c                                                                                          
00237a   d832     RCALL     0x23e0                                                                                          
00237c   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   C:\fw\midicontroller\x014\usb.c
00237e   0b02     ANDLW     0x2                                                                                             
002380   e004     BZ        0x238a                                                                                          
002382   5069     MOVF      0x69,0x0,0x0                                                                                    
002384   0b02     ANDLW     0x2                                                                                             
002386   e001     BZ        0x238a                                                                                          
002388   d831     RCALL     0x23ec                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     C:\fw\midicontroller\x014\usb.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       C:\fw\midicontroller\x014\usb.c
                                                * state and is ready for communication.                                     C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
00238a   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 C:\fw\midicontroller\x014\usb.c
00238c   0101     MOVLB     0x1                                                                                             
00238e   5d22     SUBWF     0x22,0x0,0x1                                                                                    
002390   e201     BC        0x2394                                                                                          
002392   d008     BRA       0x23a4                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
002394   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           C:\fw\midicontroller\x014\usb.c
002396   0b08     ANDLW     0x8                                                                                             
002398   e005     BZ        0x23a4                                                                                          
00239a   5069     MOVF      0x69,0x0,0x0                                                                                    
00239c   0b08     ANDLW     0x8                                                                                             
00239e   e002     BZ        0x23a4                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x014\usb.c
                                                    * USBCtrlEPService only services transactions over EP0.                 C:\fw\midicontroller\x014\usb.c
                                                    * It ignores all other EP transactions.                                 C:\fw\midicontroller\x014\usb.c
                                                    */                                                                      C:\fw\midicontroller\x014\usb.c
0023a0   de34     RCALL     0x200a                 USBCtrlEPService();                                                      C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x014\usb.c
                                                    * Other EP can be serviced later by responsible device class firmware.  C:\fw\midicontroller\x014\usb.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    C:\fw\midicontroller\x014\usb.c
                                                    * checking the buffer ownership bit.                                    C:\fw\midicontroller\x014\usb.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      C:\fw\midicontroller\x014\usb.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       C:\fw\midicontroller\x014\usb.c
                                                    *                                                                       C:\fw\midicontroller\x014\usb.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    C:\fw\midicontroller\x014\usb.c
                                                    * of non-EP0 transactions.                                              C:\fw\midicontroller\x014\usb.c
                                                    */                                                                      C:\fw\midicontroller\x014\usb.c
0023a2   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\fw\midicontroller\x014\usb.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023a4   0012     RETURN    0x0            }//end USBDriverService                                                          C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBSuspend(void)                                        C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:                                                                     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBSuspend(void)                                                            C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   C:\fw\midicontroller\x014\usb.c
                                                * Reason:                                                                   C:\fw\midicontroller\x014\usb.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               C:\fw\midicontroller\x014\usb.c
                                                * This is a 1:1 ratio interrupt generation.                                 C:\fw\midicontroller\x014\usb.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             C:\fw\midicontroller\x014\usb.c
                                                * the number of subsequent bus transitions.                                 C:\fw\midicontroller\x014\usb.c
                                                *                                                                           C:\fw\midicontroller\x014\usb.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 C:\fw\midicontroller\x014\usb.c
                                                * [       IDLE       ][bus activity ->                                      C:\fw\midicontroller\x014\usb.c
                                                * <--- 3 ms ----->     ^                                                    C:\fw\midicontroller\x014\usb.c
                                                *                ^     ACTVIF=1                                             C:\fw\midicontroller\x014\usb.c
                                                *                IDLEIF=1                                                   C:\fw\midicontroller\x014\usb.c
                                                *  #           #           #           #   (#=Program polling flags)        C:\fw\midicontroller\x014\usb.c
                                                *                          ^                                                C:\fw\midicontroller\x014\usb.c
                                                *                          This polling loop will see both                  C:\fw\midicontroller\x014\usb.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           C:\fw\midicontroller\x014\usb.c
                                                *                          However, the program services IDLEIF first       C:\fw\midicontroller\x014\usb.c
                                                *                          because ACTIVIE=0.                               C:\fw\midicontroller\x014\usb.c
                                                *                          If this routine clears the only ACTIVIF,         C:\fw\midicontroller\x014\usb.c
                                                *                          then it can never get out of the suspend         C:\fw\midicontroller\x014\usb.c
                                                *                          mode.                                            C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
0023a6   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     C:\fw\midicontroller\x014\usb.c
0023a8   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          C:\fw\midicontroller\x014\usb.c
0023aa   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  C:\fw\midicontroller\x014\usb.c
                                                                                       // mode, SIE clock inactive          C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * At this point the PIC can go into sleep,idle, or                          C:\fw\midicontroller\x014\usb.c
                                                * switch to a slower clock, etc.                                            C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               /* Modifiable Section */                                                     C:\fw\midicontroller\x014\usb.c
0023ac   9aa1     BCF       0xa1,0x5,0x0       PIR2bits.USBIF = 0;                                                          C:\fw\midicontroller\x014\usb.c
                                           /*                                                                               C:\fw\midicontroller\x014\usb.c
                                           //2/15/05 JD This was causing problems with USBIE being enabled..                C:\fw\midicontroller\x014\usb.c
                                               INTCONbits.RBIF = 0;                                                         C:\fw\midicontroller\x014\usb.c
                                               PIE2bits.USBIE = 1;                     // Set USB wakeup source             C:\fw\midicontroller\x014\usb.c
                                               INTCONbits.RBIE = 1;                    // Set sw2,3 wakeup source           C:\fw\midicontroller\x014\usb.c
                                               Sleep();                                // Goto sleep                        C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                               if(INTCONbits.RBIF == 1)                // Check if external stimulus        C:\fw\midicontroller\x014\usb.c
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
                                                   USBRemoteWakeup();                  // If yes, attempt RWU               C:\fw\midicontroller\x014\usb.c
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
                                               PIE2bits.USBIE = 0;                                                          C:\fw\midicontroller\x014\usb.c
                                               INTCONbits.RBIE = 0;                                                         C:\fw\midicontroller\x014\usb.c
                                           */                                                                               C:\fw\midicontroller\x014\usb.c
                                               /* End Modifiable Section */                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023ae   0012     RETURN    0x0            }//end USBSuspend                                                                C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBWakeFromSuspend(void)                                C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:                                                                     C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBWakeFromSuspend(void)                                                    C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * If using clock switching, this is the place to restore the                C:\fw\midicontroller\x014\usb.c
                                                * original clock frequency.                                                 C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
0023b0   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         C:\fw\midicontroller\x014\usb.c
0023b2   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          C:\fw\midicontroller\x014\usb.c
0023b4   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          C:\fw\midicontroller\x014\usb.c
0023b6   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBRemoteWakeup(void)                                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        This function should be called by user when the device       C:\fw\midicontroller\x014\usb.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      C:\fw\midicontroller\x014\usb.c
                                            *                  Please read the note below to understand the limitations.    C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            The modifiable section in this routine should be changed     C:\fw\midicontroller\x014\usb.c
                                            *                  to meet the application needs. Current implementation        C:\fw\midicontroller\x014\usb.c
                                            *                  temporary blocks other functions from executing for a        C:\fw\midicontroller\x014\usb.c
                                            *                  period of 1-13 ms depending on the core frequency.           C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          C:\fw\midicontroller\x014\usb.c
                                            *                  "The remote wakeup device must hold the resume signaling     C:\fw\midicontroller\x014\usb.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                C:\fw\midicontroller\x014\usb.c
                                            *                  The idea here is to use a delay counter loop, using a        C:\fw\midicontroller\x014\usb.c
                                            *                  common value that would work over a wide range of core       C:\fw\midicontroller\x014\usb.c
                                            *                  frequencies.                                                 C:\fw\midicontroller\x014\usb.c
                                            *                  That value selected is 1800. See table below:                C:\fw\midicontroller\x014\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x014\usb.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    C:\fw\midicontroller\x014\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x014\usb.c
                                            *                      48              12          1.05                         C:\fw\midicontroller\x014\usb.c
                                            *                       4              1           12.6                         C:\fw\midicontroller\x014\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x014\usb.c
                                            *                  * These timing could be incorrect when using code            C:\fw\midicontroller\x014\usb.c
                                            *                    optimization or extended instruction mode,                 C:\fw\midicontroller\x014\usb.c
                                            *                    or when having other interrupts enabled.                   C:\fw\midicontroller\x014\usb.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBRemoteWakeup(void)                                                       C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               static word delay_count;                                                     C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023b8   0101     MOVLB     0x1                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    C:\fw\midicontroller\x014\usb.c
0023ba   a123     BTFSS     0x23,0x0,0x1                                                                                    
0023bc   d00e     BRA       0x23da                                                                                          
                                               {                                       // has been enabled by the host.     C:\fw\midicontroller\x014\usb.c
0023be   dff8     RCALL     0x23b0                 USBWakeFromSuspend();               // Unsuspend USB modue               C:\fw\midicontroller\x014\usb.c
0023c0   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /* Modifiable Section */                                                 C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023c2   0101     MOVLB     0x1                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       C:\fw\midicontroller\x014\usb.c
0023c4   0e08     MOVLW     0x8                                                                                             
0023c6   6f2e     MOVWF     0x2e,0x1                                                                                        
0023c8   0e07     MOVLW     0x7                                                                                             
0023ca   6f2f     MOVWF     0x2f,0x1                                                                                        
                                                   do                                                                       C:\fw\midicontroller\x014\usb.c
                                                   {                                                                        C:\fw\midicontroller\x014\usb.c
0023cc   072e     DECF      0x2e,0x1,0x1               delay_count--;                                                       C:\fw\midicontroller\x014\usb.c
0023ce   0e00     MOVLW     0x0                                                                                             
0023d0   5b2f     SUBWFB    0x2f,0x1,0x1                                                                                    
0023d2   512e     MOVF      0x2e,0x0,0x1           }while(delay_count);                                                     C:\fw\midicontroller\x014\usb.c
0023d4   112f     IORWF     0x2f,0x0,0x1                                                                                    
0023d6   e1fa     BNZ       0x23cc                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                   /* End Modifiable Section */                                             C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023d8   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     C:\fw\midicontroller\x014\usb.c
                                               }//endif                                                                     C:\fw\midicontroller\x014\usb.c
0023da   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USB_SOF_Handler(void)                                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    C:\fw\midicontroller\x014\usb.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     C:\fw\midicontroller\x014\usb.c
                                            *                  pipes. End designers should implement callback routine       C:\fw\midicontroller\x014\usb.c
                                            *                  as necessary.                                                C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USB_SOF_Handler(void)                                                       C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               /* Callback routine here */                                                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023dc   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           C:\fw\midicontroller\x014\usb.c
0023de   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBStallHandler(void)                                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         C:\fw\midicontroller\x014\usb.c
                                            *                  packet regardless of which endpoint causes it.               C:\fw\midicontroller\x014\usb.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  C:\fw\midicontroller\x014\usb.c
                                            *                  endpoint stops stalling once it receives a setup packet.     C:\fw\midicontroller\x014\usb.c
                                            *                  In this case, the SIE will accepts the Setup packet and      C:\fw\midicontroller\x014\usb.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    C:\fw\midicontroller\x014\usb.c
                                            *                  for that particular endpoint pipe will be automatically      C:\fw\midicontroller\x014\usb.c
                                            *                  disabled (direction specific).                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            *                  There are a few reasons for an endpoint to be stalled.       C:\fw\midicontroller\x014\usb.c
                                            *                  1. When a non-supported USB request is received.             C:\fw\midicontroller\x014\usb.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 C:\fw\midicontroller\x014\usb.c
                                            *                  2. When an endpoint is currently halted.                     C:\fw\midicontroller\x014\usb.c
                                            *                  3. When the device class specifies that an endpoint must     C:\fw\midicontroller\x014\usb.c
                                            *                     stall in response to a specific event.                    C:\fw\midicontroller\x014\usb.c
                                            *                     Example: Mass Storage Device Class                        C:\fw\midicontroller\x014\usb.c
                                            *                              If the CBW is not valid, the device shall        C:\fw\midicontroller\x014\usb.c
                                            *                              STALL the Bulk-In pipe.                          C:\fw\midicontroller\x014\usb.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   C:\fw\midicontroller\x014\usb.c
                                            *                              Specification for more details.                  C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     C:\fw\midicontroller\x014\usb.c
                                            *                  the stall event.                                             C:\fw\midicontroller\x014\usb.c
                                            *                  If                                                           C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBStallHandler(void)                                                       C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
                                               /*                                                                           C:\fw\midicontroller\x014\usb.c
                                                * Does not really have to do anything here,                                 C:\fw\midicontroller\x014\usb.c
                                                * even for the control endpoint.                                            C:\fw\midicontroller\x014\usb.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         C:\fw\midicontroller\x014\usb.c
                                                * but once a Setup Transaction is received, the ownership                   C:\fw\midicontroller\x014\usb.c
                                                * for EP0_OUT will be returned to CPU.                                      C:\fw\midicontroller\x014\usb.c
                                                * When the Setup Transaction is serviced, the ownership                     C:\fw\midicontroller\x014\usb.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   C:\fw\midicontroller\x014\usb.c
                                                */                                                                          C:\fw\midicontroller\x014\usb.c
0023e0   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    C:\fw\midicontroller\x014\usb.c
0023e2   d002     BRA       0x23e8                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
0023e4   df76     RCALL     0x22d2                 USBPrepareForNextSetupTrf();        // Firmware work-around              C:\fw\midicontroller\x014\usb.c
0023e6   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    C:\fw\midicontroller\x014\usb.c
                                               }                                                                            C:\fw\midicontroller\x014\usb.c
0023e8   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         C:\fw\midicontroller\x014\usb.c
0023ea   0012     RETURN    0x0            }//end USBStallHandler                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBErrorHandler(void)                                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        C:\fw\midicontroller\x014\usb.c
                                            *                  during development. Check UEIR to see which error causes     C:\fw\midicontroller\x014\usb.c
                                            *                  the interrupt.                                               C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBErrorHandler(void)                                                       C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
0023ec   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          C:\fw\midicontroller\x014\usb.c
0023ee   0012     RETURN    0x0            }//end USBErrorHandler                                                           C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\usb.c
                                            * Function:        void USBProtocolResetHandler(void)                           C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * PreCondition:    A USB bus reset is received from the host.                   C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              C:\fw\midicontroller\x014\usb.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     C:\fw\midicontroller\x014\usb.c
                                            *                  might not be desirable in some applications.                 C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Overview:        Once a USB bus reset is received from the host, this         C:\fw\midicontroller\x014\usb.c
                                            *                  routine should be called. It resets the device address to    C:\fw\midicontroller\x014\usb.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     C:\fw\midicontroller\x014\usb.c
                                            *                  be ready for default communication, clears all USB           C:\fw\midicontroller\x014\usb.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      C:\fw\midicontroller\x014\usb.c
                                            *                  reinitializes internal state-machine variables.              C:\fw\midicontroller\x014\usb.c
                                            *                                                                               C:\fw\midicontroller\x014\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\usb.c
                                           void USBProtocolResetHandler(void)                                               C:\fw\midicontroller\x014\usb.c
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
0023f0   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 C:\fw\midicontroller\x014\usb.c
0023f2   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 C:\fw\midicontroller\x014\usb.c
0023f4   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           C:\fw\midicontroller\x014\usb.c
0023f6   6e6b     MOVWF     0x6b,0x0                                                                                        
0023f8   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       C:\fw\midicontroller\x014\usb.c
0023fa   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
0023fc   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  C:\fw\midicontroller\x014\usb.c
0023fe   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          C:\fw\midicontroller\x014\usb.c
002400   6ee6     MOVWF     0xe6,0x0                                                                                        
002402   0e71     MOVLW     0x71                                                                                            
002404   6ee6     MOVWF     0xe6,0x0                                                                                        
002406   0e0f     MOVLW     0xf                                                                                             
002408   6ee6     MOVWF     0xe6,0x0                                                                                        
00240a   d811     RCALL     0x242e                                                                                          
00240c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00240e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002410   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002412   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       C:\fw\midicontroller\x014\usb.c
002414   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002416   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            C:\fw\midicontroller\x014\usb.c
002418   d002     BRA       0x241e                                                                                          
00241c   d7fc     BRA       0x2416                                                                                          
00241a   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
00241e   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    C:\fw\midicontroller\x014\usb.c
002420   df58     RCALL     0x22d2             USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
002422   0101     MOVLB     0x1                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            C:\fw\midicontroller\x014\usb.c
002424   9123     BCF       0x23,0x0,0x1                                                                                    
002426   6b24     CLRF      0x24,0x1           usb_active_cfg = 0;             // Clear active configuration                C:\fw\midicontroller\x014\usb.c
002428   0e03     MOVLW     0x3                usb_device_state = DEFAULT_STATE;                                            C:\fw\midicontroller\x014\usb.c
00242a   6f22     MOVWF     0x22,0x1                                                                                        
00242c   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /* Auxiliary Function */                                                         C:\fw\midicontroller\x014\usb.c
00242e   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       C:\fw\midicontroller\x014\usb.c
002430   ffe6                                                                                                               
002432   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002434   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x014\usb.c
002436   0efd     MOVLW     0xfd               *startAdr;                                                                   C:\fw\midicontroller\x014\usb.c
002438   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00243a   ffe9                                                                                                               
00243c   0efe     MOVLW     0xfe                                                                                            
00243e   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002440   ffea                                                                                                               
002442   0efc     MOVLW     0xfc               while(count)                                                                 C:\fw\midicontroller\x014\usb.c
002444   50db     MOVF      0xdb,0x0,0x0                                                                                    
002446   e004     BZ        0x2450                                                                                          
00244e   d7f9     BRA       0x2442                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\usb.c
                                                   _asm                                                                     C:\fw\midicontroller\x014\usb.c
002448   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          C:\fw\midicontroller\x014\usb.c
                                                   _endasm                                                                  C:\fw\midicontroller\x014\usb.c
00244a   0efc     MOVLW     0xfc                   count--;                                                                 C:\fw\midicontroller\x014\usb.c
00244c   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 C:\fw\midicontroller\x014\usb.c
002450   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                C:\fw\midicontroller\x014\usb.c
002452   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002454   ffd9                                                                                                               
002456   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                           /** EOF usbdrv.c *************************************************************/  C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usb.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x014\usbapplet.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           void PROCESS_COMM_REQUEST(void);                                                 C:\fw\midicontroller\x014\usbapplet.c
                                           //void RemCapCalculation(void);                                                  C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           void HIDSetReportHandler(void) {                                                 C:\fw\midicontroller\x014\usbapplet.c
002f0e   0100     MOVLB     0x0            	USBQuery = true;                                                                C:\fw\midicontroller\x014\usbapplet.c
002f10   89b8     BSF       0xb8,0x4,0x1                                                                                    
002f12   ec28     CALL      0x2a50,0x0     	PROCESS_COMM_REQUEST();                                                         C:\fw\midicontroller\x014\usbapplet.c
002f14   f015                                                                                                               
002f16   0100     MOVLB     0x0            	USBQuery = false;	                                                              C:\fw\midicontroller\x014\usbapplet.c
002f18   99b8     BCF       0xb8,0x4,0x1                                                                                    
002f1a   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\usbapplet.c
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x014\usbapplet.c
                                           void HIDGetReportHandler(void) {                                                 C:\fw\midicontroller\x014\usbapplet.c
                                           //load up CtrlTrfData with data.                                                 C:\fw\midicontroller\x014\usbapplet.c
002f1c   0100     MOVLB     0x0            	USBQuery = true;                                                                C:\fw\midicontroller\x014\usbapplet.c
002f1e   89b8     BSF       0xb8,0x4,0x1                                                                                    
002f20   ec28     CALL      0x2a50,0x0     	PROCESS_COMM_REQUEST();                                                         C:\fw\midicontroller\x014\usbapplet.c
002f22   f015                                                                                                               
002f24   0101     MOVLB     0x1            	ctrl_trf_session_owner = MUID_HID;                                              C:\fw\midicontroller\x014\usbapplet.c
002f26   0e02     MOVLW     0x2                                                                                             
002f28   6f27     MOVWF     0x27,0x1                                                                                        
002f2a   0101     MOVLB     0x1            	pSrc.bRam = (byte*)&CtrlTrfData;                                                C:\fw\midicontroller\x014\usbapplet.c
002f2c   0e50     MOVLW     0x50                                                                                            
002f2e   6f28     MOVWF     0x28,0x1                                                                                        
002f30   0e04     MOVLW     0x4                                                                                             
002f32   6f29     MOVWF     0x29,0x1                                                                                        
002f34   0101     MOVLB     0x1            	usb_stat.ctrl_trf_mem = _RAM;       // Set memory type                          C:\fw\midicontroller\x014\usbapplet.c
002f36   9323     BCF       0x23,0x1,0x1                                                                                    
002f38   0100     MOVLB     0x0            	USBQuery = false;                                                               C:\fw\midicontroller\x014\usbapplet.c
002f3a   99b8     BCF       0xb8,0x4,0x1                                                                                    
002f3c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           /*                                                                               C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           typedef union DATA_PACKET                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           {                                                                                C:\fw\midicontroller\x014\usbapplet.c
                                               byte _byte[HID_INT_OUT_EP_SIZE];  //For byte access                          C:\fw\midicontroller\x014\usbapplet.c
                                               word _word[HID_INT_OUT_EP_SIZE/2];//For word access(USBGEN_EP_SIZE msut be even) C:\fw\midicontroller\x014\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x014\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                   enum                                                                     C:\fw\midicontroller\x014\usbapplet.c
                                                   {                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                                       READ_VERSION    = 0x00,                                              C:\fw\midicontroller\x014\usbapplet.c
                                           //            READ_FLASH      = 0x01,                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //            WRITE_FLASH     = 0x02,                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //            ERASE_FLASH     = 0x03,                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //            READ_EEDATA     = 0x04,                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //            WRITE_EEDATA    = 0x05,                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //            READ_CONFIG     = 0x06,                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //            WRITE_CONFIG    = 0x07,                                            C:\fw\midicontroller\x014\usbapplet.c
                                                       ID_BOARD        = 0x31,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       UPDATE_LED      = 0x32,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       SET_TEMP_REAL   = 0x33,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       RD_TEMP         = 0x34,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       SET_TEMP_LOGGING= 0x35,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       RD_TEMP_LOGGING = 0x36,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       RD_POT          = 0x37,                                              C:\fw\midicontroller\x014\usbapplet.c
                                                       RESET           = 0xFF                                               C:\fw\midicontroller\x014\usbapplet.c
                                                   }CMD;                                                                    C:\fw\midicontroller\x014\usbapplet.c
                                                   byte len;                                                                C:\fw\midicontroller\x014\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x014\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x014\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                   unsigned :8;                                                             C:\fw\midicontroller\x014\usbapplet.c
                                                   byte ID;                                                                 C:\fw\midicontroller\x014\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x014\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x014\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                   unsigned :8;                                                             C:\fw\midicontroller\x014\usbapplet.c
                                                   byte led_num;                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                   byte led_status;                                                         C:\fw\midicontroller\x014\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x014\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x014\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                   unsigned :8;                                                             C:\fw\midicontroller\x014\usbapplet.c
                                                   word word_data;                                                          C:\fw\midicontroller\x014\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x014\usbapplet.c
                                           } DATA_PACKET;                                                                   C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           DATA_PACKET dataPacket;                                                          C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           void ServiceRequests(void)                                                       C:\fw\midicontroller\x014\usbapplet.c
                                           {    byte index, counter;                                                        C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                               if(HIDRxReport((byte*)&dataPacket,sizeof(dataPacket)))                       C:\fw\midicontroller\x014\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                   counter = 0;                                                             C:\fw\midicontroller\x014\usbapplet.c
                                                   switch(dataPacket.CMD)                                                   C:\fw\midicontroller\x014\usbapplet.c
                                                   {                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                                       case READ_VERSION:                                                   C:\fw\midicontroller\x014\usbapplet.c
                                                           //dataPacket._byte[1] is len                                     C:\fw\midicontroller\x014\usbapplet.c
                                                           dataPacket._byte[2] = 0x01;                                      C:\fw\midicontroller\x014\usbapplet.c
                                                           dataPacket._byte[3] = 0x02;                                      C:\fw\midicontroller\x014\usbapplet.c
                                                           counter=0x04;                                                    C:\fw\midicontroller\x014\usbapplet.c
                                                           break;                                                           C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                       default:                                                             C:\fw\midicontroller\x014\usbapplet.c
                                                           //dataPacket._byte[1] is len                                     C:\fw\midicontroller\x014\usbapplet.c
                                                           dataPacket._byte[2] = 0x01;                                      C:\fw\midicontroller\x014\usbapplet.c
                                                           dataPacket._byte[3] = 0x02;                                      C:\fw\midicontroller\x014\usbapplet.c
                                                           counter=64;                                                      C:\fw\midicontroller\x014\usbapplet.c
                                                           break;                                                           C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                           break;                                                           C:\fw\midicontroller\x014\usbapplet.c
                                                   }//end switch()                                                          C:\fw\midicontroller\x014\usbapplet.c
                                                   if(counter != 0)                                                         C:\fw\midicontroller\x014\usbapplet.c
                                                   {                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                                       if(!mHIDTxIsBusy())                                                  C:\fw\midicontroller\x014\usbapplet.c
                                                           HIDTxReport((byte*)&dataPacket,counter);                         C:\fw\midicontroller\x014\usbapplet.c
                                                   }//end if                                                                C:\fw\midicontroller\x014\usbapplet.c
                                               }//end if                                                                    C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           }//end ServiceRequests                                                           C:\fw\midicontroller\x014\usbapplet.c
                                           */                                                                               C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           unsigned char PresentCmd;                                                        C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //This handles data over report ID 44                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //Device to host must always follow a host to device                             C:\fw\midicontroller\x014\usbapplet.c
002f3e   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ProcessGenericTransferRead(void) {                                 C:\fw\midicontroller\x014\usbapplet.c
002f40   ffe6                                                                                                               
002f42   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002f44   ffd9                                                                                                               
002f46   0e02     MOVLW     0x2                                                                                             
002f48   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char index, cmdrecognized;                                             C:\fw\midicontroller\x014\usbapplet.c
                                           	                                                                                C:\fw\midicontroller\x014\usbapplet.c
002f4a   52de     MOVF      0xde,0x1,0x0   	cmdrecognized = true;                                                           C:\fw\midicontroller\x014\usbapplet.c
002f4c   0e01     MOVLW     0x1                                                                                             
002f4e   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	                                                                                C:\fw\midicontroller\x014\usbapplet.c
002f50   c0ff     MOVFF     0xff,0xfe6     	TXENQ(PresentCmd);                                                              C:\fw\midicontroller\x014\usbapplet.c
002f52   ffe6                                                                                                               
002f54   ec53     CALL      0x2ca6,0x0                                                                                      
002f56   f016                                                                                                               
002f58   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	                                                                                C:\fw\midicontroller\x014\usbapplet.c
002f5a   0100     MOVLB     0x0            	switch (PresentCmd) {                                                           C:\fw\midicontroller\x014\usbapplet.c
002f5c   51ff     MOVF      0xff,0x0,0x1                                                                                    
002f5e   0a32     XORLW     0x32                                                                                            
002f60   e001     BZ        0x2f64                                                                                          
                                           		case	READ_32:		//use address set previously to send out new data               C:\fw\midicontroller\x014\usbapplet.c
002f64   c0b6     MOVFF     0xb6,0xfe6     			TXENQ(ROMCommAddr.b_form.low);                                                C:\fw\midicontroller\x014\usbapplet.c
002f66   ffe6                                                                                                               
002f68   ec53     CALL      0x2ca6,0x0                                                                                      
002f6a   f016                                                                                                               
002f6c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f6e   c0b7     MOVFF     0xb7,0xfe6     			TXENQ(ROMCommAddr.b_form.high);                                               C:\fw\midicontroller\x014\usbapplet.c
002f70   ffe6                                                                                                               
002f72   ec53     CALL      0x2ca6,0x0                                                                                      
002f74   f016                                                                                                               
002f76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f78   6adf     CLRF      0xdf,0x0       			for (index=0;index<32;index++) {                                              C:\fw\midicontroller\x014\usbapplet.c
002f7a   0e20     MOVLW     0x20                                                                                            
002f7c   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
002f7e   e20f     BC        0x2f9e                                                                                          
002f9a   2adf     INCF      0xdf,0x1,0x0                                                                                    
002f9c   d7ee     BRA       0x2f7a                                                                                          
002f80   50df     MOVF      0xdf,0x0,0x0   				TXENQ(*(rom unsigned char *)(ROMCommAddr.s_form+index));                     C:\fw\midicontroller\x014\usbapplet.c
002f82   0100     MOVLB     0x0                                                                                             
002f84   6af7     CLRF      0xf7,0x0                                                                                        
002f86   25b6     ADDWF     0xb6,0x0,0x1                                                                                    
002f88   6ef6     MOVWF     0xf6,0x0                                                                                        
002f8a   51b7     MOVF      0xb7,0x0,0x1                                                                                    
002f8c   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002f8e   0008     TBLRD                                                                                                     
002f90   50f5     MOVF      0xf5,0x0,0x0                                                                                    
002f92   6ee6     MOVWF     0xe6,0x0                                                                                        
002f94   ec53     CALL      0x2ca6,0x0                                                                                      
002f96   f016                                                                                                               
002f98   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\usbapplet.c
002f9e   d000     BRA       0x2fa0         			break;                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           		default:                                                                       C:\fw\midicontroller\x014\usbapplet.c
                                           			//cmdrecognized = false;                                                      C:\fw\midicontroller\x014\usbapplet.c
002f62   d01e     BRA       0x2fa0         			break;                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           	}                                                                               C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           	//fill out the rest of the buffer with 0's                                      C:\fw\midicontroller\x014\usbapplet.c
002fa0   0e40     MOVLW     0x40           	for (;USBDataPointer<64;USBDataPointer++) {                                     C:\fw\midicontroller\x014\usbapplet.c
002fa2   0100     MOVLB     0x0                                                                                             
002fa4   5d70     SUBWF     0x70,0x0,0x1                                                                                    
002fa6   e207     BC        0x2fb6                                                                                          
002fb0   0100     MOVLB     0x0                                                                                             
002fb2   2b70     INCF      0x70,0x1,0x1                                                                                    
002fb4   d7f5     BRA       0x2fa0                                                                                          
002fa8   6ae6     CLRF      0xe6,0x0       		TXENQ(0);                                                                      C:\fw\midicontroller\x014\usbapplet.c
002faa   ec53     CALL      0x2ca6,0x0                                                                                      
002fac   f016                                                                                                               
002fae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\usbapplet.c
                                           	                                                                                C:\fw\midicontroller\x014\usbapplet.c
002fb6   0e01     MOVLW     0x1            	return cmdrecognized;                                                           C:\fw\midicontroller\x014\usbapplet.c
002fb8   50db     MOVF      0xdb,0x0,0x0                                                                                    
002fba   6e10     MOVWF     0x10,0x0       }                                                                                C:\fw\midicontroller\x014\usbapplet.c
002fbc   0e02     MOVLW     0x2                                                                                             
002fbe   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002fc0   e203     BC        0x2fc8                                                                                          
002fc2   d000     BRA       0x2fc4                                                                                          
002fc4   6ae1     CLRF      0xe1,0x0                                                                                        
002fc6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002fc8   6ee1     MOVWF     0xe1,0x0                                                                                        
002fca   5010     MOVF      0x10,0x0,0x0                                                                                    
002fcc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002fce   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002fd0   ffd9                                                                                                               
002fd2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
                                           //This handles data over report ID 44.	                                          C:\fw\midicontroller\x014\usbapplet.c
002fd4   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ProcessGenericTransferWrite(void) {                                C:\fw\midicontroller\x014\usbapplet.c
002fd6   ffe6                                                                                                               
002fd8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002fda   ffd9                                                                                                               
002fdc   0e04     MOVLW     0x4                                                                                             
002fde   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char index, cmdrecognized;                                             C:\fw\midicontroller\x014\usbapplet.c
                                           	unsigned short Address;                                                         C:\fw\midicontroller\x014\usbapplet.c
                                           	                                                                                C:\fw\midicontroller\x014\usbapplet.c
002fe0   52de     MOVF      0xde,0x1,0x0   	cmdrecognized = true;                                                           C:\fw\midicontroller\x014\usbapplet.c
002fe2   0e01     MOVLW     0x1                                                                                             
002fe4   6edd     MOVWF     0xdd,0x0                                                                                        
002fe6   c072     MOVFF     0x72,0xff      	PresentCmd = USBEP0DataInBuffer[1];                                             C:\fw\midicontroller\x014\usbapplet.c
002fe8   f0ff                                                                                                               
002fea   0100     MOVLB     0x0            	switch (USBEP0DataInBuffer[1]) {                                                C:\fw\midicontroller\x014\usbapplet.c
002fec   5172     MOVF      0x72,0x0,0x1                                                                                    
002fee   0a32     XORLW     0x32                                                                                            
002ff0   e02b     BZ        0x3048                                                                                          
002ff2   0a03     XORLW     0x3                                                                                             
002ff4   e00a     BZ        0x300a                                                                                          
002ff6   0a01     XORLW     0x1                                                                                             
002ff8   e001     BZ        0x2ffc                                                                                          
                                           		case	ERASE_32:                                                                 C:\fw\midicontroller\x014\usbapplet.c
002ffc   c073     MOVFF     0x73,0xd9      			ProgMemAddr.b_form.low = USBEP0DataInBuffer[2];                               C:\fw\midicontroller\x014\usbapplet.c
002ffe   f0d9                                                                                                               
003000   c074     MOVFF     0x74,0xda      			ProgMemAddr.b_form.high = USBEP0DataInBuffer[3];                              C:\fw\midicontroller\x014\usbapplet.c
003002   f0da                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
003004   ec7f     CALL      0x32fe,0x0     			EraseProgMem();	//uses global ProgMemAddr                                     C:\fw\midicontroller\x014\usbapplet.c
003006   f019                                                                                                               
003008   d024     BRA       0x3052         			break;                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           		case	WRITE_32:                                                                 C:\fw\midicontroller\x014\usbapplet.c
00300a   c073     MOVFF     0x73,0xd9      			ProgMemAddr.b_form.low = USBEP0DataInBuffer[2];                               C:\fw\midicontroller\x014\usbapplet.c
00300c   f0d9                                                                                                               
00300e   c074     MOVFF     0x74,0xda      			ProgMemAddr.b_form.high = USBEP0DataInBuffer[3];                              C:\fw\midicontroller\x014\usbapplet.c
003010   f0da                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
003012   6adf     CLRF      0xdf,0x0       			for (index=0;index<32;index++)                                                C:\fw\midicontroller\x014\usbapplet.c
003014   0e20     MOVLW     0x20                                                                                            
003016   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
003018   e214     BC        0x3042                                                                                          
00303e   2adf     INCF      0xdf,0x1,0x0                                                                                    
003040   d7e9     BRA       0x3014                                                                                          
00301a   0e04     MOVLW     0x4            				ProgmemBuffer[index] = USBEP0DataInBuffer[index+4];                          C:\fw\midicontroller\x014\usbapplet.c
00301c   24df     ADDWF     0xdf,0x0,0x0                                                                                    
00301e   6aea     CLRF      0xea,0x0                                                                                        
003020   0f71     ADDLW     0x71                                                                                            
003022   6ee9     MOVWF     0xe9,0x0                                                                                        
003024   0e00     MOVLW     0x0                                                                                             
003026   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003028   50ef     MOVF      0xef,0x0,0x0                                                                                    
00302a   6ee6     MOVWF     0xe6,0x0                                                                                        
00302c   50df     MOVF      0xdf,0x0,0x0                                                                                    
00302e   6aea     CLRF      0xea,0x0                                                                                        
003030   0fb9     ADDLW     0xb9                                                                                            
003032   6ee9     MOVWF     0xe9,0x0                                                                                        
003034   0e00     MOVLW     0x0                                                                                             
003036   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003038   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00303a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00303c   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\usbapplet.c
003042   ec52     CALL      0x32a4,0x0     			WriteProgMem();	//uses global ProgMemAddr and ProgmemBuffer[]                 C:\fw\midicontroller\x014\usbapplet.c
003044   f019                                                                                                               
003046   d005     BRA       0x3052         			break;                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           		case	READ_32:                                                                  C:\fw\midicontroller\x014\usbapplet.c
003048   c073     MOVFF     0x73,0xb6      			ROMCommAddr.b_form.low = USBEP0DataInBuffer[2];                               C:\fw\midicontroller\x014\usbapplet.c
00304a   f0b6                                                                                                               
00304c   c074     MOVFF     0x74,0xb7      			ROMCommAddr.b_form.high = USBEP0DataInBuffer[3];                              C:\fw\midicontroller\x014\usbapplet.c
00304e   f0b7                                                                                                               
003050   d000     BRA       0x3052         			break;                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           		default:                                                                       C:\fw\midicontroller\x014\usbapplet.c
                                           			//cmdrecognized = false;                                                      C:\fw\midicontroller\x014\usbapplet.c
002ffa   d02b     BRA       0x3052         			break;                                                                        C:\fw\midicontroller\x014\usbapplet.c
                                           	}                                                                               C:\fw\midicontroller\x014\usbapplet.c
003052   0e01     MOVLW     0x1            	return cmdrecognized;                                                           C:\fw\midicontroller\x014\usbapplet.c
003054   50db     MOVF      0xdb,0x0,0x0                                                                                    
003056   6e10     MOVWF     0x10,0x0       }                                                                                C:\fw\midicontroller\x014\usbapplet.c
003058   0e04     MOVLW     0x4                                                                                             
00305a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00305c   e203     BC        0x3064                                                                                          
00305e   d000     BRA       0x3060                                                                                          
003060   6ae1     CLRF      0xe1,0x0                                                                                        
003062   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003064   6ee1     MOVWF     0xe1,0x0                                                                                        
003066   5010     MOVF      0x10,0x0,0x0                                                                                    
003068   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00306a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00306c   ffd9                                                                                                               
00306e   0012     RETURN    0x0                                                                                             
                                           /*********************************************************************           C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            *********************************************************************           C:\fw\midicontroller\x014\usbdescript.c
                                            * FileName:        usbdsc.c                                                     C:\fw\midicontroller\x014\usbdescript.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x014\usbdescript.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x014\usbdescript.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x014\usbdescript.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x014\usbdescript.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x014\usbdescript.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x014\usbdescript.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x014\usbdescript.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x014\usbdescript.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x014\usbdescript.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x014\usbdescript.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x014\usbdescript.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x014\usbdescript.c
                                            * license.                                                                      C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x014\usbdescript.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x014\usbdescript.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x014\usbdescript.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x014\usbdescript.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x014\usbdescript.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /*********************************************************************           C:\fw\midicontroller\x014\usbdescript.c
                                            * -usbdsc.c-                                                                    C:\fw\midicontroller\x014\usbdescript.c
                                            * This file contains the USB descriptor information. It is used                 C:\fw\midicontroller\x014\usbdescript.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             C:\fw\midicontroller\x014\usbdescript.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                C:\fw\midicontroller\x014\usbdescript.c
                                            * the user must also change the descriptor structure defined in                 C:\fw\midicontroller\x014\usbdescript.c
                                            * the usbdsc.h file. The structure is used to calculate the                     C:\fw\midicontroller\x014\usbdescript.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * A typical configuration descriptor consists of:                               C:\fw\midicontroller\x014\usbdescript.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           C:\fw\midicontroller\x014\usbdescript.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              C:\fw\midicontroller\x014\usbdescript.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * Naming Convention:                                                            C:\fw\midicontroller\x014\usbdescript.c
                                            * To resolve ambiguity, the naming convention are as followed:                  C:\fw\midicontroller\x014\usbdescript.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      C:\fw\midicontroller\x014\usbdescript.c
                                            *   configuration number. This number should match the actual                   C:\fw\midicontroller\x014\usbdescript.c
                                            *   index value of this configuration.                                          C:\fw\midicontroller\x014\usbdescript.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               C:\fw\midicontroller\x014\usbdescript.c
                                            *   interface number and zz is the alternate interface number.                  C:\fw\midicontroller\x014\usbdescript.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 C:\fw\midicontroller\x014\usbdescript.c
                                            *   ## is the endpoint number and d is the direction of transfer.               C:\fw\midicontroller\x014\usbdescript.c
                                            *   The interface name should also be listed as a suffix to identify            C:\fw\midicontroller\x014\usbdescript.c
                                            *   which interface does the endpoint belong to.                                C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * Example:                                                                      C:\fw\midicontroller\x014\usbdescript.c
                                            * If a device has one configuration, two interfaces; interface 0                C:\fw\midicontroller\x014\usbdescript.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         C:\fw\midicontroller\x014\usbdescript.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * #define CFG01 rom struct                            \                         C:\fw\midicontroller\x014\usbdescript.c
                                            * {   USB_CFG_DSC             cd01;                   \                         C:\fw\midicontroller\x014\usbdescript.c
                                            *     USB_INTF_DSC            i00a00;                 \                         C:\fw\midicontroller\x014\usbdescript.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         C:\fw\midicontroller\x014\usbdescript.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         C:\fw\midicontroller\x014\usbdescript.c
                                            *     USB_INTF_DSC            i01a00;                 \                         C:\fw\midicontroller\x014\usbdescript.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         C:\fw\midicontroller\x014\usbdescript.c
                                            * } cfg01                                                                       C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               C:\fw\midicontroller\x014\usbdescript.c
                                            * specification requirement. All endpoints belonging to an interface            C:\fw\midicontroller\x014\usbdescript.c
                                            * should be listed immediately after that interface.                            C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x014\usbdescript.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        C:\fw\midicontroller\x014\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x014\usbdescript.c
                                            * Most items should be self-explanatory, however, a few will be                 C:\fw\midicontroller\x014\usbdescript.c
                                            * explained for clarification.                                                  C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       C:\fw\midicontroller\x014\usbdescript.c
                                            * The configuration attribute must always have the _DEFAULT                     C:\fw\midicontroller\x014\usbdescript.c
                                            * definition at the minimum. Additional options can be ORed                     C:\fw\midicontroller\x014\usbdescript.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              C:\fw\midicontroller\x014\usbdescript.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              C:\fw\midicontroller\x014\usbdescript.c
                                            * _SELF tells the USB host that this device is self-powered. The                C:\fw\midicontroller\x014\usbdescript.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             C:\fw\midicontroller\x014\usbdescript.c
                                            * Assume the following example:                                                 C:\fw\midicontroller\x014\usbdescript.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * The first two parameters are self-explanatory. They specify the               C:\fw\midicontroller\x014\usbdescript.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               C:\fw\midicontroller\x014\usbdescript.c
                                            * The next parameter identifies the endpoint, the definitions are               C:\fw\midicontroller\x014\usbdescript.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     C:\fw\midicontroller\x014\usbdescript.c
                                            * convention:                                                                   C:\fw\midicontroller\x014\usbdescript.c
                                            * _EP<##>_<dir>                                                                 C:\fw\midicontroller\x014\usbdescript.c
                                            * where ## is the endpoint number and dir is the direction of                   C:\fw\midicontroller\x014\usbdescript.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      C:\fw\midicontroller\x014\usbdescript.c
                                            * The next parameter identifies the type of the endpoint. Available             C:\fw\midicontroller\x014\usbdescript.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    C:\fw\midicontroller\x014\usbdescript.c
                                            * typically used because the default control transfer endpoint is               C:\fw\midicontroller\x014\usbdescript.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 C:\fw\midicontroller\x014\usbdescript.c
                                            * addition options can be ORed to _ISO. Example:                                C:\fw\midicontroller\x014\usbdescript.c
                                            * _ISO|_AD|_FE                                                                  C:\fw\midicontroller\x014\usbdescript.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              C:\fw\midicontroller\x014\usbdescript.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    C:\fw\midicontroller\x014\usbdescript.c
                                            * specification for details. The next parameter defines the size of             C:\fw\midicontroller\x014\usbdescript.c
                                            * the endpoint. The last parameter in the polling interval.                     C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x014\usbdescript.c
                                            * Adding a USB String                                                           C:\fw\midicontroller\x014\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x014\usbdescript.c
                                            * A string descriptor array should have the following format:                   C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              C:\fw\midicontroller\x014\usbdescript.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * The above structure provides a means for the C compiler to                    C:\fw\midicontroller\x014\usbdescript.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             C:\fw\midicontroller\x014\usbdescript.c
                                            * index number. The first two bytes of the descriptor are descriptor            C:\fw\midicontroller\x014\usbdescript.c
                                            * length and type. The rest <text> are string texts which must be               C:\fw\midicontroller\x014\usbdescript.c
                                            * in the unicode format. The unicode format is achieved by declaring            C:\fw\midicontroller\x014\usbdescript.c
                                            * each character as a word type. The whole text string is declared              C:\fw\midicontroller\x014\usbdescript.c
                                            * as a word array with the number of characters equals to <size>.               C:\fw\midicontroller\x014\usbdescript.c
                                            * <size> has to be manually counted and entered into the array                  C:\fw\midicontroller\x014\usbdescript.c
                                            * declaration. Let's study this through an example:                             C:\fw\midicontroller\x014\usbdescript.c
                                            * if the string is "USB" , then the string descriptor should be:                C:\fw\midicontroller\x014\usbdescript.c
                                            * (Using index 02)                                                              C:\fw\midicontroller\x014\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 C:\fw\midicontroller\x014\usbdescript.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * A USB project may have multiple strings and the firmware supports             C:\fw\midicontroller\x014\usbdescript.c
                                            * the management of multiple strings through a look-up table.                   C:\fw\midicontroller\x014\usbdescript.c
                                            * The look-up table is defined as:                                              C:\fw\midicontroller\x014\usbdescript.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 C:\fw\midicontroller\x014\usbdescript.c
                                            * Strings can be removed or added. sd000 is a specialized string                C:\fw\midicontroller\x014\usbdescript.c
                                            * descriptor. It defines the language code, usually this is                     C:\fw\midicontroller\x014\usbdescript.c
                                            * US English (0x0409). The index of the string must match the index             C:\fw\midicontroller\x014\usbdescript.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  C:\fw\midicontroller\x014\usbdescript.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            C:\fw\midicontroller\x014\usbdescript.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                C:\fw\midicontroller\x014\usbdescript.c
                                            * function in usb9.c.                                                           C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * The look-up table scheme also applies to the configuration                    C:\fw\midicontroller\x014\usbdescript.c
                                            * descriptor. A USB device may have multiple configuration                      C:\fw\midicontroller\x014\usbdescript.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   C:\fw\midicontroller\x014\usbdescript.c
                                            * descriptor, user must implement a structure similar to CFG01.                 C:\fw\midicontroller\x014\usbdescript.c
                                            * The next step is to add the configuration descriptor name, i.e.               C:\fw\midicontroller\x014\usbdescript.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               C:\fw\midicontroller\x014\usbdescript.c
                                            * is a dummy place holder since configuration 0 is the un-configured            C:\fw\midicontroller\x014\usbdescript.c
                                            * state according to the definition in the USB specification.                   C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /*********************************************************************           C:\fw\midicontroller\x014\usbdescript.c
                                            * Descriptor specific type definitions are defined in:                          C:\fw\midicontroller\x014\usbdescript.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          C:\fw\midicontroller\x014\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                            * Configuration information is defined in:                                      C:\fw\midicontroller\x014\usbdescript.c
                                            * autofiles\usbcfg.h                                                            C:\fw\midicontroller\x014\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           #define POLLING_INTERVAL	40                                                      C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /** I N C L U D E S *************************************************/           C:\fw\midicontroller\x014\usbdescript.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /** C O N S T A N T S ************************************************/          C:\fw\midicontroller\x014\usbdescript.c
                                           #pragma romdata                                                                  C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /* Device Descriptor */                                                          C:\fw\midicontroller\x014\usbdescript.c
                                           rom USB_DEV_DSC device_dsc=                                                      C:\fw\midicontroller\x014\usbdescript.c
                                           {                                                                                C:\fw\midicontroller\x014\usbdescript.c
                                               0x12,     	// bLength                                                        C:\fw\midicontroller\x014\usbdescript.c
                                               0x01,     	// bDescriptorType                                                C:\fw\midicontroller\x014\usbdescript.c
                                               0x0110,    	// bcdUSB (spec release #)                                       C:\fw\midicontroller\x014\usbdescript.c
                                               0x00,     	// bDeviceClass                                                   C:\fw\midicontroller\x014\usbdescript.c
                                               0x00,     	// bDeviceSubClass                                                C:\fw\midicontroller\x014\usbdescript.c
                                               0x00,     	// bDeviceProtocol                                                C:\fw\midicontroller\x014\usbdescript.c
                                               EP0_BUFF_SIZE,     	// bMaxPacketSize0                                       C:\fw\midicontroller\x014\usbdescript.c
                                               0x09AE,     // idVendor                                                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x4430,		// idProduct                                                        C:\fw\midicontroller\x014\usbdescript.c
                                               0x0010,    	// bcdDevice : Project version = 0.10                            C:\fw\midicontroller\x014\usbdescript.c
                                               INDEX_MANUFACTURER,	// Index of string Descriptor describing manufacturer      C:\fw\midicontroller\x014\usbdescript.c
                                               INDEX_NAME,			// Index of string Descriptor describing product               C:\fw\midicontroller\x014\usbdescript.c
                                               INDEX_SERIALNUM,	// Index of string Descriptor describing the device's serial number C:\fw\midicontroller\x014\usbdescript.c
                                               0x01				// bNumConfigurations : renaud 1 configuration                       C:\fw\midicontroller\x014\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /* Configuration 1 Descriptor */                                                 C:\fw\midicontroller\x014\usbdescript.c
                                           CFG01={                                                                          C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09,		// bLength: Configuration Descriptor size                                C:\fw\midicontroller\x014\usbdescript.c
                                           	0x02,		// bDescriptorType: Configuration                                        C:\fw\midicontroller\x014\usbdescript.c
                                           	P1_CONFDESC_LEN,	//(word) Length of configuration descriptor. **Renaud : To update C:\fw\midicontroller\x014\usbdescript.c
                                           	0x01,		// bNumInterfaces: 1 interface.                                          C:\fw\midicontroller\x014\usbdescript.c
                                           	0x01,		// bConfigurationValue: Configuration value = 1                          C:\fw\midicontroller\x014\usbdescript.c
                                           	0,			// iConfiguration: Index of string descriptor describing the configuration (None) C:\fw\midicontroller\x014\usbdescript.c
                                           //	0x80,		// bmAttributes: Bus powered and NO Remote wakeup                      C:\fw\midicontroller\x014\usbdescript.c
                                           	0xA0,		// bmAttributes: Bus powered and Remote wakeup ** Renaud : changed from 0xE0 C:\fw\midicontroller\x014\usbdescript.c
                                           //	0xC0,		// bmAttributes: Self powered and NO Remote wakeup                     C:\fw\midicontroller\x014\usbdescript.c
                                           //	0xE0,		// bmAttributes: Self powered and Remote wakeup                        C:\fw\midicontroller\x014\usbdescript.c
                                           	0x32,		// MaxPower 50 mA : ** Renaud : MaxPowerself-powered draws 0 mA from the bus.  C:\fw\midicontroller\x014\usbdescript.c
                                           //	0x00,		// 0 mA power consumption.                                             C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           // Interface descriptor (Interface 0 = DemoKit)                                  C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09,		// bLength: Interface Descriptor size                                    C:\fw\midicontroller\x014\usbdescript.c
                                           	0x04,		// bDescriptorType: Interface descriptor type  ** Renaud : to check      C:\fw\midicontroller\x014\usbdescript.c
                                           	0x00,		// bInterfaceNumber: Interface Number = 0                                C:\fw\midicontroller\x014\usbdescript.c
                                           	0x00,		// bAlternateSetting: No Alternate setting                               C:\fw\midicontroller\x014\usbdescript.c
                                           	0x01,		// bNumEndpoints:                                                        C:\fw\midicontroller\x014\usbdescript.c
                                           	0x03,		// bInterfaceClass: HID                                                  C:\fw\midicontroller\x014\usbdescript.c
                                           	0x00,		// bInterfaceSubClass:                                                   C:\fw\midicontroller\x014\usbdescript.c
                                           	0x00,		// bInterfaceProtocol: ** Renaud : changed from 2 (protocol - mouse in tripplite descriptor) to 0 : no protocol  C:\fw\midicontroller\x014\usbdescript.c
                                           	0x00,		// iInterface: Index of string descriptor (No string value)              C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           // HID descriptor (Demokit)                                                      C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09,		// bLength: HID Descriptor size                                          C:\fw\midicontroller\x014\usbdescript.c
                                           	0x21,		// bDescriptorType: HID                                                  C:\fw\midicontroller\x014\usbdescript.c
                                           	0x0110,		// (word) bcdHID: HID Class Spec release number (1.10) ** Renaud : I let rev 1.10, but Tripplite has HID class release number (1.00) C:\fw\midicontroller\x014\usbdescript.c
                                           	0x00,		// bCountryCode: Hardware target country US ** Renaud changed from 0x21 (US) to 0x00 (none specified) C:\fw\midicontroller\x014\usbdescript.c
                                           	0x01,		// bNumDescriptors: Number of HID class descriptors to follow            C:\fw\midicontroller\x014\usbdescript.c
                                           	0x22,		// bDescriptorType: Report                                               C:\fw\midicontroller\x014\usbdescript.c
                                           	HID_RPT_UPS_SIZE,	// (word) Length of report descriptor interface 0 (2 bytes) ** Renaud : To update C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           // Endpoint 1 descriptor (Demokit)                                               C:\fw\midicontroller\x014\usbdescript.c
                                           	0x07,		// bLength: Endpoint Descriptor size                                     C:\fw\midicontroller\x014\usbdescript.c
                                           	0x05,		// bDescriptorType: Endpoint descriptor type   ** Renaud : To check      C:\fw\midicontroller\x014\usbdescript.c
                                           	0x81,		// bEndpointAddress: Endpoint  1 IN                                      C:\fw\midicontroller\x014\usbdescript.c
                                           	0x03,		// bmAttributes: Interrupt endpoint                                      C:\fw\midicontroller\x014\usbdescript.c
                                           	0x0008,		// wMaxPacketSize(LSB):                                                C:\fw\midicontroller\x014\usbdescript.c
                                           	POLLING_INTERVAL       // bInterval: Polling Interval (40 ms = 0x28)            C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //    sizeof(USB_EP_DSC),DSC_EP,_EP01_IN,_INT,HID_INT_IN_EP_SIZE,POLLING_INTERVAL C:\fw\midicontroller\x014\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //    sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_INT,HID_INT_OUT_EP_SIZE,POLLING_INTERVAL, C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //2/8/05 JD language selection I think..                                         C:\fw\midicontroller\x014\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    C:\fw\midicontroller\x014\usbdescript.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //Manufacturer string                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[11];}MfrString={               C:\fw\midicontroller\x014\usbdescript.c
                                           sizeof(MfrString),DSC_STR,                                                       C:\fw\midicontroller\x014\usbdescript.c
                                           'J','o','e'};                                                                    C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //Product String                                                                 C:\fw\midicontroller\x014\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[21];}PrdString={               C:\fw\midicontroller\x014\usbdescript.c
                                           sizeof(PrdString),DSC_STR,                                                       C:\fw\midicontroller\x014\usbdescript.c
                                           'M','I','D','I',' ','D','e','v','i','c','e',' '};                                C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //Serial Number                                                                  C:\fw\midicontroller\x014\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[16];}SerialNum={               C:\fw\midicontroller\x014\usbdescript.c
                                           sizeof(SerialNum),DSC_STR,                                                       C:\fw\midicontroller\x014\usbdescript.c
                                           '6','9','1','2','0','6','0','B',' '};                                            C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //the reason for this structure is so that sizeof() returns a value.             C:\fw\midicontroller\x014\usbdescript.c
                                           rom struct{byte report[HID_RPT_UPS_SIZE];}hid_rpt_UPS={                          C:\fw\midicontroller\x014\usbdescript.c
                                           //Production test information                                                    C:\fw\midicontroller\x014\usbdescript.c
                                               0x06, 0xff, 0xff,              //     USAGE_PAGE (Vendor Defined Page 0xffff) C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09,  0x01,               		// USAGE (Vendor Usage 1)                          C:\fw\midicontroller\x014\usbdescript.c
                                           	0xa1,  0x01,              	  // COLLECTION (Application)                        C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x95, 0x01,                    //       REPORT_COUNT (1)                     C:\fw\midicontroller\x014\usbdescript.c
                                               0x26, 0xff, 0x00,              //       LOGICAL_MAXIMUM (255)                C:\fw\midicontroller\x014\usbdescript.c
                                               0x15, 0x00,                    //       LOGICAL_MINIMUM (0)                  C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //NVR Operations                                                                 C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x96,                    //       REPORT_ID (150)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xC0,                    //       USAGE (***NVR Read/Write Data)       C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0xB4,                    //       REPORT_ID (180)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xD2,                    //       USAGE (***NVR Page Read/Write Data)  C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x97,                    //       REPORT_ID (151)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xC1,                    //       USAGE (***NVR Address 16bit)         C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //RAM Operations                                                                 C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x98,                    //       REPORT_ID (152)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xC2,                    //       USAGE (***RAM Read/Write Data)       C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x99,                    //       REPORT_ID (153)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xC3,                    //       USAGE (***RAM Address 16bit)         C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //ROM Operations                                                                 C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x9C,                    //       REPORT_ID (156)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xD4,                    //       USAGE (***ROM Read/Write Data)       C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x9D,                    //       REPORT_ID (157)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xD5,                    //       USAGE (***ROM Address 16bit)         C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //Production test protocol #                                                     C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x9B,                    //       REPORT_ID (155)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xC5,                    //       USAGE (***Production Test Protocol #) C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              C:\fw\midicontroller\x014\usbdescript.c
                                           	0x81, 0xa2,					   //	 	INPUT (Data,Var,Abs, Vol, NPrf)                         C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x76, 0x00, 0x02,              //       REPORT_SIZE (512)                    C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0xB0,                    //       REPORT_ID (176)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xEA,                    //       USAGE (***Voltage Data Bulk)         C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //Firmware Partnumber                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           	0x75, 0x20,						//	   REPORT_SIZE (32)                                         C:\fw\midicontroller\x014\usbdescript.c
                                           	0x85, 0xC2,						//	   REPORT_ID (194)                                          C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09, 0xD6,						//	   USAGE (***Firmware Partnumber 32bit)                     C:\fw\midicontroller\x014\usbdescript.c
                                           	0xb1, 0x02,						//	   FEATURE (Data,Var,Abs)                                   C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //Production test password = 866E1942                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0x85, 0x9A,                    //       REPORT_ID (154)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x09, 0xC4,                    //       USAGE (***Production test Password - 32bit) C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //The input report		                                                             C:\fw\midicontroller\x014\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x014\usbdescript.c
                                               0x95, 63,                    //       REPORT_COUNT (63)                      C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           	0x85, 44,					// REPORT_ID 44                                                   C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09, 0x04,					// usage - vendor defined                                       C:\fw\midicontroller\x014\usbdescript.c
                                           //	0x81, 0x02,					// Input (Data, Variable, Absolute)                           C:\fw\midicontroller\x014\usbdescript.c
                                           	0x09, 0x04,					// usage - vendor defined                                       C:\fw\midicontroller\x014\usbdescript.c
                                               0xb1, 0x02,                 //       FEATURE (Data,Var,Abs)                  C:\fw\midicontroller\x014\usbdescript.c
                                           		                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                           //The output report		                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           //	0x09, 0x06,					// usage - vendor defined                                     C:\fw\midicontroller\x014\usbdescript.c
                                           //	0x91, 0x02,					// Output (Data, Variable, Absolute)                          C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                               0xc0                          //     END_COLLECTION                          C:\fw\midicontroller\x014\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                           //** Renaud : end_ReportDescriptor                                               C:\fw\midicontroller\x014\usbdescript.c
                                           	                                                                                C:\fw\midicontroller\x014\usbdescript.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       C:\fw\midicontroller\x014\usbdescript.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&MfrString,&PrdString,&SerialNum}; C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           rom pFunc ClassReqHandler[1]=                                                    C:\fw\midicontroller\x014\usbdescript.c
                                           {                                                                                C:\fw\midicontroller\x014\usbdescript.c
                                               &USBCheckHIDRequest                                                          C:\fw\midicontroller\x014\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x014\usbdescript.c
                                           /** EOF usbdsc.c ****************************************************/           C:\fw\midicontroller\x014\usbdescript.c
                                           //############################################################################### C:\fw\midicontroller\x014\rs232.c
                                           //#										       						       		#                                             C:\fw\midicontroller\x014\rs232.c
                                           //#			Author: Joe Dunne											 		#                                           C:\fw\midicontroller\x014\rs232.c
                                           //#			RS232 Communication ROUTINE											#                                    C:\fw\midicontroller\x014\rs232.c
                                           //#			File Name: RXCOMM.ASM												#                                         C:\fw\midicontroller\x014\rs232.c
                                           //#																				#                                                         C:\fw\midicontroller\x014\rs232.c
                                           //#			Updated 2/02/05 by JD												#                                         C:\fw\midicontroller\x014\rs232.c
                                           //#									      	       	       	       	       		#                            C:\fw\midicontroller\x014\rs232.c
                                           //############################################################################### C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           #include	"c_system.h"                                                            C:\fw\midicontroller\x014\rs232.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\rs232.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           #define	FW_REV						0x10                                                         C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           #define	UPS_TYPE					(2|FW_REV)                                                  C:\fw\midicontroller\x014\rs232.c
                                           #define	PRODUCTION_TEST_PROTOCOL	0x0003                                          C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[];}SerialNum;           C:\fw\midicontroller\x014\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[24];}MfrString;         C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           void	RemCapCalculation(void);                                                    C:\fw\midicontroller\x014\rs232.c
                                           void	EE_READ(void);                                                              C:\fw\midicontroller\x014\rs232.c
                                           void	D_DIV(void);                                                                C:\fw\midicontroller\x014\rs232.c
                                           void	SQRT_16BIT(void);		//result is stored in RES0.                              C:\fw\midicontroller\x014\rs232.c
                                           void	HIDGetReportHandler(void);                                                  C:\fw\midicontroller\x014\rs232.c
                                           unsigned char	READ_SYSTEM_NVR(void);                                             C:\fw\midicontroller\x014\rs232.c
                                           void	EE_PAGE_WRITE(void);                                                        C:\fw\midicontroller\x014\rs232.c
                                           void	BOOT_LOAD_MODE(void);                                                       C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           //--------------------------------------------------------------                 C:\fw\midicontroller\x014\rs232.c
                                           //						Handle received query                                                    C:\fw\midicontroller\x014\rs232.c
                                           //--------------------------------------------------------------                 C:\fw\midicontroller\x014\rs232.c
002a50   cfd9     MOVFF     0xfd9,0xfe6    void	PROCESS_COMM_REQUEST(void) {                                                C:\fw\midicontroller\x014\rs232.c
002a52   ffe6                                                                                                               
002a54   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002a56   ffd9                                                                                                               
002a58   0e11     MOVLW     0x11                                                                                            
002a5a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char *RcvPtr;                                                          C:\fw\midicontroller\x014\rs232.c
                                           	unsigned char tempvar1, tempvar0;                                               C:\fw\midicontroller\x014\rs232.c
                                           	far unsigned char *Data;                                                        C:\fw\midicontroller\x014\rs232.c
                                           	BitField ByteToSend;                                                            C:\fw\midicontroller\x014\rs232.c
                                           	TwoBytes tempreg, tempnum0, value;                                              C:\fw\midicontroller\x014\rs232.c
                                           	FourBytes longreg;                                                              C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
002a5c   0100     MOVLB     0x0            	ResponseType = INVALID_REQUEST;		//no response                                  C:\fw\midicontroller\x014\rs232.c
002a5e   69b1     SETF      0xb1,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           	//USB query                                                                     C:\fw\midicontroller\x014\rs232.c
002a60   0100     MOVLB     0x0            	USBDataPointer = 1;		//the 0th byte is the reportid                             C:\fw\midicontroller\x014\rs232.c
002a62   0e01     MOVLW     0x1                                                                                             
002a64   6f70     MOVWF     0x70,0x1                                                                                        
002a66   0e72     MOVLW     0x72           	RcvPtr = (unsigned char *)&USBEP0DataInBuffer[1];                               C:\fw\midicontroller\x014\rs232.c
002a68   6ede     MOVWF     0xde,0x0                                                                                        
002a6a   0e00     MOVLW     0x0                                                                                             
002a6c   6edd     MOVWF     0xdd,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           //Polling command:                                                               C:\fw\midicontroller\x014\rs232.c
002a6e   0104     MOVLB     0x4            	if (SetupPkt.bRequest == GET_REPORT) {                                          C:\fw\midicontroller\x014\rs232.c
002a70   0511     DECF      0x11,0x0,0x1                                                                                    
002a72   e001     BZ        0x2a76                                                                                          
002a74   d08d     BRA       0x2b90                                                                                          
002a76   5112     MOVF      0x12,0x0,0x1   		switch (SetupPkt._byte[2]) {                                                   C:\fw\midicontroller\x014\rs232.c
002a78   0ab4     XORLW     0xb4                                                                                            
002a7a   e071     BZ        0x2b5e                                                                                          
002a7c   0a2f     XORLW     0x2f                                                                                            
002a7e   e064     BZ        0x2b48                                                                                          
002a80   0a02     XORLW     0x2                                                                                             
002a82   e056     BZ        0x2b30                                                                                          
002a84   0a01     XORLW     0x1                                                                                             
002a86   e040     BZ        0x2b08                                                                                          
002a88   0a0f     XORLW     0xf                                                                                             
002a8a   e032     BZ        0x2af0                                                                                          
002a8c   0a01     XORLW     0x1                                                                                             
002a8e   e025     BZ        0x2ada                                                                                          
002a90   0aba     XORLW     0xba                                                                                            
002a92   e013     BZ        0x2aba                                                                                          
002a94   0a83     XORLW     0x83                                                                                            
002a96   e001     BZ        0x2a9a                                                                                          
002a98   d07a     BRA       0x2b8e                                                                                          
                                           			                                                                              C:\fw\midicontroller\x014\rs232.c
                                           		case 175:		//voltage data                                                      C:\fw\midicontroller\x014\rs232.c
002a9a   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002a9c   0e05     MOVLW     0x5                                                                                             
002a9e   6fb1     MOVWF     0xb1,0x1                                                                                        
002aa0   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x014\rs232.c
002aa2   d901     RCALL     0x2ca6                                                                                          
002aa4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002aa6   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x014\rs232.c
002aa8   d8fe     RCALL     0x2ca6                                                                                          
002aaa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002aac   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x014\rs232.c
002aae   d8fb     RCALL     0x2ca6                                                                                          
002ab0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ab2   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x014\rs232.c
002ab4   d8f8     RCALL     0x2ca6                                                                                          
002ab6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ab8   d06b     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           		case 44:		//generic data transfer device to host                               C:\fw\midicontroller\x014\rs232.c
002aba   ec9f     CALL      0x2f3e,0x0     			if (ProcessGenericTransferRead()) ResponseType = DATA_RETURNED;               C:\fw\midicontroller\x014\rs232.c
002abc   f017                                                                                                               
002abe   cff3     MOVFF     0xff3,0x10                                                                                      
002ac0   f010                                                                                                               
002ac2   cff4     MOVFF     0xff4,0x11                                                                                      
002ac4   f011                                                                                                               
002ac6   5010     MOVF      0x10,0x0,0x0                                                                                    
002ac8   1011     IORWF     0x11,0x0,0x0                                                                                    
002aca   e004     BZ        0x2ad4                                                                                          
002acc   0100     MOVLB     0x0                                                                                             
002ace   0e05     MOVLW     0x5                                                                                             
002ad0   6fb1     MOVWF     0xb1,0x1                                                                                        
002ad2   d002     BRA       0x2ad8         			else ResponseType = INVALID_REQUEST;                                          C:\fw\midicontroller\x014\rs232.c
002ad4   0100     MOVLB     0x0                                                                                             
002ad6   69b1     SETF      0xb1,0x1                                                                                        
002ad8   d05b     BRA       0x2b90         			break;	                                                                       C:\fw\midicontroller\x014\rs232.c
                                           			                                                                              C:\fw\midicontroller\x014\rs232.c
                                           //production test commands:			                                                   C:\fw\midicontroller\x014\rs232.c
                                           		case 150:		//NVR Read                                                          C:\fw\midicontroller\x014\rs232.c
002ada   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002adc   0e05     MOVLW     0x5                                                                                             
002ade   6fb1     MOVWF     0xb1,0x1                                                                                        
002ae0   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x014\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        C:\fw\midicontroller\x014\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x014\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();		//returns data through wreg                    C:\fw\midicontroller\x014\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x014\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x014\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x014\rs232.c
002ae2   d005     BRA       0x2aee         			else {                                                                        C:\fw\midicontroller\x014\rs232.c
002ae4   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x014\rs232.c
002ae6   6fb1     MOVWF     0xb1,0x1                                                                                        
002ae8   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x014\rs232.c
002aea   d8dd     RCALL     0x2ca6                                                                                          
002aec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\rs232.c
002aee   d050     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           			                                                                              C:\fw\midicontroller\x014\rs232.c
                                           		case 151:		//NVR Address                                                       C:\fw\midicontroller\x014\rs232.c
002af0   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002af2   0e05     MOVLW     0x5                                                                                             
002af4   6fb1     MOVWF     0xb1,0x1                                                                                        
002af6   c0b2     MOVFF     0xb2,0xfe6     			TXENQ(NVRCommAddr.b_form.low);		//low byte                                    C:\fw\midicontroller\x014\rs232.c
002af8   ffe6                                                                                                               
002afa   d8d5     RCALL     0x2ca6                                                                                          
002afc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002afe   c0b3     MOVFF     0xb3,0xfe6     			TXENQ(NVRCommAddr.b_form.high);		//high byte                                  C:\fw\midicontroller\x014\rs232.c
002b00   ffe6                                                                                                               
002b02   d8d1     RCALL     0x2ca6                                                                                          
002b04   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b06   d044     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		case 152:		//RAM Read                                                          C:\fw\midicontroller\x014\rs232.c
002b08   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002b0a   0e05     MOVLW     0x5                                                                                             
002b0c   6fb1     MOVWF     0xb1,0x1                                                                                        
002b0e   0e04     MOVLW     0x4            			Data = (far unsigned char *)RAMCommAddr.s_form;                               C:\fw\midicontroller\x014\rs232.c
002b10   c0b4     MOVFF     0xb4,0xfdb                                                                                      
002b12   ffdb                                                                                                               
002b14   0e05     MOVLW     0x5                                                                                             
002b16   c0b5     MOVFF     0xb5,0xfdb                                                                                      
002b18   ffdb                                                                                                               
002b1a   0e04     MOVLW     0x4            			TXENQ(*Data);                                                                 C:\fw\midicontroller\x014\rs232.c
002b1c   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002b1e   ffe9                                                                                                               
002b20   0e05     MOVLW     0x5                                                                                             
002b22   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002b24   ffea                                                                                                               
002b26   50ef     MOVF      0xef,0x0,0x0                                                                                    
002b28   6ee6     MOVWF     0xe6,0x0                                                                                        
002b2a   d8bd     RCALL     0x2ca6                                                                                          
002b2c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b2e   d030     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           	                                                                                C:\fw\midicontroller\x014\rs232.c
                                           		case 153:		//RAM Address                                                       C:\fw\midicontroller\x014\rs232.c
002b30   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002b32   0e05     MOVLW     0x5                                                                                             
002b34   6fb1     MOVWF     0xb1,0x1                                                                                        
002b36   c0b4     MOVFF     0xb4,0xfe6     			TXENQ(RAMCommAddr.b_form.low);		//low byte                                    C:\fw\midicontroller\x014\rs232.c
002b38   ffe6                                                                                                               
002b3a   d8b5     RCALL     0x2ca6                                                                                          
002b3c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b3e   c0b5     MOVFF     0xb5,0xfe6     			TXENQ(RAMCommAddr.b_form.high);		//high byte                                  C:\fw\midicontroller\x014\rs232.c
002b40   ffe6                                                                                                               
002b42   d8b1     RCALL     0x2ca6                                                                                          
002b44   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
002b46   d024     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           	                                                                                C:\fw\midicontroller\x014\rs232.c
                                           		case 155:		//production test protocol                                          C:\fw\midicontroller\x014\rs232.c
002b48   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002b4a   0e05     MOVLW     0x5                                                                                             
002b4c   6fb1     MOVWF     0xb1,0x1                                                                                        
002b4e   0e03     MOVLW     0x3            			TXENQ(PRODUCTION_TEST_PROTOCOL&255);                                          C:\fw\midicontroller\x014\rs232.c
002b50   6ee6     MOVWF     0xe6,0x0                                                                                        
002b52   d8a9     RCALL     0x2ca6                                                                                          
002b54   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b56   6ae6     CLRF      0xe6,0x0       			TXENQ(PRODUCTION_TEST_PROTOCOL>>8);                                           C:\fw\midicontroller\x014\rs232.c
002b58   d8a6     RCALL     0x2ca6                                                                                          
002b5a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b5c   d019     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           	                                                                                C:\fw\midicontroller\x014\rs232.c
                                           		case 180:		//NVR Page Read                                                     C:\fw\midicontroller\x014\rs232.c
002b5e   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x014\rs232.c
002b60   0e05     MOVLW     0x5                                                                                             
002b62   6fb1     MOVWF     0xb1,0x1                                                                                        
002b64   b8a0     BTFSC     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x014\rs232.c
002b66   d004     BRA       0x2b70                                                                                          
002b68   9ef2     BCF       0xf2,0x7,0x0   				DISABLE_ALL_INTERRUPTS();                                                    C:\fw\midicontroller\x014\rs232.c
002b6a   9cf2     BCF       0xf2,0x6,0x0                                                                                    
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        C:\fw\midicontroller\x014\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x014\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x014\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x014\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x014\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x014\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x014\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x014\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x014\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x014\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x014\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x014\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x014\rs232.c
002b6c   d011     BRA       0x2b90         				break;                                                                       C:\fw\midicontroller\x014\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x014\rs232.c
002b6e   d00f     BRA       0x2b8e         			else {                                                                        C:\fw\midicontroller\x014\rs232.c
002b70   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x014\rs232.c
002b72   6fb1     MOVWF     0xb1,0x1                                                                                        
002b74   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x014\rs232.c
002b76   d897     RCALL     0x2ca6                                                                                          
002b78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b7a   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x014\rs232.c
002b7c   d894     RCALL     0x2ca6                                                                                          
002b7e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b80   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x014\rs232.c
002b82   d891     RCALL     0x2ca6                                                                                          
002b84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b86   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x014\rs232.c
002b88   d88e     RCALL     0x2ca6                                                                                          
002b8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b8c   d001     BRA       0x2b90         				break;                                                                       C:\fw\midicontroller\x014\rs232.c
                                           			}				                                                                         C:\fw\midicontroller\x014\rs232.c
                                           		default:                                                                       C:\fw\midicontroller\x014\rs232.c
002b8e   d000     BRA       0x2b90         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		}                                                                              C:\fw\midicontroller\x014\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           //Set command:                                                                   C:\fw\midicontroller\x014\rs232.c
002b90   0e09     MOVLW     0x9            	if (SetupPkt.bRequest == SET_REPORT) {                                          C:\fw\midicontroller\x014\rs232.c
002b92   0104     MOVLB     0x4                                                                                             
002b94   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002b96   e16b     BNZ       0x2c6e                                                                                          
002b98   5112     MOVF      0x12,0x0,0x1   		switch (SetupPkt._byte[2]) {                                                   C:\fw\midicontroller\x014\rs232.c
002b9a   0ab4     XORLW     0xb4                                                                                            
002b9c   e064     BZ        0x2c66                                                                                          
002b9e   0a2e     XORLW     0x2e                                                                                            
002ba0   e05e     BZ        0x2c5e                                                                                          
002ba2   0a03     XORLW     0x3                                                                                             
002ba4   e048     BZ        0x2c36                                                                                          
002ba6   0a01     XORLW     0x1                                                                                             
002ba8   e038     BZ        0x2c1a                                                                                          
002baa   0a0f     XORLW     0xf                                                                                             
002bac   e01e     BZ        0x2bea                                                                                          
002bae   0a01     XORLW     0x1                                                                                             
002bb0   e014     BZ        0x2bda                                                                                          
002bb2   0aba     XORLW     0xba                                                                                            
002bb4   e001     BZ        0x2bb8                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           		case 44:		//generic data transfer host to device                               C:\fw\midicontroller\x014\rs232.c
002bb8   ecea     CALL      0x2fd4,0x0     			if (ProcessGenericTransferWrite()) ResponseType = COMMAND_ACCEPTED;           C:\fw\midicontroller\x014\rs232.c
002bba   f017                                                                                                               
002bbc   cff3     MOVFF     0xff3,0x10                                                                                      
002bbe   f010                                                                                                               
002bc0   cff4     MOVFF     0xff4,0x11                                                                                      
002bc2   f011                                                                                                               
002bc4   5010     MOVF      0x10,0x0,0x0                                                                                    
002bc6   1011     IORWF     0x11,0x0,0x0                                                                                    
002bc8   e004     BZ        0x2bd2                                                                                          
002bca   0100     MOVLB     0x0                                                                                             
002bcc   0e02     MOVLW     0x2                                                                                             
002bce   6fb1     MOVWF     0xb1,0x1                                                                                        
002bd0   d003     BRA       0x2bd8         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x014\rs232.c
002bd2   0100     MOVLB     0x0                                                                                             
002bd4   0e01     MOVLW     0x1                                                                                             
002bd6   6fb1     MOVWF     0xb1,0x1                                                                                        
002bd8   d04a     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           //Production test commands                                                       C:\fw\midicontroller\x014\rs232.c
                                           		case 150:		//NVR Write                                                         C:\fw\midicontroller\x014\rs232.c
002bda   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x014\rs232.c
002bdc   0e02     MOVLW     0x2                                                                                             
002bde   6fb1     MOVWF     0xb1,0x1                                                                                        
002be0   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x014\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x014\rs232.c
                                           //				EECounterB = 1;						//Number of bytes to write.                           C:\fw\midicontroller\x014\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;	//EEPROM register starting address byte. C:\fw\midicontroller\x014\rs232.c
                                           //				EEData = RcvPtr[0];					//First byte of data to write.                     C:\fw\midicontroller\x014\rs232.c
                                           //diag disable ee_page_write                                                     C:\fw\midicontroller\x014\rs232.c
                                           //				EE_PAGE_WRITE();                                                           C:\fw\midicontroller\x014\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x014\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x014\rs232.c
002be2   d002     BRA       0x2be8         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x014\rs232.c
002be4   0e01     MOVLW     0x1                                                                                             
002be6   6fb1     MOVWF     0xb1,0x1                                                                                        
002be8   d042     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           			                                                                              C:\fw\midicontroller\x014\rs232.c
                                           		case 151:		//NVR Address                                                       C:\fw\midicontroller\x014\rs232.c
002bea   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x014\rs232.c
002bec   0e02     MOVLW     0x2                                                                                             
002bee   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x014\rs232.c
002bf0   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.low = RcvPtr[0];		//low byte                              C:\fw\midicontroller\x014\rs232.c
002bf2   ffe9                                                                                                               
002bf4   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002bf6   ffea                                                                                                               
002bf8   cfef     MOVFF     0xfef,0xb2                                                                                      
002bfa   f0b2                                                                                                               
002bfc   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.high = RcvPtr[1];	//high byte                             C:\fw\midicontroller\x014\rs232.c
002bfe   ffe9                                                                                                               
002c00   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002c02   ffea                                                                                                               
002c04   0e01     MOVLW     0x1                                                                                             
002c06   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002c08   0e00     MOVLW     0x0                                                                                             
002c0a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002c0c   cfef     MOVFF     0xfef,0xb3                                                                                      
002c0e   f0b3                                                                                                               
                                           			}                                                                             C:\fw\midicontroller\x014\rs232.c
002c10   d003     BRA       0x2c18         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x014\rs232.c
002c12   0100     MOVLB     0x0                                                                                             
002c14   0e01     MOVLW     0x1                                                                                             
002c16   6fb1     MOVWF     0xb1,0x1                                                                                        
002c18   d02a     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		case 152:		//RAM Write                                                         C:\fw\midicontroller\x014\rs232.c
002c1a   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x014\rs232.c
002c1c   0e02     MOVLW     0x2                                                                                             
002c1e   6fb1     MOVWF     0xb1,0x1                                                                                        
002c20   cfde     MOVFF     0xfde,0xfe9    			*(far unsigned char *)RAMCommAddr.s_form = RcvPtr[0];                         C:\fw\midicontroller\x014\rs232.c
002c22   ffe9                                                                                                               
002c24   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002c26   ffea                                                                                                               
002c28   50ef     MOVF      0xef,0x0,0x0                                                                                    
002c2a   c0b4     MOVFF     0xb4,0xfe9                                                                                      
002c2c   ffe9                                                                                                               
002c2e   c0b5     MOVFF     0xb5,0xfea                                                                                      
002c30   ffea                                                                                                               
002c32   6eef     MOVWF     0xef,0x0                                                                                        
002c34   d01c     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           	                                                                                C:\fw\midicontroller\x014\rs232.c
                                           		case 153:		//RAM Address                                                       C:\fw\midicontroller\x014\rs232.c
002c36   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x014\rs232.c
002c38   0e02     MOVLW     0x2                                                                                             
002c3a   6fb1     MOVWF     0xb1,0x1                                                                                        
002c3c   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.low = RcvPtr[0];		//low byte                               C:\fw\midicontroller\x014\rs232.c
002c3e   ffe9                                                                                                               
002c40   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002c42   ffea                                                                                                               
002c44   cfef     MOVFF     0xfef,0xb4                                                                                      
002c46   f0b4                                                                                                               
002c48   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.high = RcvPtr[1];	//high byte                              C:\fw\midicontroller\x014\rs232.c
002c4a   ffe9                                                                                                               
002c4c   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002c4e   ffea                                                                                                               
002c50   0e01     MOVLW     0x1                                                                                             
002c52   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002c54   0e00     MOVLW     0x0                                                                                             
002c56   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002c58   cfef     MOVFF     0xfef,0xb5                                                                                      
002c5a   f0b5                                                                                                               
002c5c   d008     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		case 154:		//Password write (starting with low byte)                           C:\fw\midicontroller\x014\rs232.c
002c5e   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x014\rs232.c
002c60   0e02     MOVLW     0x2                                                                                             
002c62   6fb1     MOVWF     0xb1,0x1                                                                                        
002c64   d004     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		case 180:		//NVR Page Write                                                    C:\fw\midicontroller\x014\rs232.c
002c66   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x014\rs232.c
002c68   0e02     MOVLW     0x2                                                                                             
002c6a   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           //diag.. disable ee_page_write                                                   C:\fw\midicontroller\x014\rs232.c
002c6c   d000     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		default:                                                                       C:\fw\midicontroller\x014\rs232.c
002bb6   d05b     BRA       0x2c6e         			break;                                                                        C:\fw\midicontroller\x014\rs232.c
                                           		}                                                                              C:\fw\midicontroller\x014\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x014\rs232.c
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
002c6e   0eff     MOVLW     0xff           	if (ResponseType == INVALID_REQUEST) return;                                    C:\fw\midicontroller\x014\rs232.c
002c70   0100     MOVLB     0x0                                                                                             
002c72   5db1     SUBWF     0xb1,0x0,0x1                                                                                    
002c74   e101     BNZ       0x2c78                                                                                          
002c76   d00d     BRA       0x2c92                                                                                          
                                           //no response or ack?                                                            C:\fw\midicontroller\x014\rs232.c
002c78   0e09     MOVLW     0x9            	if (SetupPkt.bRequest == SET_REPORT) return;		//no response to set_report       C:\fw\midicontroller\x014\rs232.c
002c7a   0104     MOVLB     0x4                                                                                             
002c7c   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002c7e   e101     BNZ       0x2c82                                                                                          
002c80   d008     BRA       0x2c92                                                                                          
                                           	                                                                                C:\fw\midicontroller\x014\rs232.c
                                           //USB query setup data:                                                          C:\fw\midicontroller\x014\rs232.c
002c82   c412     MOVFF     0x412,0x450    	CtrlTrfData._byte[0] = SetupPkt._byte[2];                                       C:\fw\midicontroller\x014\rs232.c
002c84   f450                                                                                                               
002c86   0100     MOVLB     0x0            	wCount._word = USBDataPointer;		//Calculate number of bytes to send             C:\fw\midicontroller\x014\rs232.c
002c88   5170     MOVF      0x70,0x0,0x1                                                                                    
002c8a   0101     MOVLB     0x1                                                                                             
002c8c   6f2c     MOVWF     0x2c,0x1                                                                                        
002c8e   6b2d     CLRF      0x2d,0x1                                                                                        
002c90   d000     BRA       0x2c92         	return;                                                                         C:\fw\midicontroller\x014\rs232.c
002c92   0e11     MOVLW     0x11           }                                                                                C:\fw\midicontroller\x014\rs232.c
002c94   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002c96   e202     BC        0x2c9c                                                                                          
002c98   6ae1     CLRF      0xe1,0x0                                                                                        
002c9a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c9c   6ee1     MOVWF     0xe1,0x0                                                                                        
002c9e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ca0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002ca2   ffd9                                                                                                               
002ca4   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\rs232.c
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x014\rs232.c
                                           //This routine will store a character into the TxBuffer.                         C:\fw\midicontroller\x014\rs232.c
002ca6   cfd9     MOVFF     0xfd9,0xfe6    void	TXENQ(unsigned char Input) {                                                C:\fw\midicontroller\x014\rs232.c
002ca8   ffe6                                                                                                               
002caa   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002cac   ffd9                                                                                                               
                                           	//USB Query                                                                     C:\fw\midicontroller\x014\rs232.c
002cae   0e40     MOVLW     0x40           	if (USBDataPointer >= 64) return;		//Exit if buffer full.                       C:\fw\midicontroller\x014\rs232.c
002cb0   0100     MOVLB     0x0                                                                                             
002cb2   5d70     SUBWF     0x70,0x0,0x1                                                                                    
002cb4   e301     BNC       0x2cb8                                                                                          
002cb6   d00a     BRA       0x2ccc                                                                                          
002cb8   5170     MOVF      0x70,0x0,0x1   	CtrlTrfData._byte[USBDataPointer] = Input;                                      C:\fw\midicontroller\x014\rs232.c
002cba   6aea     CLRF      0xea,0x0                                                                                        
002cbc   0f50     ADDLW     0x50                                                                                            
002cbe   6ee9     MOVWF     0xe9,0x0                                                                                        
002cc0   0e04     MOVLW     0x4                                                                                             
002cc2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002cc4   0efe     MOVLW     0xfe                                                                                            
002cc6   cfdb     MOVFF     0xfdb,0xfef                                                                                     
002cc8   ffef                                                                                                               
002cca   2b70     INCF      0x70,0x1,0x1   	USBDataPointer++;                                                               C:\fw\midicontroller\x014\rs232.c
002ccc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\rs232.c
002cce   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002cd0   ffd9                                                                                                               
002cd2   0012     RETURN    0x0                                                                                             
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x014\rs232.c
                                           /*********************************************************************           C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            *             Microchip USB C18 Firmware -  HID Version 1.0                     C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            *********************************************************************           C:\fw\midicontroller\x014\hid.c
                                            * FileName:        hid.c                                                        C:\fw\midicontroller\x014\hid.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x014\hid.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x014\hid.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x014\hid.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x014\hid.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x014\hid.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x014\hid.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x014\hid.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x014\hid.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x014\hid.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x014\hid.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x014\hid.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x014\hid.c
                                            * license.                                                                      C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x014\hid.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x014\hid.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x014\hid.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x014\hid.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x014\hid.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Author               Date        Comment                                      C:\fw\midicontroller\x014\hid.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\fw\midicontroller\x014\hid.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\fw\midicontroller\x014\hid.c
                                            ********************************************************************/           C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x014\hid.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x014\hid.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\hid.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\hid.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           #ifdef USB_USE_HID                                                               C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x014\hid.c
                                           void HIDGetReportHandler(void);                                                  C:\fw\midicontroller\x014\hid.c
                                           void HIDSetReportHandler(void);                                                  C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x014\hid.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x014\hid.c
                                           byte idle_rate;                                                                  C:\fw\midicontroller\x014\hid.c
                                           byte active_protocol;               // [0] Boot Protocol [1] Report Protocol     C:\fw\midicontroller\x014\hid.c
                                           byte hid_rpt_rx_len;                                                             C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x014\hid.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  C:\fw\midicontroller\x014\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\hid.c
                                            * Function:        void USBCheckHIDRequest(void)                                C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\fw\midicontroller\x014\hid.c
                                            *                  knows how to handle it                                       C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\hid.c
                                           void USBCheckHIDRequest(void)                                                    C:\fw\midicontroller\x014\hid.c
                                           {                                                                                C:\fw\midicontroller\x014\hid.c
002cd4   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  C:\fw\midicontroller\x014\hid.c
002cd6   5110     MOVF      0x10,0x0,0x1                                                                                    
002cd8   0b1f     ANDLW     0x1f                                                                                            
002cda   0801     SUBLW     0x1                                                                                             
002cdc   e001     BZ        0x2ce0                                                                                          
002cde   d086     BRA       0x2dec                                                                                          
002ce0   5114     MOVF      0x14,0x0,0x1       if(SetupPkt.bIntfID != HID_INTF_ID) return;                                  C:\fw\midicontroller\x014\hid.c
002ce2   e001     BZ        0x2ce6                                                                                          
002ce4   d083     BRA       0x2dec                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                               /*                                                                           C:\fw\midicontroller\x014\hid.c
                                                * There are two standard requests that hid.c may support.                   C:\fw\midicontroller\x014\hid.c
                                                * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\fw\midicontroller\x014\hid.c
                                                * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\fw\midicontroller\x014\hid.c
                                                */                                                                          C:\fw\midicontroller\x014\hid.c
002ce6   0e06     MOVLW     0x6                if(SetupPkt.bRequest == GET_DSC)                                             C:\fw\midicontroller\x014\hid.c
002ce8   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002cea   e12e     BNZ       0x2d48                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\hid.c
002cec   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\fw\midicontroller\x014\hid.c
002cee   0a23     XORLW     0x23                                                                                            
002cf0   e028     BZ        0x2d42                                                                                          
002cf2   0a01     XORLW     0x1                                                                                             
002cf4   e013     BZ        0x2d1c                                                                                          
002cf6   0a03     XORLW     0x3                                                                                             
002cf8   e001     BZ        0x2cfc                                                                                          
002cfa   d024     BRA       0x2d44                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\hid.c
                                                       case DSC_HID:                                                        C:\fw\midicontroller\x014\hid.c
002cfc   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               C:\fw\midicontroller\x014\hid.c
002cfe   0e02     MOVLW     0x2                                                                                             
002d00   6f27     MOVWF     0x27,0x1                                                                                        
002d02   0101     MOVLB     0x1                            mUSBGetHIDDscAdr(pSrc.bRom);        // See usbcfg.h              C:\fw\midicontroller\x014\hid.c
002d04   0524     DECF      0x24,0x0,0x1                                                                                    
002d06   e105     BNZ       0x2d12                                                                                          
002d08   0101     MOVLB     0x1                                                                                             
002d0a   0e94     MOVLW     0x94                                                                                            
002d0c   6f28     MOVWF     0x28,0x1                                                                                        
002d0e   0e30     MOVLW     0x30                                                                                            
002d10   6f29     MOVWF     0x29,0x1                                                                                        
002d12   0e09     MOVLW     0x9                            wCount._word = sizeof(USB_HID_DSC);                              C:\fw\midicontroller\x014\hid.c
002d14   0101     MOVLB     0x1                                                                                             
002d16   6f2c     MOVWF     0x2c,0x1                                                                                        
002d18   6b2d     CLRF      0x2d,0x1                                                                                        
002d1a   d014     BRA       0x2d44                         break;                                                           C:\fw\midicontroller\x014\hid.c
                                                       case DSC_RPT:                                                        C:\fw\midicontroller\x014\hid.c
002d1c   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               C:\fw\midicontroller\x014\hid.c
002d1e   0e02     MOVLW     0x2                                                                                             
002d20   6f27     MOVWF     0x27,0x1                                                                                        
002d22   0101     MOVLB     0x1                            mUSBGetHIDRptDscAdr(pSrc.bRom);     // See usbcfg.h              C:\fw\midicontroller\x014\hid.c
002d24   0524     DECF      0x24,0x0,0x1                                                                                    
002d26   e105     BNZ       0x2d32                                                                                          
002d28   0101     MOVLB     0x1                                                                                             
002d2a   0e0e     MOVLW     0xe                                                                                             
002d2c   6f28     MOVWF     0x28,0x1                                                                                        
002d2e   0e31     MOVLW     0x31                                                                                            
002d30   6f29     MOVWF     0x29,0x1                                                                                        
002d32   0101     MOVLB     0x1                            mUSBGetHIDRptDscSize(wCount._word); // See usbcfg.h              C:\fw\midicontroller\x014\hid.c
002d34   0524     DECF      0x24,0x0,0x1                                                                                    
002d36   e104     BNZ       0x2d40                                                                                          
002d38   0e7c     MOVLW     0x7c                                                                                            
002d3a   0101     MOVLB     0x1                                                                                             
002d3c   6f2c     MOVWF     0x2c,0x1                                                                                        
002d3e   6b2d     CLRF      0x2d,0x1                                                                                        
002d40   d001     BRA       0x2d44                         break;                                                           C:\fw\midicontroller\x014\hid.c
                                                       case DSC_PHY:                                                        C:\fw\midicontroller\x014\hid.c
                                                           // ctrl_trf_session_owner = MUID_HID;                            C:\fw\midicontroller\x014\hid.c
002d42   d000     BRA       0x2d44                         break;                                                           C:\fw\midicontroller\x014\hid.c
                                                   }//end switch(SetupPkt.bDscType)                                         C:\fw\midicontroller\x014\hid.c
002d44   0101     MOVLB     0x1                    usb_stat.ctrl_trf_mem = _ROM;                                            C:\fw\midicontroller\x014\hid.c
002d46   8323     BSF       0x23,0x1,0x1                                                                                    
                                               }//end if(SetupPkt.bRequest == GET_DSC)                                      C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002d48   0104     MOVLB     0x4                if(SetupPkt.RequestType != CLASS) return;                                    C:\fw\midicontroller\x014\hid.c
002d4a   5110     MOVF      0x10,0x0,0x1                                                                                    
002d4c   0b60     ANDLW     0x60                                                                                            
002d4e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002d50   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002d52   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002d54   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002d56   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002d58   0801     SUBLW     0x1                                                                                             
002d5a   e001     BZ        0x2d5e                                                                                          
002d5c   d047     BRA       0x2dec                                                                                          
002d5e   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\fw\midicontroller\x014\hid.c
002d60   0a0b     XORLW     0xb                                                                                             
002d62   e03e     BZ        0x2de0                                                                                          
002d64   0a08     XORLW     0x8                                                                                             
002d66   e02e     BZ        0x2dc4                                                                                          
002d68   0a09     XORLW     0x9                                                                                             
002d6a   e026     BZ        0x2db8                                                                                          
002d6c   0a08     XORLW     0x8                                                                                             
002d6e   e016     BZ        0x2d9c                                                                                          
002d70   0a0b     XORLW     0xb                                                                                             
002d72   e006     BZ        0x2d80                                                                                          
002d74   0a08     XORLW     0x8                                                                                             
002d76   e001     BZ        0x2d7a                                                                                          
002d78   d039     BRA       0x2dec                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\hid.c
                                                   case GET_REPORT:                                                         C:\fw\midicontroller\x014\hid.c
002d7a   ec8e     CALL      0x2f1c,0x0                 HIDGetReportHandler();                                               C:\fw\midicontroller\x014\hid.c
002d7c   f017                                                                                                               
002d7e   d036     BRA       0x2dec                     break;                                                               C:\fw\midicontroller\x014\hid.c
                                                   case SET_REPORT:                                                         C:\fw\midicontroller\x014\hid.c
                                           //            HIDSetReportHandler();      //2/8/05 JD this was not at the right location. C:\fw\midicontroller\x014\hid.c
002d80   0101     MOVLB     0x1            			pDst.bRam = (byte*)&USBEP0DataInBuffer;	//Set destination for report data.    C:\fw\midicontroller\x014\hid.c
002d82   0e71     MOVLW     0x71                                                                                            
002d84   6f2a     MOVWF     0x2a,0x1                                                                                        
002d86   0e00     MOVLW     0x0                                                                                             
002d88   6f2b     MOVWF     0x2b,0x1                                                                                        
002d8a   0101     MOVLB     0x1            			usb_stat.ctrl_trf_mem = _RAM;		//Set memory type                              C:\fw\midicontroller\x014\hid.c
002d8c   9323     BCF       0x23,0x1,0x1                                                                                    
002d8e   0101     MOVLB     0x1            			wCount._word = 0;					//reset counter                                         C:\fw\midicontroller\x014\hid.c
002d90   6b2c     CLRF      0x2c,0x1                                                                                        
002d92   6b2d     CLRF      0x2d,0x1                                                                                        
002d94   0101     MOVLB     0x1            			ctrl_trf_session_owner = MUID_HID;  //set owner to HID, service this when we have some data..	 C:\fw\midicontroller\x014\hid.c
002d96   0e02     MOVLW     0x2                                                                                             
002d98   6f27     MOVWF     0x27,0x1                                                                                        
002d9a   d028     BRA       0x2dec                     break;                                                               C:\fw\midicontroller\x014\hid.c
                                                   case GET_IDLE:                                                           C:\fw\midicontroller\x014\hid.c
002d9c   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x014\hid.c
002d9e   0e02     MOVLW     0x2                                                                                             
002da0   6f27     MOVWF     0x27,0x1                                                                                        
002da2   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&idle_rate;      // Set source                    C:\fw\midicontroller\x014\hid.c
002da4   0e30     MOVLW     0x30                                                                                            
002da6   6f28     MOVWF     0x28,0x1                                                                                        
002da8   0e01     MOVLW     0x1                                                                                             
002daa   6f29     MOVWF     0x29,0x1                                                                                        
002dac   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\fw\midicontroller\x014\hid.c
002dae   9323     BCF       0x23,0x1,0x1                                                                                    
002db0   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                C:\fw\midicontroller\x014\hid.c
002db2   0e01     MOVLW     0x1                                                                                             
002db4   6f2c     MOVWF     0x2c,0x1                                                                                        
002db6   d01a     BRA       0x2dec                     break;                                                               C:\fw\midicontroller\x014\hid.c
                                                   case SET_IDLE:                                                           C:\fw\midicontroller\x014\hid.c
002db8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x014\hid.c
002dba   0e02     MOVLW     0x2                                                                                             
002dbc   6f27     MOVWF     0x27,0x1                                                                                        
002dbe   c413     MOVFF     0x413,0x130                idle_rate = MSB(SetupPkt.W_Value);                                   C:\fw\midicontroller\x014\hid.c
002dc0   f130                                                                                                               
002dc2   d014     BRA       0x2dec                     break;                                                               C:\fw\midicontroller\x014\hid.c
                                                   case GET_PROTOCOL:                                                       C:\fw\midicontroller\x014\hid.c
002dc4   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x014\hid.c
002dc6   0e02     MOVLW     0x2                                                                                             
002dc8   6f27     MOVWF     0x27,0x1                                                                                        
002dca   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&active_protocol;// Set source                    C:\fw\midicontroller\x014\hid.c
002dcc   0e31     MOVLW     0x31                                                                                            
002dce   6f28     MOVWF     0x28,0x1                                                                                        
002dd0   0e01     MOVLW     0x1                                                                                             
002dd2   6f29     MOVWF     0x29,0x1                                                                                        
002dd4   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\fw\midicontroller\x014\hid.c
002dd6   9323     BCF       0x23,0x1,0x1                                                                                    
002dd8   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                C:\fw\midicontroller\x014\hid.c
002dda   0e01     MOVLW     0x1                                                                                             
002ddc   6f2c     MOVWF     0x2c,0x1                                                                                        
002dde   d006     BRA       0x2dec                     break;                                                               C:\fw\midicontroller\x014\hid.c
                                                   case SET_PROTOCOL:                                                       C:\fw\midicontroller\x014\hid.c
002de0   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x014\hid.c
002de2   0e02     MOVLW     0x2                                                                                             
002de4   6f27     MOVWF     0x27,0x1                                                                                        
002de6   c412     MOVFF     0x412,0x131                active_protocol = LSB(SetupPkt.W_Value);                             C:\fw\midicontroller\x014\hid.c
002de8   f131                                                                                                               
002dea   d000     BRA       0x2dec                     break;                                                               C:\fw\midicontroller\x014\hid.c
                                               }//end switch(SetupPkt.bRequest)                                             C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002dec   0012     RETURN    0x0            }//end USBCheckHIDRequest                                                        C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** U S E R  A P I ***********************************************************/  C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\hid.c
                                            * Function:        void HIDInitEP(void)                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Input:           None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Overview:        HIDInitEP initializes HID endpoints, buffer descriptors,     C:\fw\midicontroller\x014\hid.c
                                            *                  internal state-machine, and variables.                       C:\fw\midicontroller\x014\hid.c
                                            *                  It should be called after the USB host has sent out a        C:\fw\midicontroller\x014\hid.c
                                            *                  SET_CONFIGURATION request.                                   C:\fw\midicontroller\x014\hid.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\hid.c
                                           void HIDInitEP(void)                                                             C:\fw\midicontroller\x014\hid.c
                                           {                                                                                C:\fw\midicontroller\x014\hid.c
002dee   0101     MOVLB     0x1                hid_rpt_rx_len =0;                                                           C:\fw\midicontroller\x014\hid.c
002df0   6b32     CLRF      0x32,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002df2   0e1e     MOVLW     0x1e               HID_UEP = EP_OUT_IN|HSHK_EN;                // Enable 2 data pipes           C:\fw\midicontroller\x014\hid.c
002df4   6e71     MOVWF     0x71,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002df6   0104     MOVLB     0x4                HID_BD_OUT.Cnt = sizeof(hid_report_out);    // Set buffer size               C:\fw\midicontroller\x014\hid.c
002df8   0e08     MOVLW     0x8                                                                                             
002dfa   6f09     MOVWF     0x9,0x1                                                                                         
002dfc   0e90     MOVLW     0x90               HID_BD_OUT.ADR = (byte*)&hid_report_out;    // Set buffer address            C:\fw\midicontroller\x014\hid.c
002dfe   6f0a     MOVWF     0xa,0x1                                                                                         
002e00   0e04     MOVLW     0x4                                                                                             
002e02   6f0b     MOVWF     0xb,0x1                                                                                         
002e04   0e88     MOVLW     0x88               HID_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN; // Set status                    C:\fw\midicontroller\x014\hid.c
002e06   6f08     MOVWF     0x8,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                               /*                                                                           C:\fw\midicontroller\x014\hid.c
                                                * Do not have to init Cnt of IN pipes here.                                 C:\fw\midicontroller\x014\hid.c
                                                * Reason:  Number of bytes to send to the host                              C:\fw\midicontroller\x014\hid.c
                                                *          varies from one transaction to                                   C:\fw\midicontroller\x014\hid.c
                                                *          another. Cnt should equal the exact                              C:\fw\midicontroller\x014\hid.c
                                                *          number of bytes to transmit for                                  C:\fw\midicontroller\x014\hid.c
                                                *          a given IN transaction.                                          C:\fw\midicontroller\x014\hid.c
                                                *          This number of bytes will only                                   C:\fw\midicontroller\x014\hid.c
                                                *          be known right before the data is                                C:\fw\midicontroller\x014\hid.c
                                                *          sent.                                                            C:\fw\midicontroller\x014\hid.c
                                                */                                                                          C:\fw\midicontroller\x014\hid.c
002e08   0104     MOVLB     0x4                HID_BD_IN.ADR = (byte*)&hid_report_in;      // Set buffer address            C:\fw\midicontroller\x014\hid.c
002e0a   0e98     MOVLW     0x98                                                                                            
002e0c   6f0e     MOVWF     0xe,0x1                                                                                         
002e0e   0e04     MOVLW     0x4                                                                                             
002e10   6f0f     MOVWF     0xf,0x1                                                                                         
002e12   0e40     MOVLW     0x40               HID_BD_IN.Stat._byte = _UCPU|_DAT1;         // Set status                    C:\fw\midicontroller\x014\hid.c
002e14   6f0c     MOVWF     0xc,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002e16   0012     RETURN    0x0            }//end HIDInitEP                                                                 C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\hid.c
                                            * Function:        void HIDTxReport(char *buffer, byte len)                     C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * PreCondition:    mHIDTxIsBusy() must return false.                            C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            *                  Value of 'len' must be equal to or smaller than              C:\fw\midicontroller\x014\hid.c
                                            *                  HID_INT_IN_EP_SIZE                                           C:\fw\midicontroller\x014\hid.c
                                            *                  For an interrupt endpoint, the largest buffer size is        C:\fw\midicontroller\x014\hid.c
                                            *                  64 bytes.                                                    C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Input:           buffer  : Pointer to the starting location of data bytes     C:\fw\midicontroller\x014\hid.c
                                            *                  len     : Number of bytes to be transferred                  C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Overview:        Use this macro to transfer data located in data memory.      C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            *                  Remember: mHIDTxIsBusy() must return false before user       C:\fw\midicontroller\x014\hid.c
                                            *                  can call this function.                                      C:\fw\midicontroller\x014\hid.c
                                            *                  Unexpected behavior will occur if this function is called    C:\fw\midicontroller\x014\hid.c
                                            *                  when mHIDTxIsBusy() == 0                                     C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            *                  Typical Usage:                                               C:\fw\midicontroller\x014\hid.c
                                            *                  if(!mHIDTxIsBusy())                                          C:\fw\midicontroller\x014\hid.c
                                            *                      HIDTxReport(buffer, 3);                                  C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x014\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\hid.c
002e18   cfd9     MOVFF     0xfd9,0xfe6    void HIDTxReport(char *buffer, byte len)                                         C:\fw\midicontroller\x014\hid.c
002e1a   ffe6                                                                                                               
002e1c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002e1e   ffd9                                                                                                               
002e20   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x014\hid.c
                                           	byte i;                                                                         C:\fw\midicontroller\x014\hid.c
                                           	                                                                                C:\fw\midicontroller\x014\hid.c
                                               /*                                                                           C:\fw\midicontroller\x014\hid.c
                                                * Value of len should be equal to or smaller than HID_INT_IN_EP_SIZE.       C:\fw\midicontroller\x014\hid.c
                                                * This check forces the value of len to meet the precondition.              C:\fw\midicontroller\x014\hid.c
                                                */                                                                          C:\fw\midicontroller\x014\hid.c
002e22   0efc     MOVLW     0xfc           	if(len > HID_INT_IN_EP_SIZE)                                                    C:\fw\midicontroller\x014\hid.c
002e24   50db     MOVF      0xdb,0x0,0x0                                                                                    
002e26   0808     SUBLW     0x8                                                                                             
002e28   e205     BC        0x2e34                                                                                          
002e2a   0e08     MOVLW     0x8            	    len = HID_INT_IN_EP_SIZE;                                                   C:\fw\midicontroller\x014\hid.c
002e2c   6ef3     MOVWF     0xf3,0x0                                                                                        
002e2e   0efc     MOVLW     0xfc                                                                                            
002e30   cff3     MOVFF     0xff3,0xfdb                                                                                     
002e32   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                              /*                                                                            C:\fw\midicontroller\x014\hid.c
                                               * Copy data from user's buffer to dual-ram buffer                            C:\fw\midicontroller\x014\hid.c
                                               */                                                                           C:\fw\midicontroller\x014\hid.c
002e34   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    C:\fw\midicontroller\x014\hid.c
002e36   0efc     MOVLW     0xfc                                                                                            
002e38   50db     MOVF      0xdb,0x0,0x0                                                                                    
002e3a   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
002e3c   e219     BC        0x2e70                                                                                          
002e6c   2adf     INCF      0xdf,0x1,0x0                                                                                    
002e6e   d7e3     BRA       0x2e36                                                                                          
002e3e   50df     MOVF      0xdf,0x0,0x0       	hid_report_in[i] = buffer[i];                                               C:\fw\midicontroller\x014\hid.c
002e40   6ee7     MOVWF     0xe7,0x0                                                                                        
002e42   0efd     MOVLW     0xfd                                                                                            
002e44   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002e46   ffe9                                                                                                               
002e48   0efe     MOVLW     0xfe                                                                                            
002e4a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002e4c   ffea                                                                                                               
002e4e   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002e50   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002e52   0e00     MOVLW     0x0                                                                                             
002e54   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002e56   50ef     MOVF      0xef,0x0,0x0                                                                                    
002e58   6ee6     MOVWF     0xe6,0x0                                                                                        
002e5a   50df     MOVF      0xdf,0x0,0x0                                                                                    
002e5c   6aea     CLRF      0xea,0x0                                                                                        
002e5e   0f98     ADDLW     0x98                                                                                            
002e60   6ee9     MOVWF     0xe9,0x0                                                                                        
002e62   0e04     MOVLW     0x4                                                                                             
002e64   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002e66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e68   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002e6a   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002e70   0efc     MOVLW     0xfc               HID_BD_IN.Cnt = len;                                                         C:\fw\midicontroller\x014\hid.c
002e72   cfdb     MOVFF     0xfdb,0x40d                                                                                     
002e74   f40d                                                                                                               
002e76   0e40     MOVLW     0x40               mUSBBufferReady(HID_BD_IN);                                                  C:\fw\midicontroller\x014\hid.c
002e78   0104     MOVLB     0x4                                                                                             
002e7a   170c     ANDWF     0xc,0x1,0x1                                                                                     
002e7c   7d0c     BTG       0xc,0x6,0x1                                                                                     
002e7e   0e88     MOVLW     0x88                                                                                            
002e80   130c     IORWF     0xc,0x1,0x1                                                                                     
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002e82   52e5     MOVF      0xe5,0x1,0x0   }//end HIDTxReport                                                               C:\fw\midicontroller\x014\hid.c
002e84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e86   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002e88   ffd9                                                                                                               
002e8a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x014\hid.c
                                            * Function:        byte HIDRxReport(char *buffer, byte len)                     C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     C:\fw\midicontroller\x014\hid.c
                                            *                  maximum endpoint size responsible for receiving report       C:\fw\midicontroller\x014\hid.c
                                            *                  data from USB host for HID class.                            C:\fw\midicontroller\x014\hid.c
                                            *                  Input argument 'buffer' should point to a buffer area that   C:\fw\midicontroller\x014\hid.c
                                            *                  is bigger or equal to the size specified by 'len'.           C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   C:\fw\midicontroller\x014\hid.c
                                            *                  len     : The number of bytes expected.                      C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Output:          The number of bytes copied to buffer.                        C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Side Effects:    Publicly accessible variable hid_rpt_rx_len is updated       C:\fw\midicontroller\x014\hid.c
                                            *                  with the number of bytes copied to buffer.                   C:\fw\midicontroller\x014\hid.c
                                            *                  Once HIDRxReport is called, subsequent retrieval of          C:\fw\midicontroller\x014\hid.c
                                            *                  hid_rpt_rx_len can be done by calling macro                  C:\fw\midicontroller\x014\hid.c
                                            *                  mHIDGetRptRxLength().                                        C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Overview:        HIDRxReport copies a string of bytes received through        C:\fw\midicontroller\x014\hid.c
                                            *                  USB HID OUT endpoint to a user's specified location.         C:\fw\midicontroller\x014\hid.c
                                            *                  It is a non-blocking function. It does not wait              C:\fw\midicontroller\x014\hid.c
                                            *                  for data if there is no data available. Instead it returns   C:\fw\midicontroller\x014\hid.c
                                            *                  '0' to notify the caller that there is no data available.    C:\fw\midicontroller\x014\hid.c
                                            *                                                                               C:\fw\midicontroller\x014\hid.c
                                            * Note:            If the actual number of bytes received is larger than the    C:\fw\midicontroller\x014\hid.c
                                            *                  number of bytes expected (len), only the expected number     C:\fw\midicontroller\x014\hid.c
                                            *                  of bytes specified will be copied to buffer.                 C:\fw\midicontroller\x014\hid.c
                                            *                  If the actual number of bytes received is smaller than the   C:\fw\midicontroller\x014\hid.c
                                            *                  number of bytes expected (len), only the actual number       C:\fw\midicontroller\x014\hid.c
                                            *                  of bytes received will be copied to buffer.                  C:\fw\midicontroller\x014\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x014\hid.c
002e8c   cfd9     MOVFF     0xfd9,0xfe6    byte HIDRxReport(char *buffer, byte len)                                         C:\fw\midicontroller\x014\hid.c
002e8e   ffe6                                                                                                               
002e90   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002e92   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x014\hid.c
002e94   0101     MOVLB     0x1                hid_rpt_rx_len = 0;                                                          C:\fw\midicontroller\x014\hid.c
002e96   6b32     CLRF      0x32,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002e98   0104     MOVLB     0x4                if(!mHIDRxIsBusy())                                                          C:\fw\midicontroller\x014\hid.c
002e9a   bf08     BTFSC     0x8,0x7,0x1                                                                                     
002e9c   d031     BRA       0x2f00                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x014\hid.c
                                                    * Adjust the expected number of bytes to equal                          C:\fw\midicontroller\x014\hid.c
                                                    * the actual number of bytes received.                                  C:\fw\midicontroller\x014\hid.c
                                                    */                                                                      C:\fw\midicontroller\x014\hid.c
002e9e   0efc     MOVLW     0xfc                   if(len > HID_BD_OUT.Cnt)                                                 C:\fw\midicontroller\x014\hid.c
002ea0   cfdb     MOVFF     0xfdb,0x10                                                                                      
002ea2   f010                                                                                                               
002ea4   5109     MOVF      0x9,0x0,0x1                                                                                     
002ea6   80d8     BSF       0xd8,0x0,0x0                                                                                    
002ea8   5410     SUBFWB    0x10,0x0,0x0                                                                                    
002eaa   e203     BC        0x2eb2                                                                                          
002eac   0efc     MOVLW     0xfc                       len = HID_BD_OUT.Cnt;                                                C:\fw\midicontroller\x014\hid.c
002eae   c409     MOVFF     0x409,0xfdb                                                                                     
002eb0   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x014\hid.c
                                                    * Copy data from dual-ram buffer to user's buffer                       C:\fw\midicontroller\x014\hid.c
                                                    */                                                                      C:\fw\midicontroller\x014\hid.c
002eb2   0101     MOVLB     0x1                    for(hid_rpt_rx_len = 0; hid_rpt_rx_len < len; hid_rpt_rx_len++)          C:\fw\midicontroller\x014\hid.c
002eb4   6b32     CLRF      0x32,0x1                                                                                        
002eb6   0efc     MOVLW     0xfc                                                                                            
002eb8   50db     MOVF      0xdb,0x0,0x0                                                                                    
002eba   5d32     SUBWF     0x32,0x0,0x1                                                                                    
002ebc   e219     BC        0x2ef0                                                                                          
002eec   2b32     INCF      0x32,0x1,0x1                                                                                    
002eee   d7e3     BRA       0x2eb6                                                                                          
002ebe   5132     MOVF      0x32,0x0,0x1               buffer[hid_rpt_rx_len] = hid_report_out[hid_rpt_rx_len];             C:\fw\midicontroller\x014\hid.c
002ec0   6aea     CLRF      0xea,0x0                                                                                        
002ec2   0f90     ADDLW     0x90                                                                                            
002ec4   6ee9     MOVWF     0xe9,0x0                                                                                        
002ec6   0e04     MOVLW     0x4                                                                                             
002ec8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002eca   50ef     MOVF      0xef,0x0,0x0                                                                                    
002ecc   6ee6     MOVWF     0xe6,0x0                                                                                        
002ece   5132     MOVF      0x32,0x0,0x1                                                                                    
002ed0   6ee7     MOVWF     0xe7,0x0                                                                                        
002ed2   0efd     MOVLW     0xfd                                                                                            
002ed4   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002ed6   ffe9                                                                                                               
002ed8   0efe     MOVLW     0xfe                                                                                            
002eda   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002edc   ffea                                                                                                               
002ede   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002ee0   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002ee2   0e00     MOVLW     0x0                                                                                             
002ee4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002ee6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ee8   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002eea   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x014\hid.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      C:\fw\midicontroller\x014\hid.c
                                                    */                                                                      C:\fw\midicontroller\x014\hid.c
002ef0   0104     MOVLB     0x4                    HID_BD_OUT.Cnt = sizeof(hid_report_out);                                 C:\fw\midicontroller\x014\hid.c
002ef2   0e08     MOVLW     0x8                                                                                             
002ef4   6f09     MOVWF     0x9,0x1                                                                                         
002ef6   0e40     MOVLW     0x40                   mUSBBufferReady(HID_BD_OUT);                                             C:\fw\midicontroller\x014\hid.c
002ef8   1708     ANDWF     0x8,0x1,0x1                                                                                     
002efa   7d08     BTG       0x8,0x6,0x1                                                                                     
002efc   0e88     MOVLW     0x88                                                                                            
002efe   1308     IORWF     0x8,0x1,0x1                                                                                     
                                               }//end if                                                                    C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002f00   0101     MOVLB     0x1                return hid_rpt_rx_len;                                                       C:\fw\midicontroller\x014\hid.c
002f02   5132     MOVF      0x32,0x0,0x1                                                                                    
002f04   d000     BRA       0x2f06                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\hid.c
002f06   52e5     MOVF      0xe5,0x1,0x0   }//end HIDRxReport                                                               C:\fw\midicontroller\x014\hid.c
002f08   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002f0a   ffd9                                                                                                               
002f0c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           #endif //def USB_USE_HID                                                         C:\fw\midicontroller\x014\hid.c
                                                                                                                            C:\fw\midicontroller\x014\hid.c
                                           /** EOF hid.c ***************************************************************/   C:\fw\midicontroller\x014\hid.c
                                           //This file contains the global ram definitions for the project                  C:\fw\midicontroller\x014\ram_def.c
                                           #include	"c_system.h"                                                            C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           //----------------------------Main variables---------------------------------------- C:\fw\midicontroller\x014\ram_def.c
                                           TwoBytes NVRCommAddr;                                                            C:\fw\midicontroller\x014\ram_def.c
                                           TwoBytes RAMCommAddr;                                                            C:\fw\midicontroller\x014\ram_def.c
                                           TwoBytes ROMCommAddr;                                                            C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           BitField	CommFlags1;                                                             C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char ProgmemBuffer[32];                                                 C:\fw\midicontroller\x014\ram_def.c
                                           TwoBytes	ProgMemAddr;                                                            C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           #pragma udata RamData                                                            C:\fw\midicontroller\x014\ram_def.c
                                           BitField ArbFlags1;                                                              C:\fw\midicontroller\x014\ram_def.c
                                           BitField MiscFlags1;                                                             C:\fw\midicontroller\x014\ram_def.c
                                           BitField DispSegData[5];                                                         C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char DispNumOfCommons;                                                  C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char LedStates;			//footswitch leds                                     C:\fw\midicontroller\x014\ram_def.c
                                           unsigned long	ButtonState;                                                       C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char ExpPedalInst;                                                      C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           TwoBytes ExpPedalAvg;                                                            C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           //----------------------------USB stuff----------------------------------        C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char USBDataPointer;                                                    C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char USBEP0DataInBuffer[64];                                            C:\fw\midicontroller\x014\ram_def.c
                                           unsigned char ResponseType;                                                      C:\fw\midicontroller\x014\ram_def.c
                                                                                                                            C:\fw\midicontroller\x014\ram_def.c
                                           ;###########################################################################     C:\fw\midicontroller\x014\config.asm
                                           ;#			Author: Joe Dunne				  #                                                    C:\fw\midicontroller\x014\config.asm
                                           ;#			Date 4/06/07					  #                                                        C:\fw\midicontroller\x014\config.asm
                                           ;#			Main arbitrator					  #                                                     C:\fw\midicontroller\x014\config.asm
                                           ;#			File Name: config.asm  				  #                                              C:\fw\midicontroller\x014\config.asm
                                           ;#									  #                                                                   C:\fw\midicontroller\x014\config.asm
                                           ;############################################################################    C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           	ERRORLEVEL -208, -216                                                           C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           	LIST R=DEC                                                                      C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           	INCLUDE "a_MICRDEF.INC"                                                         C:\fw\midicontroller\x014\config.asm
                                                   LIST                                                                     C:\fw\midicontroller\x014\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x014\a_MICRDEF.INC
                                           ;==========================================================================      C:\fw\midicontroller\x014\a_MICRDEF.INC
                                           ;  $Id: P18F4550.INC,v 1.7 2004/10/06 13:56:45 curtiss Exp $                     C:\fw\midicontroller\x014\a_MICRDEF.INC
                                           ;  MPASM PIC18F4550 processor include                                            C:\fw\midicontroller\x014\a_MICRDEF.INC
                                           ;                                                                                C:\fw\midicontroller\x014\a_MICRDEF.INC
                                           ;  (c) Copyright 1999-2004 Microchip Technology, All rights reserved             C:\fw\midicontroller\x014\a_MICRDEF.INC
                                           ;==========================================================================      C:\fw\midicontroller\x014\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x014\a_MICRDEF.INC
                                                   LIST                                                                     C:\fw\midicontroller\x014\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           ;This section contains configuration bits for the processor                      C:\fw\midicontroller\x014\config.asm
                                           ;Don't change this unless you know what you're doing.                            C:\fw\midicontroller\x014\config.asm
                                           ;300000                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG USBDIV=2, CPUDIV=OSC2_PLL3, PLLDIV=2                                     C:\fw\midicontroller\x014\config.asm
                                           ;300001                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG FOSC=HSPLL_HS, FCMEN=OFF, IESO=OFF                                       C:\fw\midicontroller\x014\config.asm
                                           ;300002                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG VREGEN=ON, PWRT=ON, BOR=ON, BORV=2		;2 = 2.7V..                          C:\fw\midicontroller\x014\config.asm
                                           ;300003                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG WDT=OFF, WDTPS=128                                                       C:\fw\midicontroller\x014\config.asm
                                           ;300005                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG CCP2MX=ON, PBADEN=OFF, LPT1OSC=OFF, MCLRE=ON                             C:\fw\midicontroller\x014\config.asm
                                           ;300006                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG STVREN=ON, LVP=OFF, ICPRT=OFF, XINST=OFF, DEBUG=OFF                      C:\fw\midicontroller\x014\config.asm
                                           ;300008                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG CP0=OFF, CP1=OFF, CP2=OFF                                                C:\fw\midicontroller\x014\config.asm
                                           ;300009                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG CPB=OFF, CPD=OFF                                                         C:\fw\midicontroller\x014\config.asm
                                           ;30000A                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG WRT0=OFF, WRT1=OFF, WRT2=OFF                                             C:\fw\midicontroller\x014\config.asm
                                           ;30000B                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG WRTC=OFF, WRTB=OFF, WRTD=OFF                                             C:\fw\midicontroller\x014\config.asm
                                           ;30000C                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG EBTR0=OFF, EBTR1=OFF, EBTR2=OFF                                          C:\fw\midicontroller\x014\config.asm
                                           ;30000D                                                                          C:\fw\midicontroller\x014\config.asm
                                           	CONFIG EBTRB=OFF                                                                C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           	global	CLEAR_RAM                                                                C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           	code                                                                            C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           ;clear general purpose registers 0x000 through 0x7FF.                            C:\fw\midicontroller\x014\config.asm
                                           CLEAR_RAM                                                                        C:\fw\midicontroller\x014\config.asm
00348c   6aea     CLRF      0xea,0x0       	clrf	FSR0H                                                                      C:\fw\midicontroller\x014\config.asm
00348e   6ae9     CLRF      0xe9,0x0       	clrf	FSR0L                                                                      C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           RAMCLEAR                                                                         C:\fw\midicontroller\x014\config.asm
003490   0004     CLRWDT                   	CLRWDT                                                                          C:\fw\midicontroller\x014\config.asm
003492   6aee     CLRF      0xee,0x0       	clrf	POSTINC0                                                                   C:\fw\midicontroller\x014\config.asm
003494   a6ea     BTFSS     0xea,0x3,0x0   	btfss	FSR0H, 3                                                                  C:\fw\midicontroller\x014\config.asm
003496   d7fc     BRA       0x3490         	bra	RAMCLEAR                                                                    C:\fw\midicontroller\x014\config.asm
003498   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x014\config.asm
                                                                                                                            C:\fw\midicontroller\x014\config.asm
                                           	END                                                                             C:\fw\midicontroller\x014\config.asm
                                           //#######################################################################        C:\fw\midicontroller\x014\intslct.c
                                           /**                                                                              C:\fw\midicontroller\x014\intslct.c
                                           * @file intslct.c                                                                C:\fw\midicontroller\x014\intslct.c
                                           * interrupt handler                                                              C:\fw\midicontroller\x014\intslct.c
                                           *                                                                                C:\fw\midicontroller\x014\intslct.c
                                           * @author Joe Dunne                                                              C:\fw\midicontroller\x014\intslct.c
                                           * @date 2/02/05                                                                  C:\fw\midicontroller\x014\intslct.c
                                           * @brief RS232/USB communication routine                                         C:\fw\midicontroller\x014\intslct.c
                                           */                                                                               C:\fw\midicontroller\x014\intslct.c
                                           //			*See Updates section at bottom of file*                                     C:\fw\midicontroller\x014\intslct.c
                                           //#######################################################################        C:\fw\midicontroller\x014\intslct.c
                                                                                                                            C:\fw\midicontroller\x014\intslct.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\intslct.c
                                                                                                                            C:\fw\midicontroller\x014\intslct.c
                                           #pragma code InterruptVectorHigh = 0xA08                                         C:\fw\midicontroller\x014\intslct.c
                                           void                                                                             C:\fw\midicontroller\x014\intslct.c
                                           InterruptVectorHigh (void)                                                       C:\fw\midicontroller\x014\intslct.c
                                           {                                                                                C:\fw\midicontroller\x014\intslct.c
                                             _asm                                                                           C:\fw\midicontroller\x014\intslct.c
000a08   ef20     GOTO      0x3440         	goto InterruptHandlerHigh //jump to interrupt routine                           C:\fw\midicontroller\x014\intslct.c
000a0a   f01a                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x014\intslct.c
000a0c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\intslct.c
                                                                                                                            C:\fw\midicontroller\x014\intslct.c
                                                                                                                            C:\fw\midicontroller\x014\intslct.c
                                           //----------------------------------------------------------------------------   C:\fw\midicontroller\x014\intslct.c
                                           // High priority interrupt routine                                               C:\fw\midicontroller\x014\intslct.c
                                                                                                                            C:\fw\midicontroller\x014\intslct.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\intslct.c
                                                                                                                            C:\fw\midicontroller\x014\intslct.c
                                           #pragma interrupt InterruptHandlerHigh                                           C:\fw\midicontroller\x014\intslct.c
003440   cfda     MOVFF     0xfda,0xfe4    void	InterruptHandlerHigh ()                                                     C:\fw\midicontroller\x014\intslct.c
003442   ffe4                                                                                                               
003444   cfe2     MOVFF     0xfe2,0xfda                                                                                     
003446   ffda                                                                                                               
003448   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x014\intslct.c
00344a   a4f2     BTFSS     0xf2,0x2,0x0     if (INTCONbits.TMR0IF)                                                         C:\fw\midicontroller\x014\intslct.c
00344c   d003     BRA       0x3454                                                                                          
                                               {                                   //check for TMR0 overflow                C:\fw\midicontroller\x014\intslct.c
00344e   94f2     BCF       0xf2,0x2,0x0         INTCONbits.TMR0IF = 0;            //clear interrupt flag                   C:\fw\midicontroller\x014\intslct.c
003450   0100     MOVLB     0x0                  Systick = true;                                                            C:\fw\midicontroller\x014\intslct.c
003452   8160     BSF       0x60,0x0,0x1                                                                                    
                                               }                                                                            C:\fw\midicontroller\x014\intslct.c
003454   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\intslct.c
003456   cfe5     MOVFF     0xfe5,0xfda                                                                                     
003458   ffda                                                                                                               
00345a   0011     RETFIE    0x1                                                                                             
                                           #pragma code                                                                     C:\fw\midicontroller\x014\intslct.c
                                           //----------------------------------------------------------------------------   C:\fw\midicontroller\x014\intslct.c
                                           //*;###########################################################################  C:\fw\midicontroller\x014\init.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\init.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x014\init.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x014\init.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x014\init.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\init.c
                                           //;############################################################################  C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\init.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           void init(void) {                                                                C:\fw\midicontroller\x014\init.c
00335e   ec46     CALL      0x348c,0x0     	CLEAR_RAM();                                                                    C:\fw\midicontroller\x014\init.c
003360   f01a                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\init.c
003362   6a89     CLRF      0x89,0x0       	LATA = 0;                                                                       C:\fw\midicontroller\x014\init.c
003364   6a8a     CLRF      0x8a,0x0       	LATB = 0;                                                                       C:\fw\midicontroller\x014\init.c
003366   6a8b     CLRF      0x8b,0x0       	LATC = 0;                                                                       C:\fw\midicontroller\x014\init.c
003368   6a8c     CLRF      0x8c,0x0       	LATD = 0;                                                                       C:\fw\midicontroller\x014\init.c
00336a   6a8d     CLRF      0x8d,0x0       	LATE = 0;                                                                       C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
00336c   0e01     MOVLW     0x1            	TRISA = INIT_TRISA;                                                             C:\fw\midicontroller\x014\init.c
00336e   6e92     MOVWF     0x92,0x0                                                                                        
003370   0e10     MOVLW     0x10           	TRISB = INIT_TRISB;                                                             C:\fw\midicontroller\x014\init.c
003372   6e93     MOVWF     0x93,0x0                                                                                        
003374   0ef8     MOVLW     0xf8           	TRISC = INIT_TRISC;                                                             C:\fw\midicontroller\x014\init.c
003376   6e94     MOVWF     0x94,0x0                                                                                        
003378   6a95     CLRF      0x95,0x0       	TRISD = INIT_TRISD;                                                             C:\fw\midicontroller\x014\init.c
00337a   0e02     MOVLW     0x2            	TRISE = INIT_TRISE;                                                             C:\fw\midicontroller\x014\init.c
00337c   6e96     MOVWF     0x96,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\init.c
00337e   0100     MOVLB     0x0            	DispNumOfCommons = DISP_NUMBER_OF_COMMONS;                                      C:\fw\midicontroller\x014\init.c
003380   0e05     MOVLW     0x5                                                                                             
003382   6f67     MOVWF     0x67,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           //	TRISCbits.TRISC6 = false;                                                     C:\fw\midicontroller\x014\init.c
                                           //	RCSTA = 0x90;                                                                 C:\fw\midicontroller\x014\init.c
                                           //	TXSTA = 0xA2;		//0x46;                                                        C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           //	SPBRG = 204;                                                                  C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           #ifdef UARTISRS232                                                               C:\fw\midicontroller\x014\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          C:\fw\midicontroller\x014\init.c
                                           //Initialize the USART control registers                                         C:\fw\midicontroller\x014\init.c
                                           	TXSTA = 0xA6;			//master,8bit,async,high speed                                  C:\fw\midicontroller\x014\init.c
                                           	RCSTA = 0x90;			//enabled,8bit, continuous                                      C:\fw\midicontroller\x014\init.c
                                           //	BAUDCONbits.BRG16 = true;                                                     C:\fw\midicontroller\x014\init.c
                                           	SPBRG = 16;			//115200 baud                                                     C:\fw\midicontroller\x014\init.c
                                           	SPBRGH = 0x01;                                                                  C:\fw\midicontroller\x014\init.c
                                           #else                                                                            C:\fw\midicontroller\x014\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          C:\fw\midicontroller\x014\init.c
                                           //Initialize the USART control registers                                         C:\fw\midicontroller\x014\init.c
003384   0ee6     MOVLW     0xe6           	TXSTA = 0xE6;			//master,8bit,async, BRGH=1                                     C:\fw\midicontroller\x014\init.c
003386   6eac     MOVWF     0xac,0x0                                                                                        
003388   0e90     MOVLW     0x90           	RCSTA = 0x90;			//enabled,8bit, continuous                                      C:\fw\midicontroller\x014\init.c
00338a   6eab     MOVWF     0xab,0x0                                                                                        
                                           //	BAUDCONbits.BRG16 = true;                                                     C:\fw\midicontroller\x014\init.c
00338c   0e3f     MOVLW     0x3f           	SPBRG = 63;			//31250 baud                                                      C:\fw\midicontroller\x014\init.c
00338e   6eaf     MOVWF     0xaf,0x0                                                                                        
003390   6ab0     CLRF      0xb0,0x0       	SPBRGH = 0x00;                                                                  C:\fw\midicontroller\x014\init.c
                                           #endif                                                                           C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           //These constants setup the application's MCU Analog-to-Digital Converter module. C:\fw\midicontroller\x014\init.c
003392   0e40     MOVLW     0x40           	ADCON0	= 0b01000000;		//AN0, off                                                C:\fw\midicontroller\x014\init.c
003394   6ec2     MOVWF     0xc2,0x0                                                                                        
003396   0e0e     MOVLW     0xe            	ADCON1	= 0b00001110;		//1 analog channels                                       C:\fw\midicontroller\x014\init.c
003398   6ec1     MOVWF     0xc1,0x0                                                                                        
00339a   0e86     MOVLW     0x86           	ADCON2	= 0b10000110;		//Right justified, 0 TAD(manual), FOSC/32                 C:\fw\midicontroller\x014\init.c
00339c   6ec0     MOVWF     0xc0,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                           //set up timer0 to interrupt at some interval..                                  C:\fw\midicontroller\x014\init.c
00339e   0e20     MOVLW     0x20           	INTCON = 0x20;                //disable global and enable TMR0 interrupt        C:\fw\midicontroller\x014\init.c
0033a0   6ef2     MOVWF     0xf2,0x0                                                                                        
0033a2   0e84     MOVLW     0x84           	INTCON2 = 0x84;               //TMR0 high priority                              C:\fw\midicontroller\x014\init.c
0033a4   6ef1     MOVWF     0xf1,0x0                                                                                        
0033a6   8ed0     BSF       0xd0,0x7,0x0   	RCONbits.IPEN = 1;            //enable priority levels                          C:\fw\midicontroller\x014\init.c
0033a8   6ad7     CLRF      0xd7,0x0       	TMR0H = 0;                    //clear timer                                     C:\fw\midicontroller\x014\init.c
0033aa   6ad6     CLRF      0xd6,0x0       	TMR0L = 0;                    //clear timer                                     C:\fw\midicontroller\x014\init.c
0033ac   0e80     MOVLW     0x80           	T0CON = 0x80;                 //set up timer0 - prescaler 1:8                   C:\fw\midicontroller\x014\init.c
0033ae   6ed5     MOVWF     0xd5,0x0                                                                                        
0033b0   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIEH = 1;          //enable interrupts                               C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
                                                                                                                            C:\fw\midicontroller\x014\init.c
0033b2   0e14     MOVLW     0x14           	mInitializeUSBDriver();                                                         C:\fw\midicontroller\x014\init.c
0033b4   6e6f     MOVWF     0x6f,0x0                                                                                        
0033b6   0101     MOVLB     0x1                                                                                             
0033b8   6b22     CLRF      0x22,0x1                                                                                        
0033ba   0101     MOVLB     0x1                                                                                             
0033bc   6b23     CLRF      0x23,0x1                                                                                        
0033be   0101     MOVLB     0x1                                                                                             
0033c0   6b24     CLRF      0x24,0x1                                                                                        
0033c2   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\init.c
                                           //*;###########################################################################  C:\fw\midicontroller\x014\hwcalls.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\hwcalls.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x014\hwcalls.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x014\hwcalls.c
                                           //;#			File Name: hwcalls.c   										  #                                      C:\fw\midicontroller\x014\hwcalls.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\hwcalls.c
                                           //;############################################################################  C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
002458   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ADC_CONVERSION(unsigned char Channel) {                            C:\fw\midicontroller\x014\hwcalls.c
00245a   ffe6                                                                                                               
00245c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00245e   ffd9                                                                                                               
002460   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char tempcntr;                                                         C:\fw\midicontroller\x014\hwcalls.c
002462   0efe     MOVLW     0xfe           	ADCON0 = Channel;                                                               C:\fw\midicontroller\x014\hwcalls.c
002464   50db     MOVF      0xdb,0x0,0x0                                                                                    
002466   6ec2     MOVWF     0xc2,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //Wait for the converter's holding capacitor to charge up.                       C:\fw\midicontroller\x014\hwcalls.c
                                           ADC_CHARGING_DELAY_LOOP:                                                         C:\fw\midicontroller\x014\hwcalls.c
002468   0e0a     MOVLW     0xa            	for(tempcntr = 10;tempcntr!=0;tempcntr--);                                      C:\fw\midicontroller\x014\hwcalls.c
00246a   6edf     MOVWF     0xdf,0x0                                                                                        
00246c   50df     MOVF      0xdf,0x0,0x0                                                                                    
00246e   e002     BZ        0x2474                                                                                          
002470   06df     DECF      0xdf,0x1,0x0                                                                                    
002472   d7fc     BRA       0x246c                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //Start the conversion                                                           C:\fw\midicontroller\x014\hwcalls.c
002474   82c2     BSF       0xc2,0x1,0x0   	ADCON0bits.GO = true;                                                           C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //Wait for the conversion to complete, then exit                                 C:\fw\midicontroller\x014\hwcalls.c
                                           ADC_CONVERSION_DELAY:                                                            C:\fw\midicontroller\x014\hwcalls.c
002476   b2c2     BTFSC     0xc2,0x1,0x0   	for(;ADCON0bits.GO;);                                                           C:\fw\midicontroller\x014\hwcalls.c
002478   d7fe     BRA       0x2476                                                                                          
                                           	                                                                                C:\fw\midicontroller\x014\hwcalls.c
00247a   50c4     MOVF      0xc4,0x0,0x0   	return ADRESH;                                                                  C:\fw\midicontroller\x014\hwcalls.c
00247c   d000     BRA       0x247e                                                                                          
00247e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002480   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002482   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002484   ffd9                                                                                                               
002486   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Send a single MIDI byte. */                                                   C:\fw\midicontroller\x014\hwcalls.c
002488   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_byte(u8 data) {                                                   C:\fw\midicontroller\x014\hwcalls.c
00248a   ffe6                                                                                                               
00248c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00248e   ffd9                                                                                                               
002490   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char temp;                                                             C:\fw\midicontroller\x014\hwcalls.c
                                           	//send out first byte.                                                          C:\fw\midicontroller\x014\hwcalls.c
002492   0efe     MOVLW     0xfe           	TXREG = data;                                                                   C:\fw\midicontroller\x014\hwcalls.c
002494   50db     MOVF      0xdb,0x0,0x0                                                                                    
002496   6ead     MOVWF     0xad,0x0                                                                                        
002498   509e     MOVF      0x9e,0x0,0x0   	temp = PIR1;			//clear TXIF..                                                   C:\fw\midicontroller\x014\hwcalls.c
00249a   6edf     MOVWF     0xdf,0x0                                                                                        
00249c   a89e     BTFSS     0x9e,0x4,0x0   	while(!PIR1bits.TXIF);                                                          C:\fw\midicontroller\x014\hwcalls.c
00249e   d7fe     BRA       0x249c                                                                                          
0024a0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
0024a2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0024a4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024a6   ffd9                                                                                                               
0024a8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //****************************************************************************** C:\fw\midicontroller\x014\hwcalls.c
                                           //JDunne 5/27/07 - Converted routine from assembly to C.  (used to be called SEND_TO_LATCHES) C:\fw\midicontroller\x014\hwcalls.c
                                           //------------------------------------------------------------------------------ C:\fw\midicontroller\x014\hwcalls.c
0024aa   cfd9     MOVFF     0xfd9,0xfe6    void	SendDataToShiftReg(unsigned char dataToSend) {                              C:\fw\midicontroller\x014\hwcalls.c
0024ac   ffe6                                                                                                               
0024ae   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0024b0   ffd9                                                                                                               
0024b2   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char DataCounter;                                                      C:\fw\midicontroller\x014\hwcalls.c
                                           //SEND_SPEC_TO_LATCHES                                                           C:\fw\midicontroller\x014\hwcalls.c
0024b4   0e08     MOVLW     0x8            	DataCounter = 8;								//Load number of bits to be transfered                  C:\fw\midicontroller\x014\hwcalls.c
0024b6   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //	bcf	SRCK_LAT_BIT						//Control clock signal, also prevent IIC start          C:\fw\midicontroller\x014\hwcalls.c
0024b8   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Flush out garbage                              C:\fw\midicontroller\x014\hwcalls.c
0024ba   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //STL_TRANSMIT_BIT                                                               C:\fw\midicontroller\x014\hwcalls.c
                                           	do {                                                                            C:\fw\midicontroller\x014\hwcalls.c
0024bc   9289     BCF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = false;				//Clear strobe pin                           C:\fw\midicontroller\x014\hwcalls.c
0024be   0efe     MOVLW     0xfe           		if (!chkbit(dataToSend, 7)) {		//MSB high?                                     C:\fw\midicontroller\x014\hwcalls.c
0024c0   bedb     BTFSC     0xdb,0x7,0x0                                                                                    
0024c2   d002     BRA       0x24c8                                                                                          
0024c4   9689     BCF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = false;		//No, set data signal low                   C:\fw\midicontroller\x014\hwcalls.c
                                           		}                                                                              C:\fw\midicontroller\x014\hwcalls.c
0024c6   d001     BRA       0x24ca         		else {								//MSB low?                                                       C:\fw\midicontroller\x014\hwcalls.c
0024c8   8689     BSF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = true;		//No, release data signal                    C:\fw\midicontroller\x014\hwcalls.c
                                           		}                                                                              C:\fw\midicontroller\x014\hwcalls.c
0024ca   cfdb     MOVFF     0xfdb,0xff3    		dataToSend <<=1;					//Shift next bit to MSB position                          C:\fw\midicontroller\x014\hwcalls.c
0024cc   fff3                                                                                                               
0024ce   9ef3     BCF       0xf3,0x7,0x0                                                                                    
0024d0   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
0024d2   cff3     MOVFF     0xff3,0xfdb                                                                                     
0024d4   ffdb                                                                                                               
0024d6   8289     BSF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = true;                                                  C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //STL_RESET_CLOCK_LEVEL                                                          C:\fw\midicontroller\x014\hwcalls.c
0024d8   06df     DECF      0xdf,0x1,0x0   	} while (--DataCounter!=0);				//All 8 bits transfered? No, go transfer next bit C:\fw\midicontroller\x014\hwcalls.c
0024da   e1f0     BNZ       0x24bc                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //STL_STROBE                                                                     C:\fw\midicontroller\x014\hwcalls.c
0024dc   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Strobe the data                                C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //STL_STROBE_DELAY                                                               C:\fw\midicontroller\x014\hwcalls.c
0024de   0e10     MOVLW     0x10           	for (DataCounter = LATCH_STROBE_DELAY; DataCounter !=0;DataCounter--);		//Pause for data transfer from external latch_1's input to its output C:\fw\midicontroller\x014\hwcalls.c
0024e0   6edf     MOVWF     0xdf,0x0                                                                                        
0024e2   50df     MOVF      0xdf,0x0,0x0                                                                                    
0024e4   e002     BZ        0x24ea                                                                                          
0024e6   06df     DECF      0xdf,0x1,0x0                                                                                    
0024e8   d7fc     BRA       0x24e2                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
0024ea   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   C:\fw\midicontroller\x014\hwcalls.c
0024ec   8689     BSF       0x89,0x3,0x0   	SHIFTREG_SER_IN_LAT_BIT = true;				//Release data signal                        C:\fw\midicontroller\x014\hwcalls.c
0024ee   8289     BSF       0x89,0x1,0x0   	SHIFTREG_SRCK_LAT_BIT = true;			//Release serial clk                            C:\fw\midicontroller\x014\hwcalls.c
0024f0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
0024f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0024f4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024f6   ffd9                                                                                                               
0024f8   0012     RETURN    0x0                                                                                             
                                           //------------------------------------------------------------------------------ C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //returns data into ButtonState.                                                 C:\fw\midicontroller\x014\hwcalls.c
0024fa   cfd9     MOVFF     0xfd9,0xfe6    void	ReadButtons(void) {                                                         C:\fw\midicontroller\x014\hwcalls.c
0024fc   ffe6                                                                                                               
0024fe   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002500   ffd9                                                                                                               
002502   0e04     MOVLW     0x4                                                                                             
002504   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char BtnAddress, bitloc, i;                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	BitField TempButtons;                                                           C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           //the following only reads 7 buttons from the multiplexor, and the 8th from the pin directly. C:\fw\midicontroller\x014\hwcalls.c
                                           //the 7th bit of the multiplexor is the modeswitch which is read below.          C:\fw\midicontroller\x014\hwcalls.c
002506   52de     MOVF      0xde,0x1,0x0   	bitloc = 1;                                                                     C:\fw\midicontroller\x014\hwcalls.c
002508   0e01     MOVLW     0x1                                                                                             
00250a   6edd     MOVWF     0xdd,0x0                                                                                        
00250c   0e03     MOVLW     0x3            	TempButtons.byte = 0;                                                           C:\fw\midicontroller\x014\hwcalls.c
00250e   6adb     CLRF      0xdb,0x0                                                                                        
002510   6adf     CLRF      0xdf,0x0       	for (BtnAddress = 0;BtnAddress<=6;BtnAddress++) {                               C:\fw\midicontroller\x014\hwcalls.c
002512   50df     MOVF      0xdf,0x0,0x0                                                                                    
002514   0806     SUBLW     0x6                                                                                             
002516   e322     BNC       0x255c                                                                                          
002558   2adf     INCF      0xdf,0x1,0x0                                                                                    
00255a   d7db     BRA       0x2512                                                                                          
002518   cfdf     MOVFF     0xfdf,0xfe6    		SetDipAddress(BtnAddress);                                                     C:\fw\midicontroller\x014\hwcalls.c
00251a   ffe6                                                                                                               
00251c   d848     RCALL     0x25ae                                                                                          
00251e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
002520   0e05     MOVLW     0x5            		for (i = BTN_SAMPLE_DELAY;i!=0;i--);		//delay for a sampling delay             C:\fw\midicontroller\x014\hwcalls.c
002522   6ef3     MOVWF     0xf3,0x0                                                                                        
002524   0e02     MOVLW     0x2                                                                                             
002526   cff3     MOVFF     0xff3,0xfdb                                                                                     
002528   ffdb                                                                                                               
00252a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00252c   e003     BZ        0x2534                                                                                          
00252e   0e02     MOVLW     0x2                                                                                             
002530   06db     DECF      0xdb,0x1,0x0                                                                                    
002532   d7fb     BRA       0x252a                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
002534   a284     BTFSS     0x84,0x1,0x0   		if (BTN_IN_PIN) TempButtons.byte |= bitloc;		//Or in the current bit if it is set. C:\fw\midicontroller\x014\hwcalls.c
002536   d009     BRA       0x254a                                                                                          
002538   0e03     MOVLW     0x3                                                                                             
00253a   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
00253c   ffe7                                                                                                               
00253e   0e01     MOVLW     0x1                                                                                             
002540   50db     MOVF      0xdb,0x0,0x0                                                                                    
002542   12e7     IORWF     0xe7,0x1,0x0                                                                                    
002544   0e03     MOVLW     0x3                                                                                             
002546   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002548   ffdb                                                                                                               
00254a   0e01     MOVLW     0x1            		bitloc <<= 1;										//shift the bit over to the next                        C:\fw\midicontroller\x014\hwcalls.c
00254c   cfdb     MOVFF     0xfdb,0xff3                                                                                     
00254e   fff3                                                                                                               
002550   9ef3     BCF       0xf3,0x7,0x0                                                                                    
002552   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
002554   cff3     MOVFF     0xff3,0xfdb                                                                                     
002556   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
00255c   0e03     MOVLW     0x3            	ButtonState = TempButtons.byte;                                                 C:\fw\midicontroller\x014\hwcalls.c
00255e   cfdb     MOVFF     0xfdb,0x69                                                                                      
002560   f069                                                                                                               
002562   0100     MOVLB     0x0                                                                                             
002564   6b6a     CLRF      0x6a,0x1                                                                                        
002566   6b6b     CLRF      0x6b,0x1                                                                                        
002568   6b6c     CLRF      0x6c,0x1                                                                                        
00256a   90d8     BCF       0xd8,0x0,0x0   	ButtonState <<=1;			//shift everything over one because the 0th bit is supposed C:\fw\midicontroller\x014\hwcalls.c
00256c   3769     RLCF      0x69,0x1,0x1                                                                                    
00256e   376a     RLCF      0x6a,0x1,0x1                                                                                    
002570   376b     RLCF      0x6b,0x1,0x1                                                                                    
002572   376c     RLCF      0x6c,0x1,0x1                                                                                    
                                           								//to be PRESET_1, which is on another pin.                               C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
002574   696a     SETF      0x6a,0x1       	ButtonState |= 0xFFFFFF00;                                                      C:\fw\midicontroller\x014\hwcalls.c
002576   696b     SETF      0x6b,0x1                                                                                        
002578   696c     SETF      0x6c,0x1                                                                                        
00257a   b881     BTFSC     0x81,0x4,0x0   	if (BTN_PRESET_1_PIN) setbit(ButtonState,0);                                    C:\fw\midicontroller\x014\hwcalls.c
00257c   8169     BSF       0x69,0x0,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	//all buttons are backwards logic, so simply invert the state of ButtonState.   C:\fw\midicontroller\x014\hwcalls.c
00257e   1f69     COMF      0x69,0x1,0x1   	ButtonState = ~ButtonState;                                                     C:\fw\midicontroller\x014\hwcalls.c
002580   1f6a     COMF      0x6a,0x1,0x1                                                                                    
002582   1f6b     COMF      0x6b,0x1,0x1                                                                                    
002584   1f6c     COMF      0x6c,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	//read the 7th bit of the shift register.  (Which is the slider mode switch)    C:\fw\midicontroller\x014\hwcalls.c
002586   0e07     MOVLW     0x7            	BtnAddress = 0x07;                                                              C:\fw\midicontroller\x014\hwcalls.c
002588   6edf     MOVWF     0xdf,0x0                                                                                        
00258a   cfdf     MOVFF     0xfdf,0xfe6    	SetDipAddress(BtnAddress);                                                      C:\fw\midicontroller\x014\hwcalls.c
00258c   ffe6                                                                                                               
00258e   d80f     RCALL     0x25ae                                                                                          
002590   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002592   0100     MOVLB     0x0            	ModeSwitchState = true;                                                         C:\fw\midicontroller\x014\hwcalls.c
002594   8161     BSF       0x61,0x0,0x1                                                                                    
002596   b284     BTFSC     0x84,0x1,0x0   	if (BTN_IN_PIN) ModeSwitchState = false;                                        C:\fw\midicontroller\x014\hwcalls.c
002598   9161     BCF       0x61,0x0,0x1                                                                                    
00259a   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x014\hwcalls.c
00259c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00259e   e202     BC        0x25a4                                                                                          
0025a0   6ae1     CLRF      0xe1,0x0                                                                                        
0025a2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0025a4   6ee1     MOVWF     0xe1,0x0                                                                                        
0025a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0025a8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0025aa   ffd9                                                                                                               
0025ac   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /*                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                           ///Average = ((Inst-Avg)/(2^Tau))+Avg                                            C:\fw\midicontroller\x014\hwcalls.c
                                           TwoBytes Filtered2SampleAvg(TwoBytes Avg, unsigned char Inst, unsigned char Tau) { C:\fw\midicontroller\x014\hwcalls.c
                                           	unsigned char positive;                                                         C:\fw\midicontroller\x014\hwcalls.c
                                           	TwoBytes diff;                                                                  C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	diff.s_form = 0;                                                                C:\fw\midicontroller\x014\hwcalls.c
                                           	if (Inst >= Avg.b_form.high) {                                                  C:\fw\midicontroller\x014\hwcalls.c
                                           		diff.b_form.high = Inst - Avg.b_form.high;                                     C:\fw\midicontroller\x014\hwcalls.c
                                           		setbit(positive,0);                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	}                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                           	else {                                                                          C:\fw\midicontroller\x014\hwcalls.c
                                           		diff.b_form.high = Avg.b_form.high - Inst;                                     C:\fw\midicontroller\x014\hwcalls.c
                                           		clrbit(positive,0);                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	}                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	diff.s_form >>= Tau;                                                            C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           	if (chkbit(positive,0)) {                                                       C:\fw\midicontroller\x014\hwcalls.c
                                           		Avg.s_form += diff.s_form;                                                     C:\fw\midicontroller\x014\hwcalls.c
                                           	}                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                           	else {                                                                          C:\fw\midicontroller\x014\hwcalls.c
                                           		Avg.s_form -= diff.s_form;                                                     C:\fw\midicontroller\x014\hwcalls.c
                                           	}                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                           	return Avg;                                                                     C:\fw\midicontroller\x014\hwcalls.c
                                           }                                                                                C:\fw\midicontroller\x014\hwcalls.c
                                           */                                                                               C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
0025ae   cfd9     MOVFF     0xfd9,0xfe6    void	SetDipAddress(unsigned char Address) {                                      C:\fw\midicontroller\x014\hwcalls.c
0025b0   ffe6                                                                                                               
0025b2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0025b4   ffd9                                                                                                               
0025b6   9889     BCF       0x89,0x4,0x0   	BTN_S0_LAT_BIT = false;                                                         C:\fw\midicontroller\x014\hwcalls.c
0025b8   9a89     BCF       0x89,0x5,0x0   	BTN_S1_LAT_BIT = false;                                                         C:\fw\midicontroller\x014\hwcalls.c
0025ba   908d     BCF       0x8d,0x0,0x0   	BTN_S2_LAT_BIT = false;                                                         C:\fw\midicontroller\x014\hwcalls.c
0025bc   0efe     MOVLW     0xfe           	if (chkbit(Address,0)) BTN_S0_LAT_BIT = true;                                   C:\fw\midicontroller\x014\hwcalls.c
0025be   b0db     BTFSC     0xdb,0x0,0x0                                                                                    
0025c0   8889     BSF       0x89,0x4,0x0                                                                                    
0025c2   b2db     BTFSC     0xdb,0x1,0x0   	if (chkbit(Address,1)) BTN_S1_LAT_BIT = true;                                   C:\fw\midicontroller\x014\hwcalls.c
0025c4   8a89     BSF       0x89,0x5,0x0                                                                                    
0025c6   b4db     BTFSC     0xdb,0x2,0x0   	if (chkbit(Address,2)) BTN_S2_LAT_BIT = true;                                   C:\fw\midicontroller\x014\hwcalls.c
0025c8   808d     BSF       0x8d,0x0,0x0                                                                                    
0025ca   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
0025cc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0025ce   ffd9                                                                                                               
0025d0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* --------------- LED read-out display functions: */                            C:\fw\midicontroller\x014\hwcalls.c
0025d2   cfd9     MOVFF     0xfd9,0xfe6    u32 fsw_poll(){                                                                  C:\fw\midicontroller\x014\hwcalls.c
0025d4   ffe6                                                                                                               
0025d6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0025d8   ffd9                                                                                                               
0025da   0e04     MOVLW     0x4                                                                                             
0025dc   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	FourBytes TempButtons;                                                          C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
0025de   6ade     CLRF      0xde,0x0       	TempButtons.l_form = 0;                                                         C:\fw\midicontroller\x014\hwcalls.c
0025e0   6ade     CLRF      0xde,0x0                                                                                        
0025e2   6ade     CLRF      0xde,0x0                                                                                        
0025e4   6add     CLRF      0xdd,0x0                                                                                        
0025e6   52dd     MOVF      0xdd,0x1,0x0                                                                                    
0025e8   52dd     MOVF      0xdd,0x1,0x0                                                                                    
0025ea   c069     MOVFF     0x69,0x10      	TempButtons.b_form.byte3 = ButtonState&0xF0;                                    C:\fw\midicontroller\x014\hwcalls.c
0025ec   f010                                                                                                               
0025ee   c06a     MOVFF     0x6a,0x11                                                                                       
0025f0   f011                                                                                                               
0025f2   c06b     MOVFF     0x6b,0x12                                                                                       
0025f4   f012                                                                                                               
0025f6   c06c     MOVFF     0x6c,0x13                                                                                       
0025f8   f013                                                                                                               
0025fa   0ef0     MOVLW     0xf0                                                                                            
0025fc   1610     ANDWF     0x10,0x1,0x0                                                                                    
0025fe   6a11     CLRF      0x11,0x0                                                                                        
002600   6a12     CLRF      0x12,0x0                                                                                        
002602   6a13     CLRF      0x13,0x0                                                                                        
002604   0e03     MOVLW     0x3                                                                                             
002606   c010     MOVFF     0x10,0xfdb                                                                                      
002608   ffdb                                                                                                               
00260a   c069     MOVFF     0x69,0x10      	TempButtons.b_form.byte0 = ButtonState&0x0F;                                    C:\fw\midicontroller\x014\hwcalls.c
00260c   f010                                                                                                               
00260e   c06a     MOVFF     0x6a,0x11                                                                                       
002610   f011                                                                                                               
002612   c06b     MOVFF     0x6b,0x12                                                                                       
002614   f012                                                                                                               
002616   c06c     MOVFF     0x6c,0x13                                                                                       
002618   f013                                                                                                               
00261a   0e0f     MOVLW     0xf                                                                                             
00261c   1610     ANDWF     0x10,0x1,0x0                                                                                    
00261e   6a11     CLRF      0x11,0x0                                                                                        
002620   6a12     CLRF      0x12,0x0                                                                                        
002622   6a13     CLRF      0x13,0x0                                                                                        
002624   5010     MOVF      0x10,0x0,0x0                                                                                    
002626   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
002628   cfdf     MOVFF     0xfdf,0x10     	return TempButtons.l_form;                                                      C:\fw\midicontroller\x014\hwcalls.c
00262a   f010                                                                                                               
00262c   0e01     MOVLW     0x1                                                                                             
00262e   cfdb     MOVFF     0xfdb,0x11                                                                                      
002630   f011                                                                                                               
002632   c010     MOVFF     0x10,0xff3                                                                                      
002634   fff3                                                                                                               
002636   c011     MOVFF     0x11,0xff4                                                                                      
002638   fff4                                                                                                               
00263a   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x014\hwcalls.c
00263c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00263e   e203     BC        0x2646                                                                                          
002640   d000     BRA       0x2642                                                                                          
002642   6ae1     CLRF      0xe1,0x0                                                                                        
002644   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002646   6ee1     MOVWF     0xe1,0x0                                                                                        
002648   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00264a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00264c   ffd9                                                                                                               
00264e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           void	UpdateLeds(void) {                                                          C:\fw\midicontroller\x014\hwcalls.c
002650   c068     MOVFF     0x68,0xfe6     	SendDataToShiftReg(LedStates);                                                  C:\fw\midicontroller\x014\hwcalls.c
002652   ffe6                                                                                                               
002654   df2a     RCALL     0x24aa                                                                                          
002656   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002658   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\hwcalls.c
                                           /* Set currently active program foot-switch's LED indicator and disable all others */ C:\fw\midicontroller\x014\hwcalls.c
00265a   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_set_active(int idx){                                                C:\fw\midicontroller\x014\hwcalls.c
00265c   ffe6                                                                                                               
00265e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002660   ffd9                                                                                                               
002662   0100     MOVLB     0x0            	LedStates = 0;                                                                  C:\fw\midicontroller\x014\hwcalls.c
002664   6b68     CLRF      0x68,0x1                                                                                        
002666   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          C:\fw\midicontroller\x014\hwcalls.c
002668   6ef3     MOVWF     0xf3,0x0                                                                                        
00266a   0efd     MOVLW     0xfd                                                                                            
00266c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00266e   e004     BZ        0x2678                                                                                          
002670   90d8     BCF       0xd8,0x0,0x0                                                                                    
002672   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002674   06e8     DECF      0xe8,0x1,0x0                                                                                    
002676   e1fc     BNZ       0x2670                                                                                          
002678   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00267a   0100     MOVLB     0x0                                                                                             
00267c   1368     IORWF     0x68,0x1,0x1                                                                                    
00267e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002680   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002682   ffd9                                                                                                               
002684   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Explicitly enable a single LED without affecting the others */                C:\fw\midicontroller\x014\hwcalls.c
002686   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_enable(int idx){                                                    C:\fw\midicontroller\x014\hwcalls.c
002688   ffe6                                                                                                               
00268a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00268c   ffd9                                                                                                               
00268e   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          C:\fw\midicontroller\x014\hwcalls.c
002690   6ef3     MOVWF     0xf3,0x0                                                                                        
002692   0efd     MOVLW     0xfd                                                                                            
002694   50db     MOVF      0xdb,0x0,0x0                                                                                    
002696   e004     BZ        0x26a0                                                                                          
002698   90d8     BCF       0xd8,0x0,0x0                                                                                    
00269a   36f3     RLCF      0xf3,0x1,0x0                                                                                    
00269c   06e8     DECF      0xe8,0x1,0x0                                                                                    
00269e   e1fc     BNZ       0x2698                                                                                          
0026a0   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0026a2   0100     MOVLB     0x0                                                                                             
0026a4   1368     IORWF     0x68,0x1,0x1                                                                                    
0026a6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
0026a8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0026aa   ffd9                                                                                                               
0026ac   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Explicitly disable a single LED without affecting the others */               C:\fw\midicontroller\x014\hwcalls.c
0026ae   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_disable(int idx){                                                   C:\fw\midicontroller\x014\hwcalls.c
0026b0   ffe6                                                                                                               
0026b2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0026b4   ffd9                                                                                                               
0026b6   0e01     MOVLW     0x1            	clrbit(LedStates,idx);                                                          C:\fw\midicontroller\x014\hwcalls.c
0026b8   6ef3     MOVWF     0xf3,0x0                                                                                        
0026ba   0efd     MOVLW     0xfd                                                                                            
0026bc   50db     MOVF      0xdb,0x0,0x0                                                                                    
0026be   e004     BZ        0x26c8                                                                                          
0026c0   90d8     BCF       0xd8,0x0,0x0                                                                                    
0026c2   36f3     RLCF      0xf3,0x1,0x0                                                                                    
0026c4   06e8     DECF      0xe8,0x1,0x0                                                                                    
0026c6   e1fc     BNZ       0x26c0                                                                                          
0026c8   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0026ca   6e10     MOVWF     0x10,0x0                                                                                        
0026cc   6a11     CLRF      0x11,0x0                                                                                        
0026ce   be10     BTFSC     0x10,0x7,0x0                                                                                    
0026d0   6811     SETF      0x11,0x0                                                                                        
0026d2   0eff     MOVLW     0xff                                                                                            
0026d4   1810     XORWF     0x10,0x0,0x0                                                                                    
0026d6   0100     MOVLB     0x0                                                                                             
0026d8   1768     ANDWF     0x68,0x1,0x1                                                                                    
0026da   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
0026dc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0026de   ffd9                                                                                                               
0026e0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Poll the slider switch to see which mode we're in: */                         C:\fw\midicontroller\x014\hwcalls.c
                                           u8 slider_poll(){                                                                C:\fw\midicontroller\x014\hwcalls.c
0026e2   0100     MOVLB     0x0            	return	ModeSwitchState;                                                         C:\fw\midicontroller\x014\hwcalls.c
0026e4   5161     MOVF      0x61,0x0,0x1                                                                                    
0026e6   0b01     ANDLW     0x1                                                                                             
0026e8   d000     BRA       0x26ea                                                                                          
0026ea   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Poll the expression pedal's data (0-127): */                                  C:\fw\midicontroller\x014\hwcalls.c
                                           u8 expr_poll(){                                                                  C:\fw\midicontroller\x014\hwcalls.c
                                           	                                                                                C:\fw\midicontroller\x014\hwcalls.c
0026ec   0e01     MOVLW     0x1            	ADC_CONVERSION(EXP_PEDAL_CHANNEL);                                              C:\fw\midicontroller\x014\hwcalls.c
0026ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0026f0   deb3     RCALL     0x2458                                                                                          
0026f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0026f4   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* --------------- Data persistence functions: */                                C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Gets number of stored banks */                                                C:\fw\midicontroller\x014\hwcalls.c
                                           u16 banks_count(){                                                               C:\fw\midicontroller\x014\hwcalls.c
0026f6   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Loads a bank into the specified arrays: */                                    C:\fw\midicontroller\x014\hwcalls.c
0026f8   cfd9     MOVFF     0xfd9,0xfe6    void bank_load(u16 bank_index, char name[BANK_NAME_MAXLENGTH], u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 *bankmap_count){ C:\fw\midicontroller\x014\hwcalls.c
0026fa   ffe6                                                                                                               
0026fc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0026fe   ffd9                                                                                                               
002700   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002702   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002704   ffd9                                                                                                               
002706   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Stores the programs back to the bank: */                                      C:\fw\midicontroller\x014\hwcalls.c
002708   cfd9     MOVFF     0xfd9,0xfe6    void bank_store(u16 bank_index, u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 bankmap_count){ C:\fw\midicontroller\x014\hwcalls.c
00270a   ffe6                                                                                                               
00270c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00270e   ffd9                                                                                                               
002710   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002712   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002714   ffd9                                                                                                               
002716   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Load bank name for browsing through banks: */                                 C:\fw\midicontroller\x014\hwcalls.c
002718   cfd9     MOVFF     0xfd9,0xfe6    void bank_loadname(u16 bank_index, char name[BANK_NAME_MAXLENGTH]){              C:\fw\midicontroller\x014\hwcalls.c
00271a   ffe6                                                                                                               
00271c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00271e   ffd9                                                                                                               
002720   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002722   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002724   ffd9                                                                                                               
002726   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Get the alphabetically sorted bank index */                                   C:\fw\midicontroller\x014\hwcalls.c
002728   cfd9     MOVFF     0xfd9,0xfe6    u16 bank_getsortedindex(u16 sort_index){                                         C:\fw\midicontroller\x014\hwcalls.c
00272a   ffe6                                                                                                               
00272c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00272e   ffd9                                                                                                               
002730   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002732   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002734   ffd9                                                                                                               
002736   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* --------------- MIDI I/O functions: */                                        C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /* Send formatted MIDI commands.                                                 C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                               0 <= cmd <= F       - MIDI command                                           C:\fw\midicontroller\x014\hwcalls.c
                                               0 <= channel <= F   - MIDI channel to send command to                        C:\fw\midicontroller\x014\hwcalls.c
                                               00 <= data1 <= FF   - first data byte of MIDI command                        C:\fw\midicontroller\x014\hwcalls.c
                                               00 <= data2 <= FF   - second (optional) data byte of MIDI command            C:\fw\midicontroller\x014\hwcalls.c
                                           */                                                                               C:\fw\midicontroller\x014\hwcalls.c
002738   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd1(u8 cmd, u8 channel, u8 data1){                               C:\fw\midicontroller\x014\hwcalls.c
00273a   ffe6                                                                                                               
00273c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00273e   ffd9                                                                                                               
002740   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002742   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002744   ffd9                                                                                                               
002746   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
002748   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd2(u8 cmd, u8 channel, u8 data1, u8 data2){                     C:\fw\midicontroller\x014\hwcalls.c
00274a   ffe6                                                                                                               
00274c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00274e   ffd9                                                                                                               
002750   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\hwcalls.c
002752   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002754   ffd9                                                                                                               
002756   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x014\hwcalls.c
                                           /*                                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	A programmable MIDI foot controller.                                            C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	Written by James S. Dunne                                                       C:\fw\midicontroller\x014\controller.c
                                           	04/05/2007                                                                      C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	Possible hardware layout diagram:                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	(o)     = SPST rugged foot-switch                                               C:\fw\midicontroller\x014\controller.c
                                           	(*)     = Single on/off LED                                                     C:\fw\midicontroller\x014\controller.c
                                           	[ ... ] = LED 7-segment (or more) display                                       C:\fw\midicontroller\x014\controller.c
                                           	{\}		= slider switch                                                            C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                            PWR  MIDI OUT EXPR IN (opt)                                                     C:\fw\midicontroller\x014\controller.c
                                             |      ||      ||                                                              C:\fw\midicontroller\x014\controller.c
                                           /--------------------\                                                           C:\fw\midicontroller\x014\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x014\controller.c
                                           | [8 8 8 8] {\}  [8] |                                                           C:\fw\midicontroller\x014\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x014\controller.c
                                           | (*)  (*)  (*)  (*) |                                                           C:\fw\midicontroller\x014\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           C:\fw\midicontroller\x014\controller.c
                                           |  1    2    3    4  |                                                           C:\fw\midicontroller\x014\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x014\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           C:\fw\midicontroller\x014\controller.c
                                           | DEC  INC  ENTR NEXT|                                                           C:\fw\midicontroller\x014\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x014\controller.c
                                           \--------------------/                                                           C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           NOTE:   CONCERT mode: Implement hold-down of preset button to                    C:\fw\midicontroller\x014\controller.c
                                           quick-switch to said preset, but on release switch back to last                  C:\fw\midicontroller\x014\controller.c
                                           preset.                                                                          C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           */                                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           #include "types.h"                                                               C:\fw\midicontroller\x014\controller.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           const u8 midi_channel = 0;                                                       C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           u8      bank[BANK_PRESET_COUNT];                                                 C:\fw\midicontroller\x014\controller.c
                                           u8		bankcontroller[BANK_PRESET_COUNT];                                           C:\fw\midicontroller\x014\controller.c
                                           u8		bankmap[BANK_MAP_COUNT];                                                     C:\fw\midicontroller\x014\controller.c
                                           u8		bankmap_count;                                                               C:\fw\midicontroller\x014\controller.c
                                           char	bankname[BANK_NAME_MAXLENGTH];                                              C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* current settings */                                                           C:\fw\midicontroller\x014\controller.c
                                           u8      curr_program;                                                            C:\fw\midicontroller\x014\controller.c
                                           u8      curr_preset;                                                             C:\fw\midicontroller\x014\controller.c
                                           u8      curr_mapindex;                                                           C:\fw\midicontroller\x014\controller.c
                                           u16     curr_bank, loaded_bank;                                                  C:\fw\midicontroller\x014\controller.c
                                           u16		curr_sortedbank;                                                            C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           u16		bank_count;                                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           u32		preset_held = 0;                                                            C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* decrement timer in ms: */                                                     C:\fw\midicontroller\x014\controller.c
                                           u16		accel_time;                                                                 C:\fw\midicontroller\x014\controller.c
                                           u8		accel_count;                                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           u16		cdtimer_value = 0;                                                          C:\fw\midicontroller\x014\controller.c
                                           u16		cdtimer_flash = 0;                                                          C:\fw\midicontroller\x014\controller.c
                                           u16		cdtimer_store = 0;                                                          C:\fw\midicontroller\x014\controller.c
                                           u16		cdtimer_incdec_held = 0;                                                    C:\fw\midicontroller\x014\controller.c
                                           u16		cdtimer_holdenter = 0;                                                      C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           enum acceleration_state {                                                        C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_NONE,                                                                     C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_INC_SLOW,                                                                 C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_INC_MEDIUM,                                                               C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_INC_FAST,                                                                 C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_DEC_SLOW,                                                                 C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_DEC_MEDIUM,                                                               C:\fw\midicontroller\x014\controller.c
                                           	ACCEL_DEC_FAST                                                                  C:\fw\midicontroller\x014\controller.c
                                           } accel_state = ACCEL_NONE;                                                      C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           enum flashing_led_state {                                                        C:\fw\midicontroller\x014\controller.c
                                           	FLASH_NONE,                                                                     C:\fw\midicontroller\x014\controller.c
                                           	FLASH_STORE,                                                                    C:\fw\midicontroller\x014\controller.c
                                           	FLASH_BANK_SELECT_MODE,                                                         C:\fw\midicontroller\x014\controller.c
                                           	FLASH_PRGM_SELECT_MODE                                                          C:\fw\midicontroller\x014\controller.c
                                           } flash_state = FLASH_NONE;                                                      C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           enum program_modes {                                                             C:\fw\midicontroller\x014\controller.c
                                           	PROGRAM_NONE,                                                                   C:\fw\midicontroller\x014\controller.c
                                           	PROGRAM_SEQUENCE,                                                               C:\fw\midicontroller\x014\controller.c
                                           	PROGRAM_COMPLETE                                                                C:\fw\midicontroller\x014\controller.c
                                           } program_mode = PROGRAM_NONE;                                                   C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           u8		flash_led = 0;                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* time period in ms before value is changed */                                  C:\fw\midicontroller\x014\controller.c
                                           const u16 accel_time_slow	= 15;                                                  C:\fw\midicontroller\x014\controller.c
                                           const u16 accel_time_medium	=  5;                                                C:\fw\midicontroller\x014\controller.c
                                           const u16 accel_time_fast	=  2;                                                  C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           const u16 value_flashtime	= 75;                                                  C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* concert/practice main mode switch */                                          C:\fw\midicontroller\x014\controller.c
                                           enum mainmode {                                                                  C:\fw\midicontroller\x014\controller.c
                                           	MODE_PRACTICE = 0,                                                              C:\fw\midicontroller\x014\controller.c
                                           	MODE_CONCERT = 1                                                                C:\fw\midicontroller\x014\controller.c
                                           } mode;                                                                          C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* convert integer to ASCII in fixed number of chars, right-aligned */           C:\fw\midicontroller\x014\controller.c
000abe   cfd9     MOVFF     0xfd9,0xfe6    void itoa_fixed(u8 n, char s[LEDS_MAX_ALPHAS]) {                                 C:\fw\midicontroller\x014\controller.c
000ac0   ffe6                                                                                                               
000ac2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ac4   ffd9                                                                                                               
000ac6   52e6     MOVF      0xe6,0x1,0x0                                                                                    
000ac8   0e03     MOVLW     0x3            	u8 i = LEDS_MAX_ALPHAS - 1;                                                     C:\fw\midicontroller\x014\controller.c
000aca   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	do {                                                                            C:\fw\midicontroller\x014\controller.c
000acc   0e0a     MOVLW     0xa            		s[i--] = (n%10) + '0';                                                         C:\fw\midicontroller\x014\controller.c
000ace   6e10     MOVWF     0x10,0x0                                                                                        
000ad0   c010     MOVFF     0x10,0xc                                                                                        
000ad2   f00c                                                                                                               
000ad4   0efe     MOVLW     0xfe                                                                                            
000ad6   cfdb     MOVFF     0xfdb,0x7                                                                                       
000ad8   f007                                                                                                               
000ada   ec2e     CALL      0x345c,0x0                                                                                      
000adc   f01a                                                                                                               
000ade   5003     MOVF      0x3,0x0,0x0                                                                                     
000ae0   0f30     ADDLW     0x30                                                                                            
000ae2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ae4   50df     MOVF      0xdf,0x0,0x0                                                                                    
000ae6   06df     DECF      0xdf,0x1,0x0                                                                                    
000ae8   6ee7     MOVWF     0xe7,0x0                                                                                        
000aea   0efc     MOVLW     0xfc                                                                                            
000aec   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000aee   ffe9                                                                                                               
000af0   0efd     MOVLW     0xfd                                                                                            
000af2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000af4   ffea                                                                                                               
000af6   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000af8   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000afa   0e00     MOVLW     0x0                                                                                             
000afc   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000afe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b00   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b02   6eef     MOVWF     0xef,0x0                                                                                        
000b04   0e0a     MOVLW     0xa            	} while ((n /= 10) > 0);                                                        C:\fw\midicontroller\x014\controller.c
000b06   6e10     MOVWF     0x10,0x0                                                                                        
000b08   c010     MOVFF     0x10,0xc                                                                                        
000b0a   f00c                                                                                                               
000b0c   0efe     MOVLW     0xfe                                                                                            
000b0e   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b10   f007                                                                                                               
000b12   ec2e     CALL      0x345c,0x0                                                                                      
000b14   f01a                                                                                                               
000b16   0efe     MOVLW     0xfe                                                                                            
000b18   c007     MOVFF     0x7,0xfdb                                                                                       
000b1a   ffdb                                                                                                               
000b1c   5007     MOVF      0x7,0x0,0x0                                                                                     
000b1e   0800     SUBLW     0x0                                                                                             
000b20   e3d5     BNC       0xacc                                                                                           
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* pad the left chars with spaces: */                                           C:\fw\midicontroller\x014\controller.c
000b22   50df     MOVF      0xdf,0x0,0x0   	for (;i > 0;--i) s[i] = ' ';                                                    C:\fw\midicontroller\x014\controller.c
000b24   0800     SUBLW     0x0                                                                                             
000b26   e210     BC        0xb48                                                                                           
000b28   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b2a   6ee7     MOVWF     0xe7,0x0                                                                                        
000b2c   0efc     MOVLW     0xfc                                                                                            
000b2e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b30   ffe9                                                                                                               
000b32   0efd     MOVLW     0xfd                                                                                            
000b34   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b36   ffea                                                                                                               
000b38   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b3a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b3c   0e00     MOVLW     0x0                                                                                             
000b3e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000b40   0e20     MOVLW     0x20                                                                                            
000b42   6eef     MOVWF     0xef,0x0                                                                                        
000b44   06df     DECF      0xdf,0x1,0x0                                                                                    
000b46   d7ed     BRA       0xb22                                                                                           
000b48   50df     MOVF      0xdf,0x0,0x0   	s[i] = ' ';                                                                     C:\fw\midicontroller\x014\controller.c
000b4a   6ee7     MOVWF     0xe7,0x0                                                                                        
000b4c   0efc     MOVLW     0xfc                                                                                            
000b4e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b50   ffe9                                                                                                               
000b52   0efd     MOVLW     0xfd                                                                                            
000b54   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b56   ffea                                                                                                               
000b58   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b5a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b5c   0e00     MOVLW     0x0                                                                                             
000b5e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000b60   0e20     MOVLW     0x20                                                                                            
000b62   6eef     MOVWF     0xef,0x0                                                                                        
000b64   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000b66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b68   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000b6a   ffd9                                                                                                               
000b6c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* display a program value in decimal with a leading 'P': */                     C:\fw\midicontroller\x014\controller.c
000b6e   cfd9     MOVFF     0xfd9,0xfe6    void show_program() {                                                            C:\fw\midicontroller\x014\controller.c
000b70   ffe6                                                                                                               
000b72   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000b74   ffd9                                                                                                               
000b76   0e04     MOVLW     0x4                                                                                             
000b78   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	char	a[LEDS_MAX_ALPHAS];                                                        C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* convert curr_program to ASCII: */                                            C:\fw\midicontroller\x014\controller.c
000b7a   cfd9     MOVFF     0xfd9,0xfe6    	itoa_fixed(curr_program + 1, a);                                                C:\fw\midicontroller\x014\controller.c
000b7c   ffe6                                                                                                               
000b7e   cfda     MOVFF     0xfda,0xfe6                                                                                     
000b80   ffe6                                                                                                               
000b82   0100     MOVLB     0x0                                                                                             
000b84   29f0     INCF      0xf0,0x0,0x1                                                                                    
000b86   6ee6     MOVWF     0xe6,0x0                                                                                        
000b88   df9a     RCALL     0xabe                                                                                           
000b8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b8c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b8e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* leading 'P' char: */                                                         C:\fw\midicontroller\x014\controller.c
000b90   0e50     MOVLW     0x50           	a[0] = 'P';                                                                     C:\fw\midicontroller\x014\controller.c
000b92   6edf     MOVWF     0xdf,0x0                                                                                        
000b94   cfd9     MOVFF     0xfd9,0xfe6    	leds_show_4alphas(a);                                                           C:\fw\midicontroller\x014\controller.c
000b96   ffe6                                                                                                               
000b98   cfda     MOVFF     0xfda,0xfe6                                                                                     
000b9a   ffe6                                                                                                               
000b9c   ec7d     CALL      0x28fa,0x0                                                                                      
000b9e   f014                                                                                                               
000ba0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ba2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* start timer to revert the display: */                                        C:\fw\midicontroller\x014\controller.c
000ba4   c117     MOVFF     0x117,0x103    	cdtimer_value = value_flashtime;                                                C:\fw\midicontroller\x014\controller.c
000ba6   f103                                                                                                               
000ba8   c118     MOVFF     0x118,0x104                                                                                     
000baa   f104                                                                                                               
000bac   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x014\controller.c
000bae   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000bb0   e202     BC        0xbb6                                                                                           
000bb2   6ae1     CLRF      0xe1,0x0                                                                                        
000bb4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bb6   6ee1     MOVWF     0xe1,0x0                                                                                        
000bb8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bba   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000bbc   ffd9                                                                                                               
000bbe   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* send the MIDI program change message */                                       C:\fw\midicontroller\x014\controller.c
000bc0   cfd9     MOVFF     0xfd9,0xfe6    void program_activate(u8 notify) {                                               C:\fw\midicontroller\x014\controller.c
000bc2   ffe6                                                                                                               
000bc4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bc6   ffd9                                                                                                               
000bc8   c0f0     MOVFF     0xf0,0xfe6     	midi_send_cmd1(0xC, midi_channel, curr_program);                                C:\fw\midicontroller\x014\controller.c
000bca   ffe6                                                                                                               
000bcc   c100     MOVFF     0x100,0xfe6                                                                                     
000bce   ffe6                                                                                                               
000bd0   0e0c     MOVLW     0xc                                                                                             
000bd2   6ee6     MOVWF     0xe6,0x0                                                                                        
000bd4   ec9c     CALL      0x2738,0x0                                                                                      
000bd6   f013                                                                                                               
000bd8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bda   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bdc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bde   0efe     MOVLW     0xfe           	if (notify) {                                                                   C:\fw\midicontroller\x014\controller.c
000be0   50db     MOVF      0xdb,0x0,0x0                                                                                    
000be2   e001     BZ        0xbe6                                                                                           
                                           		/* show the program value: */                                                  C:\fw\midicontroller\x014\controller.c
000be4   dfc4     RCALL     0xb6e          		show_program();                                                                C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
000be6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000be8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000bea   ffd9                                                                                                               
000bec   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* activate current preset */                                                    C:\fw\midicontroller\x014\controller.c
000bee   cfd9     MOVFF     0xfd9,0xfe6    void preset_activate(u8 notify) {                                                C:\fw\midicontroller\x014\controller.c
000bf0   ffe6                                                                                                               
000bf2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bf4   ffd9                                                                                                               
                                           	/* grab the program # from the bank */                                          C:\fw\midicontroller\x014\controller.c
000bf6   0100     MOVLB     0x0            	curr_program = bank[curr_preset];                                               C:\fw\midicontroller\x014\controller.c
000bf8   51f1     MOVF      0xf1,0x0,0x1                                                                                    
000bfa   6aea     CLRF      0xea,0x0                                                                                        
000bfc   0fdb     ADDLW     0xdb                                                                                            
000bfe   6ee9     MOVWF     0xe9,0x0                                                                                        
000c00   0e00     MOVLW     0x0                                                                                             
000c02   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c04   cfef     MOVFF     0xfef,0xf0                                                                                      
000c06   f0f0                                                                                                               
000c08   0efe     MOVLW     0xfe           	program_activate(notify);                                                       C:\fw\midicontroller\x014\controller.c
000c0a   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000c0c   ffe6                                                                                                               
000c0e   dfd8     RCALL     0xbc0                                                                                           
000c10   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* activate the footswitch LED: */                                              C:\fw\midicontroller\x014\controller.c
000c12   0100     MOVLB     0x0            	fsw_led_set_active(curr_preset);                                                C:\fw\midicontroller\x014\controller.c
000c14   51f1     MOVF      0xf1,0x0,0x1                                                                                    
000c16   6ee6     MOVWF     0xe6,0x0                                                                                        
000c18   6ae6     CLRF      0xe6,0x0                                                                                        
000c1a   ec2d     CALL      0x265a,0x0                                                                                      
000c1c   f013                                                                                                               
000c1e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c20   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c22   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000c24   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c26   ffd9                                                                                                               
000c28   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* display the sequence index on the 1-digit LED display: */                     C:\fw\midicontroller\x014\controller.c
                                           void bankmap_show() {                                                            C:\fw\midicontroller\x014\controller.c
000c2a   0100     MOVLB     0x0            	leds_show_1digit(curr_mapindex + 1);                                            C:\fw\midicontroller\x014\controller.c
000c2c   29f2     INCF      0xf2,0x0,0x1                                                                                    
000c2e   6ee6     MOVWF     0xe6,0x0                                                                                        
000c30   ecb8     CALL      0x2970,0x0                                                                                      
000c32   f014                                                                                                               
000c34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c36   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* activate the preset for the current bank map index */                         C:\fw\midicontroller\x014\controller.c
000c38   cfd9     MOVFF     0xfd9,0xfe6    void bankmap_activate(u8 notify) {                                               C:\fw\midicontroller\x014\controller.c
000c3a   ffe6                                                                                                               
000c3c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c3e   ffd9                                                                                                               
                                           	/* switch preset */                                                             C:\fw\midicontroller\x014\controller.c
000c40   c0f3     MOVFF     0xf3,0xf5      	loaded_bank = curr_bank;                                                        C:\fw\midicontroller\x014\controller.c
000c42   f0f5                                                                                                               
000c44   c0f4     MOVFF     0xf4,0xf6                                                                                       
000c46   f0f6                                                                                                               
000c48   0100     MOVLB     0x0            	curr_preset = bankmap[curr_mapindex];                                           C:\fw\midicontroller\x014\controller.c
000c4a   51f2     MOVF      0xf2,0x0,0x1                                                                                    
000c4c   6aea     CLRF      0xea,0x0                                                                                        
000c4e   0fe3     ADDLW     0xe3                                                                                            
000c50   6ee9     MOVWF     0xe9,0x0                                                                                        
000c52   0e00     MOVLW     0x0                                                                                             
000c54   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c56   cfef     MOVFF     0xfef,0xf1                                                                                      
000c58   f0f1                                                                                                               
000c5a   0efe     MOVLW     0xfe           	preset_activate(notify);                                                        C:\fw\midicontroller\x014\controller.c
000c5c   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000c5e   ffe6                                                                                                               
000c60   dfc6     RCALL     0xbee                                                                                           
000c62   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* always show the bank map index */                                            C:\fw\midicontroller\x014\controller.c
000c64   dfe2     RCALL     0xc2a          	bankmap_show();                                                                 C:\fw\midicontroller\x014\controller.c
000c66   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000c68   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c6a   ffd9                                                                                                               
000c6c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* load current bank but do not switch to a preset */                            C:\fw\midicontroller\x014\controller.c
000c6e   cfd9     MOVFF     0xfd9,0xfe6    void bank_activate(u8 notify) {                                                  C:\fw\midicontroller\x014\controller.c
000c70   ffe6                                                                                                               
000c72   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c74   ffd9                                                                                                               
                                           	/* load up the selected bank: */                                                C:\fw\midicontroller\x014\controller.c
000c76   0eeb     MOVLW     0xeb           	bank_load(curr_bank, bankname, bank, bankcontroller, bankmap, &bankmap_count);  C:\fw\midicontroller\x014\controller.c
000c78   6ee6     MOVWF     0xe6,0x0                                                                                        
000c7a   0e00     MOVLW     0x0                                                                                             
000c7c   6ee6     MOVWF     0xe6,0x0                                                                                        
000c7e   0ee3     MOVLW     0xe3                                                                                            
000c80   6ee6     MOVWF     0xe6,0x0                                                                                        
000c82   0e00     MOVLW     0x0                                                                                             
000c84   6ee6     MOVWF     0xe6,0x0                                                                                        
000c86   0edf     MOVLW     0xdf                                                                                            
000c88   6ee6     MOVWF     0xe6,0x0                                                                                        
000c8a   0e00     MOVLW     0x0                                                                                             
000c8c   6ee6     MOVWF     0xe6,0x0                                                                                        
000c8e   0edb     MOVLW     0xdb                                                                                            
000c90   6ee6     MOVWF     0xe6,0x0                                                                                        
000c92   0e00     MOVLW     0x0                                                                                             
000c94   6ee6     MOVWF     0xe6,0x0                                                                                        
000c96   0eec     MOVLW     0xec                                                                                            
000c98   6ee6     MOVWF     0xe6,0x0                                                                                        
000c9a   0e00     MOVLW     0x0                                                                                             
000c9c   6ee6     MOVWF     0xe6,0x0                                                                                        
000c9e   c0f3     MOVFF     0xf3,0xfe6                                                                                      
000ca0   ffe6                                                                                                               
000ca2   c0f4     MOVFF     0xf4,0xfe6                                                                                      
000ca4   ffe6                                                                                                               
000ca6   ec7c     CALL      0x26f8,0x0                                                                                      
000ca8   f013                                                                                                               
000caa   6e10     MOVWF     0x10,0x0                                                                                        
000cac   0e0c     MOVLW     0xc                                                                                             
000cae   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000cb0   5010     MOVF      0x10,0x0,0x0                                                                                    
000cb2   0100     MOVLB     0x0            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x014\controller.c
000cb4   6bf2     CLRF      0xf2,0x1                                                                                        
                                           	/* always show the bank map index */                                            C:\fw\midicontroller\x014\controller.c
000cb6   29f2     INCF      0xf2,0x0,0x1   	leds_show_1digit(curr_mapindex + 1);                                            C:\fw\midicontroller\x014\controller.c
000cb8   6ee6     MOVWF     0xe6,0x0                                                                                        
000cba   ecb8     CALL      0x2970,0x0                                                                                      
000cbc   f014                                                                                                               
000cbe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000cc0   0efe     MOVLW     0xfe           	if (notify) {                                                                   C:\fw\midicontroller\x014\controller.c
000cc2   50db     MOVF      0xdb,0x0,0x0                                                                                    
000cc4   e008     BZ        0xcd6                                                                                           
                                           		/* display bank name: */                                                       C:\fw\midicontroller\x014\controller.c
000cc6   0eec     MOVLW     0xec           		leds_show_4alphas(bankname);                                                   C:\fw\midicontroller\x014\controller.c
000cc8   6ee6     MOVWF     0xe6,0x0                                                                                        
000cca   0e00     MOVLW     0x0                                                                                             
000ccc   6ee6     MOVWF     0xe6,0x0                                                                                        
000cce   ec7d     CALL      0x28fa,0x0                                                                                      
000cd0   f014                                                                                                               
000cd2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000cd4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
000cd6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000cd8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000cda   ffd9                                                                                                               
000cdc   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* load the real bank # from the sorted index */                                 C:\fw\midicontroller\x014\controller.c
000cde   cfd9     MOVFF     0xfd9,0xfe6    void sortedbank_activate(u8 notify) {                                            C:\fw\midicontroller\x014\controller.c
000ce0   ffe6                                                                                                               
000ce2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ce4   ffd9                                                                                                               
000ce6   c0f7     MOVFF     0xf7,0xfe6     	curr_bank = bank_getsortedindex(curr_sortedbank);                               C:\fw\midicontroller\x014\controller.c
000ce8   ffe6                                                                                                               
000cea   c0f8     MOVFF     0xf8,0xfe6                                                                                      
000cec   ffe6                                                                                                               
000cee   ec94     CALL      0x2728,0x0                                                                                      
000cf0   f013                                                                                                               
000cf2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000cf4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000cf6   cff3     MOVFF     0xff3,0xf3                                                                                      
000cf8   f0f3                                                                                                               
000cfa   cff4     MOVFF     0xff4,0xf4                                                                                      
000cfc   f0f4                                                                                                               
000cfe   0efe     MOVLW     0xfe           	bank_activate(notify);                                                          C:\fw\midicontroller\x014\controller.c
000d00   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000d02   ffe6                                                                                                               
000d04   dfb4     RCALL     0xc6e                                                                                           
000d06   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d08   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000d0a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d0c   ffd9                                                                                                               
000d0e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* load only current bank name and display it on 4-digit display */              C:\fw\midicontroller\x014\controller.c
                                           void bank_showname() {                                                           C:\fw\midicontroller\x014\controller.c
000d10   0eec     MOVLW     0xec           	bank_loadname(curr_bank, bankname);                                             C:\fw\midicontroller\x014\controller.c
000d12   6ee6     MOVWF     0xe6,0x0                                                                                        
000d14   0e00     MOVLW     0x0                                                                                             
000d16   6ee6     MOVWF     0xe6,0x0                                                                                        
000d18   c0f3     MOVFF     0xf3,0xfe6                                                                                      
000d1a   ffe6                                                                                                               
000d1c   c0f4     MOVFF     0xf4,0xfe6                                                                                      
000d1e   ffe6                                                                                                               
000d20   ec8c     CALL      0x2718,0x0                                                                                      
000d22   f013                                                                                                               
000d24   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d28   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d2a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d2c   0eec     MOVLW     0xec           	leds_show_4alphas(bankname);                                                    C:\fw\midicontroller\x014\controller.c
000d2e   6ee6     MOVWF     0xe6,0x0                                                                                        
000d30   0e00     MOVLW     0x0                                                                                             
000d32   6ee6     MOVWF     0xe6,0x0                                                                                        
000d34   ec7d     CALL      0x28fa,0x0                                                                                      
000d36   f014                                                                                                               
000d38   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d3a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d3c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* load only current bank name from the sorted index and display it on 4-digit display */ C:\fw\midicontroller\x014\controller.c
                                           void sortedbank_showname() {                                                     C:\fw\midicontroller\x014\controller.c
000d3e   0101     MOVLB     0x1            	if (program_mode != PROGRAM_NONE) {                                             C:\fw\midicontroller\x014\controller.c
000d40   510f     MOVF      0xf,0x0,0x1                                                                                     
000d42   e009     BZ        0xd56                                                                                           
000d44   0e9a     MOVLW     0x9a           		leds_show_4alphas("SEQ-");                                                     C:\fw\midicontroller\x014\controller.c
000d46   6ee6     MOVWF     0xe6,0x0                                                                                        
000d48   0e34     MOVLW     0x34                                                                                            
000d4a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d4c   ec7d     CALL      0x28fa,0x0                                                                                      
000d4e   f014                                                                                                               
000d50   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d52   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d54   d022     BRA       0xd9a          	} else {                                                                        C:\fw\midicontroller\x014\controller.c
000d56   c0f7     MOVFF     0xf7,0xfe6     		curr_bank = bank_getsortedindex(curr_sortedbank);                              C:\fw\midicontroller\x014\controller.c
000d58   ffe6                                                                                                               
000d5a   c0f8     MOVFF     0xf8,0xfe6                                                                                      
000d5c   ffe6                                                                                                               
000d5e   ec94     CALL      0x2728,0x0                                                                                      
000d60   f013                                                                                                               
000d62   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d64   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d66   cff3     MOVFF     0xff3,0xf3                                                                                      
000d68   f0f3                                                                                                               
000d6a   cff4     MOVFF     0xff4,0xf4                                                                                      
000d6c   f0f4                                                                                                               
000d6e   0eec     MOVLW     0xec           		bank_loadname(curr_bank, bankname);                                            C:\fw\midicontroller\x014\controller.c
000d70   6ee6     MOVWF     0xe6,0x0                                                                                        
000d72   0e00     MOVLW     0x0                                                                                             
000d74   6ee6     MOVWF     0xe6,0x0                                                                                        
000d76   c0f3     MOVFF     0xf3,0xfe6                                                                                      
000d78   ffe6                                                                                                               
000d7a   c0f4     MOVFF     0xf4,0xfe6                                                                                      
000d7c   ffe6                                                                                                               
000d7e   ec8c     CALL      0x2718,0x0                                                                                      
000d80   f013                                                                                                               
000d82   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8a   0eec     MOVLW     0xec           		leds_show_4alphas(bankname);                                                   C:\fw\midicontroller\x014\controller.c
000d8c   6ee6     MOVWF     0xe6,0x0                                                                                        
000d8e   0e00     MOVLW     0x0                                                                                             
000d90   6ee6     MOVWF     0xe6,0x0                                                                                        
000d92   ec7d     CALL      0x28fa,0x0                                                                                      
000d94   f014                                                                                                               
000d96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d98   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
000d9a   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* current and previous foot-switch states: */                                   C:\fw\midicontroller\x014\controller.c
                                           u32		sw_curr = 0, sw_last = 0;                                                   C:\fw\midicontroller\x014\controller.c
                                           u8		cc_curr = 0, cc_last = 0;                                                    C:\fw\midicontroller\x014\controller.c
                                           u8		switch_state = 0, store_state = 0;                                           C:\fw\midicontroller\x014\controller.c
                                           u8		incdec_mode = 0;                                                             C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* determine if a footswitch was pressed: */                                     C:\fw\midicontroller\x014\controller.c
000d9c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_pressed(u32 mask) {                                                    C:\fw\midicontroller\x014\controller.c
000d9e   ffe6                                                                                                               
000da0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000da2   ffd9                                                                                                               
000da4   0efd     MOVLW     0xfd           	return ((sw_curr & mask) == mask) && ((sw_last & mask) == 0);                   C:\fw\midicontroller\x014\controller.c
000da6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000da8   0101     MOVLB     0x1                                                                                             
000daa   1519     ANDWF     0x19,0x0,0x1                                                                                    
000dac   0100     MOVLB     0x0                                                                                             
000dae   6e10     MOVWF     0x10,0x0                                                                                        
000db0   0efe     MOVLW     0xfe                                                                                            
000db2   50db     MOVF      0xdb,0x0,0x0                                                                                    
000db4   0101     MOVLB     0x1                                                                                             
000db6   151a     ANDWF     0x1a,0x0,0x1                                                                                    
000db8   0100     MOVLB     0x0                                                                                             
000dba   6e11     MOVWF     0x11,0x0                                                                                        
000dbc   0efd     MOVLW     0xfd                                                                                            
000dbe   50db     MOVF      0xdb,0x0,0x0                                                                                    
000dc0   1810     XORWF     0x10,0x0,0x0                                                                                    
000dc2   e103     BNZ       0xdca                                                                                           
000dc4   0efe     MOVLW     0xfe                                                                                            
000dc6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000dc8   1811     XORWF     0x11,0x0,0x0                                                                                    
000dca   e10f     BNZ       0xdea                                                                                           
000dcc   0efd     MOVLW     0xfd                                                                                            
000dce   50db     MOVF      0xdb,0x0,0x0                                                                                    
000dd0   0101     MOVLB     0x1                                                                                             
000dd2   151b     ANDWF     0x1b,0x0,0x1                                                                                    
000dd4   0100     MOVLB     0x0                                                                                             
000dd6   6e12     MOVWF     0x12,0x0                                                                                        
000dd8   0efe     MOVLW     0xfe                                                                                            
000dda   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ddc   0101     MOVLB     0x1                                                                                             
000dde   151c     ANDWF     0x1c,0x0,0x1                                                                                    
000de0   0100     MOVLB     0x0                                                                                             
000de2   6e13     MOVWF     0x13,0x0                                                                                        
000de4   5012     MOVF      0x12,0x0,0x0                                                                                    
000de6   1013     IORWF     0x13,0x0,0x0                                                                                    
000de8   e002     BZ        0xdee                                                                                           
000dea   0e00     MOVLW     0x0                                                                                             
000dec   d001     BRA       0xdf0                                                                                           
000dee   0e01     MOVLW     0x1                                                                                             
000df0   d000     BRA       0xdf2                                                                                           
000df2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000df4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000df6   ffd9                                                                                                               
000df8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* determine if still holding footswitch: */                                     C:\fw\midicontroller\x014\controller.c
000dfa   cfd9     MOVFF     0xfd9,0xfe6    u8 button_held(u32 mask) {                                                       C:\fw\midicontroller\x014\controller.c
000dfc   ffe6                                                                                                               
000dfe   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e00   ffd9                                                                                                               
000e02   0efd     MOVLW     0xfd           	return (sw_curr & mask) == mask;                                                C:\fw\midicontroller\x014\controller.c
000e04   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e06   0101     MOVLB     0x1                                                                                             
000e08   1519     ANDWF     0x19,0x0,0x1                                                                                    
000e0a   0100     MOVLB     0x0                                                                                             
000e0c   6e10     MOVWF     0x10,0x0                                                                                        
000e0e   0efe     MOVLW     0xfe                                                                                            
000e10   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e12   0101     MOVLB     0x1                                                                                             
000e14   151a     ANDWF     0x1a,0x0,0x1                                                                                    
000e16   0100     MOVLB     0x0                                                                                             
000e18   6e11     MOVWF     0x11,0x0                                                                                        
000e1a   0efd     MOVLW     0xfd                                                                                            
000e1c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e1e   1810     XORWF     0x10,0x0,0x0                                                                                    
000e20   e103     BNZ       0xe28                                                                                           
000e22   0efe     MOVLW     0xfe                                                                                            
000e24   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e26   1811     XORWF     0x11,0x0,0x0                                                                                    
000e28   e002     BZ        0xe2e                                                                                           
000e2a   0e00     MOVLW     0x0                                                                                             
000e2c   d001     BRA       0xe30                                                                                           
000e2e   0e01     MOVLW     0x1                                                                                             
000e30   d000     BRA       0xe32                                                                                           
000e32   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000e34   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e36   ffd9                                                                                                               
000e38   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* determine if a footswitch was released: */                                    C:\fw\midicontroller\x014\controller.c
000e3a   cfd9     MOVFF     0xfd9,0xfe6    u8 button_released(u32 mask) {                                                   C:\fw\midicontroller\x014\controller.c
000e3c   ffe6                                                                                                               
000e3e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e40   ffd9                                                                                                               
000e42   0efd     MOVLW     0xfd           	return ((sw_last & mask) == mask) && ((sw_curr & mask) == 0);                   C:\fw\midicontroller\x014\controller.c
000e44   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e46   0101     MOVLB     0x1                                                                                             
000e48   151b     ANDWF     0x1b,0x0,0x1                                                                                    
000e4a   0100     MOVLB     0x0                                                                                             
000e4c   6e10     MOVWF     0x10,0x0                                                                                        
000e4e   0efe     MOVLW     0xfe                                                                                            
000e50   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e52   0101     MOVLB     0x1                                                                                             
000e54   151c     ANDWF     0x1c,0x0,0x1                                                                                    
000e56   0100     MOVLB     0x0                                                                                             
000e58   6e11     MOVWF     0x11,0x0                                                                                        
000e5a   0efd     MOVLW     0xfd                                                                                            
000e5c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e5e   1810     XORWF     0x10,0x0,0x0                                                                                    
000e60   e103     BNZ       0xe68                                                                                           
000e62   0efe     MOVLW     0xfe                                                                                            
000e64   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e66   1811     XORWF     0x11,0x0,0x0                                                                                    
000e68   e10f     BNZ       0xe88                                                                                           
000e6a   0efd     MOVLW     0xfd                                                                                            
000e6c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e6e   0101     MOVLB     0x1                                                                                             
000e70   1519     ANDWF     0x19,0x0,0x1                                                                                    
000e72   0100     MOVLB     0x0                                                                                             
000e74   6e12     MOVWF     0x12,0x0                                                                                        
000e76   0efe     MOVLW     0xfe                                                                                            
000e78   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e7a   0101     MOVLB     0x1                                                                                             
000e7c   151a     ANDWF     0x1a,0x0,0x1                                                                                    
000e7e   0100     MOVLB     0x0                                                                                             
000e80   6e13     MOVWF     0x13,0x0                                                                                        
000e82   5012     MOVF      0x12,0x0,0x0                                                                                    
000e84   1013     IORWF     0x13,0x0,0x0                                                                                    
000e86   e002     BZ        0xe8c                                                                                           
000e88   0e00     MOVLW     0x0                                                                                             
000e8a   d001     BRA       0xe8e                                                                                           
000e8c   0e01     MOVLW     0x1                                                                                             
000e8e   d000     BRA       0xe90                                                                                           
000e90   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\controller.c
000e92   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e94   ffd9                                                                                                               
000e96   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* called every 10ms */                                                          C:\fw\midicontroller\x014\controller.c
                                           void controller_10msec_timer() {                                                 C:\fw\midicontroller\x014\controller.c
                                           	/* handle inc/dec acceleration: */                                              C:\fw\midicontroller\x014\controller.c
000e98   0101     MOVLB     0x1            	if (accel_state != ACCEL_NONE) {                                                C:\fw\midicontroller\x014\controller.c
000e9a   510d     MOVF      0xd,0x0,0x1                                                                                     
000e9c   e00a     BZ        0xeb2                                                                                           
000e9e   0100     MOVLB     0x0            		if (accel_time > 0) --accel_time;                                              C:\fw\midicontroller\x014\controller.c
000ea0   0e00     MOVLW     0x0                                                                                             
000ea2   80d8     BSF       0xd8,0x0,0x0                                                                                    
000ea4   55fb     SUBFWB    0xfb,0x0,0x1                                                                                    
000ea6   0e00     MOVLW     0x0                                                                                             
000ea8   55fc     SUBFWB    0xfc,0x0,0x1                                                                                    
000eaa   e203     BC        0xeb2                                                                                           
000eac   07fb     DECF      0xfb,0x1,0x1                                                                                    
000eae   0e00     MOVLW     0x0                                                                                             
000eb0   5bfc     SUBWFB    0xfc,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* handle simple count-down timers: */                                          C:\fw\midicontroller\x014\controller.c
000eb2   0101     MOVLB     0x1            	if (cdtimer_store > 0) --cdtimer_store;                                         C:\fw\midicontroller\x014\controller.c
000eb4   0e00     MOVLW     0x0                                                                                             
000eb6   80d8     BSF       0xd8,0x0,0x0                                                                                    
000eb8   5507     SUBFWB    0x7,0x0,0x1                                                                                     
000eba   0e00     MOVLW     0x0                                                                                             
000ebc   5508     SUBFWB    0x8,0x0,0x1                                                                                     
000ebe   e203     BC        0xec6                                                                                           
000ec0   0707     DECF      0x7,0x1,0x1                                                                                     
000ec2   0e00     MOVLW     0x0                                                                                             
000ec4   5b08     SUBWFB    0x8,0x1,0x1                                                                                     
000ec6   0e00     MOVLW     0x0            	if (cdtimer_incdec_held > 0) --cdtimer_incdec_held;                             C:\fw\midicontroller\x014\controller.c
000ec8   80d8     BSF       0xd8,0x0,0x0                                                                                    
000eca   5509     SUBFWB    0x9,0x0,0x1                                                                                     
000ecc   0e00     MOVLW     0x0                                                                                             
000ece   550a     SUBFWB    0xa,0x0,0x1                                                                                     
000ed0   e203     BC        0xed8                                                                                           
000ed2   0709     DECF      0x9,0x1,0x1                                                                                     
000ed4   0e00     MOVLW     0x0                                                                                             
000ed6   5b0a     SUBWFB    0xa,0x1,0x1                                                                                     
000ed8   0e00     MOVLW     0x0            	if (cdtimer_value > 0) {                                                        C:\fw\midicontroller\x014\controller.c
000eda   80d8     BSF       0xd8,0x0,0x0                                                                                    
000edc   5503     SUBFWB    0x3,0x0,0x1                                                                                     
000ede   0e00     MOVLW     0x0                                                                                             
000ee0   5504     SUBFWB    0x4,0x0,0x1                                                                                     
000ee2   e20c     BC        0xefc                                                                                           
000ee4   0703     DECF      0x3,0x1,0x1    		--cdtimer_value;                                                               C:\fw\midicontroller\x014\controller.c
000ee6   0e00     MOVLW     0x0                                                                                             
000ee8   5b04     SUBWFB    0x4,0x1,0x1                                                                                     
000eea   5103     MOVF      0x3,0x0,0x1    		if (cdtimer_value == 0) {                                                      C:\fw\midicontroller\x014\controller.c
000eec   1104     IORWF     0x4,0x0,0x1                                                                                     
000eee   e106     BNZ       0xefc                                                                                           
000ef0   0100     MOVLB     0x0            			if (mode == MODE_CONCERT) bank_showname();                                    C:\fw\midicontroller\x014\controller.c
000ef2   05fe     DECF      0xfe,0x0,0x1                                                                                    
000ef4   e102     BNZ       0xefa                                                                                           
000ef6   df0c     RCALL     0xd10                                                                                           
000ef8   d001     BRA       0xefc          			else sortedbank_showname();                                                   C:\fw\midicontroller\x014\controller.c
000efa   df21     RCALL     0xd3e                                                                                           
                                           		}                                                                              C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
000efc   0101     MOVLB     0x1            	if (cdtimer_holdenter > 0) --cdtimer_holdenter;                                 C:\fw\midicontroller\x014\controller.c
000efe   0e00     MOVLW     0x0                                                                                             
000f00   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f02   550b     SUBFWB    0xb,0x0,0x1                                                                                     
000f04   0e00     MOVLW     0x0                                                                                             
000f06   550c     SUBFWB    0xc,0x0,0x1                                                                                     
000f08   e203     BC        0xf10                                                                                           
000f0a   070b     DECF      0xb,0x1,0x1                                                                                     
000f0c   0e00     MOVLW     0x0                                                                                             
000f0e   5b0c     SUBWFB    0xc,0x1,0x1                                                                                     
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* handle LED flashing states: */                                               C:\fw\midicontroller\x014\controller.c
000f10   0e00     MOVLW     0x0            	if (cdtimer_flash > 0) {                                                        C:\fw\midicontroller\x014\controller.c
000f12   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f14   5505     SUBFWB    0x5,0x0,0x1                                                                                     
000f16   0e00     MOVLW     0x0                                                                                             
000f18   5506     SUBFWB    0x6,0x0,0x1                                                                                     
000f1a   e301     BNC       0xf1e                                                                                           
000f1c   d0bf     BRA       0x109c                                                                                          
000f1e   510e     MOVF      0xe,0x0,0x1    		switch (flash_state) {                                                         C:\fw\midicontroller\x014\controller.c
000f20   0a03     XORLW     0x3                                                                                             
000f22   e067     BZ        0xff2                                                                                           
000f24   0a01     XORLW     0x1                                                                                             
000f26   e01f     BZ        0xf66                                                                                           
000f28   0a03     XORLW     0x3                                                                                             
000f2a   e001     BZ        0xf2e                                                                                           
000f2c   d0a8     BRA       0x107e                                                                                          
                                           			case FLASH_STORE:                                                             C:\fw\midicontroller\x014\controller.c
000f2e   5105     MOVF      0x5,0x0,0x1    				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x014\controller.c
000f30   0b1f     ANDLW     0x1f                                                                                            
000f32   e108     BNZ       0xf44                                                                                           
000f34   5110     MOVF      0x10,0x0,0x1   					fsw_led_enable(flash_led);                                                  C:\fw\midicontroller\x014\controller.c
000f36   6ee6     MOVWF     0xe6,0x0                                                                                        
000f38   6ae6     CLRF      0xe6,0x0                                                                                        
000f3a   ec43     CALL      0x2686,0x0                                                                                      
000f3c   f013                                                                                                               
000f3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f40   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f42   d010     BRA       0xf64          				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x014\controller.c
000f44   0e1f     MOVLW     0x1f                                                                                            
000f46   1505     ANDWF     0x5,0x0,0x1                                                                                     
000f48   6e10     MOVWF     0x10,0x0                                                                                        
000f4a   6a11     CLRF      0x11,0x0                                                                                        
000f4c   0e0f     MOVLW     0xf                                                                                             
000f4e   1810     XORWF     0x10,0x0,0x0                                                                                    
000f50   e101     BNZ       0xf54                                                                                           
000f52   5011     MOVF      0x11,0x0,0x0                                                                                    
000f54   e107     BNZ       0xf64                                                                                           
000f56   5110     MOVF      0x10,0x0,0x1   					fsw_led_disable(flash_led);                                                 C:\fw\midicontroller\x014\controller.c
000f58   6ee6     MOVWF     0xe6,0x0                                                                                        
000f5a   6ae6     CLRF      0xe6,0x0                                                                                        
000f5c   ec57     CALL      0x26ae,0x0                                                                                      
000f5e   f013                                                                                                               
000f60   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f62   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x014\controller.c
000f64   d08c     BRA       0x107e         				break;                                                                       C:\fw\midicontroller\x014\controller.c
                                           			case FLASH_BANK_SELECT_MODE:                                                  C:\fw\midicontroller\x014\controller.c
000f66   5105     MOVF      0x5,0x0,0x1    				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x014\controller.c
000f68   0b1f     ANDLW     0x1f                                                                                            
000f6a   e11d     BNZ       0xfa6                                                                                           
000f6c   0e00     MOVLW     0x0            					fsw_led_enable(0);                                                          C:\fw\midicontroller\x014\controller.c
000f6e   6ee6     MOVWF     0xe6,0x0                                                                                        
000f70   6ae6     CLRF      0xe6,0x0                                                                                        
000f72   ec43     CALL      0x2686,0x0                                                                                      
000f74   f013                                                                                                               
000f76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f7a   0e01     MOVLW     0x1            					fsw_led_enable(1);                                                          C:\fw\midicontroller\x014\controller.c
000f7c   6ee6     MOVWF     0xe6,0x0                                                                                        
000f7e   6ae6     CLRF      0xe6,0x0                                                                                        
000f80   ec43     CALL      0x2686,0x0                                                                                      
000f82   f013                                                                                                               
000f84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f88   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x014\controller.c
000f8a   6ee6     MOVWF     0xe6,0x0                                                                                        
000f8c   6ae6     CLRF      0xe6,0x0                                                                                        
000f8e   ec57     CALL      0x26ae,0x0                                                                                      
000f90   f013                                                                                                               
000f92   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000f96   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x014\controller.c
000f98   6ee6     MOVWF     0xe6,0x0                                                                                        
000f9a   6ae6     CLRF      0xe6,0x0                                                                                        
000f9c   ec57     CALL      0x26ae,0x0                                                                                      
000f9e   f013                                                                                                               
000fa0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa4   d025     BRA       0xff0          				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x014\controller.c
000fa6   0e1f     MOVLW     0x1f                                                                                            
000fa8   1505     ANDWF     0x5,0x0,0x1                                                                                     
000faa   6e10     MOVWF     0x10,0x0                                                                                        
000fac   6a11     CLRF      0x11,0x0                                                                                        
000fae   0e0f     MOVLW     0xf                                                                                             
000fb0   1810     XORWF     0x10,0x0,0x0                                                                                    
000fb2   e101     BNZ       0xfb6                                                                                           
000fb4   5011     MOVF      0x11,0x0,0x0                                                                                    
000fb6   e11c     BNZ       0xff0                                                                                           
000fb8   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x014\controller.c
000fba   6ee6     MOVWF     0xe6,0x0                                                                                        
000fbc   6ae6     CLRF      0xe6,0x0                                                                                        
000fbe   ec57     CALL      0x26ae,0x0                                                                                      
000fc0   f013                                                                                                               
000fc2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fc6   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x014\controller.c
000fc8   6ee6     MOVWF     0xe6,0x0                                                                                        
000fca   6ae6     CLRF      0xe6,0x0                                                                                        
000fcc   ec57     CALL      0x26ae,0x0                                                                                      
000fce   f013                                                                                                               
000fd0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fd2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fd4   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x014\controller.c
000fd6   6ee6     MOVWF     0xe6,0x0                                                                                        
000fd8   6ae6     CLRF      0xe6,0x0                                                                                        
000fda   ec57     CALL      0x26ae,0x0                                                                                      
000fdc   f013                                                                                                               
000fde   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fe0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fe2   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x014\controller.c
000fe4   6ee6     MOVWF     0xe6,0x0                                                                                        
000fe6   6ae6     CLRF      0xe6,0x0                                                                                        
000fe8   ec57     CALL      0x26ae,0x0                                                                                      
000fea   f013                                                                                                               
000fec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x014\controller.c
000ff0   d046     BRA       0x107e         				break;                                                                       C:\fw\midicontroller\x014\controller.c
                                           			case FLASH_PRGM_SELECT_MODE:                                                  C:\fw\midicontroller\x014\controller.c
000ff2   5105     MOVF      0x5,0x0,0x1    				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x014\controller.c
000ff4   0b1f     ANDLW     0x1f                                                                                            
000ff6   e11d     BNZ       0x1032                                                                                          
000ff8   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x014\controller.c
000ffa   6ee6     MOVWF     0xe6,0x0                                                                                        
000ffc   6ae6     CLRF      0xe6,0x0                                                                                        
000ffe   ec57     CALL      0x26ae,0x0                                                                                      
001000   f013                                                                                                               
001002   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001004   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001006   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x014\controller.c
001008   6ee6     MOVWF     0xe6,0x0                                                                                        
00100a   6ae6     CLRF      0xe6,0x0                                                                                        
00100c   ec57     CALL      0x26ae,0x0                                                                                      
00100e   f013                                                                                                               
001010   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001012   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001014   0e02     MOVLW     0x2            					fsw_led_enable(2);                                                          C:\fw\midicontroller\x014\controller.c
001016   6ee6     MOVWF     0xe6,0x0                                                                                        
001018   6ae6     CLRF      0xe6,0x0                                                                                        
00101a   ec43     CALL      0x2686,0x0                                                                                      
00101c   f013                                                                                                               
00101e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001020   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001022   0e03     MOVLW     0x3            					fsw_led_enable(3);                                                          C:\fw\midicontroller\x014\controller.c
001024   6ee6     MOVWF     0xe6,0x0                                                                                        
001026   6ae6     CLRF      0xe6,0x0                                                                                        
001028   ec43     CALL      0x2686,0x0                                                                                      
00102a   f013                                                                                                               
00102c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00102e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001030   d025     BRA       0x107c         				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x014\controller.c
001032   0e1f     MOVLW     0x1f                                                                                            
001034   1505     ANDWF     0x5,0x0,0x1                                                                                     
001036   6e10     MOVWF     0x10,0x0                                                                                        
001038   6a11     CLRF      0x11,0x0                                                                                        
00103a   0e0f     MOVLW     0xf                                                                                             
00103c   1810     XORWF     0x10,0x0,0x0                                                                                    
00103e   e101     BNZ       0x1042                                                                                          
001040   5011     MOVF      0x11,0x0,0x0                                                                                    
001042   e11c     BNZ       0x107c                                                                                          
001044   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x014\controller.c
001046   6ee6     MOVWF     0xe6,0x0                                                                                        
001048   6ae6     CLRF      0xe6,0x0                                                                                        
00104a   ec57     CALL      0x26ae,0x0                                                                                      
00104c   f013                                                                                                               
00104e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001050   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001052   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x014\controller.c
001054   6ee6     MOVWF     0xe6,0x0                                                                                        
001056   6ae6     CLRF      0xe6,0x0                                                                                        
001058   ec57     CALL      0x26ae,0x0                                                                                      
00105a   f013                                                                                                               
00105c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00105e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001060   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x014\controller.c
001062   6ee6     MOVWF     0xe6,0x0                                                                                        
001064   6ae6     CLRF      0xe6,0x0                                                                                        
001066   ec57     CALL      0x26ae,0x0                                                                                      
001068   f013                                                                                                               
00106a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00106c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00106e   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x014\controller.c
001070   6ee6     MOVWF     0xe6,0x0                                                                                        
001072   6ae6     CLRF      0xe6,0x0                                                                                        
001074   ec57     CALL      0x26ae,0x0                                                                                      
001076   f013                                                                                                               
001078   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00107a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x014\controller.c
00107c   d000     BRA       0x107e         				break;                                                                       C:\fw\midicontroller\x014\controller.c
                                           		}                                                                              C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
00107e   0101     MOVLB     0x1            		--cdtimer_flash;                                                               C:\fw\midicontroller\x014\controller.c
001080   0705     DECF      0x5,0x1,0x1                                                                                     
001082   0e00     MOVLW     0x0                                                                                             
001084   5b06     SUBWFB    0x6,0x1,0x1                                                                                     
001086   5105     MOVF      0x5,0x0,0x1    		if (cdtimer_flash == 0) {                                                      C:\fw\midicontroller\x014\controller.c
001088   1106     IORWF     0x6,0x0,0x1                                                                                     
00108a   e108     BNZ       0x109c                                                                                          
                                           			/* reset LEDs to proper state */                                              C:\fw\midicontroller\x014\controller.c
00108c   0100     MOVLB     0x0            			fsw_led_set_active(curr_preset);                                              C:\fw\midicontroller\x014\controller.c
00108e   51f1     MOVF      0xf1,0x0,0x1                                                                                    
001090   6ee6     MOVWF     0xe6,0x0                                                                                        
001092   6ae6     CLRF      0xe6,0x0                                                                                        
001094   ec2d     CALL      0x265a,0x0                                                                                      
001096   f013                                                                                                               
001098   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00109a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
00109c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           void inc_practice_value() {                                                      C:\fw\midicontroller\x014\controller.c
00109e   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x014\controller.c
0010a0   5121     MOVF      0x21,0x0,0x1                                                                                    
0010a2   e115     BNZ       0x10ce                                                                                          
0010a4   c0f9     MOVFF     0xf9,0x10      		if (curr_sortedbank == bank_count - 1) curr_sortedbank = 0;                    C:\fw\midicontroller\x014\controller.c
0010a6   f010                                                                                                               
0010a8   c0fa     MOVFF     0xfa,0x11                                                                                       
0010aa   f011                                                                                                               
0010ac   0610     DECF      0x10,0x1,0x0                                                                                    
0010ae   0e00     MOVLW     0x0                                                                                             
0010b0   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
0010b2   5010     MOVF      0x10,0x0,0x0                                                                                    
0010b4   0100     MOVLB     0x0                                                                                             
0010b6   19f7     XORWF     0xf7,0x0,0x1                                                                                    
0010b8   e102     BNZ       0x10be                                                                                          
0010ba   5011     MOVF      0x11,0x0,0x0                                                                                    
0010bc   19f8     XORWF     0xf8,0x0,0x1                                                                                    
0010be   e103     BNZ       0x10c6                                                                                          
0010c0   6bf7     CLRF      0xf7,0x1                                                                                        
0010c2   6bf8     CLRF      0xf8,0x1                                                                                        
0010c4   d003     BRA       0x10cc         		else ++curr_sortedbank;                                                        C:\fw\midicontroller\x014\controller.c
0010c6   2bf7     INCF      0xf7,0x1,0x1                                                                                    
0010c8   0e00     MOVLW     0x0                                                                                             
0010ca   23f8     ADDWFC    0xf8,0x1,0x1                                                                                    
0010cc   d007     BRA       0x10dc         	} else {                                                                        C:\fw\midicontroller\x014\controller.c
0010ce   0e7f     MOVLW     0x7f           		if (curr_program == 127) curr_program = 0;                                     C:\fw\midicontroller\x014\controller.c
0010d0   0100     MOVLB     0x0                                                                                             
0010d2   5df0     SUBWF     0xf0,0x0,0x1                                                                                    
0010d4   e102     BNZ       0x10da                                                                                          
0010d6   6bf0     CLRF      0xf0,0x1                                                                                        
0010d8   d001     BRA       0x10dc         		else ++curr_program;                                                           C:\fw\midicontroller\x014\controller.c
0010da   2bf0     INCF      0xf0,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
0010dc   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           void dec_practice_value() {                                                      C:\fw\midicontroller\x014\controller.c
0010de   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x014\controller.c
0010e0   5121     MOVF      0x21,0x0,0x1                                                                                    
0010e2   e111     BNZ       0x1106                                                                                          
0010e4   0100     MOVLB     0x0            		if (curr_sortedbank == 0) curr_sortedbank = bank_count - 1;                    C:\fw\midicontroller\x014\controller.c
0010e6   51f7     MOVF      0xf7,0x0,0x1                                                                                    
0010e8   11f8     IORWF     0xf8,0x0,0x1                                                                                    
0010ea   e109     BNZ       0x10fe                                                                                          
0010ec   c0f9     MOVFF     0xf9,0xf7                                                                                       
0010ee   f0f7                                                                                                               
0010f0   c0fa     MOVFF     0xfa,0xf8                                                                                       
0010f2   f0f8                                                                                                               
0010f4   0e01     MOVLW     0x1                                                                                             
0010f6   5ff7     SUBWF     0xf7,0x1,0x1                                                                                    
0010f8   0e00     MOVLW     0x0                                                                                             
0010fa   5bf8     SUBWFB    0xf8,0x1,0x1                                                                                    
0010fc   d003     BRA       0x1104         		else --curr_sortedbank;                                                        C:\fw\midicontroller\x014\controller.c
0010fe   07f7     DECF      0xf7,0x1,0x1                                                                                    
001100   0e00     MOVLW     0x0                                                                                             
001102   5bf8     SUBWFB    0xf8,0x1,0x1                                                                                    
001104   d007     BRA       0x1114         	} else {                                                                        C:\fw\midicontroller\x014\controller.c
001106   0100     MOVLB     0x0            		if (curr_program == 0) curr_program = 127;                                     C:\fw\midicontroller\x014\controller.c
001108   51f0     MOVF      0xf0,0x0,0x1                                                                                    
00110a   e103     BNZ       0x1112                                                                                          
00110c   0e7f     MOVLW     0x7f                                                                                            
00110e   6ff0     MOVWF     0xf0,0x1                                                                                        
001110   d001     BRA       0x1114         		else --curr_program;                                                           C:\fw\midicontroller\x014\controller.c
001112   07f0     DECF      0xf0,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
001114   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           void notify_practice_value() {                                                   C:\fw\midicontroller\x014\controller.c
001116   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x014\controller.c
001118   5121     MOVF      0x21,0x0,0x1                                                                                    
00111a   e102     BNZ       0x1120                                                                                          
00111c   de10     RCALL     0xd3e          		sortedbank_showname();                                                         C:\fw\midicontroller\x014\controller.c
00111e   d001     BRA       0x1122         	} else {                                                                        C:\fw\midicontroller\x014\controller.c
001120   dd26     RCALL     0xb6e          		show_program();                                                                C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
001122   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           void activate_practice_value() {                                                 C:\fw\midicontroller\x014\controller.c
001124   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x014\controller.c
001126   5121     MOVF      0x21,0x0,0x1                                                                                    
001128   e104     BNZ       0x1132                                                                                          
00112a   6ae6     CLRF      0xe6,0x0       		sortedbank_activate(0);                                                        C:\fw\midicontroller\x014\controller.c
00112c   ddd8     RCALL     0xcde                                                                                           
00112e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001130   d004     BRA       0x113a         	} else {                                                                        C:\fw\midicontroller\x014\controller.c
001132   0e01     MOVLW     0x1            		program_activate(1);                                                           C:\fw\midicontroller\x014\controller.c
001134   6ee6     MOVWF     0xe6,0x0                                                                                        
001136   dd44     RCALL     0xbc0                                                                                           
001138   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
00113a   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* sequence programming completed, set state to repeat the sequence back: */     C:\fw\midicontroller\x014\controller.c
                                           void sequence_complete() {                                                       C:\fw\midicontroller\x014\controller.c
                                           	/* set the sequence length and store to the ROM: */                             C:\fw\midicontroller\x014\controller.c
00113c   c0f2     MOVFF     0xf2,0xeb      	bankmap_count = curr_mapindex;                                                  C:\fw\midicontroller\x014\controller.c
00113e   f0eb                                                                                                               
001140   c0eb     MOVFF     0xeb,0xfe6     	bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);            C:\fw\midicontroller\x014\controller.c
001142   ffe6                                                                                                               
001144   0ee3     MOVLW     0xe3                                                                                            
001146   6ee6     MOVWF     0xe6,0x0                                                                                        
001148   0e00     MOVLW     0x0                                                                                             
00114a   6ee6     MOVWF     0xe6,0x0                                                                                        
00114c   0edf     MOVLW     0xdf                                                                                            
00114e   6ee6     MOVWF     0xe6,0x0                                                                                        
001150   0e00     MOVLW     0x0                                                                                             
001152   6ee6     MOVWF     0xe6,0x0                                                                                        
001154   0edb     MOVLW     0xdb                                                                                            
001156   6ee6     MOVWF     0xe6,0x0                                                                                        
001158   0e00     MOVLW     0x0                                                                                             
00115a   6ee6     MOVWF     0xe6,0x0                                                                                        
00115c   c0f3     MOVFF     0xf3,0xfe6                                                                                      
00115e   ffe6                                                                                                               
001160   c0f4     MOVFF     0xf4,0xfe6                                                                                      
001162   ffe6                                                                                                               
001164   ec84     CALL      0x2708,0x0                                                                                      
001166   f013                                                                                                               
001168   6e10     MOVWF     0x10,0x0                                                                                        
00116a   0e09     MOVLW     0x9                                                                                             
00116c   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
00116e   5010     MOVF      0x10,0x0,0x0                                                                                    
                                           	/* set up state to repeat the stored sequence back on the preset LEDs: */       C:\fw\midicontroller\x014\controller.c
001170   0101     MOVLB     0x1            	program_mode = PROGRAM_COMPLETE;                                                C:\fw\midicontroller\x014\controller.c
001172   0e02     MOVLW     0x2                                                                                             
001174   6f0f     MOVWF     0xf,0x1                                                                                         
001176   0e32     MOVLW     0x32           	cdtimer_holdenter = 50;                                                         C:\fw\midicontroller\x014\controller.c
001178   6f0b     MOVWF     0xb,0x1                                                                                         
00117a   6b0c     CLRF      0xc,0x1                                                                                         
00117c   0100     MOVLB     0x0            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x014\controller.c
00117e   6bf2     CLRF      0xf2,0x1                                                                                        
001180   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* set the controller to an initial state */                                     C:\fw\midicontroller\x014\controller.c
                                           void controller_init() {                                                         C:\fw\midicontroller\x014\controller.c
001182   ec7b     CALL      0x26f6,0x0     	bank_count = banks_count();                                                     C:\fw\midicontroller\x014\controller.c
001184   f013                                                                                                               
001186   cff3     MOVFF     0xff3,0xf9                                                                                      
001188   f0f9                                                                                                               
00118a   cff4     MOVFF     0xff4,0xfa                                                                                      
00118c   f0fa                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
00118e   0100     MOVLB     0x0            	curr_bank = 0;                                                                  C:\fw\midicontroller\x014\controller.c
001190   6bf3     CLRF      0xf3,0x1                                                                                        
001192   6bf4     CLRF      0xf4,0x1                                                                                        
001194   0e01     MOVLW     0x1            	bank_activate(1);                                                               C:\fw\midicontroller\x014\controller.c
001196   6ee6     MOVWF     0xe6,0x0                                                                                        
001198   dd6a     RCALL     0xc6e                                                                                           
00119a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\controller.c
00119c   0100     MOVLB     0x0            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x014\controller.c
00119e   6bf2     CLRF      0xf2,0x1                                                                                        
0011a0   0e01     MOVLW     0x1            	bankmap_activate(1);                                                            C:\fw\midicontroller\x014\controller.c
0011a2   6ee6     MOVWF     0xe6,0x0                                                                                        
0011a4   dd49     RCALL     0xc38                                                                                           
0011a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x014\controller.c
0011a8   0e00     MOVLW     0x0            	sw_curr = sw_last = 0;                                                          C:\fw\midicontroller\x014\controller.c
0011aa   0101     MOVLB     0x1                                                                                             
0011ac   6f1b     MOVWF     0x1b,0x1                                                                                        
0011ae   6b1c     CLRF      0x1c,0x1                                                                                        
0011b0   6f19     MOVWF     0x19,0x1                                                                                        
0011b2   6b1a     CLRF      0x1a,0x1                                                                                        
0011b4   ec76     CALL      0x26ec,0x0     	cc_curr = cc_last = expr_poll();                                                C:\fw\midicontroller\x014\controller.c
0011b6   f013                                                                                                               
0011b8   0101     MOVLB     0x1                                                                                             
0011ba   6f1e     MOVWF     0x1e,0x1                                                                                        
0011bc   6f1d     MOVWF     0x1d,0x1                                                                                        
0011be   ec71     CALL      0x26e2,0x0     	mode = slider_poll();                                                           C:\fw\midicontroller\x014\controller.c
0011c0   f013                                                                                                               
0011c2   0100     MOVLB     0x0                                                                                             
0011c4   6ffe     MOVWF     0xfe,0x1                                                                                        
0011c6   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           /* main control loop */                                                          C:\fw\midicontroller\x014\controller.c
                                           void controller_handle() {                                                       C:\fw\midicontroller\x014\controller.c
                                           	/* poll foot-switch depression status: */                                       C:\fw\midicontroller\x014\controller.c
0011c8   ece9     CALL      0x25d2,0x0     	sw_curr = fsw_poll();                                                           C:\fw\midicontroller\x014\controller.c
0011ca   f012                                                                                                               
0011cc   cff3     MOVFF     0xff3,0x119                                                                                     
0011ce   f119                                                                                                               
0011d0   cff4     MOVFF     0xff4,0x11a                                                                                     
0011d2   f11a                                                                                                               
                                           	/* poll expression pedal value: */                                              C:\fw\midicontroller\x014\controller.c
0011d4   ec76     CALL      0x26ec,0x0     	cc_curr = expr_poll();                                                          C:\fw\midicontroller\x014\controller.c
0011d6   f013                                                                                                               
0011d8   0101     MOVLB     0x1                                                                                             
0011da   6f1d     MOVWF     0x1d,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* send CC message only if changed: */                                          C:\fw\midicontroller\x014\controller.c
0011dc   511e     MOVF      0x1e,0x0,0x1   	if (cc_curr != cc_last) {                                                       C:\fw\midicontroller\x014\controller.c
0011de   5d1d     SUBWF     0x1d,0x0,0x1                                                                                    
0011e0   e016     BZ        0x120e                                                                                          
0011e2   0e7f     MOVLW     0x7f           		midi_send_cmd2(0xB, midi_channel, bankcontroller[curr_preset], cc_curr & 0x7F); C:\fw\midicontroller\x014\controller.c
0011e4   151d     ANDWF     0x1d,0x0,0x1                                                                                    
0011e6   6ee6     MOVWF     0xe6,0x0                                                                                        
0011e8   0100     MOVLB     0x0                                                                                             
0011ea   51f1     MOVF      0xf1,0x0,0x1                                                                                    
0011ec   6aea     CLRF      0xea,0x0                                                                                        
0011ee   0fdf     ADDLW     0xdf                                                                                            
0011f0   6ee9     MOVWF     0xe9,0x0                                                                                        
0011f2   0e00     MOVLW     0x0                                                                                             
0011f4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0011f6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0011f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011fa   c100     MOVFF     0x100,0xfe6                                                                                     
0011fc   ffe6                                                                                                               
0011fe   0e0b     MOVLW     0xb                                                                                             
001200   6ee6     MOVWF     0xe6,0x0                                                                                        
001202   eca4     CALL      0x2748,0x0                                                                                      
001204   f013                                                                                                               
001206   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001208   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00120a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00120c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* determine mode */                                                            C:\fw\midicontroller\x014\controller.c
00120e   ec71     CALL      0x26e2,0x0     	if (slider_poll() == 0) {                                                       C:\fw\midicontroller\x014\controller.c
001210   f013                                                                                                               
001212   0900     IORLW     0x0                                                                                             
001214   e110     BNZ       0x1236                                                                                          
001216   0100     MOVLB     0x0            		if (mode == MODE_CONCERT) {                                                    C:\fw\midicontroller\x014\controller.c
001218   05fe     DECF      0xfe,0x0,0x1                                                                                    
00121a   e10c     BNZ       0x1234                                                                                          
                                           			/* switched from CONCERT to PRACTICE */                                       C:\fw\midicontroller\x014\controller.c
00121c   6bfe     CLRF      0xfe,0x1       			mode = MODE_PRACTICE;                                                         C:\fw\midicontroller\x014\controller.c
                                           			/* load the alphabetically first bank and start from the beginning of its program */ C:\fw\midicontroller\x014\controller.c
00121e   6bf7     CLRF      0xf7,0x1       			curr_sortedbank = 0;                                                          C:\fw\midicontroller\x014\controller.c
001220   6bf8     CLRF      0xf8,0x1                                                                                        
001222   0e01     MOVLW     0x1            			sortedbank_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
001224   6ee6     MOVWF     0xe6,0x0                                                                                        
001226   dd5b     RCALL     0xcde                                                                                           
001228   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00122a   0100     MOVLB     0x0            			curr_mapindex = 0;                                                            C:\fw\midicontroller\x014\controller.c
00122c   6bf2     CLRF      0xf2,0x1                                                                                        
00122e   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          C:\fw\midicontroller\x014\controller.c
001230   dd03     RCALL     0xc38                                                                                           
001232   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x014\controller.c
001234   d00f     BRA       0x1254         	} else {                                                                        C:\fw\midicontroller\x014\controller.c
001236   0100     MOVLB     0x0            		if (mode == MODE_PRACTICE) {                                                   C:\fw\midicontroller\x014\controller.c
001238   51fe     MOVF      0xfe,0x0,0x1                                                                                    
00123a   e10c     BNZ       0x1254                                                                                          
                                           			/* switched from PRACTICE to CONCERT */                                       C:\fw\midicontroller\x014\controller.c
00123c   0e01     MOVLW     0x1            			mode = MODE_CONCERT;                                                          C:\fw\midicontroller\x014\controller.c
00123e   6ffe     MOVWF     0xfe,0x1                                                                                        
                                           			/* load the sequentially first bank and start from the beginning of its program */ C:\fw\midicontroller\x014\controller.c
001240   6bf3     CLRF      0xf3,0x1       			curr_bank = 0;                                                                C:\fw\midicontroller\x014\controller.c
001242   6bf4     CLRF      0xf4,0x1                                                                                        
001244   6ee6     MOVWF     0xe6,0x0       			bank_activate(1);                                                             C:\fw\midicontroller\x014\controller.c
001246   dd13     RCALL     0xc6e                                                                                           
001248   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00124a   0100     MOVLB     0x0            			curr_mapindex = 0;                                                            C:\fw\midicontroller\x014\controller.c
00124c   6bf2     CLRF      0xf2,0x1                                                                                        
00124e   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          C:\fw\midicontroller\x014\controller.c
001250   dcf3     RCALL     0xc38                                                                                           
001252   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* NEXT never changes function depending on mode */                             C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* NEXT pressed: */                                                             C:\fw\midicontroller\x014\controller.c
001254   0e00     MOVLW     0x0            	if (button_pressed(FSM_NEXT)) {                                                 C:\fw\midicontroller\x014\controller.c
001256   6ee6     MOVWF     0xe6,0x0                                                                                        
001258   6ae6     CLRF      0xe6,0x0                                                                                        
00125a   dda0     RCALL     0xd9c                                                                                           
00125c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00125e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001260   0900     IORLW     0x0                                                                                             
001262   e04b     BZ        0x12fa                                                                                          
001264   0100     MOVLB     0x0            		if (loaded_bank != curr_bank) {                                                C:\fw\midicontroller\x014\controller.c
001266   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001268   19f5     XORWF     0xf5,0x0,0x1                                                                                    
00126a   e102     BNZ       0x1270                                                                                          
00126c   51f4     MOVF      0xf4,0x0,0x1                                                                                    
00126e   19f6     XORWF     0xf6,0x0,0x1                                                                                    
001270   e005     BZ        0x127c                                                                                          
                                           			/* prepared to switch to a bank, but did not activate the first map */        C:\fw\midicontroller\x014\controller.c
001272   0e01     MOVLW     0x1            			bankmap_activate(1);                                                          C:\fw\midicontroller\x014\controller.c
001274   6ee6     MOVWF     0xe6,0x0                                                                                        
001276   dce0     RCALL     0xc38                                                                                           
001278   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00127a   d03f     BRA       0x12fa         		} else {                                                                       C:\fw\midicontroller\x014\controller.c
00127c   05eb     DECF      0xeb,0x0,0x1   			if (curr_mapindex == bankmap_count - 1) {                                     C:\fw\midicontroller\x014\controller.c
00127e   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
001280   e137     BNZ       0x12f0                                                                                          
                                           				/* crossed the upper bank-map boundary, load the next bank */                C:\fw\midicontroller\x014\controller.c
001282   51fe     MOVF      0xfe,0x0,0x1   				if (mode == MODE_PRACTICE) {                                                 C:\fw\midicontroller\x014\controller.c
001284   e118     BNZ       0x12b6                                                                                          
                                           					/* PRACTICE mode cycles through banks by sorted index #: */                 C:\fw\midicontroller\x014\controller.c
001286   c0f9     MOVFF     0xf9,0x10      					if (curr_sortedbank == bank_count - 1) {                                    C:\fw\midicontroller\x014\controller.c
001288   f010                                                                                                               
00128a   c0fa     MOVFF     0xfa,0x11                                                                                       
00128c   f011                                                                                                               
00128e   0610     DECF      0x10,0x1,0x0                                                                                    
001290   0e00     MOVLW     0x0                                                                                             
001292   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001294   5010     MOVF      0x10,0x0,0x0                                                                                    
001296   19f7     XORWF     0xf7,0x0,0x1                                                                                    
001298   e102     BNZ       0x129e                                                                                          
00129a   5011     MOVF      0x11,0x0,0x0                                                                                    
00129c   19f8     XORWF     0xf8,0x0,0x1                                                                                    
00129e   e103     BNZ       0x12a6                                                                                          
0012a0   6bf7     CLRF      0xf7,0x1       						curr_sortedbank = 0;                                                       C:\fw\midicontroller\x014\controller.c
0012a2   6bf8     CLRF      0xf8,0x1                                                                                        
0012a4   d003     BRA       0x12ac         					} else {                                                                    C:\fw\midicontroller\x014\controller.c
0012a6   2bf7     INCF      0xf7,0x1,0x1   						++curr_sortedbank;                                                         C:\fw\midicontroller\x014\controller.c
0012a8   0e00     MOVLW     0x0                                                                                             
0012aa   23f8     ADDWFC    0xf8,0x1,0x1                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* show the bank name */                                                    C:\fw\midicontroller\x014\controller.c
0012ac   0e01     MOVLW     0x1            					sortedbank_activate(1);                                                     C:\fw\midicontroller\x014\controller.c
0012ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0012b0   dd16     RCALL     0xcde                                                                                           
0012b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012b4   d017     BRA       0x12e4         				} else {                                                                     C:\fw\midicontroller\x014\controller.c
                                           					/* CONCERT mode cycles through banks by index #: */                         C:\fw\midicontroller\x014\controller.c
0012b6   c0f9     MOVFF     0xf9,0x10      					if (curr_bank == bank_count - 1) {                                          C:\fw\midicontroller\x014\controller.c
0012b8   f010                                                                                                               
0012ba   c0fa     MOVFF     0xfa,0x11                                                                                       
0012bc   f011                                                                                                               
0012be   0610     DECF      0x10,0x1,0x0                                                                                    
0012c0   0e00     MOVLW     0x0                                                                                             
0012c2   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
0012c4   5010     MOVF      0x10,0x0,0x0                                                                                    
0012c6   19f3     XORWF     0xf3,0x0,0x1                                                                                    
0012c8   e102     BNZ       0x12ce                                                                                          
0012ca   5011     MOVF      0x11,0x0,0x0                                                                                    
0012cc   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0012ce   e103     BNZ       0x12d6                                                                                          
0012d0   6bf3     CLRF      0xf3,0x1       						curr_bank = 0;                                                             C:\fw\midicontroller\x014\controller.c
0012d2   6bf4     CLRF      0xf4,0x1                                                                                        
0012d4   d003     BRA       0x12dc         					} else {                                                                    C:\fw\midicontroller\x014\controller.c
0012d6   2bf3     INCF      0xf3,0x1,0x1   						++curr_bank;                                                               C:\fw\midicontroller\x014\controller.c
0012d8   0e00     MOVLW     0x0                                                                                             
0012da   23f4     ADDWFC    0xf4,0x1,0x1                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* show the bank name */                                                    C:\fw\midicontroller\x014\controller.c
0012dc   0e01     MOVLW     0x1            					bank_activate(1);                                                           C:\fw\midicontroller\x014\controller.c
0012de   6ee6     MOVWF     0xe6,0x0                                                                                        
0012e0   dcc6     RCALL     0xc6e                                                                                           
0012e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x014\controller.c
                                           				/* activate the first map for the new bank, but do not display the MIDI program # */ C:\fw\midicontroller\x014\controller.c
0012e4   0100     MOVLB     0x0            				curr_mapindex = 0;                                                           C:\fw\midicontroller\x014\controller.c
0012e6   6bf2     CLRF      0xf2,0x1                                                                                        
0012e8   6ae6     CLRF      0xe6,0x0       				bankmap_activate(0);                                                         C:\fw\midicontroller\x014\controller.c
0012ea   dca6     RCALL     0xc38                                                                                           
0012ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012ee   d005     BRA       0x12fa         			} else {                                                                      C:\fw\midicontroller\x014\controller.c
                                           				/* activate the next map for the new bank, and display the MIDI program # */ C:\fw\midicontroller\x014\controller.c
0012f0   2bf2     INCF      0xf2,0x1,0x1   				++curr_mapindex;                                                             C:\fw\midicontroller\x014\controller.c
0012f2   0e01     MOVLW     0x1            				bankmap_activate(1);                                                         C:\fw\midicontroller\x014\controller.c
0012f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0012f6   dca0     RCALL     0xc38                                                                                           
0012f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                           		}                                                                              C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           	/* PRACTICE vs. CONCERT modes: */                                               C:\fw\midicontroller\x014\controller.c
0012fa   0100     MOVLB     0x0            	switch (mode) {                                                                 C:\fw\midicontroller\x014\controller.c
0012fc   51fe     MOVF      0xfe,0x0,0x1                                                                                    
0012fe   0a01     XORLW     0x1                                                                                             
001300   e101     BNZ       0x1304                                                                                          
001302   d317     BRA       0x1932                                                                                          
001304   0a01     XORLW     0x1                                                                                             
001306   e002     BZ        0x130c                                                                                          
001308   ef83     GOTO      0x1d06                                                                                          
00130a   f00e                                                                                                               
                                           		case MODE_PRACTICE:                                                            C:\fw\midicontroller\x014\controller.c
                                           			/* PRACTICE mode has sub-modes of its own: */                                 C:\fw\midicontroller\x014\controller.c
00130c   0101     MOVLB     0x1            			switch (program_mode) {                                                       C:\fw\midicontroller\x014\controller.c
00130e   510f     MOVF      0xf,0x0,0x1                                                                                     
001310   0a02     XORLW     0x2                                                                                             
001312   e101     BNZ       0x1316                                                                                          
001314   d2d8     BRA       0x18c6                                                                                          
001316   0a03     XORLW     0x3                                                                                             
001318   e101     BNZ       0x131c                                                                                          
00131a   d23a     BRA       0x1790                                                                                          
00131c   0a01     XORLW     0x1                                                                                             
00131e   e001     BZ        0x1322                                                                                          
001320   d307     BRA       0x1930                                                                                          
                                           				case PROGRAM_NONE:                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* one of preset 1-4 pressed: */                                            C:\fw\midicontroller\x014\controller.c
001322   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         C:\fw\midicontroller\x014\controller.c
001324   6ee6     MOVWF     0xe6,0x0                                                                                        
001326   6ae6     CLRF      0xe6,0x0                                                                                        
001328   dd39     RCALL     0xd9c                                                                                           
00132a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00132c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00132e   0900     IORLW     0x0                                                                                             
001330   e00e     BZ        0x134e                                                                                          
001332   0100     MOVLB     0x0            						curr_preset = 0;                                                           C:\fw\midicontroller\x014\controller.c
001334   6bf1     CLRF      0xf1,0x1                                                                                        
001336   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x014\controller.c
001338   0521     DECF      0x21,0x0,0x1                                                                                    
00133a   e105     BNZ       0x1346                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x014\controller.c
00133c   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x014\controller.c
00133e   6f07     MOVWF     0x7,0x1                                                                                         
001340   6b08     CLRF      0x8,0x1                                                                                         
001342   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x014\controller.c
001344   d004     BRA       0x134e         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
001346   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
001348   6ee6     MOVWF     0xe6,0x0                                                                                        
00134a   dc51     RCALL     0xbee                                                                                           
00134c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
00134e   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         C:\fw\midicontroller\x014\controller.c
001350   6ee6     MOVWF     0xe6,0x0                                                                                        
001352   6ae6     CLRF      0xe6,0x0                                                                                        
001354   dd23     RCALL     0xd9c                                                                                           
001356   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001358   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00135a   0900     IORLW     0x0                                                                                             
00135c   e00f     BZ        0x137c                                                                                          
00135e   0100     MOVLB     0x0            						curr_preset = 1;                                                           C:\fw\midicontroller\x014\controller.c
001360   0e01     MOVLW     0x1                                                                                             
001362   6ff1     MOVWF     0xf1,0x1                                                                                        
001364   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x014\controller.c
001366   0521     DECF      0x21,0x0,0x1                                                                                    
001368   e105     BNZ       0x1374                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x014\controller.c
00136a   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x014\controller.c
00136c   6f07     MOVWF     0x7,0x1                                                                                         
00136e   6b08     CLRF      0x8,0x1                                                                                         
001370   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x014\controller.c
001372   d004     BRA       0x137c         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
001374   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
001376   6ee6     MOVWF     0xe6,0x0                                                                                        
001378   dc3a     RCALL     0xbee                                                                                           
00137a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
00137c   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         C:\fw\midicontroller\x014\controller.c
00137e   6ee6     MOVWF     0xe6,0x0                                                                                        
001380   6ae6     CLRF      0xe6,0x0                                                                                        
001382   dd0c     RCALL     0xd9c                                                                                           
001384   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001386   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001388   0900     IORLW     0x0                                                                                             
00138a   e00f     BZ        0x13aa                                                                                          
00138c   0100     MOVLB     0x0            						curr_preset = 2;                                                           C:\fw\midicontroller\x014\controller.c
00138e   0e02     MOVLW     0x2                                                                                             
001390   6ff1     MOVWF     0xf1,0x1                                                                                        
001392   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x014\controller.c
001394   0521     DECF      0x21,0x0,0x1                                                                                    
001396   e105     BNZ       0x13a2                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x014\controller.c
001398   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x014\controller.c
00139a   6f07     MOVWF     0x7,0x1                                                                                         
00139c   6b08     CLRF      0x8,0x1                                                                                         
00139e   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x014\controller.c
0013a0   d004     BRA       0x13aa         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
0013a2   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
0013a4   6ee6     MOVWF     0xe6,0x0                                                                                        
0013a6   dc23     RCALL     0xbee                                                                                           
0013a8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
0013aa   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         C:\fw\midicontroller\x014\controller.c
0013ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0013ae   6ae6     CLRF      0xe6,0x0                                                                                        
0013b0   dcf5     RCALL     0xd9c                                                                                           
0013b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013b6   0900     IORLW     0x0                                                                                             
0013b8   e00f     BZ        0x13d8                                                                                          
0013ba   0100     MOVLB     0x0            						curr_preset = 3;                                                           C:\fw\midicontroller\x014\controller.c
0013bc   0e03     MOVLW     0x3                                                                                             
0013be   6ff1     MOVWF     0xf1,0x1                                                                                        
0013c0   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x014\controller.c
0013c2   0521     DECF      0x21,0x0,0x1                                                                                    
0013c4   e105     BNZ       0x13d0                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x014\controller.c
0013c6   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x014\controller.c
0013c8   6f07     MOVWF     0x7,0x1                                                                                         
0013ca   6b08     CLRF      0x8,0x1                                                                                         
0013cc   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x014\controller.c
0013ce   d004     BRA       0x13d8         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
0013d0   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
0013d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0013d4   dc0c     RCALL     0xbee                                                                                           
0013d6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
0013d8   0101     MOVLB     0x1            					if (incdec_mode == 1) {                                                     C:\fw\midicontroller\x014\controller.c
0013da   0521     DECF      0x21,0x0,0x1                                                                                    
0013dc   e001     BZ        0x13e0                                                                                          
0013de   d087     BRA       0x14ee                                                                                          
                                           						/* check if the store-timer ran out and we're able to store: */            C:\fw\midicontroller\x014\controller.c
0013e0   5107     MOVF      0x7,0x0,0x1    						if ((cdtimer_store == 0) && (store_state == 0)) {                          C:\fw\midicontroller\x014\controller.c
0013e2   1108     IORWF     0x8,0x0,0x1                                                                                     
0013e4   e153     BNZ       0x148c                                                                                          
0013e6   5120     MOVF      0x20,0x0,0x1                                                                                    
0013e8   e151     BNZ       0x148c                                                                                          
                                           							/* still holding a button? */                                             C:\fw\midicontroller\x014\controller.c
0013ea   0e01     MOVLW     0x1            							if (button_held(FSM_PRESET_1) || button_held(FSM_PRESET_2) || button_held(FSM_PRESET_3) || button_held(FSM_PRESET_4)) { C:\fw\midicontroller\x014\controller.c
0013ec   6ee6     MOVWF     0xe6,0x0                                                                                        
0013ee   6ae6     CLRF      0xe6,0x0                                                                                        
0013f0   dd04     RCALL     0xdfa                                                                                           
0013f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013f6   0900     IORLW     0x0                                                                                             
0013f8   e118     BNZ       0x142a                                                                                          
0013fa   0e02     MOVLW     0x2                                                                                             
0013fc   6ee6     MOVWF     0xe6,0x0                                                                                        
0013fe   6ae6     CLRF      0xe6,0x0                                                                                        
001400   dcfc     RCALL     0xdfa                                                                                           
001402   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001404   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001406   0900     IORLW     0x0                                                                                             
001408   e110     BNZ       0x142a                                                                                          
00140a   0e04     MOVLW     0x4                                                                                             
00140c   6ee6     MOVWF     0xe6,0x0                                                                                        
00140e   6ae6     CLRF      0xe6,0x0                                                                                        
001410   dcf4     RCALL     0xdfa                                                                                           
001412   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001414   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001416   0900     IORLW     0x0                                                                                             
001418   e108     BNZ       0x142a                                                                                          
00141a   0e08     MOVLW     0x8                                                                                             
00141c   6ee6     MOVWF     0xe6,0x0                                                                                        
00141e   6ae6     CLRF      0xe6,0x0                                                                                        
001420   dcec     RCALL     0xdfa                                                                                           
001422   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001424   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001426   0900     IORLW     0x0                                                                                             
001428   e031     BZ        0x148c                                                                                          
                                           								/* store the program */                                                  C:\fw\midicontroller\x014\controller.c
00142a   0101     MOVLB     0x1            								store_state = 1;                                                         C:\fw\midicontroller\x014\controller.c
00142c   0e01     MOVLW     0x1                                                                                             
00142e   6f20     MOVWF     0x20,0x1                                                                                        
001430   0100     MOVLB     0x0            								bank[curr_preset] = curr_program;                                        C:\fw\midicontroller\x014\controller.c
001432   51f1     MOVF      0xf1,0x0,0x1                                                                                    
001434   6aea     CLRF      0xea,0x0                                                                                        
001436   0fdb     ADDLW     0xdb                                                                                            
001438   6ee9     MOVWF     0xe9,0x0                                                                                        
00143a   0e00     MOVLW     0x0                                                                                             
00143c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00143e   c0f0     MOVFF     0xf0,0xfef                                                                                      
001440   ffef                                                                                                               
001442   c0eb     MOVFF     0xeb,0xfe6     								bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);     C:\fw\midicontroller\x014\controller.c
001444   ffe6                                                                                                               
001446   0ee3     MOVLW     0xe3                                                                                            
001448   6ee6     MOVWF     0xe6,0x0                                                                                        
00144a   0e00     MOVLW     0x0                                                                                             
00144c   6ee6     MOVWF     0xe6,0x0                                                                                        
00144e   0edf     MOVLW     0xdf                                                                                            
001450   6ee6     MOVWF     0xe6,0x0                                                                                        
001452   0e00     MOVLW     0x0                                                                                             
001454   6ee6     MOVWF     0xe6,0x0                                                                                        
001456   0edb     MOVLW     0xdb                                                                                            
001458   6ee6     MOVWF     0xe6,0x0                                                                                        
00145a   0e00     MOVLW     0x0                                                                                             
00145c   6ee6     MOVWF     0xe6,0x0                                                                                        
00145e   c0f3     MOVFF     0xf3,0xfe6                                                                                      
001460   ffe6                                                                                                               
001462   c0f4     MOVFF     0xf4,0xfe6                                                                                      
001464   ffe6                                                                                                               
001466   ec84     CALL      0x2708,0x0                                                                                      
001468   f013                                                                                                               
00146a   6e10     MOVWF     0x10,0x0                                                                                        
00146c   0e09     MOVLW     0x9                                                                                             
00146e   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
001470   5010     MOVF      0x10,0x0,0x0                                                                                    
001472   0e01     MOVLW     0x1            								preset_activate(1);                                                      C:\fw\midicontroller\x014\controller.c
001474   6ee6     MOVWF     0xe6,0x0                                                                                        
001476   ecf7     CALL      0xbee,0x0                                                                                       
001478   f005                                                                                                               
00147a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           								/* flash the stored LED */                                               C:\fw\midicontroller\x014\controller.c
00147c   0101     MOVLB     0x1            								flash_state = FLASH_STORE;                                               C:\fw\midicontroller\x014\controller.c
00147e   0e01     MOVLW     0x1                                                                                             
001480   6f0e     MOVWF     0xe,0x1                                                                                         
001482   c0f1     MOVFF     0xf1,0x110     								flash_led = curr_preset;                                                 C:\fw\midicontroller\x014\controller.c
001484   f110                                                                                                               
001486   0e64     MOVLW     0x64           								cdtimer_flash = 100;                                                     C:\fw\midicontroller\x014\controller.c
001488   6f05     MOVWF     0x5,0x1                                                                                         
00148a   6b06     CLRF      0x6,0x1                                                                                         
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           						/* check if a button was released: */                                      C:\fw\midicontroller\x014\controller.c
00148c   0e01     MOVLW     0x1            						if (button_released(FSM_PRESET_1) || button_released(FSM_PRESET_2) || button_released(FSM_PRESET_3) || button_released(FSM_PRESET_4)) { C:\fw\midicontroller\x014\controller.c
00148e   6ee6     MOVWF     0xe6,0x0                                                                                        
001490   6ae6     CLRF      0xe6,0x0                                                                                        
001492   dcd3     RCALL     0xe3a                                                                                           
001494   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001496   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001498   0900     IORLW     0x0                                                                                             
00149a   e118     BNZ       0x14cc                                                                                          
00149c   0e02     MOVLW     0x2                                                                                             
00149e   6ee6     MOVWF     0xe6,0x0                                                                                        
0014a0   6ae6     CLRF      0xe6,0x0                                                                                        
0014a2   dccb     RCALL     0xe3a                                                                                           
0014a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014a8   0900     IORLW     0x0                                                                                             
0014aa   e110     BNZ       0x14cc                                                                                          
0014ac   0e04     MOVLW     0x4                                                                                             
0014ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b0   6ae6     CLRF      0xe6,0x0                                                                                        
0014b2   dcc3     RCALL     0xe3a                                                                                           
0014b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014b8   0900     IORLW     0x0                                                                                             
0014ba   e108     BNZ       0x14cc                                                                                          
0014bc   0e08     MOVLW     0x8                                                                                             
0014be   6ee6     MOVWF     0xe6,0x0                                                                                        
0014c0   6ae6     CLRF      0xe6,0x0                                                                                        
0014c2   dcbb     RCALL     0xe3a                                                                                           
0014c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014c8   0900     IORLW     0x0                                                                                             
0014ca   e011     BZ        0x14ee                                                                                          
0014cc   0101     MOVLB     0x1            							if ((cdtimer_store > 0) && (store_state == 0)) {                          C:\fw\midicontroller\x014\controller.c
0014ce   0e00     MOVLW     0x0                                                                                             
0014d0   80d8     BSF       0xd8,0x0,0x0                                                                                    
0014d2   5507     SUBFWB    0x7,0x0,0x1                                                                                     
0014d4   0e00     MOVLW     0x0                                                                                             
0014d6   5508     SUBFWB    0x8,0x0,0x1                                                                                     
0014d8   e20a     BC        0x14ee                                                                                          
0014da   5120     MOVF      0x20,0x0,0x1                                                                                    
0014dc   e108     BNZ       0x14ee                                                                                          
                                           								/* was only tapped (held less than ~300msec) */                          C:\fw\midicontroller\x014\controller.c
0014de   0e01     MOVLW     0x1            								preset_activate(1);                                                      C:\fw\midicontroller\x014\controller.c
0014e0   6ee6     MOVWF     0xe6,0x0                                                                                        
0014e2   ecf7     CALL      0xbee,0x0                                                                                       
0014e4   f005                                                                                                               
0014e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014e8   0101     MOVLB     0x1            								cdtimer_store = 0;                                                       C:\fw\midicontroller\x014\controller.c
0014ea   6b07     CLRF      0x7,0x1                                                                                         
0014ec   6b08     CLRF      0x8,0x1                                                                                         
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           					/* INC pressed: */                                                          C:\fw\midicontroller\x014\controller.c
0014ee   0e00     MOVLW     0x0            					if (button_pressed(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x014\controller.c
0014f0   6ee6     MOVWF     0xe6,0x0                                                                                        
0014f2   6ae6     CLRF      0xe6,0x0                                                                                        
0014f4   dc53     RCALL     0xd9c                                                                                           
0014f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014fa   0900     IORLW     0x0                                                                                             
0014fc   e00f     BZ        0x151c                                                                                          
0014fe   0e00     MOVLW     0x0                                                                                             
001500   6ee6     MOVWF     0xe6,0x0                                                                                        
001502   6ae6     CLRF      0xe6,0x0                                                                                        
001504   dc7a     RCALL     0xdfa                                                                                           
001506   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001508   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00150a   0900     IORLW     0x0                                                                                             
00150c   e107     BNZ       0x151c                                                                                          
00150e   0101     MOVLB     0x1                                                                                             
001510   5109     MOVF      0x9,0x0,0x1                                                                                     
001512   110a     IORWF     0xa,0x0,0x1                                                                                     
001514   e103     BNZ       0x151c                                                                                          
                                           						/* INC pushed first */                                                     C:\fw\midicontroller\x014\controller.c
001516   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  C:\fw\midicontroller\x014\controller.c
001518   6f09     MOVWF     0x9,0x1                                                                                         
00151a   6b0a     CLRF      0xa,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* Still holding INC alone after ~300 ms: */                                C:\fw\midicontroller\x014\controller.c
00151c   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x014\controller.c
00151e   510d     MOVF      0xd,0x0,0x1                                                                                     
001520   e11b     BNZ       0x1558                                                                                          
001522   0e00     MOVLW     0x0                                                                                             
001524   6ee6     MOVWF     0xe6,0x0                                                                                        
001526   6ae6     CLRF      0xe6,0x0                                                                                        
001528   dc68     RCALL     0xdfa                                                                                           
00152a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00152c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00152e   0900     IORLW     0x0                                                                                             
001530   e013     BZ        0x1558                                                                                          
001532   0e00     MOVLW     0x0                                                                                             
001534   6ee6     MOVWF     0xe6,0x0                                                                                        
001536   6ae6     CLRF      0xe6,0x0                                                                                        
001538   dc60     RCALL     0xdfa                                                                                           
00153a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00153c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00153e   0900     IORLW     0x0                                                                                             
001540   e10b     BNZ       0x1558                                                                                          
001542   0101     MOVLB     0x1                                                                                             
001544   5109     MOVF      0x9,0x0,0x1                                                                                     
001546   110a     IORWF     0xa,0x0,0x1                                                                                     
001548   e107     BNZ       0x1558                                                                                          
00154a   0100     MOVLB     0x0            						accel_time = 0;                                                            C:\fw\midicontroller\x014\controller.c
00154c   6bfb     CLRF      0xfb,0x1                                                                                        
00154e   6bfc     CLRF      0xfc,0x1                                                                                        
001550   6bfd     CLRF      0xfd,0x1       						accel_count = 0;                                                           C:\fw\midicontroller\x014\controller.c
001552   0101     MOVLB     0x1            						accel_state = ACCEL_INC_SLOW;                                              C:\fw\midicontroller\x014\controller.c
001554   0e01     MOVLW     0x1                                                                                             
001556   6f0d     MOVWF     0xd,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* INC released: */                                                         C:\fw\midicontroller\x014\controller.c
001558   0e00     MOVLW     0x0            					if (button_released(FSM_INC)) {                                             C:\fw\midicontroller\x014\controller.c
00155a   6ee6     MOVWF     0xe6,0x0                                                                                        
00155c   6ae6     CLRF      0xe6,0x0                                                                                        
00155e   dc6d     RCALL     0xe3a                                                                                           
001560   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001562   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001564   0900     IORLW     0x0                                                                                             
001566   e00c     BZ        0x1580                                                                                          
001568   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             C:\fw\midicontroller\x014\controller.c
00156a   0e00     MOVLW     0x0                                                                                             
00156c   80d8     BSF       0xd8,0x0,0x0                                                                                    
00156e   5509     SUBFWB    0x9,0x0,0x1                                                                                     
001570   0e00     MOVLW     0x0                                                                                             
001572   550a     SUBFWB    0xa,0x0,0x1                                                                                     
001574   e202     BC        0x157a                                                                                          
001576   dd93     RCALL     0x109e         							inc_practice_value();                                                     C:\fw\midicontroller\x014\controller.c
001578   ddce     RCALL     0x1116         							notify_practice_value();                                                  C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
00157a   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  C:\fw\midicontroller\x014\controller.c
00157c   6b0d     CLRF      0xd,0x1                                                                                         
00157e   ddd2     RCALL     0x1124         						activate_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           					/* DEC pressed: */                                                          C:\fw\midicontroller\x014\controller.c
001580   0e00     MOVLW     0x0            					if (button_pressed(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x014\controller.c
001582   6ee6     MOVWF     0xe6,0x0                                                                                        
001584   6ae6     CLRF      0xe6,0x0                                                                                        
001586   dc0a     RCALL     0xd9c                                                                                           
001588   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00158a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00158c   0900     IORLW     0x0                                                                                             
00158e   e00f     BZ        0x15ae                                                                                          
001590   0e00     MOVLW     0x0                                                                                             
001592   6ee6     MOVWF     0xe6,0x0                                                                                        
001594   6ae6     CLRF      0xe6,0x0                                                                                        
001596   dc31     RCALL     0xdfa                                                                                           
001598   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00159a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00159c   0900     IORLW     0x0                                                                                             
00159e   e107     BNZ       0x15ae                                                                                          
0015a0   0101     MOVLB     0x1                                                                                             
0015a2   5109     MOVF      0x9,0x0,0x1                                                                                     
0015a4   110a     IORWF     0xa,0x0,0x1                                                                                     
0015a6   e103     BNZ       0x15ae                                                                                          
                                           						/* DEC pushed first */                                                     C:\fw\midicontroller\x014\controller.c
0015a8   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  C:\fw\midicontroller\x014\controller.c
0015aa   6f09     MOVWF     0x9,0x1                                                                                         
0015ac   6b0a     CLRF      0xa,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* Still holding DEC alone after ~300 ms: */                                C:\fw\midicontroller\x014\controller.c
0015ae   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x014\controller.c
0015b0   510d     MOVF      0xd,0x0,0x1                                                                                     
0015b2   e11b     BNZ       0x15ea                                                                                          
0015b4   0e00     MOVLW     0x0                                                                                             
0015b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0015b8   6ae6     CLRF      0xe6,0x0                                                                                        
0015ba   dc1f     RCALL     0xdfa                                                                                           
0015bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c0   0900     IORLW     0x0                                                                                             
0015c2   e013     BZ        0x15ea                                                                                          
0015c4   0e00     MOVLW     0x0                                                                                             
0015c6   6ee6     MOVWF     0xe6,0x0                                                                                        
0015c8   6ae6     CLRF      0xe6,0x0                                                                                        
0015ca   dc17     RCALL     0xdfa                                                                                           
0015cc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015d0   0900     IORLW     0x0                                                                                             
0015d2   e10b     BNZ       0x15ea                                                                                          
0015d4   0101     MOVLB     0x1                                                                                             
0015d6   5109     MOVF      0x9,0x0,0x1                                                                                     
0015d8   110a     IORWF     0xa,0x0,0x1                                                                                     
0015da   e107     BNZ       0x15ea                                                                                          
0015dc   0100     MOVLB     0x0            						accel_time = 0;                                                            C:\fw\midicontroller\x014\controller.c
0015de   6bfb     CLRF      0xfb,0x1                                                                                        
0015e0   6bfc     CLRF      0xfc,0x1                                                                                        
0015e2   6bfd     CLRF      0xfd,0x1       						accel_count = 0;                                                           C:\fw\midicontroller\x014\controller.c
0015e4   0101     MOVLB     0x1            						accel_state = ACCEL_DEC_SLOW;                                              C:\fw\midicontroller\x014\controller.c
0015e6   0e04     MOVLW     0x4                                                                                             
0015e8   6f0d     MOVWF     0xd,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* DEC released: */                                                         C:\fw\midicontroller\x014\controller.c
0015ea   0e00     MOVLW     0x0            					if (button_released(FSM_DEC)) {                                             C:\fw\midicontroller\x014\controller.c
0015ec   6ee6     MOVWF     0xe6,0x0                                                                                        
0015ee   6ae6     CLRF      0xe6,0x0                                                                                        
0015f0   dc24     RCALL     0xe3a                                                                                           
0015f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015f6   0900     IORLW     0x0                                                                                             
0015f8   e00c     BZ        0x1612                                                                                          
0015fa   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             C:\fw\midicontroller\x014\controller.c
0015fc   0e00     MOVLW     0x0                                                                                             
0015fe   80d8     BSF       0xd8,0x0,0x0                                                                                    
001600   5509     SUBFWB    0x9,0x0,0x1                                                                                     
001602   0e00     MOVLW     0x0                                                                                             
001604   550a     SUBFWB    0xa,0x0,0x1                                                                                     
001606   e202     BC        0x160c                                                                                          
001608   dd6a     RCALL     0x10de         							dec_practice_value();                                                     C:\fw\midicontroller\x014\controller.c
00160a   dd85     RCALL     0x1116         							notify_practice_value();                                                  C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
00160c   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  C:\fw\midicontroller\x014\controller.c
00160e   6b0d     CLRF      0xd,0x1                                                                                         
001610   dd89     RCALL     0x1124         						activate_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           					/* ENTER pressed */                                                         C:\fw\midicontroller\x014\controller.c
001612   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            C:\fw\midicontroller\x014\controller.c
001614   6ee6     MOVWF     0xe6,0x0                                                                                        
001616   6ae6     CLRF      0xe6,0x0                                                                                        
001618   ecce     CALL      0xd9c,0x0                                                                                       
00161a   f006                                                                                                               
00161c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00161e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001620   0900     IORLW     0x0                                                                                             
001622   e004     BZ        0x162c                                                                                          
001624   0e1e     MOVLW     0x1e           						cdtimer_holdenter = 30;                                                    C:\fw\midicontroller\x014\controller.c
001626   0101     MOVLB     0x1                                                                                             
001628   6f0b     MOVWF     0xb,0x1                                                                                         
00162a   6b0c     CLRF      0xc,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* ENTER held at least ~300msec: */                                         C:\fw\midicontroller\x014\controller.c
00162c   0e00     MOVLW     0x0            					if (button_held(FSM_ENTER) && (cdtimer_holdenter == 0) && (program_mode == PROGRAM_NONE)) { C:\fw\midicontroller\x014\controller.c
00162e   6ee6     MOVWF     0xe6,0x0                                                                                        
001630   6ae6     CLRF      0xe6,0x0                                                                                        
001632   ecfd     CALL      0xdfa,0x0                                                                                       
001634   f006                                                                                                               
001636   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001638   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00163a   0900     IORLW     0x0                                                                                             
00163c   e00e     BZ        0x165a                                                                                          
00163e   0101     MOVLB     0x1                                                                                             
001640   510b     MOVF      0xb,0x0,0x1                                                                                     
001642   110c     IORWF     0xc,0x0,0x1                                                                                     
001644   e10a     BNZ       0x165a                                                                                          
001646   510f     MOVF      0xf,0x0,0x1                                                                                     
001648   e108     BNZ       0x165a                                                                                          
                                           						/* enter sequence program mode */                                          C:\fw\midicontroller\x014\controller.c
00164a   0e01     MOVLW     0x1            						program_mode = PROGRAM_SEQUENCE;                                           C:\fw\midicontroller\x014\controller.c
00164c   6f0f     MOVWF     0xf,0x1                                                                                         
00164e   0100     MOVLB     0x0            						curr_mapindex = 0;                                                         C:\fw\midicontroller\x014\controller.c
001650   6bf2     CLRF      0xf2,0x1                                                                                        
001652   0e04     MOVLW     0x4            						curr_preset = 4;                                                           C:\fw\midicontroller\x014\controller.c
001654   6ff1     MOVWF     0xf1,0x1                                                                                        
001656   ec9f     CALL      0xd3e,0x0      						sortedbank_showname();                                                     C:\fw\midicontroller\x014\controller.c
001658   f006                                                                                                               
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           					/* ENTER released before ~300msec was up: */                                C:\fw\midicontroller\x014\controller.c
00165a   0e00     MOVLW     0x0            					if (button_released(FSM_ENTER) && (cdtimer_holdenter > 0)) {                C:\fw\midicontroller\x014\controller.c
00165c   6ee6     MOVWF     0xe6,0x0                                                                                        
00165e   6ae6     CLRF      0xe6,0x0                                                                                        
001660   ec1d     CALL      0xe3a,0x0                                                                                       
001662   f007                                                                                                               
001664   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001666   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001668   0900     IORLW     0x0                                                                                             
00166a   e019     BZ        0x169e                                                                                          
00166c   0101     MOVLB     0x1                                                                                             
00166e   0e00     MOVLW     0x0                                                                                             
001670   80d8     BSF       0xd8,0x0,0x0                                                                                    
001672   550b     SUBFWB    0xb,0x0,0x1                                                                                     
001674   0e00     MOVLW     0x0                                                                                             
001676   550c     SUBFWB    0xc,0x0,0x1                                                                                     
001678   e212     BC        0x169e                                                                                          
00167a   5121     MOVF      0x21,0x0,0x1   						if (incdec_mode == 0) {                                                    C:\fw\midicontroller\x014\controller.c
00167c   e109     BNZ       0x1690                                                                                          
                                           							/* program-select mode */                                                 C:\fw\midicontroller\x014\controller.c
00167e   0e01     MOVLW     0x1            							incdec_mode = 1;                                                          C:\fw\midicontroller\x014\controller.c
001680   6f21     MOVWF     0x21,0x1                                                                                        
001682   0e03     MOVLW     0x3            							flash_state = FLASH_PRGM_SELECT_MODE;                                     C:\fw\midicontroller\x014\controller.c
001684   6f0e     MOVWF     0xe,0x1                                                                                         
001686   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      C:\fw\midicontroller\x014\controller.c
001688   6f05     MOVWF     0x5,0x1                                                                                         
00168a   6b06     CLRF      0x6,0x1                                                                                         
00168c   dd44     RCALL     0x1116         							notify_practice_value();                                                  C:\fw\midicontroller\x014\controller.c
00168e   d007     BRA       0x169e         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
                                           							/* bank-select mode by alphabetical order */                              C:\fw\midicontroller\x014\controller.c
001690   6b21     CLRF      0x21,0x1       							incdec_mode = 0;                                                          C:\fw\midicontroller\x014\controller.c
001692   0e02     MOVLW     0x2            							flash_state = FLASH_BANK_SELECT_MODE;                                     C:\fw\midicontroller\x014\controller.c
001694   6f0e     MOVWF     0xe,0x1                                                                                         
001696   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      C:\fw\midicontroller\x014\controller.c
001698   6f05     MOVWF     0x5,0x1                                                                                         
00169a   6b06     CLRF      0x6,0x1                                                                                         
00169c   dd3c     RCALL     0x1116         							notify_practice_value();                                                  C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           					/* acceleration countdown timer hit 0 and we're incrementing slowly */      C:\fw\midicontroller\x014\controller.c
00169e   0101     MOVLB     0x1            					if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                     C:\fw\midicontroller\x014\controller.c
0016a0   510d     MOVF      0xd,0x0,0x1                                                                                     
0016a2   e075     BZ        0x178e                                                                                          
0016a4   0100     MOVLB     0x0                                                                                             
0016a6   51fb     MOVF      0xfb,0x0,0x1                                                                                    
0016a8   11fc     IORWF     0xfc,0x0,0x1                                                                                    
0016aa   e171     BNZ       0x178e                                                                                          
0016ac   0101     MOVLB     0x1            						switch (accel_state) {                                                     C:\fw\midicontroller\x014\controller.c
0016ae   510d     MOVF      0xd,0x0,0x1                                                                                     
0016b0   0a06     XORLW     0x6                                                                                             
0016b2   e066     BZ        0x1780                                                                                          
0016b4   0a03     XORLW     0x3                                                                                             
0016b6   e04f     BZ        0x1756                                                                                          
0016b8   0a01     XORLW     0x1                                                                                             
0016ba   e038     BZ        0x172c                                                                                          
0016bc   0a07     XORLW     0x7                                                                                             
0016be   e02f     BZ        0x171e                                                                                          
0016c0   0a01     XORLW     0x1                                                                                             
0016c2   e018     BZ        0x16f4                                                                                          
0016c4   0a03     XORLW     0x3                                                                                             
0016c6   e001     BZ        0x16ca                                                                                          
0016c8   d062     BRA       0x178e                                                                                          
                                           							case ACCEL_INC_SLOW:                                                      C:\fw\midicontroller\x014\controller.c
0016ca   dce9     RCALL     0x109e         								inc_practice_value();                                                    C:\fw\midicontroller\x014\controller.c
0016cc   dd24     RCALL     0x1116         								notify_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x014\controller.c
0016ce   0100     MOVLB     0x0            								if (accel_count++ == 5) {                                                C:\fw\midicontroller\x014\controller.c
0016d0   51fd     MOVF      0xfd,0x0,0x1                                                                                    
0016d2   2bfd     INCF      0xfd,0x1,0x1                                                                                    
0016d4   0805     SUBLW     0x5                                                                                             
0016d6   e109     BNZ       0x16ea                                                                                          
0016d8   6bfd     CLRF      0xfd,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x014\controller.c
0016da   0101     MOVLB     0x1            									accel_state = ACCEL_INC_MEDIUM;                                         C:\fw\midicontroller\x014\controller.c
0016dc   0e02     MOVLW     0x2                                                                                             
0016de   6f0d     MOVWF     0xd,0x1                                                                                         
0016e0   c113     MOVFF     0x113,0xfb     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x014\controller.c
0016e2   f0fb                                                                                                               
0016e4   c114     MOVFF     0x114,0xfc                                                                                      
0016e6   f0fc                                                                                                               
0016e8   d004     BRA       0x16f2         								} else {                                                                 C:\fw\midicontroller\x014\controller.c
0016ea   c111     MOVFF     0x111,0xfb     									accel_time = accel_time_slow;                                           C:\fw\midicontroller\x014\controller.c
0016ec   f0fb                                                                                                               
0016ee   c112     MOVFF     0x112,0xfc                                                                                      
0016f0   f0fc                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x014\controller.c
0016f2   d04d     BRA       0x178e         								break;                                                                   C:\fw\midicontroller\x014\controller.c
                                           							case ACCEL_INC_MEDIUM:                                                    C:\fw\midicontroller\x014\controller.c
0016f4   dcd4     RCALL     0x109e         								inc_practice_value();                                                    C:\fw\midicontroller\x014\controller.c
0016f6   dd0f     RCALL     0x1116         								notify_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x014\controller.c
0016f8   0100     MOVLB     0x0            								if (accel_count++ == 20) {                                               C:\fw\midicontroller\x014\controller.c
0016fa   51fd     MOVF      0xfd,0x0,0x1                                                                                    
0016fc   2bfd     INCF      0xfd,0x1,0x1                                                                                    
0016fe   0814     SUBLW     0x14                                                                                            
001700   e109     BNZ       0x1714                                                                                          
001702   6bfd     CLRF      0xfd,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x014\controller.c
001704   0101     MOVLB     0x1            									accel_state = ACCEL_INC_FAST;                                           C:\fw\midicontroller\x014\controller.c
001706   0e03     MOVLW     0x3                                                                                             
001708   6f0d     MOVWF     0xd,0x1                                                                                         
00170a   c115     MOVFF     0x115,0xfb     									accel_time = accel_time_fast;                                           C:\fw\midicontroller\x014\controller.c
00170c   f0fb                                                                                                               
00170e   c116     MOVFF     0x116,0xfc                                                                                      
001710   f0fc                                                                                                               
001712   d004     BRA       0x171c         								} else {                                                                 C:\fw\midicontroller\x014\controller.c
001714   c113     MOVFF     0x113,0xfb     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x014\controller.c
001716   f0fb                                                                                                               
001718   c114     MOVFF     0x114,0xfc                                                                                      
00171a   f0fc                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x014\controller.c
00171c   d038     BRA       0x178e         								break;                                                                   C:\fw\midicontroller\x014\controller.c
                                           							case ACCEL_INC_FAST:                                                      C:\fw\midicontroller\x014\controller.c
00171e   dcbf     RCALL     0x109e         								inc_practice_value();                                                    C:\fw\midicontroller\x014\controller.c
001720   dcfa     RCALL     0x1116         								notify_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
001722   c115     MOVFF     0x115,0xfb     								accel_time = accel_time_fast;                                            C:\fw\midicontroller\x014\controller.c
001724   f0fb                                                                                                               
001726   c116     MOVFF     0x116,0xfc                                                                                      
001728   f0fc                                                                                                               
00172a   d031     BRA       0x178e         								break;                                                                   C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           							case ACCEL_DEC_SLOW:                                                      C:\fw\midicontroller\x014\controller.c
00172c   dcd8     RCALL     0x10de         								dec_practice_value();                                                    C:\fw\midicontroller\x014\controller.c
00172e   dcf3     RCALL     0x1116         								notify_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x014\controller.c
001730   0100     MOVLB     0x0            								if (accel_count++ == 5) {                                                C:\fw\midicontroller\x014\controller.c
001732   51fd     MOVF      0xfd,0x0,0x1                                                                                    
001734   2bfd     INCF      0xfd,0x1,0x1                                                                                    
001736   0805     SUBLW     0x5                                                                                             
001738   e109     BNZ       0x174c                                                                                          
00173a   6bfd     CLRF      0xfd,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x014\controller.c
00173c   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_MEDIUM;                                         C:\fw\midicontroller\x014\controller.c
00173e   0e05     MOVLW     0x5                                                                                             
001740   6f0d     MOVWF     0xd,0x1                                                                                         
001742   c113     MOVFF     0x113,0xfb     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x014\controller.c
001744   f0fb                                                                                                               
001746   c114     MOVFF     0x114,0xfc                                                                                      
001748   f0fc                                                                                                               
00174a   d004     BRA       0x1754         								} else {                                                                 C:\fw\midicontroller\x014\controller.c
00174c   c111     MOVFF     0x111,0xfb     									accel_time = accel_time_slow;                                           C:\fw\midicontroller\x014\controller.c
00174e   f0fb                                                                                                               
001750   c112     MOVFF     0x112,0xfc                                                                                      
001752   f0fc                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x014\controller.c
001754   d01c     BRA       0x178e         								break;                                                                   C:\fw\midicontroller\x014\controller.c
                                           							case ACCEL_DEC_MEDIUM:                                                    C:\fw\midicontroller\x014\controller.c
001756   dcc3     RCALL     0x10de         								dec_practice_value();                                                    C:\fw\midicontroller\x014\controller.c
001758   dcde     RCALL     0x1116         								notify_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x014\controller.c
00175a   0100     MOVLB     0x0            								if (accel_count++ == 20) {                                               C:\fw\midicontroller\x014\controller.c
00175c   51fd     MOVF      0xfd,0x0,0x1                                                                                    
00175e   2bfd     INCF      0xfd,0x1,0x1                                                                                    
001760   0814     SUBLW     0x14                                                                                            
001762   e109     BNZ       0x1776                                                                                          
001764   6bfd     CLRF      0xfd,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x014\controller.c
001766   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_FAST;                                           C:\fw\midicontroller\x014\controller.c
001768   0e06     MOVLW     0x6                                                                                             
00176a   6f0d     MOVWF     0xd,0x1                                                                                         
00176c   c115     MOVFF     0x115,0xfb     									accel_time = accel_time_fast;                                           C:\fw\midicontroller\x014\controller.c
00176e   f0fb                                                                                                               
001770   c116     MOVFF     0x116,0xfc                                                                                      
001772   f0fc                                                                                                               
001774   d004     BRA       0x177e         								} else {                                                                 C:\fw\midicontroller\x014\controller.c
001776   c113     MOVFF     0x113,0xfb     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x014\controller.c
001778   f0fb                                                                                                               
00177a   c114     MOVFF     0x114,0xfc                                                                                      
00177c   f0fc                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x014\controller.c
00177e   d007     BRA       0x178e         								break;                                                                   C:\fw\midicontroller\x014\controller.c
                                           							case ACCEL_DEC_FAST:                                                      C:\fw\midicontroller\x014\controller.c
001780   dcae     RCALL     0x10de         								dec_practice_value();                                                    C:\fw\midicontroller\x014\controller.c
001782   dcc9     RCALL     0x1116         								notify_practice_value();                                                 C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
001784   c115     MOVFF     0x115,0xfb     								accel_time = accel_time_fast;                                            C:\fw\midicontroller\x014\controller.c
001786   f0fb                                                                                                               
001788   c116     MOVFF     0x116,0xfc                                                                                      
00178a   f0fc                                                                                                               
00178c   d000     BRA       0x178e         								break;                                                                   C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
00178e   d0d0     BRA       0x1930         					break;                                                                      C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           				/* sequence programming mode: */                                             C:\fw\midicontroller\x014\controller.c
                                           				case PROGRAM_SEQUENCE:                                                       C:\fw\midicontroller\x014\controller.c
                                           					/* one of preset 1-4 pressed: */                                            C:\fw\midicontroller\x014\controller.c
001790   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         C:\fw\midicontroller\x014\controller.c
001792   6ee6     MOVWF     0xe6,0x0                                                                                        
001794   6ae6     CLRF      0xe6,0x0                                                                                        
001796   ecce     CALL      0xd9c,0x0                                                                                       
001798   f006                                                                                                               
00179a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00179c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00179e   0900     IORLW     0x0                                                                                             
0017a0   e01a     BZ        0x17d6                                                                                          
0017a2   0100     MOVLB     0x0            						if (curr_preset != 0) {                                                    C:\fw\midicontroller\x014\controller.c
0017a4   51f1     MOVF      0xf1,0x0,0x1                                                                                    
0017a6   e017     BZ        0x17d6                                                                                          
0017a8   6bf1     CLRF      0xf1,0x1       							curr_preset = 0;                                                          C:\fw\midicontroller\x014\controller.c
0017aa   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
0017ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0017ae   ecf7     CALL      0xbee,0x0                                                                                       
0017b0   f005                                                                                                               
0017b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017b4   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x014\controller.c
0017b6   51f2     MOVF      0xf2,0x0,0x1                                                                                    
0017b8   2bf2     INCF      0xf2,0x1,0x1                                                                                    
0017ba   6aea     CLRF      0xea,0x0                                                                                        
0017bc   0fe3     ADDLW     0xe3                                                                                            
0017be   6ee9     MOVWF     0xe9,0x0                                                                                        
0017c0   0e00     MOVLW     0x0                                                                                             
0017c2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0017c4   c0f1     MOVFF     0xf1,0xfef                                                                                      
0017c6   ffef                                                                                                               
0017c8   ec15     CALL      0xc2a,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x014\controller.c
0017ca   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x014\controller.c
0017cc   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x014\controller.c
0017ce   0100     MOVLB     0x0                                                                                             
0017d0   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
0017d2   e101     BNZ       0x17d6                                                                                          
0017d4   dcb3     RCALL     0x113c         								sequence_complete();                                                     C:\fw\midicontroller\x014\controller.c
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
0017d6   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         C:\fw\midicontroller\x014\controller.c
0017d8   6ee6     MOVWF     0xe6,0x0                                                                                        
0017da   6ae6     CLRF      0xe6,0x0                                                                                        
0017dc   ecce     CALL      0xd9c,0x0                                                                                       
0017de   f006                                                                                                               
0017e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017e4   0900     IORLW     0x0                                                                                             
0017e6   e01a     BZ        0x181c                                                                                          
0017e8   0100     MOVLB     0x0            						if (curr_preset != 1) {                                                    C:\fw\midicontroller\x014\controller.c
0017ea   05f1     DECF      0xf1,0x0,0x1                                                                                    
0017ec   e017     BZ        0x181c                                                                                          
0017ee   0e01     MOVLW     0x1            							curr_preset = 1;                                                          C:\fw\midicontroller\x014\controller.c
0017f0   6ff1     MOVWF     0xf1,0x1                                                                                        
0017f2   6ee6     MOVWF     0xe6,0x0       							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
0017f4   ecf7     CALL      0xbee,0x0                                                                                       
0017f6   f005                                                                                                               
0017f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017fa   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x014\controller.c
0017fc   51f2     MOVF      0xf2,0x0,0x1                                                                                    
0017fe   2bf2     INCF      0xf2,0x1,0x1                                                                                    
001800   6aea     CLRF      0xea,0x0                                                                                        
001802   0fe3     ADDLW     0xe3                                                                                            
001804   6ee9     MOVWF     0xe9,0x0                                                                                        
001806   0e00     MOVLW     0x0                                                                                             
001808   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00180a   c0f1     MOVFF     0xf1,0xfef                                                                                      
00180c   ffef                                                                                                               
00180e   ec15     CALL      0xc2a,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x014\controller.c
001810   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x014\controller.c
001812   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x014\controller.c
001814   0100     MOVLB     0x0                                                                                             
001816   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
001818   e101     BNZ       0x181c                                                                                          
00181a   dc90     RCALL     0x113c         								sequence_complete();                                                     C:\fw\midicontroller\x014\controller.c
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
00181c   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         C:\fw\midicontroller\x014\controller.c
00181e   6ee6     MOVWF     0xe6,0x0                                                                                        
001820   6ae6     CLRF      0xe6,0x0                                                                                        
001822   ecce     CALL      0xd9c,0x0                                                                                       
001824   f006                                                                                                               
001826   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001828   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00182a   0900     IORLW     0x0                                                                                             
00182c   e01c     BZ        0x1866                                                                                          
00182e   0e02     MOVLW     0x2            						if (curr_preset != 2) {                                                    C:\fw\midicontroller\x014\controller.c
001830   0100     MOVLB     0x0                                                                                             
001832   5df1     SUBWF     0xf1,0x0,0x1                                                                                    
001834   e018     BZ        0x1866                                                                                          
001836   0e02     MOVLW     0x2            							curr_preset = 2;                                                          C:\fw\midicontroller\x014\controller.c
001838   6ff1     MOVWF     0xf1,0x1                                                                                        
00183a   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
00183c   6ee6     MOVWF     0xe6,0x0                                                                                        
00183e   ecf7     CALL      0xbee,0x0                                                                                       
001840   f005                                                                                                               
001842   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001844   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x014\controller.c
001846   51f2     MOVF      0xf2,0x0,0x1                                                                                    
001848   2bf2     INCF      0xf2,0x1,0x1                                                                                    
00184a   6aea     CLRF      0xea,0x0                                                                                        
00184c   0fe3     ADDLW     0xe3                                                                                            
00184e   6ee9     MOVWF     0xe9,0x0                                                                                        
001850   0e00     MOVLW     0x0                                                                                             
001852   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001854   c0f1     MOVFF     0xf1,0xfef                                                                                      
001856   ffef                                                                                                               
001858   ec15     CALL      0xc2a,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x014\controller.c
00185a   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x014\controller.c
00185c   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x014\controller.c
00185e   0100     MOVLB     0x0                                                                                             
001860   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
001862   e101     BNZ       0x1866                                                                                          
001864   dc6b     RCALL     0x113c         								sequence_complete();                                                     C:\fw\midicontroller\x014\controller.c
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
001866   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         C:\fw\midicontroller\x014\controller.c
001868   6ee6     MOVWF     0xe6,0x0                                                                                        
00186a   6ae6     CLRF      0xe6,0x0                                                                                        
00186c   ecce     CALL      0xd9c,0x0                                                                                       
00186e   f006                                                                                                               
001870   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001872   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001874   0900     IORLW     0x0                                                                                             
001876   e01c     BZ        0x18b0                                                                                          
001878   0e03     MOVLW     0x3            						if (curr_preset != 3) {                                                    C:\fw\midicontroller\x014\controller.c
00187a   0100     MOVLB     0x0                                                                                             
00187c   5df1     SUBWF     0xf1,0x0,0x1                                                                                    
00187e   e018     BZ        0x18b0                                                                                          
001880   0e03     MOVLW     0x3            							curr_preset = 3;                                                          C:\fw\midicontroller\x014\controller.c
001882   6ff1     MOVWF     0xf1,0x1                                                                                        
001884   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
001886   6ee6     MOVWF     0xe6,0x0                                                                                        
001888   ecf7     CALL      0xbee,0x0                                                                                       
00188a   f005                                                                                                               
00188c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188e   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x014\controller.c
001890   51f2     MOVF      0xf2,0x0,0x1                                                                                    
001892   2bf2     INCF      0xf2,0x1,0x1                                                                                    
001894   6aea     CLRF      0xea,0x0                                                                                        
001896   0fe3     ADDLW     0xe3                                                                                            
001898   6ee9     MOVWF     0xe9,0x0                                                                                        
00189a   0e00     MOVLW     0x0                                                                                             
00189c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00189e   c0f1     MOVFF     0xf1,0xfef                                                                                      
0018a0   ffef                                                                                                               
0018a2   ec15     CALL      0xc2a,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x014\controller.c
0018a4   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x014\controller.c
0018a6   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x014\controller.c
0018a8   0100     MOVLB     0x0                                                                                             
0018aa   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
0018ac   e101     BNZ       0x18b0                                                                                          
0018ae   dc46     RCALL     0x113c         								sequence_complete();                                                     C:\fw\midicontroller\x014\controller.c
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           					/* ENTER pressed */                                                         C:\fw\midicontroller\x014\controller.c
0018b0   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            C:\fw\midicontroller\x014\controller.c
0018b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0018b4   6ae6     CLRF      0xe6,0x0                                                                                        
0018b6   ecce     CALL      0xd9c,0x0                                                                                       
0018b8   f006                                                                                                               
0018ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018be   0900     IORLW     0x0                                                                                             
0018c0   e001     BZ        0x18c4                                                                                          
                                           						/* stop programming early and save the sequence: */                        C:\fw\midicontroller\x014\controller.c
0018c2   dc3c     RCALL     0x113c         						sequence_complete();                                                       C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
0018c4   d035     BRA       0x1930         					break;                                                                      C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           				/* sequence repeat mode: */                                                  C:\fw\midicontroller\x014\controller.c
                                           				case PROGRAM_COMPLETE:                                                       C:\fw\midicontroller\x014\controller.c
0018c6   510b     MOVF      0xb,0x0,0x1    					if (cdtimer_holdenter == 0) {                                               C:\fw\midicontroller\x014\controller.c
0018c8   110c     IORWF     0xc,0x0,0x1                                                                                     
0018ca   e131     BNZ       0x192e                                                                                          
0018cc   0100     MOVLB     0x0            						if (curr_mapindex == bankmap_count) {                                      C:\fw\midicontroller\x014\controller.c
0018ce   51eb     MOVF      0xeb,0x0,0x1                                                                                    
0018d0   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
0018d2   e10a     BNZ       0x18e8                                                                                          
                                           							/* we're done! */                                                         C:\fw\midicontroller\x014\controller.c
0018d4   0101     MOVLB     0x1            							program_mode = PROGRAM_NONE;                                              C:\fw\midicontroller\x014\controller.c
0018d6   6b0f     CLRF      0xf,0x1                                                                                         
0018d8   0100     MOVLB     0x0            							curr_mapindex = 0;                                                        C:\fw\midicontroller\x014\controller.c
0018da   6bf2     CLRF      0xf2,0x1                                                                                        
0018dc   0e01     MOVLW     0x1            							bankmap_activate(1);                                                      C:\fw\midicontroller\x014\controller.c
0018de   6ee6     MOVWF     0xe6,0x0                                                                                        
0018e0   ec1c     CALL      0xc38,0x0                                                                                       
0018e2   f006                                                                                                               
0018e4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018e6   d023     BRA       0x192e         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
                                           							/* set the next LED active */                                             C:\fw\midicontroller\x014\controller.c
0018e8   ec15     CALL      0xc2a,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x014\controller.c
0018ea   f006                                                                                                               
0018ec   0100     MOVLB     0x0            							curr_preset = bankmap[curr_mapindex];                                     C:\fw\midicontroller\x014\controller.c
0018ee   51f2     MOVF      0xf2,0x0,0x1                                                                                    
0018f0   6aea     CLRF      0xea,0x0                                                                                        
0018f2   0fe3     ADDLW     0xe3                                                                                            
0018f4   6ee9     MOVWF     0xe9,0x0                                                                                        
0018f6   0e00     MOVLW     0x0                                                                                             
0018f8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0018fa   cfef     MOVFF     0xfef,0xf1                                                                                      
0018fc   f0f1                                                                                                               
0018fe   51f1     MOVF      0xf1,0x0,0x1   							fsw_led_set_active(curr_preset);                                          C:\fw\midicontroller\x014\controller.c
001900   6ee6     MOVWF     0xe6,0x0                                                                                        
001902   6ae6     CLRF      0xe6,0x0                                                                                        
001904   ec2d     CALL      0x265a,0x0                                                                                      
001906   f013                                                                                                               
001908   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00190a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00190c   0100     MOVLB     0x0            							curr_program = bank[curr_preset];                                         C:\fw\midicontroller\x014\controller.c
00190e   51f1     MOVF      0xf1,0x0,0x1                                                                                    
001910   6aea     CLRF      0xea,0x0                                                                                        
001912   0fdb     ADDLW     0xdb                                                                                            
001914   6ee9     MOVWF     0xe9,0x0                                                                                        
001916   0e00     MOVLW     0x0                                                                                             
001918   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00191a   cfef     MOVFF     0xfef,0xf0                                                                                      
00191c   f0f0                                                                                                               
00191e   ecb7     CALL      0xb6e,0x0      							show_program();                                                           C:\fw\midicontroller\x014\controller.c
001920   f005                                                                                                               
001922   0100     MOVLB     0x0            							++curr_mapindex;                                                          C:\fw\midicontroller\x014\controller.c
001924   2bf2     INCF      0xf2,0x1,0x1                                                                                    
001926   0e32     MOVLW     0x32           							cdtimer_holdenter = 50;                                                   C:\fw\midicontroller\x014\controller.c
001928   0101     MOVLB     0x1                                                                                             
00192a   6f0b     MOVWF     0xb,0x1                                                                                         
00192c   6b0c     CLRF      0xc,0x1                                                                                         
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
00192e   d000     BRA       0x1930         					break;                                                                      C:\fw\midicontroller\x014\controller.c
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
001930   d1ea     BRA       0x1d06         			break;                                                                        C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           		case MODE_CONCERT:                                                             C:\fw\midicontroller\x014\controller.c
                                           			/*                                                                            C:\fw\midicontroller\x014\controller.c
                                           				next/prev buttons move bank map index pointer up/down by 1, cycling up/down bank # when bank C:\fw\midicontroller\x014\controller.c
                                           				map boundaries are crossed.  Single-digit 7-segment display shows map index # as 1-8. C:\fw\midicontroller\x014\controller.c
                                           				inc/dec buttons move through banks, resetting bank map index to 0.  Bank name displays on 4-digit display. C:\fw\midicontroller\x014\controller.c
                                           				preset button 1-4: change program # immediately, showing program # on 4-digit display for .5 sec, C:\fw\midicontroller\x014\controller.c
                                           				reverting display back to bank name.                                         C:\fw\midicontroller\x014\controller.c
                                           			*/                                                                            C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           			/* one of preset 1-4 pressed: */                                              C:\fw\midicontroller\x014\controller.c
001932   0e01     MOVLW     0x1            			if (button_pressed(FSM_PRESET_1)) {                                           C:\fw\midicontroller\x014\controller.c
001934   6ee6     MOVWF     0xe6,0x0                                                                                        
001936   6ae6     CLRF      0xe6,0x0                                                                                        
001938   ecce     CALL      0xd9c,0x0                                                                                       
00193a   f006                                                                                                               
00193c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00193e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001940   0900     IORLW     0x0                                                                                             
001942   e007     BZ        0x1952                                                                                          
001944   0100     MOVLB     0x0            				curr_preset = 0;                                                             C:\fw\midicontroller\x014\controller.c
001946   6bf1     CLRF      0xf1,0x1                                                                                        
001948   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x014\controller.c
00194a   6ee6     MOVWF     0xe6,0x0                                                                                        
00194c   ecf7     CALL      0xbee,0x0                                                                                       
00194e   f005                                                                                                               
001950   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
001952   0e02     MOVLW     0x2            			if (button_pressed(FSM_PRESET_2)) {                                           C:\fw\midicontroller\x014\controller.c
001954   6ee6     MOVWF     0xe6,0x0                                                                                        
001956   6ae6     CLRF      0xe6,0x0                                                                                        
001958   ecce     CALL      0xd9c,0x0                                                                                       
00195a   f006                                                                                                               
00195c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00195e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001960   0900     IORLW     0x0                                                                                             
001962   e007     BZ        0x1972                                                                                          
001964   0100     MOVLB     0x0            				curr_preset = 1;                                                             C:\fw\midicontroller\x014\controller.c
001966   0e01     MOVLW     0x1                                                                                             
001968   6ff1     MOVWF     0xf1,0x1                                                                                        
00196a   6ee6     MOVWF     0xe6,0x0       				preset_activate(1);                                                          C:\fw\midicontroller\x014\controller.c
00196c   ecf7     CALL      0xbee,0x0                                                                                       
00196e   f005                                                                                                               
001970   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
001972   0e04     MOVLW     0x4            			if (button_pressed(FSM_PRESET_3)) {                                           C:\fw\midicontroller\x014\controller.c
001974   6ee6     MOVWF     0xe6,0x0                                                                                        
001976   6ae6     CLRF      0xe6,0x0                                                                                        
001978   ecce     CALL      0xd9c,0x0                                                                                       
00197a   f006                                                                                                               
00197c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00197e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001980   0900     IORLW     0x0                                                                                             
001982   e008     BZ        0x1994                                                                                          
001984   0100     MOVLB     0x0            				curr_preset = 2;                                                             C:\fw\midicontroller\x014\controller.c
001986   0e02     MOVLW     0x2                                                                                             
001988   6ff1     MOVWF     0xf1,0x1                                                                                        
00198a   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x014\controller.c
00198c   6ee6     MOVWF     0xe6,0x0                                                                                        
00198e   ecf7     CALL      0xbee,0x0                                                                                       
001990   f005                                                                                                               
001992   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
001994   0e08     MOVLW     0x8            			if (button_pressed(FSM_PRESET_4)) {                                           C:\fw\midicontroller\x014\controller.c
001996   6ee6     MOVWF     0xe6,0x0                                                                                        
001998   6ae6     CLRF      0xe6,0x0                                                                                        
00199a   ecce     CALL      0xd9c,0x0                                                                                       
00199c   f006                                                                                                               
00199e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a2   0900     IORLW     0x0                                                                                             
0019a4   e008     BZ        0x19b6                                                                                          
0019a6   0100     MOVLB     0x0            				curr_preset = 3;                                                             C:\fw\midicontroller\x014\controller.c
0019a8   0e03     MOVLW     0x3                                                                                             
0019aa   6ff1     MOVWF     0xf1,0x1                                                                                        
0019ac   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x014\controller.c
0019ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0019b0   ecf7     CALL      0xbee,0x0                                                                                       
0019b2   f005                                                                                                               
0019b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           			/* INC pressed: */                                                            C:\fw\midicontroller\x014\controller.c
0019b6   0e00     MOVLW     0x0            			if (button_pressed(FSM_INC)) {                                                C:\fw\midicontroller\x014\controller.c
0019b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0019ba   6ae6     CLRF      0xe6,0x0                                                                                        
0019bc   ecce     CALL      0xd9c,0x0                                                                                       
0019be   f006                                                                                                               
0019c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c4   0900     IORLW     0x0                                                                                             
0019c6   e021     BZ        0x1a0a                                                                                          
0019c8   c0f9     MOVFF     0xf9,0x10      				if (curr_bank == bank_count - 1) curr_bank = 0;                              C:\fw\midicontroller\x014\controller.c
0019ca   f010                                                                                                               
0019cc   c0fa     MOVFF     0xfa,0x11                                                                                       
0019ce   f011                                                                                                               
0019d0   0610     DECF      0x10,0x1,0x0                                                                                    
0019d2   0e00     MOVLW     0x0                                                                                             
0019d4   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
0019d6   5010     MOVF      0x10,0x0,0x0                                                                                    
0019d8   0100     MOVLB     0x0                                                                                             
0019da   19f3     XORWF     0xf3,0x0,0x1                                                                                    
0019dc   e102     BNZ       0x19e2                                                                                          
0019de   5011     MOVF      0x11,0x0,0x0                                                                                    
0019e0   19f4     XORWF     0xf4,0x0,0x1                                                                                    
0019e2   e103     BNZ       0x19ea                                                                                          
0019e4   6bf3     CLRF      0xf3,0x1                                                                                        
0019e6   6bf4     CLRF      0xf4,0x1                                                                                        
0019e8   d003     BRA       0x19f0         				else ++curr_bank;                                                            C:\fw\midicontroller\x014\controller.c
0019ea   2bf3     INCF      0xf3,0x1,0x1                                                                                    
0019ec   0e00     MOVLW     0x0                                                                                             
0019ee   23f4     ADDWFC    0xf4,0x1,0x1                                                                                    
0019f0   ec88     CALL      0xd10,0x0      				bank_showname();                                                             C:\fw\midicontroller\x014\controller.c
0019f2   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
0019f4   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x014\controller.c
0019f6   6b0d     CLRF      0xd,0x1                                                                                         
0019f8   c111     MOVFF     0x111,0xfb     				accel_time = accel_time_slow;                                                C:\fw\midicontroller\x014\controller.c
0019fa   f0fb                                                                                                               
0019fc   c112     MOVFF     0x112,0xfc                                                                                      
0019fe   f0fc                                                                                                               
001a00   0100     MOVLB     0x0            				accel_count = 0;                                                             C:\fw\midicontroller\x014\controller.c
001a02   6bfd     CLRF      0xfd,0x1                                                                                        
001a04   0101     MOVLB     0x1            				accel_state = ACCEL_INC_SLOW;                                                C:\fw\midicontroller\x014\controller.c
001a06   0e01     MOVLW     0x1                                                                                             
001a08   6f0d     MOVWF     0xd,0x1                                                                                         
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                           			/* INC released: */                                                           C:\fw\midicontroller\x014\controller.c
001a0a   0e00     MOVLW     0x0            			if (button_released(FSM_INC)) {                                               C:\fw\midicontroller\x014\controller.c
001a0c   6ee6     MOVWF     0xe6,0x0                                                                                        
001a0e   6ae6     CLRF      0xe6,0x0                                                                                        
001a10   ec1d     CALL      0xe3a,0x0                                                                                       
001a12   f007                                                                                                               
001a14   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a18   0900     IORLW     0x0                                                                                             
001a1a   e006     BZ        0x1a28                                                                                          
001a1c   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x014\controller.c
001a1e   6b0d     CLRF      0xd,0x1                                                                                         
                                           				/* load the bank, but don't change program # */                              C:\fw\midicontroller\x014\controller.c
001a20   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            C:\fw\midicontroller\x014\controller.c
001a22   ec37     CALL      0xc6e,0x0                                                                                       
001a24   f006                                                                                                               
001a26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           			/* DEC pressed: */                                                            C:\fw\midicontroller\x014\controller.c
001a28   0e00     MOVLW     0x0            			if (button_pressed(FSM_DEC)) {                                                C:\fw\midicontroller\x014\controller.c
001a2a   6ee6     MOVWF     0xe6,0x0                                                                                        
001a2c   6ae6     CLRF      0xe6,0x0                                                                                        
001a2e   ecce     CALL      0xd9c,0x0                                                                                       
001a30   f006                                                                                                               
001a32   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a36   0900     IORLW     0x0                                                                                             
001a38   e01d     BZ        0x1a74                                                                                          
001a3a   0100     MOVLB     0x0            				if (curr_bank == 0) curr_bank = bank_count - 1;                              C:\fw\midicontroller\x014\controller.c
001a3c   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001a3e   11f4     IORWF     0xf4,0x0,0x1                                                                                    
001a40   e109     BNZ       0x1a54                                                                                          
001a42   c0f9     MOVFF     0xf9,0xf3                                                                                       
001a44   f0f3                                                                                                               
001a46   c0fa     MOVFF     0xfa,0xf4                                                                                       
001a48   f0f4                                                                                                               
001a4a   0e01     MOVLW     0x1                                                                                             
001a4c   5ff3     SUBWF     0xf3,0x1,0x1                                                                                    
001a4e   0e00     MOVLW     0x0                                                                                             
001a50   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001a52   d003     BRA       0x1a5a         				else --curr_bank;                                                            C:\fw\midicontroller\x014\controller.c
001a54   07f3     DECF      0xf3,0x1,0x1                                                                                    
001a56   0e00     MOVLW     0x0                                                                                             
001a58   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001a5a   ec88     CALL      0xd10,0x0      				bank_showname();                                                             C:\fw\midicontroller\x014\controller.c
001a5c   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
001a5e   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x014\controller.c
001a60   6b0d     CLRF      0xd,0x1                                                                                         
001a62   c111     MOVFF     0x111,0xfb     				accel_time = accel_time_slow;                                                C:\fw\midicontroller\x014\controller.c
001a64   f0fb                                                                                                               
001a66   c112     MOVFF     0x112,0xfc                                                                                      
001a68   f0fc                                                                                                               
001a6a   0100     MOVLB     0x0            				accel_count = 0;                                                             C:\fw\midicontroller\x014\controller.c
001a6c   6bfd     CLRF      0xfd,0x1                                                                                        
001a6e   0101     MOVLB     0x1            				accel_state = ACCEL_DEC_SLOW;                                                C:\fw\midicontroller\x014\controller.c
001a70   0e04     MOVLW     0x4                                                                                             
001a72   6f0d     MOVWF     0xd,0x1                                                                                         
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                           			/* DEC released: */                                                           C:\fw\midicontroller\x014\controller.c
001a74   0e00     MOVLW     0x0            			if (button_released(FSM_DEC)) {                                               C:\fw\midicontroller\x014\controller.c
001a76   6ee6     MOVWF     0xe6,0x0                                                                                        
001a78   6ae6     CLRF      0xe6,0x0                                                                                        
001a7a   ec1d     CALL      0xe3a,0x0                                                                                       
001a7c   f007                                                                                                               
001a7e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a82   0900     IORLW     0x0                                                                                             
001a84   e006     BZ        0x1a92                                                                                          
001a86   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x014\controller.c
001a88   6b0d     CLRF      0xd,0x1                                                                                         
                                           				/* load the bank, but don't change program # */                              C:\fw\midicontroller\x014\controller.c
001a8a   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            C:\fw\midicontroller\x014\controller.c
001a8c   ec37     CALL      0xc6e,0x0                                                                                       
001a8e   f006                                                                                                               
001a90   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           			/* PREV/ENTER pressed: */                                                     C:\fw\midicontroller\x014\controller.c
001a92   0e00     MOVLW     0x0            			if (button_pressed(FSM_ENTER)) {                                              C:\fw\midicontroller\x014\controller.c
001a94   6ee6     MOVWF     0xe6,0x0                                                                                        
001a96   6ae6     CLRF      0xe6,0x0                                                                                        
001a98   ecce     CALL      0xd9c,0x0                                                                                       
001a9a   f006                                                                                                               
001a9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a9e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001aa0   0900     IORLW     0x0                                                                                             
001aa2   e048     BZ        0x1b34                                                                                          
001aa4   0100     MOVLB     0x0            				if (loaded_bank != curr_bank) {                                              C:\fw\midicontroller\x014\controller.c
001aa6   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001aa8   19f5     XORWF     0xf5,0x0,0x1                                                                                    
001aaa   e102     BNZ       0x1ab0                                                                                          
001aac   51f4     MOVF      0xf4,0x0,0x1                                                                                    
001aae   19f6     XORWF     0xf6,0x0,0x1                                                                                    
001ab0   e006     BZ        0x1abe                                                                                          
                                           					/* prepared to switch to a bank, but did not activate the first map */      C:\fw\midicontroller\x014\controller.c
001ab2   0e01     MOVLW     0x1            					bankmap_activate(1);                                                        C:\fw\midicontroller\x014\controller.c
001ab4   6ee6     MOVWF     0xe6,0x0                                                                                        
001ab6   ec1c     CALL      0xc38,0x0                                                                                       
001ab8   f006                                                                                                               
001aba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001abc   d03b     BRA       0x1b34         				} else {                                                                     C:\fw\midicontroller\x014\controller.c
001abe   51f2     MOVF      0xf2,0x0,0x1   					if (curr_mapindex == 0) {                                                   C:\fw\midicontroller\x014\controller.c
001ac0   e133     BNZ       0x1b28                                                                                          
                                           						/* crossed the lower bank-map boundary, load the previous bank */          C:\fw\midicontroller\x014\controller.c
001ac2   51fe     MOVF      0xfe,0x0,0x1   						if (mode == MODE_PRACTICE) {                                               C:\fw\midicontroller\x014\controller.c
001ac4   e115     BNZ       0x1af0                                                                                          
                                           							/* PRACTICE mode cycles through banks by sorted index #: */               C:\fw\midicontroller\x014\controller.c
001ac6   51f7     MOVF      0xf7,0x0,0x1   							if (curr_sortedbank == 0) {                                               C:\fw\midicontroller\x014\controller.c
001ac8   11f8     IORWF     0xf8,0x0,0x1                                                                                    
001aca   e109     BNZ       0x1ade                                                                                          
001acc   c0f9     MOVFF     0xf9,0xf7      								curr_sortedbank = bank_count - 1;                                        C:\fw\midicontroller\x014\controller.c
001ace   f0f7                                                                                                               
001ad0   c0fa     MOVFF     0xfa,0xf8                                                                                       
001ad2   f0f8                                                                                                               
001ad4   0e01     MOVLW     0x1                                                                                             
001ad6   5ff7     SUBWF     0xf7,0x1,0x1                                                                                    
001ad8   0e00     MOVLW     0x0                                                                                             
001ada   5bf8     SUBWFB    0xf8,0x1,0x1                                                                                    
001adc   d003     BRA       0x1ae4         							} else {                                                                  C:\fw\midicontroller\x014\controller.c
001ade   07f7     DECF      0xf7,0x1,0x1   								--curr_sortedbank;                                                       C:\fw\midicontroller\x014\controller.c
001ae0   0e00     MOVLW     0x0                                                                                             
001ae2   5bf8     SUBWFB    0xf8,0x1,0x1                                                                                    
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           							/* show the bank name */                                                  C:\fw\midicontroller\x014\controller.c
001ae4   0e01     MOVLW     0x1            							sortedbank_activate(1);                                                   C:\fw\midicontroller\x014\controller.c
001ae6   6ee6     MOVWF     0xe6,0x0                                                                                        
001ae8   ec6f     CALL      0xcde,0x0                                                                                       
001aea   f006                                                                                                               
001aec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001aee   d014     BRA       0x1b18         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
                                           							/* CONCERT mode cycles through banks by index #: */                       C:\fw\midicontroller\x014\controller.c
001af0   51f3     MOVF      0xf3,0x0,0x1   							if (curr_bank == 0) {                                                     C:\fw\midicontroller\x014\controller.c
001af2   11f4     IORWF     0xf4,0x0,0x1                                                                                    
001af4   e109     BNZ       0x1b08                                                                                          
001af6   c0f9     MOVFF     0xf9,0xf3      								curr_bank = bank_count - 1;                                              C:\fw\midicontroller\x014\controller.c
001af8   f0f3                                                                                                               
001afa   c0fa     MOVFF     0xfa,0xf4                                                                                       
001afc   f0f4                                                                                                               
001afe   0e01     MOVLW     0x1                                                                                             
001b00   5ff3     SUBWF     0xf3,0x1,0x1                                                                                    
001b02   0e00     MOVLW     0x0                                                                                             
001b04   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001b06   d003     BRA       0x1b0e         							} else {                                                                  C:\fw\midicontroller\x014\controller.c
001b08   07f3     DECF      0xf3,0x1,0x1   								--curr_bank;                                                             C:\fw\midicontroller\x014\controller.c
001b0a   0e00     MOVLW     0x0                                                                                             
001b0c   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
                                           							}                                                                         C:\fw\midicontroller\x014\controller.c
                                           							/* show the bank name */                                                  C:\fw\midicontroller\x014\controller.c
001b0e   0e01     MOVLW     0x1            							bank_activate(1);                                                         C:\fw\midicontroller\x014\controller.c
001b10   6ee6     MOVWF     0xe6,0x0                                                                                        
001b12   ec37     CALL      0xc6e,0x0                                                                                       
001b14   f006                                                                                                               
001b16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
                                           						/* activate the last map for the new bank, but do not display the MIDI program # */ C:\fw\midicontroller\x014\controller.c
001b18   0100     MOVLB     0x0            						curr_mapindex = bankmap_count - 1;                                         C:\fw\midicontroller\x014\controller.c
001b1a   05eb     DECF      0xeb,0x0,0x1                                                                                    
001b1c   6ff2     MOVWF     0xf2,0x1                                                                                        
001b1e   6ae6     CLRF      0xe6,0x0       						bankmap_activate(0);                                                       C:\fw\midicontroller\x014\controller.c
001b20   ec1c     CALL      0xc38,0x0                                                                                       
001b22   f006                                                                                                               
001b24   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b26   d006     BRA       0x1b34         					} else {                                                                    C:\fw\midicontroller\x014\controller.c
                                           						/* activate the previous map for the new bank, and display the MIDI program # */ C:\fw\midicontroller\x014\controller.c
001b28   07f2     DECF      0xf2,0x1,0x1   						--curr_mapindex;                                                           C:\fw\midicontroller\x014\controller.c
001b2a   0e01     MOVLW     0x1            						bankmap_activate(1);                                                       C:\fw\midicontroller\x014\controller.c
001b2c   6ee6     MOVWF     0xe6,0x0                                                                                        
001b2e   ec1c     CALL      0xc38,0x0                                                                                       
001b30   f006                                                                                                               
001b32   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x014\controller.c
                                           				}                                                                            C:\fw\midicontroller\x014\controller.c
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           			/* acceleration countdown timer hit 0 and we're incrementing slowly */        C:\fw\midicontroller\x014\controller.c
001b34   0101     MOVLB     0x1            			if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                       C:\fw\midicontroller\x014\controller.c
001b36   510d     MOVF      0xd,0x0,0x1                                                                                     
001b38   e101     BNZ       0x1b3c                                                                                          
001b3a   d0e4     BRA       0x1d04                                                                                          
001b3c   0100     MOVLB     0x0                                                                                             
001b3e   51fb     MOVF      0xfb,0x0,0x1                                                                                    
001b40   11fc     IORWF     0xfc,0x0,0x1                                                                                    
001b42   e001     BZ        0x1b46                                                                                          
001b44   d0df     BRA       0x1d04                                                                                          
001b46   0101     MOVLB     0x1            				switch (accel_state) {                                                       C:\fw\midicontroller\x014\controller.c
001b48   510d     MOVF      0xd,0x0,0x1                                                                                     
001b4a   0a06     XORLW     0x6                                                                                             
001b4c   e101     BNZ       0x1b50                                                                                          
001b4e   d0c3     BRA       0x1cd6                                                                                          
001b50   0a03     XORLW     0x3                                                                                             
001b52   e101     BNZ       0x1b56                                                                                          
001b54   d09b     BRA       0x1c8c                                                                                          
001b56   0a01     XORLW     0x1                                                                                             
001b58   e074     BZ        0x1c42                                                                                          
001b5a   0a07     XORLW     0x7                                                                                             
001b5c   e057     BZ        0x1c0c                                                                                          
001b5e   0a01     XORLW     0x1                                                                                             
001b60   e02c     BZ        0x1bba                                                                                          
001b62   0a03     XORLW     0x3                                                                                             
001b64   e001     BZ        0x1b68                                                                                          
001b66   d0ce     BRA       0x1d04                                                                                          
                                           					case ACCEL_INC_SLOW:                                                        C:\fw\midicontroller\x014\controller.c
001b68   c0f9     MOVFF     0xf9,0x10      						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x014\controller.c
001b6a   f010                                                                                                               
001b6c   c0fa     MOVFF     0xfa,0x11                                                                                       
001b6e   f011                                                                                                               
001b70   0610     DECF      0x10,0x1,0x0                                                                                    
001b72   0e00     MOVLW     0x0                                                                                             
001b74   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001b76   5010     MOVF      0x10,0x0,0x0                                                                                    
001b78   0100     MOVLB     0x0                                                                                             
001b7a   19f3     XORWF     0xf3,0x0,0x1                                                                                    
001b7c   e102     BNZ       0x1b82                                                                                          
001b7e   5011     MOVF      0x11,0x0,0x0                                                                                    
001b80   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001b82   e103     BNZ       0x1b8a                                                                                          
001b84   6bf3     CLRF      0xf3,0x1                                                                                        
001b86   6bf4     CLRF      0xf4,0x1                                                                                        
001b88   d003     BRA       0x1b90         						else ++curr_bank;                                                          C:\fw\midicontroller\x014\controller.c
001b8a   2bf3     INCF      0xf3,0x1,0x1                                                                                    
001b8c   0e00     MOVLW     0x0                                                                                             
001b8e   23f4     ADDWFC    0xf4,0x1,0x1                                                                                    
001b90   ec88     CALL      0xd10,0x0      						bank_showname();                                                           C:\fw\midicontroller\x014\controller.c
001b92   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x014\controller.c
001b94   0100     MOVLB     0x0            						if (accel_count++ == 5) {                                                  C:\fw\midicontroller\x014\controller.c
001b96   51fd     MOVF      0xfd,0x0,0x1                                                                                    
001b98   2bfd     INCF      0xfd,0x1,0x1                                                                                    
001b9a   0805     SUBLW     0x5                                                                                             
001b9c   e109     BNZ       0x1bb0                                                                                          
001b9e   6bfd     CLRF      0xfd,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x014\controller.c
001ba0   0101     MOVLB     0x1            							accel_state = ACCEL_INC_MEDIUM;                                           C:\fw\midicontroller\x014\controller.c
001ba2   0e02     MOVLW     0x2                                                                                             
001ba4   6f0d     MOVWF     0xd,0x1                                                                                         
001ba6   c113     MOVFF     0x113,0xfb     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x014\controller.c
001ba8   f0fb                                                                                                               
001baa   c114     MOVFF     0x114,0xfc                                                                                      
001bac   f0fc                                                                                                               
001bae   d004     BRA       0x1bb8         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
001bb0   c111     MOVFF     0x111,0xfb     							accel_time = accel_time_slow;                                             C:\fw\midicontroller\x014\controller.c
001bb2   f0fb                                                                                                               
001bb4   c112     MOVFF     0x112,0xfc                                                                                      
001bb6   f0fc                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
001bb8   d0a5     BRA       0x1d04         						break;                                                                     C:\fw\midicontroller\x014\controller.c
                                           					case ACCEL_INC_MEDIUM:                                                      C:\fw\midicontroller\x014\controller.c
001bba   c0f9     MOVFF     0xf9,0x10      						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x014\controller.c
001bbc   f010                                                                                                               
001bbe   c0fa     MOVFF     0xfa,0x11                                                                                       
001bc0   f011                                                                                                               
001bc2   0610     DECF      0x10,0x1,0x0                                                                                    
001bc4   0e00     MOVLW     0x0                                                                                             
001bc6   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001bc8   5010     MOVF      0x10,0x0,0x0                                                                                    
001bca   0100     MOVLB     0x0                                                                                             
001bcc   19f3     XORWF     0xf3,0x0,0x1                                                                                    
001bce   e102     BNZ       0x1bd4                                                                                          
001bd0   5011     MOVF      0x11,0x0,0x0                                                                                    
001bd2   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001bd4   e103     BNZ       0x1bdc                                                                                          
001bd6   6bf3     CLRF      0xf3,0x1                                                                                        
001bd8   6bf4     CLRF      0xf4,0x1                                                                                        
001bda   d003     BRA       0x1be2         						else ++curr_bank;                                                          C:\fw\midicontroller\x014\controller.c
001bdc   2bf3     INCF      0xf3,0x1,0x1                                                                                    
001bde   0e00     MOVLW     0x0                                                                                             
001be0   23f4     ADDWFC    0xf4,0x1,0x1                                                                                    
001be2   ec88     CALL      0xd10,0x0      						bank_showname();                                                           C:\fw\midicontroller\x014\controller.c
001be4   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x014\controller.c
001be6   0100     MOVLB     0x0            						if (accel_count++ == 20) {                                                 C:\fw\midicontroller\x014\controller.c
001be8   51fd     MOVF      0xfd,0x0,0x1                                                                                    
001bea   2bfd     INCF      0xfd,0x1,0x1                                                                                    
001bec   0814     SUBLW     0x14                                                                                            
001bee   e109     BNZ       0x1c02                                                                                          
001bf0   6bfd     CLRF      0xfd,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x014\controller.c
001bf2   0101     MOVLB     0x1            							accel_state = ACCEL_INC_FAST;                                             C:\fw\midicontroller\x014\controller.c
001bf4   0e03     MOVLW     0x3                                                                                             
001bf6   6f0d     MOVWF     0xd,0x1                                                                                         
001bf8   c115     MOVFF     0x115,0xfb     							accel_time = accel_time_fast;                                             C:\fw\midicontroller\x014\controller.c
001bfa   f0fb                                                                                                               
001bfc   c116     MOVFF     0x116,0xfc                                                                                      
001bfe   f0fc                                                                                                               
001c00   d004     BRA       0x1c0a         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
001c02   c113     MOVFF     0x113,0xfb     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x014\controller.c
001c04   f0fb                                                                                                               
001c06   c114     MOVFF     0x114,0xfc                                                                                      
001c08   f0fc                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
001c0a   d07c     BRA       0x1d04         						break;                                                                     C:\fw\midicontroller\x014\controller.c
                                           					case ACCEL_INC_FAST:                                                        C:\fw\midicontroller\x014\controller.c
001c0c   c0f9     MOVFF     0xf9,0x10      						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x014\controller.c
001c0e   f010                                                                                                               
001c10   c0fa     MOVFF     0xfa,0x11                                                                                       
001c12   f011                                                                                                               
001c14   0610     DECF      0x10,0x1,0x0                                                                                    
001c16   0e00     MOVLW     0x0                                                                                             
001c18   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c1a   5010     MOVF      0x10,0x0,0x0                                                                                    
001c1c   0100     MOVLB     0x0                                                                                             
001c1e   19f3     XORWF     0xf3,0x0,0x1                                                                                    
001c20   e102     BNZ       0x1c26                                                                                          
001c22   5011     MOVF      0x11,0x0,0x0                                                                                    
001c24   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001c26   e103     BNZ       0x1c2e                                                                                          
001c28   6bf3     CLRF      0xf3,0x1                                                                                        
001c2a   6bf4     CLRF      0xf4,0x1                                                                                        
001c2c   d003     BRA       0x1c34         						else ++curr_bank;                                                          C:\fw\midicontroller\x014\controller.c
001c2e   2bf3     INCF      0xf3,0x1,0x1                                                                                    
001c30   0e00     MOVLW     0x0                                                                                             
001c32   23f4     ADDWFC    0xf4,0x1,0x1                                                                                    
001c34   ec88     CALL      0xd10,0x0      						bank_showname();                                                           C:\fw\midicontroller\x014\controller.c
001c36   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
001c38   c115     MOVFF     0x115,0xfb     						accel_time = accel_time_fast;                                              C:\fw\midicontroller\x014\controller.c
001c3a   f0fb                                                                                                               
001c3c   c116     MOVFF     0x116,0xfc                                                                                      
001c3e   f0fc                                                                                                               
001c40   d061     BRA       0x1d04         						break;                                                                     C:\fw\midicontroller\x014\controller.c
                                           					case ACCEL_DEC_SLOW:                                                        C:\fw\midicontroller\x014\controller.c
001c42   0100     MOVLB     0x0            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x014\controller.c
001c44   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001c46   11f4     IORWF     0xf4,0x0,0x1                                                                                    
001c48   e109     BNZ       0x1c5c                                                                                          
001c4a   c0f9     MOVFF     0xf9,0xf3                                                                                       
001c4c   f0f3                                                                                                               
001c4e   c0fa     MOVFF     0xfa,0xf4                                                                                       
001c50   f0f4                                                                                                               
001c52   0e01     MOVLW     0x1                                                                                             
001c54   5ff3     SUBWF     0xf3,0x1,0x1                                                                                    
001c56   0e00     MOVLW     0x0                                                                                             
001c58   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001c5a   d003     BRA       0x1c62         						else --curr_bank;                                                          C:\fw\midicontroller\x014\controller.c
001c5c   07f3     DECF      0xf3,0x1,0x1                                                                                    
001c5e   0e00     MOVLW     0x0                                                                                             
001c60   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001c62   ec88     CALL      0xd10,0x0      						bank_showname();                                                           C:\fw\midicontroller\x014\controller.c
001c64   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x014\controller.c
001c66   0100     MOVLB     0x0            						if (accel_count++ == 5) {                                                  C:\fw\midicontroller\x014\controller.c
001c68   51fd     MOVF      0xfd,0x0,0x1                                                                                    
001c6a   2bfd     INCF      0xfd,0x1,0x1                                                                                    
001c6c   0805     SUBLW     0x5                                                                                             
001c6e   e109     BNZ       0x1c82                                                                                          
001c70   6bfd     CLRF      0xfd,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x014\controller.c
001c72   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_MEDIUM;                                           C:\fw\midicontroller\x014\controller.c
001c74   0e05     MOVLW     0x5                                                                                             
001c76   6f0d     MOVWF     0xd,0x1                                                                                         
001c78   c113     MOVFF     0x113,0xfb     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x014\controller.c
001c7a   f0fb                                                                                                               
001c7c   c114     MOVFF     0x114,0xfc                                                                                      
001c7e   f0fc                                                                                                               
001c80   d004     BRA       0x1c8a         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
001c82   c111     MOVFF     0x111,0xfb     							accel_time = accel_time_slow;                                             C:\fw\midicontroller\x014\controller.c
001c84   f0fb                                                                                                               
001c86   c112     MOVFF     0x112,0xfc                                                                                      
001c88   f0fc                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
001c8a   d03c     BRA       0x1d04         						break;                                                                     C:\fw\midicontroller\x014\controller.c
                                           					case ACCEL_DEC_MEDIUM:                                                      C:\fw\midicontroller\x014\controller.c
001c8c   0100     MOVLB     0x0            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x014\controller.c
001c8e   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001c90   11f4     IORWF     0xf4,0x0,0x1                                                                                    
001c92   e109     BNZ       0x1ca6                                                                                          
001c94   c0f9     MOVFF     0xf9,0xf3                                                                                       
001c96   f0f3                                                                                                               
001c98   c0fa     MOVFF     0xfa,0xf4                                                                                       
001c9a   f0f4                                                                                                               
001c9c   0e01     MOVLW     0x1                                                                                             
001c9e   5ff3     SUBWF     0xf3,0x1,0x1                                                                                    
001ca0   0e00     MOVLW     0x0                                                                                             
001ca2   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001ca4   d003     BRA       0x1cac         						else --curr_bank;                                                          C:\fw\midicontroller\x014\controller.c
001ca6   07f3     DECF      0xf3,0x1,0x1                                                                                    
001ca8   0e00     MOVLW     0x0                                                                                             
001caa   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001cac   ec88     CALL      0xd10,0x0      						bank_showname();                                                           C:\fw\midicontroller\x014\controller.c
001cae   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x014\controller.c
001cb0   0100     MOVLB     0x0            						if (accel_count++ == 20) {                                                 C:\fw\midicontroller\x014\controller.c
001cb2   51fd     MOVF      0xfd,0x0,0x1                                                                                    
001cb4   2bfd     INCF      0xfd,0x1,0x1                                                                                    
001cb6   0814     SUBLW     0x14                                                                                            
001cb8   e109     BNZ       0x1ccc                                                                                          
001cba   6bfd     CLRF      0xfd,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x014\controller.c
001cbc   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_FAST;                                             C:\fw\midicontroller\x014\controller.c
001cbe   0e06     MOVLW     0x6                                                                                             
001cc0   6f0d     MOVWF     0xd,0x1                                                                                         
001cc2   c115     MOVFF     0x115,0xfb     							accel_time = accel_time_fast;                                             C:\fw\midicontroller\x014\controller.c
001cc4   f0fb                                                                                                               
001cc6   c116     MOVFF     0x116,0xfc                                                                                      
001cc8   f0fc                                                                                                               
001cca   d004     BRA       0x1cd4         						} else {                                                                   C:\fw\midicontroller\x014\controller.c
001ccc   c113     MOVFF     0x113,0xfb     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x014\controller.c
001cce   f0fb                                                                                                               
001cd0   c114     MOVFF     0x114,0xfc                                                                                      
001cd2   f0fc                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x014\controller.c
001cd4   d017     BRA       0x1d04         						break;                                                                     C:\fw\midicontroller\x014\controller.c
                                           					case ACCEL_DEC_FAST:                                                        C:\fw\midicontroller\x014\controller.c
001cd6   0100     MOVLB     0x0            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x014\controller.c
001cd8   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001cda   11f4     IORWF     0xf4,0x0,0x1                                                                                    
001cdc   e109     BNZ       0x1cf0                                                                                          
001cde   c0f9     MOVFF     0xf9,0xf3                                                                                       
001ce0   f0f3                                                                                                               
001ce2   c0fa     MOVFF     0xfa,0xf4                                                                                       
001ce4   f0f4                                                                                                               
001ce6   0e01     MOVLW     0x1                                                                                             
001ce8   5ff3     SUBWF     0xf3,0x1,0x1                                                                                    
001cea   0e00     MOVLW     0x0                                                                                             
001cec   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001cee   d003     BRA       0x1cf6         						else --curr_bank;                                                          C:\fw\midicontroller\x014\controller.c
001cf0   07f3     DECF      0xf3,0x1,0x1                                                                                    
001cf2   0e00     MOVLW     0x0                                                                                             
001cf4   5bf4     SUBWFB    0xf4,0x1,0x1                                                                                    
001cf6   ec88     CALL      0xd10,0x0      						bank_showname();                                                           C:\fw\midicontroller\x014\controller.c
001cf8   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x014\controller.c
001cfa   c115     MOVFF     0x115,0xfb     						accel_time = accel_time_fast;                                              C:\fw\midicontroller\x014\controller.c
001cfc   f0fb                                                                                                               
001cfe   c116     MOVFF     0x116,0xfc                                                                                      
001d00   f0fc                                                                                                               
001d02   d000     BRA       0x1d04         						break;                                                                     C:\fw\midicontroller\x014\controller.c
                                           				}                                                                            C:\fw\midicontroller\x014\controller.c
                                           			}                                                                             C:\fw\midicontroller\x014\controller.c
001d04   d000     BRA       0x1d06         			break;                                                                        C:\fw\midicontroller\x014\controller.c
                                           	}                                                                               C:\fw\midicontroller\x014\controller.c
001d06   c119     MOVFF     0x119,0x11b    	sw_last = sw_curr;                                                              C:\fw\midicontroller\x014\controller.c
001d08   f11b                                                                                                               
001d0a   c11a     MOVFF     0x11a,0x11c                                                                                     
001d0c   f11c                                                                                                               
001d0e   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\controller.c
                                           //*;###########################################################################  C:\fw\midicontroller\x014\vectors.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\vectors.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x014\vectors.c
                                           //;#			vectors									  			  #                                                  C:\fw\midicontroller\x014\vectors.c
                                           //;#			File Name: vectors.c   										  #                                      C:\fw\midicontroller\x014\vectors.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\vectors.c
                                           //;############################################################################  C:\fw\midicontroller\x014\vectors.c
                                                                                                                            C:\fw\midicontroller\x014\vectors.c
                                                                                                                            C:\fw\midicontroller\x014\vectors.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\vectors.c
                                                                                                                            C:\fw\midicontroller\x014\vectors.c
                                           void main(void);                                                                 C:\fw\midicontroller\x014\vectors.c
                                                                                                                            C:\fw\midicontroller\x014\vectors.c
                                           #pragma code RealInitVector = 0x00                                               C:\fw\midicontroller\x014\vectors.c
                                           void                                                                             C:\fw\midicontroller\x014\vectors.c
                                           RealInitVector (void)                                                            C:\fw\midicontroller\x014\vectors.c
                                           {                                                                                C:\fw\midicontroller\x014\vectors.c
                                             _asm                                                                           C:\fw\midicontroller\x014\vectors.c
000000   ef15     GOTO      0xa2a          	goto main //jump to interrupt routine                                           C:\fw\midicontroller\x014\vectors.c
000002   f005                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x014\vectors.c
000004   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\vectors.c
                                                                                                                            C:\fw\midicontroller\x014\vectors.c
                                           #pragma code RealInterruptVectorHigh = 0x08                                      C:\fw\midicontroller\x014\vectors.c
                                           void                                                                             C:\fw\midicontroller\x014\vectors.c
                                           RealInterruptVectorHigh (void)                                                   C:\fw\midicontroller\x014\vectors.c
                                           {                                                                                C:\fw\midicontroller\x014\vectors.c
                                             _asm                                                                           C:\fw\midicontroller\x014\vectors.c
000008   ef20     GOTO      0x3440         	goto InterruptHandlerHigh //jump to interrupt routine                           C:\fw\midicontroller\x014\vectors.c
00000a   f01a                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x014\vectors.c
00000c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\vectors.c
                                                                                                                            C:\fw\midicontroller\x014\vectors.c
                                           //*;###########################################################################  C:\fw\midicontroller\x014\eeprom.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\eeprom.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x014\eeprom.c
                                           //;#			EEProm access functions							  			  #                                    C:\fw\midicontroller\x014\eeprom.c
                                           //;#			File Name: eeprom.c   										  #                                       C:\fw\midicontroller\x014\eeprom.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\eeprom.c
                                           //;############################################################################  C:\fw\midicontroller\x014\eeprom.c
                                                                                                                            C:\fw\midicontroller\x014\eeprom.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\eeprom.c
                                                                                                                            C:\fw\midicontroller\x014\eeprom.c
0033c4   cfd9     MOVFF     0xfd9,0xfe6    unsigned char EERead(unsigned char addr) {                                       C:\fw\midicontroller\x014\eeprom.c
0033c6   ffe6                                                                                                               
0033c8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0033ca   ffd9                                                                                                               
0033cc   0efe     MOVLW     0xfe           	EEADR=(unsigned char)addr;	// Address to read                                   C:\fw\midicontroller\x014\eeprom.c
0033ce   50db     MOVF      0xdb,0x0,0x0                                                                                    
0033d0   6ea9     MOVWF     0xa9,0x0                                                                                        
0033d2   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   C:\fw\midicontroller\x014\eeprom.c
0033d4   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           C:\fw\midicontroller\x014\eeprom.c
0033d6   80a6     BSF       0xa6,0x0,0x0   	EECON1bits.RD=1;			// EE Read                                                   C:\fw\midicontroller\x014\eeprom.c
0033d8   50a8     MOVF      0xa8,0x0,0x0   	return EEDATA;				// W = EEDATA                                                 C:\fw\midicontroller\x014\eeprom.c
0033da   d000     BRA       0x33dc                                                                                          
0033dc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\eeprom.c
0033de   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0033e0   ffd9                                                                                                               
0033e2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\eeprom.c
                                           //blocking write that takes approximately 4mS ??                                 C:\fw\midicontroller\x014\eeprom.c
0033e4   cfd9     MOVFF     0xfd9,0xfe6    void EEWrite(unsigned char addr,unsigned char data) {                            C:\fw\midicontroller\x014\eeprom.c
0033e6   ffe6                                                                                                               
0033e8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0033ea   ffd9                                                                                                               
0033ec   0efe     MOVLW     0xfe           	EEADR = (unsigned char)addr;                                                    C:\fw\midicontroller\x014\eeprom.c
0033ee   50db     MOVF      0xdb,0x0,0x0                                                                                    
0033f0   6ea9     MOVWF     0xa9,0x0                                                                                        
0033f2   0efd     MOVLW     0xfd           	EEDATA=data;                                                                    C:\fw\midicontroller\x014\eeprom.c
0033f4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0033f6   6ea8     MOVWF     0xa8,0x0                                                                                        
                                           	                                                                                C:\fw\midicontroller\x014\eeprom.c
0033f8   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   C:\fw\midicontroller\x014\eeprom.c
0033fa   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           C:\fw\midicontroller\x014\eeprom.c
0033fc   84a6     BSF       0xa6,0x2,0x0   	EECON1bits.WREN=1;                                                              C:\fw\midicontroller\x014\eeprom.c
                                                                                                                            C:\fw\midicontroller\x014\eeprom.c
0033fe   9ef2     BCF       0xf2,0x7,0x0   	INTCONbits.GIE = 0;			// Disable global interrupts                              C:\fw\midicontroller\x014\eeprom.c
003400   0e55     MOVLW     0x55           	EECON2=0x55;				// Required                                                     C:\fw\midicontroller\x014\eeprom.c
003402   6ea7     MOVWF     0xa7,0x0                                                                                        
003404   0eaa     MOVLW     0xaa           	EECON2=0xAA;				// Required                                                     C:\fw\midicontroller\x014\eeprom.c
003406   6ea7     MOVWF     0xa7,0x0                                                                                        
003408   82a6     BSF       0xa6,0x1,0x0   	EECON1bits.WR=1;			// Enable writes                                             C:\fw\midicontroller\x014\eeprom.c
                                           	do {                                                                            C:\fw\midicontroller\x014\eeprom.c
00340a   0004     CLRWDT                   		ClrWdt();                                                                      C:\fw\midicontroller\x014\eeprom.c
00340c   b2a6     BTFSC     0xa6,0x1,0x0   	} while(EECON1bits.WR);		// block until write complete                          C:\fw\midicontroller\x014\eeprom.c
00340e   d7fd     BRA       0x340a                                                                                          
                                                                                                                            C:\fw\midicontroller\x014\eeprom.c
003410   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIE = 1;			// Enable global interrupts                               C:\fw\midicontroller\x014\eeprom.c
003412   94a6     BCF       0xa6,0x2,0x0   	EECON1bits.WREN=0;			// Disable writes                                          C:\fw\midicontroller\x014\eeprom.c
003414   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\eeprom.c
003416   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003418   ffd9                                                                                                               
00341a   0012     RETURN    0x0                                                                                             
                                           //*;###########################################################################  C:\fw\midicontroller\x014\leds.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\leds.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x014\leds.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x014\leds.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x014\leds.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\leds.c
                                           //;############################################################################  C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\leds.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\leds.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           void	ProcessLeds(void) {                                                         C:\fw\midicontroller\x014\leds.c
                                           	static unsigned char ComPointer;                                                C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
002758   d834     RCALL     0x27c2         	AllDigitsOff();                                                                 C:\fw\midicontroller\x014\leds.c
00275a   0101     MOVLB     0x1            	switch (ComPointer) {                                                           C:\fw\midicontroller\x014\leds.c
00275c   5133     MOVF      0x33,0x0,0x1                                                                                    
00275e   0a04     XORLW     0x4                                                                                             
002760   e021     BZ        0x27a4                                                                                          
002762   0a07     XORLW     0x7                                                                                             
002764   e019     BZ        0x2798                                                                                          
002766   0a01     XORLW     0x1                                                                                             
002768   e011     BZ        0x278c                                                                                          
00276a   0a03     XORLW     0x3                                                                                             
00276c   e009     BZ        0x2780                                                                                          
00276e   0a01     XORLW     0x1                                                                                             
002770   e001     BZ        0x2774                                                                                          
                                           		case 0:                                                                        C:\fw\midicontroller\x014\leds.c
002774   9a8a     BCF       0x8a,0x5,0x0   			DISP_COM0_LAT_BIT = false;                                                    C:\fw\midicontroller\x014\leds.c
002776   c133     MOVFF     0x133,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x014\leds.c
002778   ffe6                                                                                                               
00277a   d831     RCALL     0x27de                                                                                          
00277c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00277e   d018     BRA       0x27b0         			break;                                                                        C:\fw\midicontroller\x014\leds.c
                                           		case 1:                                                                        C:\fw\midicontroller\x014\leds.c
002780   908b     BCF       0x8b,0x0,0x0   			DISP_COM1_LAT_BIT = false;                                                    C:\fw\midicontroller\x014\leds.c
002782   c133     MOVFF     0x133,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x014\leds.c
002784   ffe6                                                                                                               
002786   d82b     RCALL     0x27de                                                                                          
002788   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00278a   d012     BRA       0x27b0         			break;                                                                        C:\fw\midicontroller\x014\leds.c
                                           		case 2:                                                                        C:\fw\midicontroller\x014\leds.c
00278c   968a     BCF       0x8a,0x3,0x0   			DISP_COM2_LAT_BIT = false;                                                    C:\fw\midicontroller\x014\leds.c
00278e   c133     MOVFF     0x133,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x014\leds.c
002790   ffe6                                                                                                               
002792   d825     RCALL     0x27de                                                                                          
002794   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002796   d00c     BRA       0x27b0         			break;                                                                        C:\fw\midicontroller\x014\leds.c
                                           		case 3:                                                                        C:\fw\midicontroller\x014\leds.c
002798   948a     BCF       0x8a,0x2,0x0   			DISP_COM3_LAT_BIT = false;                                                    C:\fw\midicontroller\x014\leds.c
00279a   c133     MOVFF     0x133,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x014\leds.c
00279c   ffe6                                                                                                               
00279e   d81f     RCALL     0x27de                                                                                          
0027a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027a2   d006     BRA       0x27b0         			break;                                                                        C:\fw\midicontroller\x014\leds.c
                                           		case 4:                                                                        C:\fw\midicontroller\x014\leds.c
0027a4   928a     BCF       0x8a,0x1,0x0   			DISP_COM4_LAT_BIT = false;                                                    C:\fw\midicontroller\x014\leds.c
0027a6   c133     MOVFF     0x133,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x014\leds.c
0027a8   ffe6                                                                                                               
0027aa   d819     RCALL     0x27de                                                                                          
0027ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027ae   d000     BRA       0x27b0         			break;                                                                        C:\fw\midicontroller\x014\leds.c
                                           		default:                                                                       C:\fw\midicontroller\x014\leds.c
                                           			//do nothing                                                                  C:\fw\midicontroller\x014\leds.c
002772   d01e     BRA       0x27b0         			break;                                                                        C:\fw\midicontroller\x014\leds.c
                                           	}                                                                               C:\fw\midicontroller\x014\leds.c
0027b0   0101     MOVLB     0x1            	if (++ComPointer >= DispNumOfCommons) ComPointer = 0;                           C:\fw\midicontroller\x014\leds.c
0027b2   2b33     INCF      0x33,0x1,0x1                                                                                    
0027b4   0100     MOVLB     0x0                                                                                             
0027b6   5167     MOVF      0x67,0x0,0x1                                                                                    
0027b8   0101     MOVLB     0x1                                                                                             
0027ba   5d33     SUBWF     0x33,0x0,0x1                                                                                    
0027bc   e301     BNC       0x27c0                                                                                          
0027be   6b33     CLRF      0x33,0x1                                                                                        
0027c0   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           void	AllDigitsOff(void) {                                                        C:\fw\midicontroller\x014\leds.c
0027c2   908a     BCF       0x8a,0x0,0x0   	DISP_SEG0_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027c4   9e8c     BCF       0x8c,0x7,0x0   	DISP_SEG1_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027c6   9c8c     BCF       0x8c,0x6,0x0   	DISP_SEG2_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027c8   9a8c     BCF       0x8c,0x5,0x0   	DISP_SEG3_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027ca   988c     BCF       0x8c,0x4,0x0   	DISP_SEG4_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027cc   948b     BCF       0x8b,0x2,0x0   	DISP_SEG5_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027ce   968c     BCF       0x8c,0x3,0x0   	DISP_SEG6_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
0027d0   948c     BCF       0x8c,0x2,0x0   	DISP_SEG7_LAT_BIT = false;                                                      C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
0027d2   8a8a     BSF       0x8a,0x5,0x0   	DISP_COM0_LAT_BIT = true;                                                       C:\fw\midicontroller\x014\leds.c
0027d4   808b     BSF       0x8b,0x0,0x0   	DISP_COM1_LAT_BIT = true;                                                       C:\fw\midicontroller\x014\leds.c
0027d6   868a     BSF       0x8a,0x3,0x0   	DISP_COM2_LAT_BIT = true;                                                       C:\fw\midicontroller\x014\leds.c
0027d8   848a     BSF       0x8a,0x2,0x0   	DISP_COM3_LAT_BIT = true;                                                       C:\fw\midicontroller\x014\leds.c
0027da   828a     BSF       0x8a,0x1,0x0   	DISP_COM4_LAT_BIT = true;                                                       C:\fw\midicontroller\x014\leds.c
0027dc   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
0027de   cfd9     MOVFF     0xfd9,0xfe6    void	HandleDigit(unsigned char ComPointer) {                                     C:\fw\midicontroller\x014\leds.c
0027e0   ffe6                                                                                                               
0027e2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0027e4   ffd9                                                                                                               
0027e6   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	BitField x;                                                                     C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
0027e8   0efe     MOVLW     0xfe           	x.byte = DispSegData[ComPointer].byte;                                          C:\fw\midicontroller\x014\leds.c
0027ea   50db     MOVF      0xdb,0x0,0x0                                                                                    
0027ec   6aea     CLRF      0xea,0x0                                                                                        
0027ee   0f62     ADDLW     0x62                                                                                            
0027f0   6ee9     MOVWF     0xe9,0x0                                                                                        
0027f2   0e00     MOVLW     0x0                                                                                             
0027f4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0027f6   cfef     MOVFF     0xfef,0xfdf                                                                                     
0027f8   ffdf                                                                                                               
0027fa   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit0) DISP_SEG0_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
0027fc   ffe9                                                                                                               
0027fe   cfda     MOVFF     0xfda,0xfea                                                                                     
002800   ffea                                                                                                               
002802   50ef     MOVF      0xef,0x0,0x0                                                                                    
002804   0b01     ANDLW     0x1                                                                                             
002806   e001     BZ        0x280a                                                                                          
002808   808a     BSF       0x8a,0x0,0x0                                                                                    
00280a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit1) DISP_SEG1_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00280c   ffe9                                                                                                               
00280e   cfda     MOVFF     0xfda,0xfea                                                                                     
002810   ffea                                                                                                               
002812   50ef     MOVF      0xef,0x0,0x0                                                                                    
002814   0b02     ANDLW     0x2                                                                                             
002816   e001     BZ        0x281a                                                                                          
002818   8e8c     BSF       0x8c,0x7,0x0                                                                                    
00281a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit2) DISP_SEG2_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00281c   ffe9                                                                                                               
00281e   cfda     MOVFF     0xfda,0xfea                                                                                     
002820   ffea                                                                                                               
002822   50ef     MOVF      0xef,0x0,0x0                                                                                    
002824   0b04     ANDLW     0x4                                                                                             
002826   e001     BZ        0x282a                                                                                          
002828   8c8c     BSF       0x8c,0x6,0x0                                                                                    
00282a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit3) DISP_SEG3_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00282c   ffe9                                                                                                               
00282e   cfda     MOVFF     0xfda,0xfea                                                                                     
002830   ffea                                                                                                               
002832   50ef     MOVF      0xef,0x0,0x0                                                                                    
002834   0b08     ANDLW     0x8                                                                                             
002836   e001     BZ        0x283a                                                                                          
002838   8a8c     BSF       0x8c,0x5,0x0                                                                                    
00283a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit4) DISP_SEG4_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00283c   ffe9                                                                                                               
00283e   cfda     MOVFF     0xfda,0xfea                                                                                     
002840   ffea                                                                                                               
002842   50ef     MOVF      0xef,0x0,0x0                                                                                    
002844   0b10     ANDLW     0x10                                                                                            
002846   e001     BZ        0x284a                                                                                          
002848   888c     BSF       0x8c,0x4,0x0                                                                                    
00284a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit5) DISP_SEG5_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00284c   ffe9                                                                                                               
00284e   cfda     MOVFF     0xfda,0xfea                                                                                     
002850   ffea                                                                                                               
002852   50ef     MOVF      0xef,0x0,0x0                                                                                    
002854   0b20     ANDLW     0x20                                                                                            
002856   e001     BZ        0x285a                                                                                          
002858   848b     BSF       0x8b,0x2,0x0                                                                                    
00285a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit6) DISP_SEG6_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00285c   ffe9                                                                                                               
00285e   cfda     MOVFF     0xfda,0xfea                                                                                     
002860   ffea                                                                                                               
002862   50ef     MOVF      0xef,0x0,0x0                                                                                    
002864   0b40     ANDLW     0x40                                                                                            
002866   e001     BZ        0x286a                                                                                          
002868   868c     BSF       0x8c,0x3,0x0                                                                                    
00286a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit7) DISP_SEG7_LAT_BIT = true;                                           C:\fw\midicontroller\x014\leds.c
00286c   ffe9                                                                                                               
00286e   cfda     MOVFF     0xfda,0xfea                                                                                     
002870   ffea                                                                                                               
002872   50ef     MOVF      0xef,0x0,0x0                                                                                    
002874   0b80     ANDLW     0x80                                                                                            
002876   e001     BZ        0x287a                                                                                          
002878   848c     BSF       0x8c,0x2,0x0                                                                                    
00287a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\leds.c
00287c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00287e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002880   ffd9                                                                                                               
002882   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\leds.c
002884   cfd9     MOVFF     0xfd9,0xfe6    void	SetDispAscii(unsigned char chars[]) {                                       C:\fw\midicontroller\x014\leds.c
002886   ffe6                                                                                                               
002888   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00288a   ffd9                                                                                                               
00288c   0e02     MOVLW     0x2                                                                                             
00288e   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
002890   0e01     MOVLW     0x1            	for (i = 0;i<5;i++) {                                                           C:\fw\midicontroller\x014\leds.c
002892   6adb     CLRF      0xdb,0x0                                                                                        
002894   0e05     MOVLW     0x5                                                                                             
002896   6ef3     MOVWF     0xf3,0x0                                                                                        
002898   0e01     MOVLW     0x1                                                                                             
00289a   cfdb     MOVFF     0xfdb,0xff4                                                                                     
00289c   fff4                                                                                                               
00289e   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0028a0   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
0028a2   e221     BC        0x28e6                                                                                          
0028e0   0e01     MOVLW     0x1                                                                                             
0028e2   2adb     INCF      0xdb,0x1,0x0                                                                                    
0028e4   d7d7     BRA       0x2894                                                                                          
0028a4   0e01     MOVLW     0x1            		x = chars[i];                                                                  C:\fw\midicontroller\x014\leds.c
0028a6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0028a8   6ee7     MOVWF     0xe7,0x0                                                                                        
0028aa   0efd     MOVLW     0xfd                                                                                            
0028ac   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0028ae   ffe9                                                                                                               
0028b0   0efe     MOVLW     0xfe                                                                                            
0028b2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0028b4   ffea                                                                                                               
0028b6   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0028b8   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0028ba   0e00     MOVLW     0x0                                                                                             
0028bc   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0028be   cfef     MOVFF     0xfef,0xfdf                                                                                     
0028c0   ffdf                                                                                                               
0028c2   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          C:\fw\midicontroller\x014\leds.c
0028c4   ffe6                                                                                                               
0028c6   d864     RCALL     0x2990                                                                                          
0028c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0028ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0028cc   0e01     MOVLW     0x1                                                                                             
0028ce   50db     MOVF      0xdb,0x0,0x0                                                                                    
0028d0   6aea     CLRF      0xea,0x0                                                                                        
0028d2   0f62     ADDLW     0x62                                                                                            
0028d4   6ee9     MOVWF     0xe9,0x0                                                                                        
0028d6   0e00     MOVLW     0x0                                                                                             
0028d8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0028da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0028dc   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0028de   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x014\leds.c
0028e6   0e02     MOVLW     0x2            }                                                                                C:\fw\midicontroller\x014\leds.c
0028e8   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0028ea   e202     BC        0x28f0                                                                                          
0028ec   6ae1     CLRF      0xe1,0x0                                                                                        
0028ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0028f0   6ee1     MOVWF     0xe1,0x0                                                                                        
0028f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0028f4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028f6   ffd9                                                                                                               
0028f8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           /* show 4 alphas on the 4-digit display */                                       C:\fw\midicontroller\x014\leds.c
0028fa   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_4alphas(char text[LEDS_MAX_ALPHAS]){                              C:\fw\midicontroller\x014\leds.c
0028fc   ffe6                                                                                                               
0028fe   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002900   ffd9                                                                                                               
002902   0e02     MOVLW     0x2                                                                                             
002904   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
002906   0e01     MOVLW     0x1            	for (i = 0;i<4;i++) {                                                           C:\fw\midicontroller\x014\leds.c
002908   6adb     CLRF      0xdb,0x0                                                                                        
00290a   0e04     MOVLW     0x4                                                                                             
00290c   6ef3     MOVWF     0xf3,0x0                                                                                        
00290e   0e01     MOVLW     0x1                                                                                             
002910   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002912   fff4                                                                                                               
002914   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002916   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002918   e221     BC        0x295c                                                                                          
002956   0e01     MOVLW     0x1                                                                                             
002958   2adb     INCF      0xdb,0x1,0x0                                                                                    
00295a   d7d7     BRA       0x290a                                                                                          
00291a   0e01     MOVLW     0x1            		x = text[i];                                                                   C:\fw\midicontroller\x014\leds.c
00291c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00291e   6ee7     MOVWF     0xe7,0x0                                                                                        
002920   0efd     MOVLW     0xfd                                                                                            
002922   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002924   ffe9                                                                                                               
002926   0efe     MOVLW     0xfe                                                                                            
002928   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00292a   ffea                                                                                                               
00292c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00292e   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002930   0e00     MOVLW     0x0                                                                                             
002932   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002934   cfef     MOVFF     0xfef,0xfdf                                                                                     
002936   ffdf                                                                                                               
002938   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          C:\fw\midicontroller\x014\leds.c
00293a   ffe6                                                                                                               
00293c   d829     RCALL     0x2990                                                                                          
00293e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002940   6ee6     MOVWF     0xe6,0x0                                                                                        
002942   0e01     MOVLW     0x1                                                                                             
002944   50db     MOVF      0xdb,0x0,0x0                                                                                    
002946   6aea     CLRF      0xea,0x0                                                                                        
002948   0f62     ADDLW     0x62                                                                                            
00294a   6ee9     MOVWF     0xe9,0x0                                                                                        
00294c   0e00     MOVLW     0x0                                                                                             
00294e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002950   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002952   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002954   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x014\leds.c
00295c   0e02     MOVLW     0x2            }                                                                                C:\fw\midicontroller\x014\leds.c
00295e   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002960   e202     BC        0x2966                                                                                          
002962   6ae1     CLRF      0xe1,0x0                                                                                        
002964   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002966   6ee1     MOVWF     0xe1,0x0                                                                                        
002968   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00296a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00296c   ffd9                                                                                                               
00296e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           /* show single digit on the single digit display */                              C:\fw\midicontroller\x014\leds.c
002970   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_1digit(u8 value){                                                 C:\fw\midicontroller\x014\leds.c
002972   ffe6                                                                                                               
002974   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002976   ffd9                                                                                                               
002978   0efe     MOVLW     0xfe           	DispSegData[4].byte = AsciiTo7Seg(value+'0');                                   C:\fw\midicontroller\x014\leds.c
00297a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00297c   0f30     ADDLW     0x30                                                                                            
00297e   6ee6     MOVWF     0xe6,0x0                                                                                        
002980   d807     RCALL     0x2990                                                                                          
002982   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002984   0100     MOVLB     0x0                                                                                             
002986   6f66     MOVWF     0x66,0x1                                                                                        
002988   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\leds.c
00298a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00298c   ffd9                                                                                                               
00298e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\leds.c
002990   cfd9     MOVFF     0xfd9,0xfe6    unsigned char AsciiTo7Seg(unsigned char chr) {                                   C:\fw\midicontroller\x014\leds.c
002992   ffe6                                                                                                               
002994   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002996   ffd9                                                                                                               
                                           	                                                                                C:\fw\midicontroller\x014\leds.c
002998   0e41     MOVLW     0x41           	if (chr >= 'A') {                                                               C:\fw\midicontroller\x014\leds.c
00299a   6ef3     MOVWF     0xf3,0x0                                                                                        
00299c   0efe     MOVLW     0xfe                                                                                            
00299e   cfdb     MOVFF     0xfdb,0xff4                                                                                     
0029a0   fff4                                                                                                               
0029a2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0029a4   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
0029a6   e328     BNC       0x29f8                                                                                          
0029a8   0e61     MOVLW     0x61           		if (chr >= 'a') chr -= 'a';	//lower case                                       C:\fw\midicontroller\x014\leds.c
0029aa   6ef3     MOVWF     0xf3,0x0                                                                                        
0029ac   0efe     MOVLW     0xfe                                                                                            
0029ae   cfdb     MOVFF     0xfdb,0xff4                                                                                     
0029b0   fff4                                                                                                               
0029b2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0029b4   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
0029b6   e30b     BNC       0x29ce                                                                                          
0029b8   0e61     MOVLW     0x61                                                                                            
0029ba   6e10     MOVWF     0x10,0x0                                                                                        
0029bc   0efe     MOVLW     0xfe                                                                                            
0029be   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
0029c0   ffe7                                                                                                               
0029c2   5010     MOVF      0x10,0x0,0x0                                                                                    
0029c4   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
0029c6   0efe     MOVLW     0xfe                                                                                            
0029c8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0029ca   ffdb                                                                                                               
0029cc   d00a     BRA       0x29e2         		else chr-='A';			//capital                                                     C:\fw\midicontroller\x014\leds.c
0029ce   0e41     MOVLW     0x41                                                                                            
0029d0   6e10     MOVWF     0x10,0x0                                                                                        
0029d2   0efe     MOVLW     0xfe                                                                                            
0029d4   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
0029d6   ffe7                                                                                                               
0029d8   5010     MOVF      0x10,0x0,0x0                                                                                    
0029da   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
0029dc   0efe     MOVLW     0xfe                                                                                            
0029de   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0029e0   ffdb                                                                                                               
0029e2   50db     MOVF      0xdb,0x0,0x0   		chr=LettersSegTable[chr];                                                      C:\fw\midicontroller\x014\leds.c
0029e4   6af7     CLRF      0xf7,0x0                                                                                        
0029e6   0f26     ADDLW     0x26                                                                                            
0029e8   6ef6     MOVWF     0xf6,0x0                                                                                        
0029ea   0e34     MOVLW     0x34                                                                                            
0029ec   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0029ee   0008     TBLRD                                                                                                     
0029f0   0efe     MOVLW     0xfe                                                                                            
0029f2   cff5     MOVFF     0xff5,0xfdb                                                                                     
0029f4   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x014\leds.c
0029f6   d026     BRA       0x2a44         	else if (chr >= '0') {                                                          C:\fw\midicontroller\x014\leds.c
0029f8   0e30     MOVLW     0x30                                                                                            
0029fa   6ef3     MOVWF     0xf3,0x0                                                                                        
0029fc   0efe     MOVLW     0xfe                                                                                            
0029fe   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002a00   fff4                                                                                                               
002a02   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002a04   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002a06   e315     BNC       0x2a32                                                                                          
002a08   0e30     MOVLW     0x30           		chr -= '0';	//numbers                                                          C:\fw\midicontroller\x014\leds.c
002a0a   6e10     MOVWF     0x10,0x0                                                                                        
002a0c   0efe     MOVLW     0xfe                                                                                            
002a0e   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002a10   ffe7                                                                                                               
002a12   5010     MOVF      0x10,0x0,0x0                                                                                    
002a14   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002a16   0efe     MOVLW     0xfe                                                                                            
002a18   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002a1a   ffdb                                                                                                               
002a1c   50db     MOVF      0xdb,0x0,0x0   		chr=NumbersSegTable[chr];                                                      C:\fw\midicontroller\x014\leds.c
002a1e   6af7     CLRF      0xf7,0x0                                                                                        
002a20   0f1c     ADDLW     0x1c                                                                                            
002a22   6ef6     MOVWF     0xf6,0x0                                                                                        
002a24   0e34     MOVLW     0x34                                                                                            
002a26   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002a28   0008     TBLRD                                                                                                     
002a2a   0efe     MOVLW     0xfe                                                                                            
002a2c   cff5     MOVFF     0xff5,0xfdb                                                                                     
002a2e   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x014\leds.c
002a30   d009     BRA       0x2a44         	else if (chr == ' ') chr = 0;		//space characters                               C:\fw\midicontroller\x014\leds.c
002a32   0efe     MOVLW     0xfe                                                                                            
002a34   50db     MOVF      0xdb,0x0,0x0                                                                                    
002a36   0820     SUBLW     0x20                                                                                            
002a38   e103     BNZ       0x2a40                                                                                          
002a3a   0efe     MOVLW     0xfe                                                                                            
002a3c   6adb     CLRF      0xdb,0x0                                                                                        
002a3e   d002     BRA       0x2a44         	else chr = 0;				//all other characters are spaces                              C:\fw\midicontroller\x014\leds.c
002a40   0efe     MOVLW     0xfe                                                                                            
002a42   6adb     CLRF      0xdb,0x0                                                                                        
002a44   50db     MOVF      0xdb,0x0,0x0   	return chr;                                                                     C:\fw\midicontroller\x014\leds.c
002a46   d000     BRA       0x2a48                                                                                          
002a48   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x014\leds.c
002a4a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002a4c   ffd9                                                                                                               
002a4e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           rom unsigned char NumbersSegTable[10] = {                                        C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<4)|(1<<2)|(1<<3),			//0                                C:\fw\midicontroller\x014\leds.c
                                           	(1<<1)|(1<<2),										//1                                                     C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3),					//2                                     C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<2)|(1<<3),					//3                                     C:\fw\midicontroller\x014\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2),						//4                                           C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<2)|(1<<3),					//5                                     C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<2)|(1<<3),			//6                                C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),								//7                                                C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<3)|(1<<4)|(1<<5)|(1<<6),	//8                           C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)					//9                                      C:\fw\midicontroller\x014\leds.c
                                           };                                                                               C:\fw\midicontroller\x014\leds.c
                                                                                                                            C:\fw\midicontroller\x014\leds.c
                                           rom unsigned char LettersSegTable[26] = {                                        C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<4)|(1<<5)|(1<<6),	//A                                  C:\fw\midicontroller\x014\leds.c
                                           	(1<<4)|(1<<6)|(1<<5)|(1<<2)|(1<<3),			//b                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<6)|(1<<4)|(1<<3),						//c                                                  C:\fw\midicontroller\x014\leds.c
                                           	(1<<6)|(1<<4)|(1<<3)|(1<<2)|(1<<1),			//d                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<3),			//E                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4),				//F                                             C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),	//g                                  C:\fw\midicontroller\x014\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4),				//h                                             C:\fw\midicontroller\x014\leds.c
                                           	(1<<1)|(1<<2),								//I                                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<1)|(1<<2)|(1<<3)|(1<<4),				//J                                             C:\fw\midicontroller\x014\leds.c
                                           	0,											//K                                                                C:\fw\midicontroller\x014\leds.c
                                           	(1<<5)|(1<<4)|(1<<3),						//L                                                  C:\fw\midicontroller\x014\leds.c
                                           	0,											//m                                                                C:\fw\midicontroller\x014\leds.c
                                           	(1<<4)|(1<<6)|(1<<2),						//n                                                  C:\fw\midicontroller\x014\leds.c
                                           	(1<<6)|(1<<4)|(1<<2)|(1<<3),				//o                                             C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<4),			//P                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2),			//q                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<4)|(1<<6),								//r                                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<3)|(1<<2)|(1<<6)|(1<<5)|(1<<0),			//S                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),						//T                                                  C:\fw\midicontroller\x014\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//u                                                  C:\fw\midicontroller\x014\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//v                                                  C:\fw\midicontroller\x014\leds.c
                                           	0,											//w                                                                C:\fw\midicontroller\x014\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4)|(1<<1),			//x                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),			//y                                       C:\fw\midicontroller\x014\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3)			//z                                        C:\fw\midicontroller\x014\leds.c
                                           };                                                                               C:\fw\midicontroller\x014\leds.c
                                           //*;###########################################################################  C:\fw\midicontroller\x014\tables.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\tables.c
                                           //;#			Date 5/28/07					      						  #                                          C:\fw\midicontroller\x014\tables.c
                                           //;#			Tables in the code								  			  #                                        C:\fw\midicontroller\x014\tables.c
                                           //;#			File Name: tables.c   										  #                                       C:\fw\midicontroller\x014\tables.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\tables.c
                                           //;############################################################################  C:\fw\midicontroller\x014\tables.c
                                                                                                                            C:\fw\midicontroller\x014\tables.c
                                                                                                                            C:\fw\midicontroller\x014\tables.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\tables.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\tables.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x014\tables.c
                                                                                                                            C:\fw\midicontroller\x014\tables.c
                                           #pragma romdata                                                                  C:\fw\midicontroller\x014\tables.c
                                                                                                                            C:\fw\midicontroller\x014\tables.c
                                           rom unsigned char EXPP_PEDAL_LINEAR_CONV_TABLE[256] =                            C:\fw\midicontroller\x014\tables.c
                                           {                                                                                C:\fw\midicontroller\x014\tables.c
                                           	0                                                                               C:\fw\midicontroller\x014\tables.c
                                           };                                                                               C:\fw\midicontroller\x014\tables.c
                                                                                                                            C:\fw\midicontroller\x014\tables.c
                                           #pragma romdata ROMSAVEDATA=0x4000                                               C:\fw\midicontroller\x014\tables.c
                                           rom unsigned char ROM_SAVEDATA[8191] = {                                         C:\fw\midicontroller\x014\tables.c
                                           	0                                                                               C:\fw\midicontroller\x014\tables.c
                                           };                                                                               C:\fw\midicontroller\x014\tables.c
                                                                                                                            C:\fw\midicontroller\x014\tables.c
                                           #pragma code                                                                     C:\fw\midicontroller\x014\tables.c
                                           //*;###########################################################################  C:\fw\midicontroller\x014\writeprogmem.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x014\writeprogmem.c
                                           //;#			Date 6/04/07					      						  #                                          C:\fw\midicontroller\x014\writeprogmem.c
                                           //;#			Write ProgMem access							  			  #                                       C:\fw\midicontroller\x014\writeprogmem.c
                                           //;#			File Name: writeprogmem.c   								  #                                   C:\fw\midicontroller\x014\writeprogmem.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x014\writeprogmem.c
                                           //;############################################################################  C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           /*                                                                               C:\fw\midicontroller\x014\writeprogmem.c
                                           void	Write64BytesProgMem(rom unsigned char *RomPtr, unsigned char *RamPtr) {     C:\fw\midicontroller\x014\writeprogmem.c
                                           	ProgMemAddr = (unsigned short)RomPtr;                                           C:\fw\midicontroller\x014\writeprogmem.c
                                           	//if (ProgmemBuffer != (unsigned short)RamPtr) return;                          C:\fw\midicontroller\x014\writeprogmem.c
                                           	WriteProgMem();                                                                 C:\fw\midicontroller\x014\writeprogmem.c
                                           }                                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                           */                                                                               C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           void StartWrite(void)                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           {                                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                               /*                                                                           C:\fw\midicontroller\x014\writeprogmem.c
                                                * A write command can be prematurely terminated by MCLR or WDT reset        C:\fw\midicontroller\x014\writeprogmem.c
                                                */                                                                          C:\fw\midicontroller\x014\writeprogmem.c
003298   0e55     MOVLW     0x55               EECON2 = 0x55;                                                               C:\fw\midicontroller\x014\writeprogmem.c
00329a   6ea7     MOVWF     0xa7,0x0                                                                                        
00329c   0eaa     MOVLW     0xaa               EECON2 = 0xAA;                                                               C:\fw\midicontroller\x014\writeprogmem.c
00329e   6ea7     MOVWF     0xa7,0x0                                                                                        
0032a0   82a6     BSF       0xa6,0x1,0x0       EECON1bits.WR = 1;                                                           C:\fw\midicontroller\x014\writeprogmem.c
0032a2   0012     RETURN    0x0            }//end StartWrite                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           //uses TwoBytes ProgMemAddr;                                                     C:\fw\midicontroller\x014\writeprogmem.c
                                           //also uses ProgmemBuffer[64]                                                    C:\fw\midicontroller\x014\writeprogmem.c
0032a4   cfd9     MOVFF     0xfd9,0xfe6    void WriteProgMem(void) //TESTED: Passed                                         C:\fw\midicontroller\x014\writeprogmem.c
0032a6   ffe6                                                                                                               
0032a8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0032aa   ffd9                                                                                                               
0032ac   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                           	unsigned char counter;                                                          C:\fw\midicontroller\x014\writeprogmem.c
                                               /*                                                                           C:\fw\midicontroller\x014\writeprogmem.c
                                                * The write holding register for the 18F4550 family is                      C:\fw\midicontroller\x014\writeprogmem.c
                                                * actually 32-byte. The code below only tries to write                      C:\fw\midicontroller\x014\writeprogmem.c
                                                * 16-byte because the GUI program only sends out 16-byte                    C:\fw\midicontroller\x014\writeprogmem.c
                                                * at a time.                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                                * This limitation will be fixed in the future version.                      C:\fw\midicontroller\x014\writeprogmem.c
                                                */                                                                          C:\fw\midicontroller\x014\writeprogmem.c
0032ae   0ee0     MOVLW     0xe0               ProgMemAddr.b_form.low &= 0b11100000;  //Force 32-byte boundary              C:\fw\midicontroller\x014\writeprogmem.c
0032b0   0100     MOVLB     0x0                                                                                             
0032b2   17d9     ANDWF     0xd9,0x1,0x1                                                                                    
0032b4   0e84     MOVLW     0x84               EECON1 = 0b10000100;        //Setup writes: EEPGD=1,WREN=1                   C:\fw\midicontroller\x014\writeprogmem.c
0032b6   6ea6     MOVWF     0xa6,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                               //LEN = # of byte to write                                                   C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
0032b8   6adf     CLRF      0xdf,0x0           for (counter = 0; counter < 32; counter++)                                   C:\fw\midicontroller\x014\writeprogmem.c
0032ba   0e20     MOVLW     0x20                                                                                            
0032bc   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
0032be   e21a     BC        0x32f4                                                                                          
0032f0   2adf     INCF      0xdf,0x1,0x0                                                                                    
0032f2   d7e3     BRA       0x32ba                                                                                          
                                               {                                                                            C:\fw\midicontroller\x014\writeprogmem.c
0032c0   50df     MOVF      0xdf,0x0,0x0           *(rom far char *)(ProgMemAddr.s_form+counter) = \                        C:\fw\midicontroller\x014\writeprogmem.c
0032c2   6aea     CLRF      0xea,0x0                                                                                        
0032c4   0fb9     ADDLW     0xb9                                                                                            
0032c6   6ee9     MOVWF     0xe9,0x0                                                                                        
0032c8   0e00     MOVLW     0x0                                                                                             
0032ca   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0032cc   cfef     MOVFF     0xfef,0x10                                                                                      
0032ce   f010                                                                                                               
0032d0   50df     MOVF      0xdf,0x0,0x0                                                                                    
0032d2   0100     MOVLB     0x0                                                                                             
0032d4   6af7     CLRF      0xf7,0x0                                                                                        
0032d6   25d9     ADDWF     0xd9,0x0,0x1                                                                                    
0032d8   6ef6     MOVWF     0xf6,0x0                                                                                        
0032da   51da     MOVF      0xda,0x0,0x1                                                                                    
0032dc   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0032de   6af8     CLRF      0xf8,0x0                                                                                        
0032e0   c010     MOVFF     0x10,0xff5                                                                                      
0032e2   fff5                                                                                                               
0032e4   000c     TBLWT                                                                                                     
                                                   ProgmemBuffer[counter];                                                  C:\fw\midicontroller\x014\writeprogmem.c
0032e6   0e1f     MOVLW     0x1f                   if ((counter & 0b00011111) == 0b00011111)                                C:\fw\midicontroller\x014\writeprogmem.c
0032e8   14df     ANDWF     0xdf,0x0,0x0                                                                                    
0032ea   081f     SUBLW     0x1f                                                                                            
0032ec   e101     BNZ       0x32f0                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x014\writeprogmem.c
0032ee   dfd4     RCALL     0x3298                     StartWrite();                                                        C:\fw\midicontroller\x014\writeprogmem.c
                                                   }//end if                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                               }//end for                                                                   C:\fw\midicontroller\x014\writeprogmem.c
0032f4   52e5     MOVF      0xe5,0x1,0x0   }//end WriteProgMem                                                              C:\fw\midicontroller\x014\writeprogmem.c
0032f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0032f8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0032fa   ffd9                                                                                                               
0032fc   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           //uses TwoBytes ProgMemAddr;                                                     C:\fw\midicontroller\x014\writeprogmem.c
                                           void EraseProgMem(void) //TESTED: Passed                                         C:\fw\midicontroller\x014\writeprogmem.c
                                           {                                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                               //The most significant 16 bits of the address pointer points to the block    C:\fw\midicontroller\x014\writeprogmem.c
                                               //being erased. Bits5:0 are ignored. (In hardware).                          C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                               //LEN = # of 64-byte block to erase                                          C:\fw\midicontroller\x014\writeprogmem.c
0032fe   0e94     MOVLW     0x94               EECON1 = 0b10010100;     //Setup writes: EEPGD=1,FREE=1,WREN=1               C:\fw\midicontroller\x014\writeprogmem.c
003300   6ea6     MOVWF     0xa6,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
003302   c0d9     MOVFF     0xd9,0xff6     	*(rom far char *)ProgMemAddr.s_form;  //Load TBLPTR                             C:\fw\midicontroller\x014\writeprogmem.c
003304   fff6                                                                                                               
003306   c0da     MOVFF     0xda,0xff7                                                                                      
003308   fff7                                                                                                               
00330a   6af8     CLRF      0xf8,0x0                                                                                        
00330c   dfc5     RCALL     0x3298         	StartWrite();                                                                   C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
00330e   6af8     CLRF      0xf8,0x0           TBLPTRU = 0;            // forces upper byte back to 0x00                    C:\fw\midicontroller\x014\writeprogmem.c
                                                                       // optional fix is to set large code model           C:\fw\midicontroller\x014\writeprogmem.c
                                                                       // (for USER ID 0x20 0x00 0x00)                      C:\fw\midicontroller\x014\writeprogmem.c
003310   0012     RETURN    0x0            }//end EraseProgMem                                                              C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
003312   cfd9     MOVFF     0xfd9,0xfe6    unsigned char ReadEE(unsigned char Addr) //TESTED: Passed                        C:\fw\midicontroller\x014\writeprogmem.c
003314   ffe6                                                                                                               
003316   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003318   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x014\writeprogmem.c
00331a   6aa6     CLRF      0xa6,0x0           EECON1 = 0x00;                                                               C:\fw\midicontroller\x014\writeprogmem.c
00331c   0efe     MOVLW     0xfe           	EEADR = Addr;                                                                   C:\fw\midicontroller\x014\writeprogmem.c
00331e   50db     MOVF      0xdb,0x0,0x0                                                                                    
003320   6ea9     MOVWF     0xa9,0x0                                                                                        
                                           	//EEADRH = 0;                                                                   C:\fw\midicontroller\x014\writeprogmem.c
003322   80a6     BSF       0xa6,0x0,0x0   	EECON1bits.RD = 1;                                                              C:\fw\midicontroller\x014\writeprogmem.c
003324   50a8     MOVF      0xa8,0x0,0x0   	return (EEDATA);                                                                C:\fw\midicontroller\x014\writeprogmem.c
003326   d000     BRA       0x3328                                                                                          
003328   52e5     MOVF      0xe5,0x1,0x0   }//end ReadEE                                                                    C:\fw\midicontroller\x014\writeprogmem.c
00332a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00332c   ffd9                                                                                                               
00332e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
003330   cfd9     MOVFF     0xfd9,0xfe6    unsigned char WriteEE(unsigned char Addr, unsigned char data) //TESTED: Passed   C:\fw\midicontroller\x014\writeprogmem.c
003332   ffe6                                                                                                               
003334   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003336   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x014\writeprogmem.c
003338   a2a6     BTFSS     0xa6,0x1,0x0   	if (EECON1bits.WR) return false;                                                C:\fw\midicontroller\x014\writeprogmem.c
00333a   d002     BRA       0x3340                                                                                          
00333c   0e00     MOVLW     0x0                                                                                             
00333e   d00b     BRA       0x3356                                                                                          
003340   0efe     MOVLW     0xfe           	EEADR = Addr;                                                                   C:\fw\midicontroller\x014\writeprogmem.c
003342   50db     MOVF      0xdb,0x0,0x0                                                                                    
003344   6ea9     MOVWF     0xa9,0x0                                                                                        
                                           	//EEADRH = 0;                                                                   C:\fw\midicontroller\x014\writeprogmem.c
003346   0efd     MOVLW     0xfd           	EEDATA = data;                                                                  C:\fw\midicontroller\x014\writeprogmem.c
003348   50db     MOVF      0xdb,0x0,0x0                                                                                    
00334a   6ea8     MOVWF     0xa8,0x0                                                                                        
00334c   0e04     MOVLW     0x4            	EECON1 = 0b00000100;    //Setup writes: EEPGD=0,WREN=1                          C:\fw\midicontroller\x014\writeprogmem.c
00334e   6ea6     MOVWF     0xa6,0x0                                                                                        
003350   dfa3     RCALL     0x3298         	StartWrite();                                                                   C:\fw\midicontroller\x014\writeprogmem.c
                                           	                                                                                C:\fw\midicontroller\x014\writeprogmem.c
003352   0e01     MOVLW     0x1            	return (true);                                                                  C:\fw\midicontroller\x014\writeprogmem.c
003354   d000     BRA       0x3356                                                                                          
                                           //	while(EECON1_WR);       //Wait till WR bit is clear                           C:\fw\midicontroller\x014\writeprogmem.c
003356   52e5     MOVF      0xe5,0x1,0x0   }//end WriteEE                                                                   C:\fw\midicontroller\x014\writeprogmem.c
003358   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00335a   ffd9                                                                                                               
00335c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                           /*                                                                               C:\fw\midicontroller\x014\writeprogmem.c
                                           //WriteConfig is different from WriteProgMem b/c it can write a byte             C:\fw\midicontroller\x014\writeprogmem.c
                                           void WriteConfig(void) //TESTED: Passed                                          C:\fw\midicontroller\x014\writeprogmem.c
                                           {                                                                                C:\fw\midicontroller\x014\writeprogmem.c
                                               EECON1 = 0b11000100;        //Setup writes: EEPGD=1,CFGS=1,WREN=1            C:\fw\midicontroller\x014\writeprogmem.c
                                               for (counter = 0; counter < dataPacket.len; counter++)                       C:\fw\midicontroller\x014\writeprogmem.c
                                               {                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                                   *((dataPacket.ADR.pAdr)+counter) = \                                     C:\fw\midicontroller\x014\writeprogmem.c
                                                   dataPacket.data[counter];                                                C:\fw\midicontroller\x014\writeprogmem.c
                                                   StartWrite();                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                               }//end for                                                                   C:\fw\midicontroller\x014\writeprogmem.c
                                                                                                                            C:\fw\midicontroller\x014\writeprogmem.c
                                               TBLPTRU = 0x00;         // forces upper byte back to 0x00                    C:\fw\midicontroller\x014\writeprogmem.c
                                                                       // optional fix is to set large code model           C:\fw\midicontroller\x014\writeprogmem.c
                                           }//end WriteConfig                                                               C:\fw\midicontroller\x014\writeprogmem.c
                                           */                                                                               C:\fw\midicontroller\x014\writeprogmem.c
