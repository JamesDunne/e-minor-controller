MP2COD 4.1, COFF to COD File Converter
Copyright (c) 2006 Microchip Technology Inc.
Listing File Generated: Fri Jun 01 10:20:43 2007


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           //*;###########################################################################  C:\fw\midicontroller\x009\main.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\main.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x009\main.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x009\main.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x009\main.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\main.c
                                           //;############################################################################  C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\main.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                           unsigned char	ADC_CONVERSION(unsigned char Channel);                             C:\fw\midicontroller\x009\main.c
                                           void	ServiceUSB(void);                                                           C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                           //#define	RX_TRIS_BIT		TRISCbits.TRISC7		// Receive direction bit                C:\fw\midicontroller\x009\main.c
                                           //#define	TX_TRIS_BIT		TRISCbits.TRISC6		// Transmit direction bit               C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                           #pragma code	main_code=0xA2A                                                     C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
000a2a   cfd9     MOVFF     0xfd9,0xfe6    void main() {                                                                    C:\fw\midicontroller\x009\main.c
000a2c   ffe6                                                                                                               
000a2e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000a30   ffd9                                                                                                               
000a32   0e05     MOVLW     0x5                                                                                             
000a34   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char chars[5];                                                         C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
000a36   ec10     CALL      0x3820,0x0     	init();                                                                         C:\fw\midicontroller\x009\main.c
000a38   f01c                                                                                                               
                                           //	controllerinit();                                                             C:\fw\midicontroller\x009\main.c
                                           	                                                                                C:\fw\midicontroller\x009\main.c
000a3a   0e20     MOVLW     0x20           	chars[0] = ' ';                                                                 C:\fw\midicontroller\x009\main.c
000a3c   6edf     MOVWF     0xdf,0x0                                                                                        
000a3e   52de     MOVF      0xde,0x1,0x0   	chars[1] = 'p';                                                                 C:\fw\midicontroller\x009\main.c
000a40   0e70     MOVLW     0x70                                                                                            
000a42   6edd     MOVWF     0xdd,0x0                                                                                        
000a44   0e61     MOVLW     0x61           	chars[2] = 'a';                                                                 C:\fw\midicontroller\x009\main.c
000a46   6ef3     MOVWF     0xf3,0x0                                                                                        
000a48   0e02     MOVLW     0x2                                                                                             
000a4a   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a4c   ffdb                                                                                                               
000a4e   0e72     MOVLW     0x72           	chars[3] = 'r';                                                                 C:\fw\midicontroller\x009\main.c
000a50   6ef3     MOVWF     0xf3,0x0                                                                                        
000a52   0e03     MOVLW     0x3                                                                                             
000a54   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a56   ffdb                                                                                                               
000a58   0e63     MOVLW     0x63           	chars[4] = 'c';                                                                 C:\fw\midicontroller\x009\main.c
000a5a   6ef3     MOVWF     0xf3,0x0                                                                                        
000a5c   0e04     MOVLW     0x4                                                                                             
000a5e   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a60   ffdb                                                                                                               
000a62   cfd9     MOVFF     0xfd9,0xfe6    	SetDispAscii(chars);                                                            C:\fw\midicontroller\x009\main.c
000a64   ffe6                                                                                                               
000a66   cfda     MOVFF     0xfda,0xfe6                                                                                     
000a68   ffe6                                                                                                               
000a6a   ecca     CALL      0x3194,0x0                                                                                      
000a6c   f018                                                                                                               
000a6e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a70   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a72   0eaa     MOVLW     0xaa           	SendDataToShiftReg(0xAA);                                                       C:\fw\midicontroller\x009\main.c
000a74   6ee6     MOVWF     0xe6,0x0                                                                                        
000a76   ec48     CALL      0x2c90,0x0                                                                                      
000a78   f016                                                                                                               
000a7a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
000a7c   0e00     MOVLW     0x0            	chars[0] = ROM_SAVEDATA[0];                                                     C:\fw\midicontroller\x009\main.c
000a7e   6ef6     MOVWF     0xf6,0x0                                                                                        
000a80   0e40     MOVLW     0x40                                                                                            
000a82   6ef7     MOVWF     0xf7,0x0                                                                                        
000a84   0008     TBLRD                                                                                                     
000a86   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000a88   6edf     MOVWF     0xdf,0x0                                                                                        
000a8a   0e01     MOVLW     0x1            	chars[1] = ROM_SAVEDATA[1];                                                     C:\fw\midicontroller\x009\main.c
000a8c   6ef6     MOVWF     0xf6,0x0                                                                                        
000a8e   0e40     MOVLW     0x40                                                                                            
000a90   6ef7     MOVWF     0xf7,0x0                                                                                        
000a92   0008     TBLRD                                                                                                     
000a94   0e01     MOVLW     0x1                                                                                             
000a96   cff5     MOVFF     0xff5,0xfdb                                                                                     
000a98   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\main.c
000a9a   0100     MOVLB     0x0            	ProgmemBuffer[0] = 0xAA;                                                        C:\fw\midicontroller\x009\main.c
000a9c   0eaa     MOVLW     0xaa                                                                                            
000a9e   6f69     MOVWF     0x69,0x1                                                                                        
000aa0   0e55     MOVLW     0x55           	ProgmemBuffer[1] = 0x55;                                                        C:\fw\midicontroller\x009\main.c
000aa2   6f6a     MOVWF     0x6a,0x1                                                                                        
000aa4   0e69     MOVLW     0x69           	Write64BytesProgMem(ROM_SAVEDATA,ProgmemBuffer);                                C:\fw\midicontroller\x009\main.c
000aa6   6ee6     MOVWF     0xe6,0x0                                                                                        
000aa8   0e00     MOVLW     0x0                                                                                             
000aaa   6ee6     MOVWF     0xe6,0x0                                                                                        
000aac   0e00     MOVLW     0x0                                                                                             
000aae   6ee6     MOVWF     0xe6,0x0                                                                                        
000ab0   0e40     MOVLW     0x40                                                                                            
000ab2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ab4   ec41     CALL      0x2e82,0x0                                                                                      
000ab6   f017                                                                                                               
000ab8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000aba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000abc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000abe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ac0   0e00     MOVLW     0x0            	chars[0] = ROM_SAVEDATA[0];                                                     C:\fw\midicontroller\x009\main.c
000ac2   6ef6     MOVWF     0xf6,0x0                                                                                        
000ac4   0e40     MOVLW     0x40                                                                                            
000ac6   6ef7     MOVWF     0xf7,0x0                                                                                        
000ac8   0008     TBLRD                                                                                                     
000aca   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000acc   6edf     MOVWF     0xdf,0x0                                                                                        
000ace   0e01     MOVLW     0x1            	chars[1] = ROM_SAVEDATA[1];                                                     C:\fw\midicontroller\x009\main.c
000ad0   6ef6     MOVWF     0xf6,0x0                                                                                        
000ad2   0e40     MOVLW     0x40                                                                                            
000ad4   6ef7     MOVWF     0xf7,0x0                                                                                        
000ad6   0008     TBLRD                                                                                                     
000ad8   0e01     MOVLW     0x1                                                                                             
000ada   cff5     MOVFF     0xff5,0xfdb                                                                                     
000adc   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                                                                                                            C:\fw\midicontroller\x009\main.c
000aee   d7f7     BRA       0xade          	for(;;) {                                                                       C:\fw\midicontroller\x009\main.c
000ade   0100     MOVLB     0x0            		if (Systick) {                                                                 C:\fw\midicontroller\x009\main.c
000ae0   a1a9     BTFSS     0xa9,0x0,0x1                                                                                    
000ae2   d004     BRA       0xaec                                                                                           
                                                                                                                            C:\fw\midicontroller\x009\main.c
000ae4   ec70     CALL      0x2ce0,0x0     			ReadButtons();                                                                C:\fw\midicontroller\x009\main.c
000ae6   f016                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                           //			ProcessControl();                                                           C:\fw\midicontroller\x009\main.c
                                           //			if (LATE == 0x05) LATE = 0x2;                                               C:\fw\midicontroller\x009\main.c
                                           //			else LATE = 0x05;                                                           C:\fw\midicontroller\x009\main.c
000ae8   ec34     CALL      0x3068,0x0     			ProcessLeds();                                                                C:\fw\midicontroller\x009\main.c
000aea   f018                                                                                                               
                                           		}                                                                              C:\fw\midicontroller\x009\main.c
000aec   d80b     RCALL     0xb04          		ServiceUSB();                                                                  C:\fw\midicontroller\x009\main.c
                                           	}                                                                               C:\fw\midicontroller\x009\main.c
000af0   0e05     MOVLW     0x5            }                                                                                C:\fw\midicontroller\x009\main.c
000af2   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000af4   e202     BC        0xafa                                                                                           
000af6   6ae1     CLRF      0xe1,0x0                                                                                        
000af8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000afa   6ee1     MOVWF     0xe1,0x0                                                                                        
000afc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000afe   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000b00   ffd9                                                                                                               
000b02   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\main.c
                                           void	ServiceUSB(void) {                                                          C:\fw\midicontroller\x009\main.c
000b04   ec69     CALL      0x2ad2,0x0     	USBCheckBusStatus();                    // Must use polling method              C:\fw\midicontroller\x009\main.c
000b06   f015                                                                                                               
000b08   be6f     BTFSC     0x6f,0x7,0x0       if(UCFGbits.UTEYE!=1) {                                                      C:\fw\midicontroller\x009\main.c
000b0a   d002     BRA       0xb10                                                                                           
000b0c   ec88     CALL      0x2b10,0x0             USBDriverService();                 // Interrupt or polling method       C:\fw\midicontroller\x009\main.c
000b0e   f015                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x009\main.c
000b10   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\main.c
                                           /* $Id: c018.c,v 1.2.14.1 2006/01/24 14:50:12 rhinec Exp $ */                    C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
                                           /* Copyright (c)1999 Microchip Technology */                                     C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
                                           /* MPLAB-C18 startup code */                                                     C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
                                           /* external reference to the user's main routine */                              C:\fw\midicontroller\x009\startup.c
                                           extern void main (void);                                                         C:\fw\midicontroller\x009\startup.c
                                           /* prototype for the startup function */                                         C:\fw\midicontroller\x009\startup.c
                                           void _entry (void);                                                              C:\fw\midicontroller\x009\startup.c
                                           void _startup (void);                                                            C:\fw\midicontroller\x009\startup.c
                                           extern near char __FPFLAGS;                                                      C:\fw\midicontroller\x009\startup.c
                                           #define RND 6                                                                    C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
                                           #pragma code _entry_scn=0x000A00                                                 C:\fw\midicontroller\x009\startup.c
                                           void                                                                             C:\fw\midicontroller\x009\startup.c
                                           _entry (void)                                                                    C:\fw\midicontroller\x009\startup.c
                                           {                                                                                C:\fw\midicontroller\x009\startup.c
000a00   efc2     GOTO      0x3984         _asm goto _startup _endasm                                                       C:\fw\midicontroller\x009\startup.c
000a02   f01c                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\startup.c
000a04   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
                                           #pragma code _startup_scn                                                        C:\fw\midicontroller\x009\startup.c
                                           void                                                                             C:\fw\midicontroller\x009\startup.c
                                           _startup (void)                                                                  C:\fw\midicontroller\x009\startup.c
                                           {                                                                                C:\fw\midicontroller\x009\startup.c
                                             _asm                                                                           C:\fw\midicontroller\x009\startup.c
                                               // Initialize the stack pointer                                              C:\fw\midicontroller\x009\startup.c
003984   ee17     LFSR      0x1,0x700          lfsr 1, _stack                                                               C:\fw\midicontroller\x009\startup.c
003986   f000                                                                                                               
003988   ee27     LFSR      0x2,0x700          lfsr 2, _stack                                                               C:\fw\midicontroller\x009\startup.c
00398a   f000                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\startup.c
00398c   6af8     CLRF      0xf8,0x0           clrf TBLPTRU, 0 // 1st silicon doesn't do this on POR                        C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
00398e   9c0f     BCF       0xf,0x6,0x0        bcf __FPFLAGS,RND,0 // Initalize rounding flag for floating point libs       C:\fw\midicontroller\x009\startup.c
                                           _endasm loop:                                                                    C:\fw\midicontroller\x009\startup.c
                                                                                                                            C:\fw\midicontroller\x009\startup.c
                                             // Call the user's main routine                                                C:\fw\midicontroller\x009\startup.c
003990   ec15     CALL      0xa2a,0x0        main ();                                                                       C:\fw\midicontroller\x009\startup.c
003992   f005                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\startup.c
003994   d7fd     BRA       0x3990           goto loop;                                                                     C:\fw\midicontroller\x009\startup.c
003996   0012     RETURN    0x0            }                               /* end _startup() */                             C:\fw\midicontroller\x009\startup.c
                                           /*********************************************************************           C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *********************************************************************           C:\fw\midicontroller\x009\usb.c
                                            * FileName:        usb9.c                                                       C:\fw\midicontroller\x009\usb.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x009\usb.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x009\usb.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x009\usb.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x009\usb.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x009\usb.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x009\usb.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x009\usb.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x009\usb.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x009\usb.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x009\usb.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x009\usb.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x009\usb.c
                                            * license.                                                                      C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x009\usb.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x009\usb.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x009\usb.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x009\usb.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x009\usb.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Author               Date        Comment                                      C:\fw\midicontroller\x009\usb.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\fw\midicontroller\x009\usb.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\fw\midicontroller\x009\usb.c
                                            ********************************************************************/           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\usb.c
                                           //#include "io_cfg.h"                     // Required for self_power status      C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBStdGetDscHandler(void);                                                  C:\fw\midicontroller\x009\usb.c
                                           void USBStdSetCfgHandler(void);                                                  C:\fw\midicontroller\x009\usb.c
                                           void USBStdGetStatusHandler(void);                                               C:\fw\midicontroller\x009\usb.c
                                           void USBStdFeatureReqHandler(void);                                              C:\fw\midicontroller\x009\usb.c
                                           void HIDSetReportHandler(void);                                                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCheckStdRequest(void)                                C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\fw\midicontroller\x009\usb.c
                                            *                  knows how to handle it                                       C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCheckStdRequest(void)                                                    C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
0024f6   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 C:\fw\midicontroller\x009\usb.c
0024f8   5110     MOVF      0x10,0x0,0x1                                                                                    
0024fa   0b60     ANDLW     0x60                                                                                            
0024fc   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0024fe   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002500   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002502   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002504   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002506   0900     IORLW     0x0                                                                                             
002508   e001     BZ        0x250c                                                                                          
00250a   d04f     BRA       0x25aa                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
00250c   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\fw\midicontroller\x009\usb.c
00250e   0a07     XORLW     0x7                                                                                             
002510   e04b     BZ        0x25a8                                                                                          
002512   0a0b     XORLW     0xb                                                                                             
002514   e049     BZ        0x25a8                                                                                          
002516   0a07     XORLW     0x7                                                                                             
002518   e03a     BZ        0x258e                                                                                          
00251a   0a01     XORLW     0x1                                                                                             
00251c   e028     BZ        0x256e                                                                                          
00251e   0a0b     XORLW     0xb                                                                                             
002520   e024     BZ        0x256a                                                                                          
002522   0a02     XORLW     0x2                                                                                             
002524   e022     BZ        0x256a                                                                                          
002526   0a03     XORLW     0x3                                                                                             
002528   e01e     BZ        0x2566                                                                                          
00252a   0a08     XORLW     0x8                                                                                             
00252c   e011     BZ        0x2550                                                                                          
00252e   0a01     XORLW     0x1                                                                                             
002530   e00d     BZ        0x254c                                                                                          
002532   0a0f     XORLW     0xf                                                                                             
002534   e009     BZ        0x2548                                                                                          
002536   0a03     XORLW     0x3                                                                                             
002538   e001     BZ        0x253c                                                                                          
00253a   d036     BRA       0x25a8                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
                                                   case SET_ADR:                                                            C:\fw\midicontroller\x009\usb.c
00253c   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x009\usb.c
00253e   0e01     MOVLW     0x1                                                                                             
002540   6f27     MOVWF     0x27,0x1                                                                                        
002542   0e04     MOVLW     0x4                        usb_device_state = ADR_PENDING_STATE;       // Update state only     C:\fw\midicontroller\x009\usb.c
002544   6f22     MOVWF     0x22,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    C:\fw\midicontroller\x009\usb.c
002546   d031     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case GET_DSC:                                                            C:\fw\midicontroller\x009\usb.c
002548   d831     RCALL     0x25ac                     USBStdGetDscHandler();                                               C:\fw\midicontroller\x009\usb.c
00254a   d02f     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case SET_CFG:                                                            C:\fw\midicontroller\x009\usb.c
00254c   d890     RCALL     0x266e                     USBStdSetCfgHandler();                                               C:\fw\midicontroller\x009\usb.c
00254e   d02d     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case GET_CFG:                                                            C:\fw\midicontroller\x009\usb.c
002550   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x009\usb.c
002552   0e01     MOVLW     0x1                                                                                             
002554   6f27     MOVWF     0x27,0x1                                                                                        
002556   0e24     MOVLW     0x24                       pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            C:\fw\midicontroller\x009\usb.c
002558   6f28     MOVWF     0x28,0x1                                                                                        
00255a   0e01     MOVLW     0x1                                                                                             
00255c   6f29     MOVWF     0x29,0x1                                                                                        
00255e   9323     BCF       0x23,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\fw\midicontroller\x009\usb.c
002560   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        C:\fw\midicontroller\x009\usb.c
002562   6f2c     MOVWF     0x2c,0x1                                                                                        
002564   d022     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case GET_STATUS:                                                         C:\fw\midicontroller\x009\usb.c
002566   d8a9     RCALL     0x26ba                     USBStdGetStatusHandler();                                            C:\fw\midicontroller\x009\usb.c
002568   d020     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case CLR_FEATURE:                                                        C:\fw\midicontroller\x009\usb.c
                                                   case SET_FEATURE:                                                        C:\fw\midicontroller\x009\usb.c
00256a   d8f1     RCALL     0x274e                     USBStdFeatureReqHandler();                                           C:\fw\midicontroller\x009\usb.c
00256c   d01e     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case GET_INTF:                                                           C:\fw\midicontroller\x009\usb.c
00256e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x009\usb.c
002570   0e01     MOVLW     0x1                                                                                             
002572   6f27     MOVWF     0x27,0x1                                                                                        
002574   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    C:\fw\midicontroller\x009\usb.c
002576   5114     MOVF      0x14,0x0,0x1                                                                                    
002578   0101     MOVLB     0x1                                                                                             
00257a   6f28     MOVWF     0x28,0x1                                                                                        
00257c   6b29     CLRF      0x29,0x1                                                                                        
00257e   0e25     MOVLW     0x25                                                                                            
002580   2728     ADDWF     0x28,0x1,0x1                                                                                    
002582   0e01     MOVLW     0x1                                                                                             
002584   2329     ADDWFC    0x29,0x1,0x1                                                                                    
002586   9323     BCF       0x23,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\fw\midicontroller\x009\usb.c
002588   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        C:\fw\midicontroller\x009\usb.c
00258a   6f2c     MOVWF     0x2c,0x1                                                                                        
00258c   d00e     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case SET_INTF:                                                           C:\fw\midicontroller\x009\usb.c
00258e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x009\usb.c
002590   0e01     MOVLW     0x1                                                                                             
002592   6f27     MOVWF     0x27,0x1                                                                                        
002594   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    C:\fw\midicontroller\x009\usb.c
002596   5114     MOVF      0x14,0x0,0x1                                                                                    
002598   6aea     CLRF      0xea,0x0                                                                                        
00259a   0f25     ADDLW     0x25                                                                                            
00259c   6ee9     MOVWF     0xe9,0x0                                                                                        
00259e   0e01     MOVLW     0x1                                                                                             
0025a0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0025a2   c412     MOVFF     0x412,0xfef                                                                                     
0025a4   ffef                                                                                                               
0025a6   d001     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case SET_DSC:                                                            C:\fw\midicontroller\x009\usb.c
                                                   case SYNCH_FRAME:                                                        C:\fw\midicontroller\x009\usb.c
                                                   default:                                                                 C:\fw\midicontroller\x009\usb.c
0025a8   d000     BRA       0x25aa                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                               }//end switch                                                                C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0025aa   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBStdGetDscHandler(void)                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    C:\fw\midicontroller\x009\usb.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     C:\fw\midicontroller\x009\usb.c
                                            *                  This routine should never have to be modified if the tables  C:\fw\midicontroller\x009\usb.c
                                            *                  in usbdsc.c are declared correctly.                          C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBStdGetDscHandler(void)                                                   C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
0025ac   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           C:\fw\midicontroller\x009\usb.c
0025ae   0104     MOVLB     0x4                                                                                             
0025b0   5d10     SUBWF     0x10,0x0,0x1                                                                                    
0025b2   e15c     BNZ       0x266c                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
0025b4   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\fw\midicontroller\x009\usb.c
0025b6   0a03     XORLW     0x3                                                                                             
0025b8   e032     BZ        0x261e                                                                                          
0025ba   0a01     XORLW     0x1                                                                                             
0025bc   e00e     BZ        0x25da                                                                                          
0025be   0a03     XORLW     0x3                                                                                             
0025c0   e001     BZ        0x25c4                                                                                          
0025c2   d04b     BRA       0x265a                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
                                                       case DSC_DEV:                                                        C:\fw\midicontroller\x009\usb.c
0025c4   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x009\usb.c
0025c6   0e01     MOVLW     0x1                                                                                             
0025c8   6f27     MOVWF     0x27,0x1                                                                                        
0025ca   0e9a     MOVLW     0x9a                           pSrc.bRom = (rom byte*)&device_dsc;                              C:\fw\midicontroller\x009\usb.c
0025cc   6f28     MOVWF     0x28,0x1                                                                                        
0025ce   0e35     MOVLW     0x35                                                                                            
0025d0   6f29     MOVWF     0x29,0x1                                                                                        
0025d2   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    C:\fw\midicontroller\x009\usb.c
0025d4   6f2c     MOVWF     0x2c,0x1                                                                                        
0025d6   6b2d     CLRF      0x2d,0x1                                                                                        
0025d8   d040     BRA       0x265a                         break;                                                           C:\fw\midicontroller\x009\usb.c
                                                       case DSC_CFG:                                                        C:\fw\midicontroller\x009\usb.c
0025da   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x009\usb.c
0025dc   0e01     MOVLW     0x1                                                                                             
0025de   6f27     MOVWF     0x27,0x1                                                                                        
0025e0   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    C:\fw\midicontroller\x009\usb.c
0025e2   5112     MOVF      0x12,0x0,0x1                                                                                    
0025e4   6ef6     MOVWF     0xf6,0x0                                                                                        
0025e6   6af7     CLRF      0xf7,0x0                                                                                        
0025e8   90d8     BCF       0xd8,0x0,0x0                                                                                    
0025ea   36f6     RLCF      0xf6,0x1,0x0                                                                                    
0025ec   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0025ee   0ea7     MOVLW     0xa7                                                                                            
0025f0   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0025f2   0e36     MOVLW     0x36                                                                                            
0025f4   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0025f6   0009     TBLRDPOSTINC                                                                                              
0025f8   cff5     MOVFF     0xff5,0x128                                                                                     
0025fa   f128                                                                                                               
0025fc   000a     TBLRDPOSTDEC                                                                                              
0025fe   cff5     MOVFF     0xff5,0x129                                                                                     
002600   f129                                                                                                               
002602   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    C:\fw\midicontroller\x009\usb.c
002604   0101     MOVLB     0x1                                                                                             
002606   6af7     CLRF      0xf7,0x0                                                                                        
002608   2528     ADDWF     0x28,0x0,0x1                                                                                    
00260a   6ef6     MOVWF     0xf6,0x0                                                                                        
00260c   5129     MOVF      0x29,0x0,0x1                                                                                    
00260e   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002610   0009     TBLRDPOSTINC                                                                                              
002612   cff5     MOVFF     0xff5,0x12c                                                                                     
002614   f12c                                                                                                               
002616   000a     TBLRDPOSTDEC                                                                                              
002618   cff5     MOVFF     0xff5,0x12d                                                                                     
00261a   f12d                                                                                                               
00261c   d01e     BRA       0x265a                         break;                                                           C:\fw\midicontroller\x009\usb.c
                                                       case DSC_STR:                                                        C:\fw\midicontroller\x009\usb.c
00261e   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x009\usb.c
002620   0e01     MOVLW     0x1                                                                                             
002622   6f27     MOVWF     0x27,0x1                                                                                        
002624   0104     MOVLB     0x4            				pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                                C:\fw\midicontroller\x009\usb.c
002626   5112     MOVF      0x12,0x0,0x1                                                                                    
002628   6ef6     MOVWF     0xf6,0x0                                                                                        
00262a   6af7     CLRF      0xf7,0x0                                                                                        
00262c   90d8     BCF       0xd8,0x0,0x0                                                                                    
00262e   36f6     RLCF      0xf6,0x1,0x0                                                                                    
002630   36f7     RLCF      0xf7,0x1,0x0                                                                                    
002632   0eab     MOVLW     0xab                                                                                            
002634   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
002636   0e36     MOVLW     0x36                                                                                            
002638   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
00263a   0009     TBLRDPOSTINC                                                                                              
00263c   cff5     MOVFF     0xff5,0x128                                                                                     
00263e   f128                                                                                                               
002640   000a     TBLRDPOSTDEC                                                                                              
002642   cff5     MOVFF     0xff5,0x129                                                                                     
002644   f129                                                                                                               
002646   c128     MOVFF     0x128,0xff6    				wCount._word = *pSrc.bRom;                  // Set data count                C:\fw\midicontroller\x009\usb.c
002648   fff6                                                                                                               
00264a   c129     MOVFF     0x129,0xff7                                                                                     
00264c   fff7                                                                                                               
00264e   0008     TBLRD                                                                                                     
002650   50f5     MOVF      0xf5,0x0,0x0                                                                                    
002652   0101     MOVLB     0x1                                                                                             
002654   6f2c     MOVWF     0x2c,0x1                                                                                        
002656   6b2d     CLRF      0x2d,0x1                                                                                        
002658   d000     BRA       0x265a                         break;                                                           C:\fw\midicontroller\x009\usb.c
                                                   }//end switch                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
00265a   0e02     MOVLW     0x2            		if (SetupPkt.bDscIndex != INDEX_NAME && SetupPkt.bDscIndex != INDEX_SERIALNUM) { //handle as NVR (or ram) read C:\fw\midicontroller\x009\usb.c
00265c   0104     MOVLB     0x4                                                                                             
00265e   5d12     SUBWF     0x12,0x0,0x1                                                                                    
002660   e005     BZ        0x266c                                                                                          
002662   0e03     MOVLW     0x3                                                                                             
002664   5d12     SUBWF     0x12,0x0,0x1                                                                                    
002666   e002     BZ        0x266c                                                                                          
002668   0101     MOVLB     0x1                    	usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type  C:\fw\midicontroller\x009\usb.c
00266a   8323     BSF       0x23,0x1,0x1                                                                                    
                                                   }                                                                        C:\fw\midicontroller\x009\usb.c
                                               }//end if                                                                    C:\fw\midicontroller\x009\usb.c
00266c   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBStdSetCfgHandler(void)                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine first disables all endpoints by clearing        C:\fw\midicontroller\x009\usb.c
                                            *                  UEP registers. It then configures (initializes) endpoints    C:\fw\midicontroller\x009\usb.c
                                            *                  specified in the modifiable section.                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBStdSetCfgHandler(void)                                                   C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
00266e   0101     MOVLB     0x1                ctrl_trf_session_owner = MUID_USB9;                                          C:\fw\midicontroller\x009\usb.c
002670   0e01     MOVLW     0x1                                                                                             
002672   6f27     MOVWF     0x27,0x1                                                                                        
002674   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  C:\fw\midicontroller\x009\usb.c
002676   6ee6     MOVWF     0xe6,0x0                                                                                        
002678   0e71     MOVLW     0x71                                                                                            
00267a   6ee6     MOVWF     0xe6,0x0                                                                                        
00267c   0e0f     MOVLW     0xf                                                                                             
00267e   6ee6     MOVWF     0xe6,0x0                                                                                        
002680   dac9     RCALL     0x2c14                                                                                          
002682   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002684   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002686   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002688   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                C:\fw\midicontroller\x009\usb.c
00268a   6ee6     MOVWF     0xe6,0x0                                                                                        
00268c   0e25     MOVLW     0x25                                                                                            
00268e   6ee6     MOVWF     0xe6,0x0                                                                                        
002690   0e01     MOVLW     0x1                                                                                             
002692   6ee6     MOVWF     0xe6,0x0                                                                                        
002694   dabf     RCALL     0x2c14                                                                                          
002696   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002698   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00269a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00269c   c412     MOVFF     0x412,0x124        usb_active_cfg = SetupPkt.bCfgValue;                                         C:\fw\midicontroller\x009\usb.c
00269e   f124                                                                                                               
0026a0   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  C:\fw\midicontroller\x009\usb.c
0026a2   5112     MOVF      0x12,0x0,0x1                                                                                    
0026a4   e104     BNZ       0x26ae                                                                                          
0026a6   0101     MOVLB     0x1                    usb_device_state = ADDRESS_STATE;                                        C:\fw\midicontroller\x009\usb.c
0026a8   0e05     MOVLW     0x5                                                                                             
0026aa   6f22     MOVWF     0x22,0x1                                                                                        
0026ac   d005     BRA       0x26b8             else                                                                         C:\fw\midicontroller\x009\usb.c
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
0026ae   0101     MOVLB     0x1                    usb_device_state = CONFIGURED_STATE;                                     C:\fw\midicontroller\x009\usb.c
0026b0   0e06     MOVLW     0x6                                                                                             
0026b2   6f22     MOVWF     0x22,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /* Modifiable Section */                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   #if defined(USB_USE_HID)                // See autofiles\usbcfg.h        C:\fw\midicontroller\x009\usb.c
0026b4   ec3d     CALL      0x347a,0x0             HIDInitEP();                                                             C:\fw\midicontroller\x009\usb.c
0026b6   f01a                                                                                                               
                                                   #endif                                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /* End modifiable section */                                             C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           C:\fw\midicontroller\x009\usb.c
0026b8   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBStdGetStatusHandler(void)                            C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine handles the standard GET_STATUS request         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBStdGetStatusHandler(void)                                                C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
0026ba   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        C:\fw\midicontroller\x009\usb.c
0026bc   6b18     CLRF      0x18,0x1                                                                                        
0026be   6b19     CLRF      0x19,0x1           CtrlTrfData._byte1 = 0;                                                      C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0026c0   5110     MOVF      0x10,0x0,0x1       switch(SetupPkt.Recipient)                                                   C:\fw\midicontroller\x009\usb.c
0026c2   0b1f     ANDLW     0x1f                                                                                            
0026c4   0a02     XORLW     0x2                                                                                             
0026c6   e014     BZ        0x26f0                                                                                          
0026c8   0a03     XORLW     0x3                                                                                             
0026ca   e00e     BZ        0x26e8                                                                                          
0026cc   0a01     XORLW     0x1                                                                                             
0026ce   e001     BZ        0x26d2                                                                                          
0026d0   d033     BRA       0x2738                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
                                                   case RCPT_DEV:                                                           C:\fw\midicontroller\x009\usb.c
0026d2   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x009\usb.c
0026d4   0e01     MOVLW     0x1                                                                                             
0026d6   6f27     MOVWF     0x27,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered C:\fw\midicontroller\x009\usb.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     C:\fw\midicontroller\x009\usb.c
                                                        */                                                                  C:\fw\midicontroller\x009\usb.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h C:\fw\midicontroller\x009\usb.c
0026d8   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  C:\fw\midicontroller\x009\usb.c
0026da   8118     BSF       0x18,0x0,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0026dc   0101     MOVLB     0x1                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c C:\fw\midicontroller\x009\usb.c
0026de   a123     BTFSS     0x23,0x0,0x1                                                                                    
0026e0   d002     BRA       0x26e6                                                                                          
0026e2   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  C:\fw\midicontroller\x009\usb.c
0026e4   8318     BSF       0x18,0x1,0x1                                                                                    
0026e6   d028     BRA       0x2738                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case RCPT_INTF:                                                          C:\fw\midicontroller\x009\usb.c
0026e8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         C:\fw\midicontroller\x009\usb.c
0026ea   0e01     MOVLW     0x1                                                                                             
0026ec   6f27     MOVWF     0x27,0x1                                                                                        
0026ee   d024     BRA       0x2738                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                                   case RCPT_EP:                                                            C:\fw\midicontroller\x009\usb.c
0026f0   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x009\usb.c
0026f2   0e01     MOVLW     0x1                                                                                             
0026f4   6f27     MOVWF     0x27,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               C:\fw\midicontroller\x009\usb.c
                                                        */                                                                  C:\fw\midicontroller\x009\usb.c
0026f6   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     C:\fw\midicontroller\x009\usb.c
0026f8   5114     MOVF      0x14,0x0,0x1                                                                                    
0026fa   0b0f     ANDLW     0xf                                                                                             
0026fc   0d08     MULLW     0x8                                                                                             
0026fe   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002700   6a11     CLRF      0x11,0x0                                                                                        
002702   0f00     ADDLW     0x0                                                                                             
002704   6e10     MOVWF     0x10,0x0                                                                                        
002706   0e04     MOVLW     0x4                                                                                             
002708   2211     ADDWFC    0x11,0x1,0x0                                                                                    
00270a   5114     MOVF      0x14,0x0,0x1                                                                                    
00270c   0b80     ANDLW     0x80                                                                                            
00270e   e001     BZ        0x2712                                                                                          
002710   0e01     MOVLW     0x1                                                                                             
002712   0d04     MULLW     0x4                                                                                             
002714   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002716   0101     MOVLB     0x1                                                                                             
002718   2410     ADDWF     0x10,0x0,0x0                                                                                    
00271a   6f2a     MOVWF     0x2a,0x1                                                                                        
00271c   0e00     MOVLW     0x0                                                                                             
00271e   2011     ADDWFC    0x11,0x0,0x0                                                                                    
002720   6f2b     MOVWF     0x2b,0x1                                                                                        
002722   c12a     MOVFF     0x12a,0xfe9                if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             C:\fw\midicontroller\x009\usb.c
002724   ffe9                                                                                                               
002726   c12b     MOVFF     0x12b,0xfea                                                                                     
002728   ffea                                                                                                               
00272a   50ef     MOVF      0xef,0x0,0x0                                                                                    
00272c   0b04     ANDLW     0x4                                                                                             
00272e   e003     BZ        0x2736                                                                                          
002730   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              C:\fw\midicontroller\x009\usb.c
002732   0e01     MOVLW     0x1                                                                                             
002734   6f18     MOVWF     0x18,0x1                                                                                        
002736   d000     BRA       0x2738                     break;                                                               C:\fw\midicontroller\x009\usb.c
                                               }//end switch                                                                C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002738   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_USB9)                                      C:\fw\midicontroller\x009\usb.c
00273a   0527     DECF      0x27,0x0,0x1                                                                                    
00273c   e107     BNZ       0x274c                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
00273e   0e18     MOVLW     0x18                   pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                C:\fw\midicontroller\x009\usb.c
002740   6f28     MOVWF     0x28,0x1                                                                                        
002742   0e04     MOVLW     0x4                                                                                             
002744   6f29     MOVWF     0x29,0x1                                                                                        
002746   9323     BCF       0x23,0x1,0x1           usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           C:\fw\midicontroller\x009\usb.c
002748   0e02     MOVLW     0x2                    LSB(wCount) = 2;                            // Set data count            C:\fw\midicontroller\x009\usb.c
00274a   6f2c     MOVWF     0x2c,0x1                                                                                        
                                               }//end if(...)                                                               C:\fw\midicontroller\x009\usb.c
00274c   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       C:\fw\midicontroller\x009\usb.c
                                            *                  requests                                                     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBStdFeatureReqHandler(void)                                               C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
00274e   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             C:\fw\midicontroller\x009\usb.c
002750   0512     DECF      0x12,0x0,0x1                                                                                    
002752   e110     BNZ       0x2774                (SetupPkt.Recipient == RCPT_DEV))                                         C:\fw\midicontroller\x009\usb.c
002754   5110     MOVF      0x10,0x0,0x1                                                                                    
002756   0b1f     ANDLW     0x1f                                                                                            
002758   0900     IORLW     0x0                                                                                             
00275a   e10c     BNZ       0x2774                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
00275c   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      C:\fw\midicontroller\x009\usb.c
00275e   0e01     MOVLW     0x1                                                                                             
002760   6f27     MOVWF     0x27,0x1                                                                                        
002762   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\fw\midicontroller\x009\usb.c
002764   0104     MOVLB     0x4                                                                                             
002766   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002768   e103     BNZ       0x2770                                                                                          
00276a   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 1;                                           C:\fw\midicontroller\x009\usb.c
00276c   8123     BSF       0x23,0x0,0x1                                                                                    
00276e   d002     BRA       0x2774                 else                                                                     C:\fw\midicontroller\x009\usb.c
002770   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 0;                                           C:\fw\midicontroller\x009\usb.c
002772   9123     BCF       0x23,0x0,0x1                                                                                    
                                               }//end if                                                                    C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002774   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    C:\fw\midicontroller\x009\usb.c
002776   5112     MOVF      0x12,0x0,0x1                                                                                    
002778   e13a     BNZ       0x27ee                (SetupPkt.Recipient == RCPT_EP)&&                                         C:\fw\midicontroller\x009\usb.c
00277a   5110     MOVF      0x10,0x0,0x1                                                                                    
00277c   0b1f     ANDLW     0x1f                                                                                            
00277e   0802     SUBLW     0x2                                                                                             
002780   e136     BNZ       0x27ee                                                                                          
002782   5114     MOVF      0x14,0x0,0x1          (SetupPkt.EPNum != 0))                                                    C:\fw\midicontroller\x009\usb.c
002784   0b0f     ANDLW     0xf                                                                                             
002786   0900     IORLW     0x0                                                                                             
002788   e032     BZ        0x27ee                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
00278a   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      C:\fw\midicontroller\x009\usb.c
00278c   0e01     MOVLW     0x1                                                                                             
00278e   6f27     MOVWF     0x27,0x1                                                                                        
                                                   /* Must do address calculation here */                                   C:\fw\midicontroller\x009\usb.c
002790   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         C:\fw\midicontroller\x009\usb.c
002792   5114     MOVF      0x14,0x0,0x1                                                                                    
002794   0b0f     ANDLW     0xf                                                                                             
002796   0d08     MULLW     0x8                                                                                             
002798   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00279a   6a11     CLRF      0x11,0x0                                                                                        
00279c   0f00     ADDLW     0x0                                                                                             
00279e   6e10     MOVWF     0x10,0x0                                                                                        
0027a0   0e04     MOVLW     0x4                                                                                             
0027a2   2211     ADDWFC    0x11,0x1,0x0                                                                                    
0027a4   5114     MOVF      0x14,0x0,0x1                                                                                    
0027a6   0b80     ANDLW     0x80                                                                                            
0027a8   e001     BZ        0x27ac                                                                                          
0027aa   0e01     MOVLW     0x1                                                                                             
0027ac   0d04     MULLW     0x4                                                                                             
0027ae   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0027b0   0101     MOVLB     0x1                                                                                             
0027b2   2410     ADDWF     0x10,0x0,0x0                                                                                    
0027b4   6f2a     MOVWF     0x2a,0x1                                                                                        
0027b6   0e00     MOVLW     0x0                                                                                             
0027b8   2011     ADDWFC    0x11,0x0,0x0                                                                                    
0027ba   6f2b     MOVWF     0x2b,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0027bc   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\fw\midicontroller\x009\usb.c
0027be   0104     MOVLB     0x4                                                                                             
0027c0   5d11     SUBWF     0x11,0x0,0x1                                                                                    
0027c2   e107     BNZ       0x27d2                                                                                          
0027c4   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          C:\fw\midicontroller\x009\usb.c
0027c6   c12a     MOVFF     0x12a,0xfe9                                                                                     
0027c8   ffe9                                                                                                               
0027ca   c12b     MOVFF     0x12b,0xfea                                                                                     
0027cc   ffea                                                                                                               
0027ce   6eef     MOVWF     0xef,0x0                                                                                        
0027d0   d00e     BRA       0x27ee                 else                                                                     C:\fw\midicontroller\x009\usb.c
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
0027d2   af14     BTFSS     0x14,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        C:\fw\midicontroller\x009\usb.c
0027d4   d006     BRA       0x27e2                                                                                          
0027d6   c12a     MOVFF     0x12a,0xfe9                    *pDst.bRam = _UCPU;                                              C:\fw\midicontroller\x009\usb.c
0027d8   ffe9                                                                                                               
0027da   c12b     MOVFF     0x12b,0xfea                                                                                     
0027dc   ffea                                                                                                               
0027de   6aef     CLRF      0xef,0x0                                                                                        
0027e0   d006     BRA       0x27ee                     else                                                                 C:\fw\midicontroller\x009\usb.c
0027e2   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 C:\fw\midicontroller\x009\usb.c
0027e4   c12a     MOVFF     0x12a,0xfe9                                                                                     
0027e6   ffe9                                                                                                               
0027e8   c12b     MOVFF     0x12b,0xfea                                                                                     
0027ea   ffea                                                                                                               
0027ec   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                C:\fw\midicontroller\x009\usb.c
                                               }//end if                                                                    C:\fw\midicontroller\x009\usb.c
0027ee   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** EOF usb9.c ***************************************************************/  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           //usbmmap.c                                                                      C:\fw\midicontroller\x009\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x009\usb.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        C:\fw\midicontroller\x009\usb.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              C:\fw\midicontroller\x009\usb.c
                                           byte usb_active_cfg;            // Value of current configuration                C:\fw\midicontroller\x009\usb.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  C:\fw\midicontroller\x009\usb.c
                                                                           // setting for each interface ID                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  C:\fw\midicontroller\x009\usb.c
                                           //#pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) C:\fw\midicontroller\x009\usb.c
                                           #pragma udata overlay usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Section A: Buffer Descriptor Table                                            C:\fw\midicontroller\x009\usb.c
                                            * - 0x400 - 0x4FF(max)                                                          C:\fw\midicontroller\x009\usb.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              C:\fw\midicontroller\x009\usb.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            C:\fw\midicontroller\x009\usb.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Section B: EP0 Buffer Space                                                   C:\fw\midicontroller\x009\usb.c
                                            ******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * - Two buffer areas are defined:                                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *   A. CTRL_TRF_SETUP                                                           C:\fw\midicontroller\x009\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\fw\midicontroller\x009\usb.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *   B. CTRL_TRF_DATA                                                            C:\fw\midicontroller\x009\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\fw\midicontroller\x009\usb.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            C:\fw\midicontroller\x009\usb.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Section C: HID Buffer                                                         C:\fw\midicontroller\x009\usb.c
                                            ******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #if defined(USB_USE_HID)                                                         C:\fw\midicontroller\x009\usb.c
                                           volatile far unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];                  C:\fw\midicontroller\x009\usb.c
                                           volatile far unsigned char hid_report_in[HID_INT_IN_EP_SIZE];                    C:\fw\midicontroller\x009\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x009\usb.c
                                           /** EOF usbmmap.c ************************************************************/  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           //usbctrltrf.c                                                                   C:\fw\midicontroller\x009\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x009\usb.c
                                           byte ctrl_trf_state;                // Control Transfer State                    C:\fw\midicontroller\x009\usb.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           POINTER pSrc;                       // Data source pointer                       C:\fw\midicontroller\x009\usb.c
                                           POINTER pDst;                       // Data destination pointer                  C:\fw\midicontroller\x009\usb.c
                                           WORD wCount;                        // Data counter                              C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlTrfSetupHandler(void);                                               C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlTrfOutHandler(void);                                                 C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlTrfInHandler(void);                                                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlEPService(void)                                  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     C:\fw\midicontroller\x009\usb.c
                                            *                  it knows how to service and services them:                   C:\fw\midicontroller\x009\usb.c
                                            *                  1. EP0 SETUP                                                 C:\fw\midicontroller\x009\usb.c
                                            *                  2. EP0 OUT                                                   C:\fw\midicontroller\x009\usb.c
                                            *                  3. EP0 IN                                                    C:\fw\midicontroller\x009\usb.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlEPService(void)                                                      C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
0027f0   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        C:\fw\midicontroller\x009\usb.c
0027f2   e10b     BNZ       0x280a                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
0027f4   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 C:\fw\midicontroller\x009\usb.c
0027f6   5100     MOVF      0x0,0x0,0x1                                                                                     
0027f8   0b3c     ANDLW     0x3c                                                                                            
0027fa   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0027fc   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0027fe   080d     SUBLW     0xd                                                                                             
002800   e102     BNZ       0x2806                                                                                          
002802   d808     RCALL     0x2814                     USBCtrlTrfSetupHandler();                                            C:\fw\midicontroller\x009\usb.c
002804   d001     BRA       0x2808                 else                                        // EP0 OUT                   C:\fw\midicontroller\x009\usb.c
002806   d83b     RCALL     0x287e                     USBCtrlTrfOutHandler();                                              C:\fw\midicontroller\x009\usb.c
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
002808   d004     BRA       0x2812             else if(USTAT == EP00_IN)                       // EP0 IN                    C:\fw\midicontroller\x009\usb.c
00280a   0e04     MOVLW     0x4                                                                                             
00280c   5c6c     SUBWF     0x6c,0x0,0x0                                                                                    
00280e   e101     BNZ       0x2812                                                                                          
002810   d846     RCALL     0x289e                 USBCtrlTrfInHandler();                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002812   0012     RETURN    0x0            }//end USBCtrlEPService                                                          C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          C:\fw\midicontroller\x009\usb.c
                                            *                  1. It initializes the control transfer state machine.        C:\fw\midicontroller\x009\usb.c
                                            *                  2. It calls on each of the module that may know how to       C:\fw\midicontroller\x009\usb.c
                                            *                     service the Setup Request from the host.                  C:\fw\midicontroller\x009\usb.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  C:\fw\midicontroller\x009\usb.c
                                            *                     As new classes are added, ClassReqHandler table in        C:\fw\midicontroller\x009\usb.c
                                            *                     usbdsc.c should be updated to call all available          C:\fw\midicontroller\x009\usb.c
                                            *                     class handlers.                                           C:\fw\midicontroller\x009\usb.c
                                            *                  3. Once each of the modules has had a chance to check if     C:\fw\midicontroller\x009\usb.c
                                            *                     it is responsible for servicing the request, stage 3      C:\fw\midicontroller\x009\usb.c
                                            *                     then checks direction of the transfer to determine how    C:\fw\midicontroller\x009\usb.c
                                            *                     to prepare EP0 for the control transfer.                  C:\fw\midicontroller\x009\usb.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            Microchip USB Firmware has three different states for        C:\fw\midicontroller\x009\usb.c
                                            *                  the control transfer state machine:                          C:\fw\midicontroller\x009\usb.c
                                            *                  1. WAIT_SETUP                                                C:\fw\midicontroller\x009\usb.c
                                            *                  2. CTRL_TRF_TX                                               C:\fw\midicontroller\x009\usb.c
                                            *                  3. CTRL_TRF_RX                                               C:\fw\midicontroller\x009\usb.c
                                            *                  Refer to firmware manual to find out how one state           C:\fw\midicontroller\x009\usb.c
                                            *                  is transitioned to another.                                  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                  A Control Transfer is composed of many USB transactions.     C:\fw\midicontroller\x009\usb.c
                                            *                  When transferring data over multiple transactions,           C:\fw\midicontroller\x009\usb.c
                                            *                  it is important to keep track of data source, data           C:\fw\midicontroller\x009\usb.c
                                            *                  destination, and data count. These three parameters are      C:\fw\midicontroller\x009\usb.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           C:\fw\midicontroller\x009\usb.c
                                            *                  note if the data source is from ROM or RAM.                  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
002814   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                C:\fw\midicontroller\x009\usb.c
002816   ffe6                                                                                                               
002818   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00281a   ffd9                                                                                                               
00281c   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               byte i;                                                                      C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /* Stage 1 */                                                                C:\fw\midicontroller\x009\usb.c
00281e   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;                                                 C:\fw\midicontroller\x009\usb.c
002820   6b26     CLRF      0x26,0x1                                                                                        
002822   6b27     CLRF      0x27,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 C:\fw\midicontroller\x009\usb.c
002824   6b2c     CLRF      0x2c,0x1           wCount._word = 0;                                                            C:\fw\midicontroller\x009\usb.c
002826   6b2d     CLRF      0x2d,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /* Stage 2 */                                                                C:\fw\midicontroller\x009\usb.c
002828   de66     RCALL     0x24f6             USBCheckStdRequest();                   // See system\usb9\usb9.c            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /* Modifiable Section */                                                     C:\fw\midicontroller\x009\usb.c
00282a   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     C:\fw\midicontroller\x009\usb.c
00282c   50df     MOVF      0xdf,0x0,0x0                                                                                    
00282e   6e10     MOVWF     0x10,0x0                                                                                        
002830   6a11     CLRF      0x11,0x0                                                                                        
002832   0e01     MOVLW     0x1                                                                                             
002834   5c10     SUBWF     0x10,0x0,0x0                                                                                    
002836   0e00     MOVLW     0x0                                                                                             
002838   5811     SUBWFB    0x11,0x0,0x0                                                                                    
00283a   e21b     BC        0x2872                                                                                          
00286e   2adf     INCF      0xdf,0x1,0x0                                                                                    
002870   d7dd     BRA       0x282c                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
00283c   0101     MOVLB     0x1                    if(ctrl_trf_session_owner != MUID_NULL)break;                            C:\fw\midicontroller\x009\usb.c
00283e   5127     MOVF      0x27,0x0,0x1                                                                                    
002840   e001     BZ        0x2844                                                                                          
002842   d017     BRA       0x2872                                                                                          
002844   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            C:\fw\midicontroller\x009\usb.c
002846   34df     RLCF      0xdf,0x0,0x0                                                                                    
002848   0bfe     ANDLW     0xfe                                                                                            
00284a   36f7     RLCF      0xf7,0x1,0x0                                                                                    
00284c   6ef6     MOVWF     0xf6,0x0                                                                                        
00284e   0eb5     MOVLW     0xb5                                                                                            
002850   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
002852   0e36     MOVLW     0x36                                                                                            
002854   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002856   0009     TBLRDPOSTINC                                                                                              
002858   cff5     MOVFF     0xff5,0x10                                                                                      
00285a   f010                                                                                                               
00285c   0008     TBLRD                                                                                                     
00285e   cff5     MOVFF     0xff5,0x11                                                                                      
002860   f011                                                                                                               
002862   d004     BRA       0x286c                                                                                          
002864   c011     MOVFF     0x11,0xffa                                                                                      
002866   fffa                                                                                                               
002868   5010     MOVF      0x10,0x0,0x0                                                                                    
00286a   6ef9     MOVWF     0xf9,0x0                                                                                        
00286c   dffb     RCALL     0x2864                                                                                          
                                               }//end while                                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /* End Modifiable Section */                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /* Stage 3 */                                                                C:\fw\midicontroller\x009\usb.c
002872   d8df     RCALL     0x2a32             USBCtrlEPServiceComplete();                                                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002874   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    C:\fw\midicontroller\x009\usb.c
002876   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002878   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00287a   ffd9                                                                                                               
00287c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine handles an OUT transaction according to         C:\fw\midicontroller\x009\usb.c
                                            *                  which control transfer state is currently active.            C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            Note that if the the control transfer was from               C:\fw\midicontroller\x009\usb.c
                                            *                  host to device, the session owner should be notified         C:\fw\midicontroller\x009\usb.c
                                            *                  at the end of each OUT transaction to service the            C:\fw\midicontroller\x009\usb.c
                                            *                  received data.                                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlTrfOutHandler(void)                                                  C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
00287e   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            C:\fw\midicontroller\x009\usb.c
002880   0101     MOVLB     0x1                                                                                             
002882   5d26     SUBWF     0x26,0x0,0x1                                                                                    
002884   e10a     BNZ       0x289a                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002886   d898     RCALL     0x29b8                 USBCtrlTrfRxService();                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x009\usb.c
                                                    * Don't have to worry about overwriting _KEEP bit                       C:\fw\midicontroller\x009\usb.c
                                                    * because if _KEEP was set, TRNIF would not have been                   C:\fw\midicontroller\x009\usb.c
                                                    * generated in the first place.                                         C:\fw\midicontroller\x009\usb.c
                                                    */                                                                      C:\fw\midicontroller\x009\usb.c
002888   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  C:\fw\midicontroller\x009\usb.c
00288a   bd00     BTFSC     0x0,0x6,0x1                                                                                     
00288c   d003     BRA       0x2894                                                                                          
00288e   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
002890   6f00     MOVWF     0x0,0x1                                                                                         
002892   d002     BRA       0x2898                 else                                                                     C:\fw\midicontroller\x009\usb.c
002894   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
002896   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
002898   d001     BRA       0x289c             else    // CTRL_TRF_TX                                                       C:\fw\midicontroller\x009\usb.c
00289a   d90e     RCALL     0x2ab8                 USBPrepareForNextSetupTrf();                                             C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
00289c   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine handles an IN transaction according to          C:\fw\midicontroller\x009\usb.c
                                            *                  which control transfer state is currently active.            C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            A Set Address Request must not change the acutal address     C:\fw\midicontroller\x009\usb.c
                                            *                  of the device until the completion of the control            C:\fw\midicontroller\x009\usb.c
                                            *                  transfer. The end of the control transfer for Set Address    C:\fw\midicontroller\x009\usb.c
                                            *                  Request is an IN transaction. Therefore it is necessary      C:\fw\midicontroller\x009\usb.c
                                            *                  to service this unique situation when the condition is       C:\fw\midicontroller\x009\usb.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          C:\fw\midicontroller\x009\usb.c
                                            *                  usb9.h and its function is to specifically service this      C:\fw\midicontroller\x009\usb.c
                                            *                  event.                                                       C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlTrfInHandler(void)                                                   C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
00289e   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    C:\fw\midicontroller\x009\usb.c
0028a0   0101     MOVLB     0x1                                                                                             
0028a2   5d22     SUBWF     0x22,0x0,0x1                                                                                    
0028a4   e10a     BNZ       0x28ba                                                                                          
0028a6   c412     MOVFF     0x412,0xf6e                                                                                     
0028a8   ff6e                                                                                                               
0028aa   506e     MOVF      0x6e,0x0,0x0                                                                                    
0028ac   0800     SUBLW     0x0                                                                                             
0028ae   e203     BC        0x28b6                                                                                          
0028b0   0e05     MOVLW     0x5                                                                                             
0028b2   6f22     MOVWF     0x22,0x1                                                                                        
0028b4   d002     BRA       0x28ba                                                                                          
0028b6   0e03     MOVLW     0x3                                                                                             
0028b8   6f22     MOVWF     0x22,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0028ba   0526     DECF      0x26,0x0,0x1       if(ctrl_trf_state == CTRL_TRF_TX)                                            C:\fw\midicontroller\x009\usb.c
0028bc   e10a     BNZ       0x28d2                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
0028be   d811     RCALL     0x28e2                 USBCtrlTrfTxService();                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0028c0   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  C:\fw\midicontroller\x009\usb.c
0028c2   bd04     BTFSC     0x4,0x6,0x1                                                                                     
0028c4   d003     BRA       0x28cc                                                                                          
0028c6   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
0028c8   6f04     MOVWF     0x4,0x1                                                                                         
0028ca   d002     BRA       0x28d0                 else                                                                     C:\fw\midicontroller\x009\usb.c
0028cc   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
0028ce   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
0028d0   d007     BRA       0x28e0             else { // CTRL_TRF_RX                                                        C:\fw\midicontroller\x009\usb.c
                                           //Rawin's code change to handle setreport data:                                  C:\fw\midicontroller\x009\usb.c
0028d2   0e09     MOVLW     0x9            		if (SetupPkt.bRequest == SET_REPORT) {                                         C:\fw\midicontroller\x009\usb.c
0028d4   0104     MOVLB     0x4                                                                                             
0028d6   5d11     SUBWF     0x11,0x0,0x1                                                                                    
0028d8   e102     BNZ       0x28de                                                                                          
0028da   ec6f     CALL      0x38de,0x0     			HIDSetReportHandler();                                                        C:\fw\midicontroller\x009\usb.c
0028dc   f01c                                                                                                               
                                           		}                                                                              C:\fw\midicontroller\x009\usb.c
0028de   d8ec     RCALL     0x2ab8         		USBPrepareForNextSetupTrf();                                                   C:\fw\midicontroller\x009\usb.c
                                           	}                                                                               C:\fw\midicontroller\x009\usb.c
0028e0   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlTrfTxService(void)                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine should be called from only two places.          C:\fw\midicontroller\x009\usb.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             C:\fw\midicontroller\x009\usb.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           C:\fw\midicontroller\x009\usb.c
                                            *                  transfer over multiple USB transactions.                     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            This routine works with isochronous endpoint larger than     C:\fw\midicontroller\x009\usb.c
                                            *                  256 bytes and is shown here as an example of how to deal     C:\fw\midicontroller\x009\usb.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   C:\fw\midicontroller\x009\usb.c
                                            *                  be larger than 64 bytes.                                     C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
0028e2   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   C:\fw\midicontroller\x009\usb.c
0028e4   ffe6                                                                                                               
0028e6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028e8   ffd9                                                                                                               
0028ea   0e02     MOVLW     0x2                                                                                             
0028ec   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               WORD byte_to_send;                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * First, have to figure out how many byte of data to send.                  C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
0028ee   0101     MOVLB     0x1                if(wCount._word < EP0_BUFF_SIZE)                                             C:\fw\midicontroller\x009\usb.c
0028f0   0e08     MOVLW     0x8                                                                                             
0028f2   5d2c     SUBWF     0x2c,0x0,0x1                                                                                    
0028f4   0e00     MOVLW     0x0                                                                                             
0028f6   592d     SUBWFB    0x2d,0x0,0x1                                                                                    
0028f8   e205     BC        0x2904                                                                                          
0028fa   c12c     MOVFF     0x12c,0xfde            byte_to_send._word = wCount._word;                                       C:\fw\midicontroller\x009\usb.c
0028fc   ffde                                                                                                               
0028fe   c12d     MOVFF     0x12d,0xfdd                                                                                     
002900   ffdd                                                                                                               
002902   d003     BRA       0x290a             else                                                                         C:\fw\midicontroller\x009\usb.c
002904   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      C:\fw\midicontroller\x009\usb.c
002906   6ede     MOVWF     0xde,0x0                                                                                        
002908   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
00290a   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          C:\fw\midicontroller\x009\usb.c
00290c   9304     BCF       0x4,0x1,0x1                                                                                     
00290e   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          C:\fw\midicontroller\x009\usb.c
002910   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       C:\fw\midicontroller\x009\usb.c
002912   50db     MOVF      0xdb,0x0,0x0                                                                                    
002914   1304     IORWF     0x4,0x1,0x1                                                                                     
002916   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               C:\fw\midicontroller\x009\usb.c
002918   f405                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Subtract the number of bytes just about to be sent from the total.        C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
00291a   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            C:\fw\midicontroller\x009\usb.c
00291c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00291e   0101     MOVLB     0x1                                                                                             
002920   5f2c     SUBWF     0x2c,0x1,0x1                                                                                    
002922   0e01     MOVLW     0x1                                                                                             
002924   50db     MOVF      0xdb,0x0,0x0                                                                                    
002926   5b2d     SUBWFB    0x2d,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002928   0e18     MOVLW     0x18               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           C:\fw\midicontroller\x009\usb.c
00292a   6f2a     MOVWF     0x2a,0x1                                                                                        
00292c   0e04     MOVLW     0x4                                                                                             
00292e   6f2b     MOVWF     0x2b,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002930   a323     BTFSS     0x23,0x1,0x1       if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   C:\fw\midicontroller\x009\usb.c
002932   d01d     BRA       0x296e                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002934   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\fw\midicontroller\x009\usb.c
002936   ffe9                                                                                                               
002938   cfda     MOVFF     0xfda,0xfea                                                                                     
00293a   ffea                                                                                                               
00293c   50ee     MOVF      0xee,0x0,0x0                                                                                    
00293e   10ed     IORWF     0xed,0x0,0x0                                                                                    
002940   e015     BZ        0x296c                                                                                          
00296a   d7e4     BRA       0x2934                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
002942   c128     MOVFF     0x128,0xff6                *pDst.bRam = *pSrc.bRom;                                             C:\fw\midicontroller\x009\usb.c
002944   fff6                                                                                                               
002946   c129     MOVFF     0x129,0xff7                                                                                     
002948   fff7                                                                                                               
00294a   0008     TBLRD                                                                                                     
00294c   50f5     MOVF      0xf5,0x0,0x0                                                                                    
00294e   c12a     MOVFF     0x12a,0xfe9                                                                                     
002950   ffe9                                                                                                               
002952   c12b     MOVFF     0x12b,0xfea                                                                                     
002954   ffea                                                                                                               
002956   6eef     MOVWF     0xef,0x0                                                                                        
002958   2b2a     INCF      0x2a,0x1,0x1               pDst.bRam++;                                                         C:\fw\midicontroller\x009\usb.c
00295a   0e00     MOVLW     0x0                                                                                             
00295c   232b     ADDWFC    0x2b,0x1,0x1                                                                                    
00295e   2b28     INCF      0x28,0x1,0x1               pSrc.bRom++;                                                         C:\fw\midicontroller\x009\usb.c
002960   2329     ADDWFC    0x29,0x1,0x1                                                                                    
002962   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\fw\midicontroller\x009\usb.c
002964   0e01     MOVLW     0x1                                                                                             
002966   e201     BC        0x296a                                                                                          
002968   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\fw\midicontroller\x009\usb.c
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
00296c   d01b     BRA       0x29a4             else // RAM                                                                  C:\fw\midicontroller\x009\usb.c
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
00296e   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\fw\midicontroller\x009\usb.c
002970   ffe9                                                                                                               
002972   cfda     MOVFF     0xfda,0xfea                                                                                     
002974   ffea                                                                                                               
002976   50ee     MOVF      0xee,0x0,0x0                                                                                    
002978   10ed     IORWF     0xed,0x0,0x0                                                                                    
00297a   e014     BZ        0x29a4                                                                                          
0029a2   d7e5     BRA       0x296e                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
00297c   c128     MOVFF     0x128,0xfe9                *pDst.bRam = *pSrc.bRam;                                             C:\fw\midicontroller\x009\usb.c
00297e   ffe9                                                                                                               
002980   c129     MOVFF     0x129,0xfea                                                                                     
002982   ffea                                                                                                               
002984   50ef     MOVF      0xef,0x0,0x0                                                                                    
002986   c12a     MOVFF     0x12a,0xfe9                                                                                     
002988   ffe9                                                                                                               
00298a   c12b     MOVFF     0x12b,0xfea                                                                                     
00298c   ffea                                                                                                               
00298e   6eef     MOVWF     0xef,0x0                                                                                        
002990   2b2a     INCF      0x2a,0x1,0x1               pDst.bRam++;                                                         C:\fw\midicontroller\x009\usb.c
002992   0e00     MOVLW     0x0                                                                                             
002994   232b     ADDWFC    0x2b,0x1,0x1                                                                                    
002996   2b28     INCF      0x28,0x1,0x1               pSrc.bRam++;                                                         C:\fw\midicontroller\x009\usb.c
002998   2329     ADDWFC    0x29,0x1,0x1                                                                                    
00299a   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\fw\midicontroller\x009\usb.c
00299c   0e01     MOVLW     0x1                                                                                             
00299e   e201     BC        0x29a2                                                                                          
0029a0   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\fw\midicontroller\x009\usb.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0029a4   0e02     MOVLW     0x2            }//end USBCtrlTrfTxService                                                       C:\fw\midicontroller\x009\usb.c
0029a6   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0029a8   e202     BC        0x29ae                                                                                          
0029aa   6ae1     CLRF      0xe1,0x0                                                                                        
0029ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0029ae   6ee1     MOVWF     0xe1,0x0                                                                                        
0029b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0029b2   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0029b4   ffd9                                                                                                               
0029b6   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlTrfRxService(void)                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    pDst and wCount are setup properly.                          C:\fw\midicontroller\x009\usb.c
                                            *                  pSrc is always &CtrlTrfData                                  C:\fw\midicontroller\x009\usb.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        C:\fw\midicontroller\x009\usb.c
                                            *                  wCount should be set to 0 at the start of each control       C:\fw\midicontroller\x009\usb.c
                                            *                  transfer.                                                    C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        *** This routine is only partially complete. Check for       C:\fw\midicontroller\x009\usb.c
                                            *                  new version of the firmware.                                 C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
0029b8   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   C:\fw\midicontroller\x009\usb.c
0029ba   ffe6                                                                                                               
0029bc   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0029be   ffd9                                                                                                               
0029c0   0e02     MOVLW     0x2                                                                                             
0029c2   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               WORD byte_to_read;                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0029c4   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    C:\fw\midicontroller\x009\usb.c
0029c6   0104     MOVLB     0x4                                                                                             
0029c8   1500     ANDWF     0x0,0x0,0x1                                                                                     
0029ca   6ee7     MOVWF     0xe7,0x0                                                                                        
0029cc   0e01     MOVLW     0x1                                                                                             
0029ce   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0029d0   ffdb                                                                                                               
0029d2   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               C:\fw\midicontroller\x009\usb.c
0029d4   ffdf                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Accumulate total number of bytes read                                     C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
0029d6   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            C:\fw\midicontroller\x009\usb.c
0029d8   0101     MOVLB     0x1                                                                                             
0029da   272c     ADDWF     0x2c,0x1,0x1                                                                                    
0029dc   50dd     MOVF      0xdd,0x0,0x0                                                                                    
0029de   232d     ADDWFC    0x2d,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0029e0   0e18     MOVLW     0x18               pSrc.bRam = (byte*)&CtrlTrfData;                                             C:\fw\midicontroller\x009\usb.c
0029e2   6f28     MOVWF     0x28,0x1                                                                                        
0029e4   0e04     MOVLW     0x4                                                                                             
0029e6   6f29     MOVWF     0x29,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
0029e8   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    C:\fw\midicontroller\x009\usb.c
0029ea   ffe9                                                                                                               
0029ec   cfda     MOVFF     0xfda,0xfea                                                                                     
0029ee   ffea                                                                                                               
0029f0   50ee     MOVF      0xee,0x0,0x0                                                                                    
0029f2   10ed     IORWF     0xed,0x0,0x0                                                                                    
0029f4   e014     BZ        0x2a1e                                                                                          
002a1c   d7e5     BRA       0x29e8                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
0029f6   c128     MOVFF     0x128,0xfe9            *pDst.bRam = *pSrc.bRam;                                                 C:\fw\midicontroller\x009\usb.c
0029f8   ffe9                                                                                                               
0029fa   c129     MOVFF     0x129,0xfea                                                                                     
0029fc   ffea                                                                                                               
0029fe   50ef     MOVF      0xef,0x0,0x0                                                                                    
002a00   c12a     MOVFF     0x12a,0xfe9                                                                                     
002a02   ffe9                                                                                                               
002a04   c12b     MOVFF     0x12b,0xfea                                                                                     
002a06   ffea                                                                                                               
002a08   6eef     MOVWF     0xef,0x0                                                                                        
002a0a   2b2a     INCF      0x2a,0x1,0x1           pDst.bRam++;                                                             C:\fw\midicontroller\x009\usb.c
002a0c   0e00     MOVLW     0x0                                                                                             
002a0e   232b     ADDWFC    0x2b,0x1,0x1                                                                                    
002a10   2b28     INCF      0x28,0x1,0x1           pSrc.bRam++;                                                             C:\fw\midicontroller\x009\usb.c
002a12   2329     ADDWFC    0x29,0x1,0x1                                                                                    
002a14   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    C:\fw\midicontroller\x009\usb.c
002a16   0e01     MOVLW     0x1                                                                                             
002a18   e201     BC        0x2a1c                                                                                          
002a1a   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002a1e   0e02     MOVLW     0x2            }//end USBCtrlTrfRxService                                                       C:\fw\midicontroller\x009\usb.c
002a20   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002a22   e202     BC        0x2a28                                                                                          
002a24   6ae1     CLRF      0xe1,0x0                                                                                        
002a26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a28   6ee1     MOVWF     0xe1,0x0                                                                                        
002a2a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a2c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002a2e   ffd9                                                                                                               
002a30   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        C:\fw\midicontroller\x009\usb.c
                                            *                  a Setup Request. Its main task is to set the endpoint        C:\fw\midicontroller\x009\usb.c
                                            *                  controls appropriately for a given situation. See code       C:\fw\midicontroller\x009\usb.c
                                            *                  below.                                                       C:\fw\midicontroller\x009\usb.c
                                            *                  There are three main scenarios:                              C:\fw\midicontroller\x009\usb.c
                                            *                  a) There was no handler for the Request, in this case        C:\fw\midicontroller\x009\usb.c
                                            *                     a STALL should be sent out.                               C:\fw\midicontroller\x009\usb.c
                                            *                  b) The host has requested a read control transfer,           C:\fw\midicontroller\x009\usb.c
                                            *                     endpoints are required to be setup in a specific way.     C:\fw\midicontroller\x009\usb.c
                                            *                  c) The host has requested a write control transfer, or       C:\fw\midicontroller\x009\usb.c
                                            *                     a control data stage is not required, endpoints are       C:\fw\midicontroller\x009\usb.c
                                            *                     required to be setup in a specific way.                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCtrlEPServiceComplete(void)                                              C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002a32   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_NULL)                                      C:\fw\midicontroller\x009\usb.c
002a34   5127     MOVF      0x27,0x0,0x1                                                                                    
002a36   e10b     BNZ       0x2a4e                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x009\usb.c
                                                    * If no one knows how to service this request then stall.               C:\fw\midicontroller\x009\usb.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          C:\fw\midicontroller\x009\usb.c
                                                    */                                                                      C:\fw\midicontroller\x009\usb.c
002a38   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               C:\fw\midicontroller\x009\usb.c
002a3a   0e08     MOVLW     0x8                                                                                             
002a3c   6f01     MOVWF     0x1,0x1                                                                                         
002a3e   0e10     MOVLW     0x10                   ep0Bo.ADR = (byte*)&SetupPkt;                                            C:\fw\midicontroller\x009\usb.c
002a40   6f02     MOVWF     0x2,0x1                                                                                         
002a42   0e04     MOVLW     0x4                                                                                             
002a44   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002a46   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        C:\fw\midicontroller\x009\usb.c
002a48   6f00     MOVWF     0x0,0x1                                                                                         
002a4a   6f04     MOVWF     0x4,0x1                ep0Bi.Stat._byte = _USIE|_BSTALL;                                        C:\fw\midicontroller\x009\usb.c
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
002a4c   d033     BRA       0x2ab4             else    // A module has claimed ownership of the control transfer session.   C:\fw\midicontroller\x009\usb.c
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002a4e   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      C:\fw\midicontroller\x009\usb.c
002a50   af10     BTFSS     0x10,0x7,0x1                                                                                    
002a52   d021     BRA       0x2a96                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
002a54   0101     MOVLB     0x1                        if(SetupPkt.wLength < wCount._word)                                  C:\fw\midicontroller\x009\usb.c
002a56   512c     MOVF      0x2c,0x0,0x1                                                                                    
002a58   0104     MOVLB     0x4                                                                                             
002a5a   5d16     SUBWF     0x16,0x0,0x1                                                                                    
002a5c   0101     MOVLB     0x1                                                                                             
002a5e   512d     MOVF      0x2d,0x0,0x1                                                                                    
002a60   0104     MOVLB     0x4                                                                                             
002a62   5917     SUBWFB    0x17,0x0,0x1                                                                                    
002a64   e204     BC        0x2a6e                                                                                          
002a66   c416     MOVFF     0x416,0x12c                    wCount._word = SetupPkt.wLength;                                 C:\fw\midicontroller\x009\usb.c
002a68   f12c                                                                                                               
002a6a   c417     MOVFF     0x417,0x12d                                                                                     
002a6c   f12d                                                                                                               
002a6e   df39     RCALL     0x28e2                     USBCtrlTrfTxService();                                               C:\fw\midicontroller\x009\usb.c
002a70   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_TX;                                        C:\fw\midicontroller\x009\usb.c
002a72   0e01     MOVLW     0x1                                                                                             
002a74   6f26     MOVWF     0x26,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * Control Read:                                                     C:\fw\midicontroller\x009\usb.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  C:\fw\midicontroller\x009\usb.c
                                                        * 1. Prepare OUT EP to respond to early termination                 C:\fw\midicontroller\x009\usb.c
                                                        *                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * NOTE:                                                             C:\fw\midicontroller\x009\usb.c
                                                        * If something went wrong during the control transfer,              C:\fw\midicontroller\x009\usb.c
                                                        * the last status stage may not be sent by the host.                C:\fw\midicontroller\x009\usb.c
                                                        * When this happens, two different things could happen              C:\fw\midicontroller\x009\usb.c
                                                        * depending on the host.                                            C:\fw\midicontroller\x009\usb.c
                                                        * a) The host could send out a RESET.                               C:\fw\midicontroller\x009\usb.c
                                                        * b) The host could send out a new SETUP transaction                C:\fw\midicontroller\x009\usb.c
                                                        *    without sending a RESET first.                                 C:\fw\midicontroller\x009\usb.c
                                                        * To properly handle case (b), the OUT EP must be setup             C:\fw\midicontroller\x009\usb.c
                                                        * to receive either a zero length OUT transaction, or a             C:\fw\midicontroller\x009\usb.c
                                                        * new SETUP transaction.                                            C:\fw\midicontroller\x009\usb.c
                                                        *                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * Since the SETUP transaction requires the DTS bit to be            C:\fw\midicontroller\x009\usb.c
                                                        * DAT0 while the zero length OUT status requires the DTS            C:\fw\midicontroller\x009\usb.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          C:\fw\midicontroller\x009\usb.c
                                                        * be disabled. This way the SIE could accept either of              C:\fw\midicontroller\x009\usb.c
                                                        * the two transactions.                                             C:\fw\midicontroller\x009\usb.c
                                                        *                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            C:\fw\midicontroller\x009\usb.c
                                                        * the SETUP data (8-byte or more), and the buffer address           C:\fw\midicontroller\x009\usb.c
                                                        * should be pointed to SetupPkt.                                    C:\fw\midicontroller\x009\usb.c
                                                        */                                                                  C:\fw\midicontroller\x009\usb.c
002a76   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\fw\midicontroller\x009\usb.c
002a78   0e08     MOVLW     0x8                                                                                             
002a7a   6f01     MOVWF     0x1,0x1                                                                                         
002a7c   0e10     MOVLW     0x10                       ep0Bo.ADR = (byte*)&SetupPkt;                                        C:\fw\midicontroller\x009\usb.c
002a7e   6f02     MOVWF     0x2,0x1                                                                                         
002a80   0e04     MOVLW     0x4                                                                                             
002a82   6f03     MOVWF     0x3,0x1                                                                                         
002a84   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             C:\fw\midicontroller\x009\usb.c
002a86   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                       /*                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                C:\fw\midicontroller\x009\usb.c
                                                        *    been initialized by responsible request owner.                 C:\fw\midicontroller\x009\usb.c
                                                        */                                                                  C:\fw\midicontroller\x009\usb.c
002a88   0e18     MOVLW     0x18                       ep0Bi.ADR = (byte*)&CtrlTrfData;                                     C:\fw\midicontroller\x009\usb.c
002a8a   6f06     MOVWF     0x6,0x1                                                                                         
002a8c   0e04     MOVLW     0x4                                                                                             
002a8e   6f07     MOVWF     0x7,0x1                                                                                         
002a90   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
002a92   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        C:\fw\midicontroller\x009\usb.c
002a94   d00f     BRA       0x2ab4                 else    // (SetupPkt.DataDir == HOST_TO_DEV)                             C:\fw\midicontroller\x009\usb.c
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
002a96   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_RX;                                        C:\fw\midicontroller\x009\usb.c
002a98   0e02     MOVLW     0x2                                                                                             
002a9a   6f26     MOVWF     0x26,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * Control Write:                                                    C:\fw\midicontroller\x009\usb.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 C:\fw\midicontroller\x009\usb.c
                                                        *                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * 1. Prepare IN EP to respond to early termination                  C:\fw\midicontroller\x009\usb.c
                                                        *                                                                   C:\fw\midicontroller\x009\usb.c
                                                        *    This is the same as a Zero Length Packet Response              C:\fw\midicontroller\x009\usb.c
                                                        *    for control transfer without a data stage                      C:\fw\midicontroller\x009\usb.c
                                                        */                                                                  C:\fw\midicontroller\x009\usb.c
002a9c   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       C:\fw\midicontroller\x009\usb.c
002a9e   6b05     CLRF      0x5,0x1                                                                                         
002aa0   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
002aa2   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                       /*                                                                   C:\fw\midicontroller\x009\usb.c
                                                        * 2. Prepare OUT EP to receive data.                                C:\fw\midicontroller\x009\usb.c
                                                        */                                                                  C:\fw\midicontroller\x009\usb.c
002aa4   0e08     MOVLW     0x8                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\fw\midicontroller\x009\usb.c
002aa6   6f01     MOVWF     0x1,0x1                                                                                         
002aa8   0e18     MOVLW     0x18                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     C:\fw\midicontroller\x009\usb.c
002aaa   6f02     MOVWF     0x2,0x1                                                                                         
002aac   0e04     MOVLW     0x4                                                                                             
002aae   6f03     MOVWF     0x3,0x1                                                                                         
002ab0   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x009\usb.c
002ab2   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               C:\fw\midicontroller\x009\usb.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   C:\fw\midicontroller\x009\usb.c
                                                * Clear to resume packet processing.                                        C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002ab4   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002ab6   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       C:\fw\midicontroller\x009\usb.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBPrepareForNextSetupTrf(void)                                             C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002ab8   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  C:\fw\midicontroller\x009\usb.c
002aba   6b26     CLRF      0x26,0x1                                                                                        
002abc   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               C:\fw\midicontroller\x009\usb.c
002abe   0e08     MOVLW     0x8                                                                                             
002ac0   6f01     MOVWF     0x1,0x1                                                                                         
002ac2   0e10     MOVLW     0x10               ep0Bo.ADR = (byte*)&SetupPkt;                                                C:\fw\midicontroller\x009\usb.c
002ac4   6f02     MOVWF     0x2,0x1                                                                                         
002ac6   0e04     MOVLW     0x4                                                                                             
002ac8   6f03     MOVWF     0x3,0x1                                                                                         
002aca   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  C:\fw\midicontroller\x009\usb.c
002acc   6f00     MOVWF     0x0,0x1                                                                                         
002ace   6b04     CLRF      0x4,0x1            ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      C:\fw\midicontroller\x009\usb.c
002ad0   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** EOF usbctrltrf.c *********************************************************/  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           //usbdrv.c                                                                       C:\fw\midicontroller\x009\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\usb.c
                                           //#include "io_cfg.h"             // Required for USBCheckBusStatus()            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBModuleEnable(void);                                                      C:\fw\midicontroller\x009\usb.c
                                           void USBModuleDisable(void);                                                     C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           void USBSuspend(void);                                                           C:\fw\midicontroller\x009\usb.c
                                           void USBWakeFromSuspend(void);                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           void USBProtocolResetHandler(void);                                              C:\fw\midicontroller\x009\usb.c
                                           void USB_SOF_Handler(void);                                                      C:\fw\midicontroller\x009\usb.c
                                           void USBStallHandler(void);                                                      C:\fw\midicontroller\x009\usb.c
                                           void USBErrorHandler(void);                                                      C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x009\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBCheckBusStatus(void)                                 C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   C:\fw\midicontroller\x009\usb.c
                                            *                  the USB power signal.                                        C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBCheckBusStatus(void)                                                     C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               /**************************************************************************  C:\fw\midicontroller\x009\usb.c
                                                * Bus Attachment & Detachment Detection                                     C:\fw\midicontroller\x009\usb.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           C:\fw\midicontroller\x009\usb.c
                                                *************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                               #define USB_BUS_ATTACHED    1                                                C:\fw\midicontroller\x009\usb.c
                                               #define USB_BUS_DETACHED    0                                                C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          C:\fw\midicontroller\x009\usb.c
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002ad2   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            C:\fw\midicontroller\x009\usb.c
002ad4   d80f     RCALL     0x2af4                     USBModuleEnable();                  // Is off, enable it             C:\fw\midicontroller\x009\usb.c
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
002ad6   d002     BRA       0x2adc             else                                                                         C:\fw\midicontroller\x009\usb.c
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002ad8   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             C:\fw\midicontroller\x009\usb.c
002ada   d813     RCALL     0x2b02                     USBModuleDisable();                 // Is on, disable it             C:\fw\midicontroller\x009\usb.c
                                               }//end if(usb_bus_sense...)                                                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * After enabling the USB module, it takes some time for the voltage         C:\fw\midicontroller\x009\usb.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. C:\fw\midicontroller\x009\usb.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is C:\fw\midicontroller\x009\usb.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     C:\fw\midicontroller\x009\usb.c
                                                * unique event as a USB bus reset from the USB host.                        C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002adc   0101     MOVLB     0x1                if(usb_device_state == ATTACHED_STATE)                                       C:\fw\midicontroller\x009\usb.c
002ade   0522     DECF      0x22,0x0,0x1                                                                                    
002ae0   e108     BNZ       0x2af2                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002ae2   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        C:\fw\midicontroller\x009\usb.c
002ae4   d006     BRA       0x2af2                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
002ae6   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          C:\fw\midicontroller\x009\usb.c
002ae8   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           C:\fw\midicontroller\x009\usb.c
002aea   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            C:\fw\midicontroller\x009\usb.c
002aec   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             C:\fw\midicontroller\x009\usb.c
002aee   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    C:\fw\midicontroller\x009\usb.c
002af0   6f22     MOVWF     0x22,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002af2   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBModuleEnable(void)                                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine enables the USB module.                         C:\fw\midicontroller\x009\usb.c
                                            *                  An end designer should never have to call this routine       C:\fw\midicontroller\x009\usb.c
                                            *                  manually. This routine should only be called from            C:\fw\midicontroller\x009\usb.c
                                            *                  USBCheckBusStatus().                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBModuleEnable(void)                                                       C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002af4   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    C:\fw\midicontroller\x009\usb.c
002af6   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\fw\midicontroller\x009\usb.c
002af8   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     C:\fw\midicontroller\x009\usb.c
002afa   0101     MOVLB     0x1                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         C:\fw\midicontroller\x009\usb.c
002afc   0e01     MOVLW     0x1                                                                                             
002afe   6f22     MOVWF     0x22,0x1                                                                                        
002b00   0012     RETURN    0x0            }//end USBModuleEnable                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBModuleDisable(void)                                  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine disables the USB module.                        C:\fw\midicontroller\x009\usb.c
                                            *                  An end designer should never have to call this routine       C:\fw\midicontroller\x009\usb.c
                                            *                  manually. This routine should only be called from            C:\fw\midicontroller\x009\usb.c
                                            *                  USBCheckBusStatus().                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBModuleDisable(void)                                                      C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002b02   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  C:\fw\midicontroller\x009\usb.c
002b04   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\fw\midicontroller\x009\usb.c
002b06   0101     MOVLB     0x1                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         C:\fw\midicontroller\x009\usb.c
002b08   6b22     CLRF      0x22,0x1                                                                                        
002b0a   0012     RETURN    0x0            }//end USBModuleDisable                                                          C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBSoftDetach(void)                                     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       C:\fw\midicontroller\x009\usb.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      C:\fw\midicontroller\x009\usb.c
                                            *                  pull-up resistor. The pull-down resistors on the host        C:\fw\midicontroller\x009\usb.c
                                            *                  side will pull both differential signal lines low and        C:\fw\midicontroller\x009\usb.c
                                            *                  the host registers the event as a disconnect.                C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                  Since the USB cable is not physically disconnected, the      C:\fw\midicontroller\x009\usb.c
                                            *                  power supply through the cable can still be sensed by        C:\fw\midicontroller\x009\usb.c
                                            *                  the device. The next time USBCheckBusStatus() function       C:\fw\midicontroller\x009\usb.c
                                            *                  is called, it will reconnect the device back to the bus.     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBSoftDetach(void)                                                         C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002b0c   ef81     GOTO      0x2b02             USBModuleDisable();                                                          C:\fw\midicontroller\x009\usb.c
002b0e   f015                                                                                                               
                                           }//end USBSoftDetach                                                             C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBDriverService(void)                                  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This routine is the heart of this firmware. It manages       C:\fw\midicontroller\x009\usb.c
                                            *                  all USB interrupts.                                          C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            Device state transitions through the following stages:       C:\fw\midicontroller\x009\usb.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                C:\fw\midicontroller\x009\usb.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBDriverService(void)                                                      C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Pointless to continue servicing if USB cable is not even attached.        C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b10   0101     MOVLB     0x1                if(usb_device_state == DETACHED_STATE) return;                               C:\fw\midicontroller\x009\usb.c
002b12   5122     MOVF      0x22,0x0,0x1                                                                                    
002b14   e101     BNZ       0x2b18                                                                                          
002b16   d039     BRA       0x2b8a                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Task A: Service USB Activity Interrupt                                    C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002b18   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                C:\fw\midicontroller\x009\usb.c
002b1a   0b04     ANDLW     0x4                                                                                             
002b1c   e004     BZ        0x2b26                                                                                          
002b1e   5069     MOVF      0x69,0x0,0x0                                                                                    
002b20   0b04     ANDLW     0x4                                                                                             
002b22   e001     BZ        0x2b26                                                                                          
002b24   d838     RCALL     0x2b96                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Pointless to continue servicing if the device is in suspend mode.         C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b26   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               C:\fw\midicontroller\x009\usb.c
002b28   d030     BRA       0x2b8a                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  C:\fw\midicontroller\x009\usb.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      C:\fw\midicontroller\x009\usb.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  C:\fw\midicontroller\x009\usb.c
                                                * This is why URSTIF is checked after ACTVIF.                               C:\fw\midicontroller\x009\usb.c
                                                *                                                                           C:\fw\midicontroller\x009\usb.c
                                                * The USB reset flag is masked when the USB state is in                     C:\fw\midicontroller\x009\usb.c
                                                * DETACHED_STATE or ATTACHED_STATE, and therefore cannot                    C:\fw\midicontroller\x009\usb.c
                                                * cause a USB reset event during these two states.                          C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b2a   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           C:\fw\midicontroller\x009\usb.c
002b2c   0b01     ANDLW     0x1                                                                                             
002b2e   e004     BZ        0x2b38                                                                                          
002b30   5069     MOVF      0x69,0x0,0x0                                                                                    
002b32   0b01     ANDLW     0x1                                                                                             
002b34   e001     BZ        0x2b38                                                                                          
002b36   d84f     RCALL     0x2bd6                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Task C: Service other USB interrupts                                      C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b38   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        C:\fw\midicontroller\x009\usb.c
002b3a   0b10     ANDLW     0x10                                                                                            
002b3c   e004     BZ        0x2b46                                                                                          
002b3e   5069     MOVF      0x69,0x0,0x0                                                                                    
002b40   0b10     ANDLW     0x10                                                                                            
002b42   e001     BZ        0x2b46                                                                                          
002b44   d823     RCALL     0x2b8c                                                                                          
002b46   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   C:\fw\midicontroller\x009\usb.c
002b48   0b40     ANDLW     0x40                                                                                            
002b4a   e004     BZ        0x2b54                                                                                          
002b4c   5069     MOVF      0x69,0x0,0x0                                                                                    
002b4e   0b40     ANDLW     0x40                                                                                            
002b50   e001     BZ        0x2b54                                                                                          
002b52   d837     RCALL     0x2bc2                                                                                          
002b54   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   C:\fw\midicontroller\x009\usb.c
002b56   0b20     ANDLW     0x20                                                                                            
002b58   e004     BZ        0x2b62                                                                                          
002b5a   5069     MOVF      0x69,0x0,0x0                                                                                    
002b5c   0b20     ANDLW     0x20                                                                                            
002b5e   e001     BZ        0x2b62                                                                                          
002b60   d832     RCALL     0x2bc6                                                                                          
002b62   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   C:\fw\midicontroller\x009\usb.c
002b64   0b02     ANDLW     0x2                                                                                             
002b66   e004     BZ        0x2b70                                                                                          
002b68   5069     MOVF      0x69,0x0,0x0                                                                                    
002b6a   0b02     ANDLW     0x2                                                                                             
002b6c   e001     BZ        0x2b70                                                                                          
002b6e   d831     RCALL     0x2bd2                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     C:\fw\midicontroller\x009\usb.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       C:\fw\midicontroller\x009\usb.c
                                                * state and is ready for communication.                                     C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b70   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 C:\fw\midicontroller\x009\usb.c
002b72   0101     MOVLB     0x1                                                                                             
002b74   5d22     SUBWF     0x22,0x0,0x1                                                                                    
002b76   e201     BC        0x2b7a                                                                                          
002b78   d008     BRA       0x2b8a                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b7a   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           C:\fw\midicontroller\x009\usb.c
002b7c   0b08     ANDLW     0x8                                                                                             
002b7e   e005     BZ        0x2b8a                                                                                          
002b80   5069     MOVF      0x69,0x0,0x0                                                                                    
002b82   0b08     ANDLW     0x8                                                                                             
002b84   e002     BZ        0x2b8a                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x009\usb.c
                                                    * USBCtrlEPService only services transactions over EP0.                 C:\fw\midicontroller\x009\usb.c
                                                    * It ignores all other EP transactions.                                 C:\fw\midicontroller\x009\usb.c
                                                    */                                                                      C:\fw\midicontroller\x009\usb.c
002b86   de34     RCALL     0x27f0                 USBCtrlEPService();                                                      C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x009\usb.c
                                                    * Other EP can be serviced later by responsible device class firmware.  C:\fw\midicontroller\x009\usb.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    C:\fw\midicontroller\x009\usb.c
                                                    * checking the buffer ownership bit.                                    C:\fw\midicontroller\x009\usb.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      C:\fw\midicontroller\x009\usb.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       C:\fw\midicontroller\x009\usb.c
                                                    *                                                                       C:\fw\midicontroller\x009\usb.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    C:\fw\midicontroller\x009\usb.c
                                                    * of non-EP0 transactions.                                              C:\fw\midicontroller\x009\usb.c
                                                    */                                                                      C:\fw\midicontroller\x009\usb.c
002b88   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\fw\midicontroller\x009\usb.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002b8a   0012     RETURN    0x0            }//end USBDriverService                                                          C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBSuspend(void)                                        C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:                                                                     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBSuspend(void)                                                            C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   C:\fw\midicontroller\x009\usb.c
                                                * Reason:                                                                   C:\fw\midicontroller\x009\usb.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               C:\fw\midicontroller\x009\usb.c
                                                * This is a 1:1 ratio interrupt generation.                                 C:\fw\midicontroller\x009\usb.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             C:\fw\midicontroller\x009\usb.c
                                                * the number of subsequent bus transitions.                                 C:\fw\midicontroller\x009\usb.c
                                                *                                                                           C:\fw\midicontroller\x009\usb.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 C:\fw\midicontroller\x009\usb.c
                                                * [       IDLE       ][bus activity ->                                      C:\fw\midicontroller\x009\usb.c
                                                * <--- 3 ms ----->     ^                                                    C:\fw\midicontroller\x009\usb.c
                                                *                ^     ACTVIF=1                                             C:\fw\midicontroller\x009\usb.c
                                                *                IDLEIF=1                                                   C:\fw\midicontroller\x009\usb.c
                                                *  #           #           #           #   (#=Program polling flags)        C:\fw\midicontroller\x009\usb.c
                                                *                          ^                                                C:\fw\midicontroller\x009\usb.c
                                                *                          This polling loop will see both                  C:\fw\midicontroller\x009\usb.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           C:\fw\midicontroller\x009\usb.c
                                                *                          However, the program services IDLEIF first       C:\fw\midicontroller\x009\usb.c
                                                *                          because ACTIVIE=0.                               C:\fw\midicontroller\x009\usb.c
                                                *                          If this routine clears the only ACTIVIF,         C:\fw\midicontroller\x009\usb.c
                                                *                          then it can never get out of the suspend         C:\fw\midicontroller\x009\usb.c
                                                *                          mode.                                            C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b8c   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     C:\fw\midicontroller\x009\usb.c
002b8e   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          C:\fw\midicontroller\x009\usb.c
002b90   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  C:\fw\midicontroller\x009\usb.c
                                                                                       // mode, SIE clock inactive          C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * At this point the PIC can go into sleep,idle, or                          C:\fw\midicontroller\x009\usb.c
                                                * switch to a slower clock, etc.                                            C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               /* Modifiable Section */                                                     C:\fw\midicontroller\x009\usb.c
002b92   9aa1     BCF       0xa1,0x5,0x0       PIR2bits.USBIF = 0;                                                          C:\fw\midicontroller\x009\usb.c
                                           /*                                                                               C:\fw\midicontroller\x009\usb.c
                                           //2/15/05 JD This was causing problems with USBIE being enabled..                C:\fw\midicontroller\x009\usb.c
                                               INTCONbits.RBIF = 0;                                                         C:\fw\midicontroller\x009\usb.c
                                               PIE2bits.USBIE = 1;                     // Set USB wakeup source             C:\fw\midicontroller\x009\usb.c
                                               INTCONbits.RBIE = 1;                    // Set sw2,3 wakeup source           C:\fw\midicontroller\x009\usb.c
                                               Sleep();                                // Goto sleep                        C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                               if(INTCONbits.RBIF == 1)                // Check if external stimulus        C:\fw\midicontroller\x009\usb.c
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
                                                   USBRemoteWakeup();                  // If yes, attempt RWU               C:\fw\midicontroller\x009\usb.c
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
                                               PIE2bits.USBIE = 0;                                                          C:\fw\midicontroller\x009\usb.c
                                               INTCONbits.RBIE = 0;                                                         C:\fw\midicontroller\x009\usb.c
                                           */                                                                               C:\fw\midicontroller\x009\usb.c
                                               /* End Modifiable Section */                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002b94   0012     RETURN    0x0            }//end USBSuspend                                                                C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBWakeFromSuspend(void)                                C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:                                                                     C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBWakeFromSuspend(void)                                                    C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * If using clock switching, this is the place to restore the                C:\fw\midicontroller\x009\usb.c
                                                * original clock frequency.                                                 C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002b96   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         C:\fw\midicontroller\x009\usb.c
002b98   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          C:\fw\midicontroller\x009\usb.c
002b9a   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          C:\fw\midicontroller\x009\usb.c
002b9c   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBRemoteWakeup(void)                                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        This function should be called by user when the device       C:\fw\midicontroller\x009\usb.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      C:\fw\midicontroller\x009\usb.c
                                            *                  Please read the note below to understand the limitations.    C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            The modifiable section in this routine should be changed     C:\fw\midicontroller\x009\usb.c
                                            *                  to meet the application needs. Current implementation        C:\fw\midicontroller\x009\usb.c
                                            *                  temporary blocks other functions from executing for a        C:\fw\midicontroller\x009\usb.c
                                            *                  period of 1-13 ms depending on the core frequency.           C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          C:\fw\midicontroller\x009\usb.c
                                            *                  "The remote wakeup device must hold the resume signaling     C:\fw\midicontroller\x009\usb.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                C:\fw\midicontroller\x009\usb.c
                                            *                  The idea here is to use a delay counter loop, using a        C:\fw\midicontroller\x009\usb.c
                                            *                  common value that would work over a wide range of core       C:\fw\midicontroller\x009\usb.c
                                            *                  frequencies.                                                 C:\fw\midicontroller\x009\usb.c
                                            *                  That value selected is 1800. See table below:                C:\fw\midicontroller\x009\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x009\usb.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    C:\fw\midicontroller\x009\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x009\usb.c
                                            *                      48              12          1.05                         C:\fw\midicontroller\x009\usb.c
                                            *                       4              1           12.6                         C:\fw\midicontroller\x009\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x009\usb.c
                                            *                  * These timing could be incorrect when using code            C:\fw\midicontroller\x009\usb.c
                                            *                    optimization or extended instruction mode,                 C:\fw\midicontroller\x009\usb.c
                                            *                    or when having other interrupts enabled.                   C:\fw\midicontroller\x009\usb.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBRemoteWakeup(void)                                                       C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               static word delay_count;                                                     C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002b9e   0101     MOVLB     0x1                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    C:\fw\midicontroller\x009\usb.c
002ba0   a123     BTFSS     0x23,0x0,0x1                                                                                    
002ba2   d00e     BRA       0x2bc0                                                                                          
                                               {                                       // has been enabled by the host.     C:\fw\midicontroller\x009\usb.c
002ba4   dff8     RCALL     0x2b96                 USBWakeFromSuspend();               // Unsuspend USB modue               C:\fw\midicontroller\x009\usb.c
002ba6   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /* Modifiable Section */                                                 C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002ba8   0101     MOVLB     0x1                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       C:\fw\midicontroller\x009\usb.c
002baa   0e08     MOVLW     0x8                                                                                             
002bac   6f2e     MOVWF     0x2e,0x1                                                                                        
002bae   0e07     MOVLW     0x7                                                                                             
002bb0   6f2f     MOVWF     0x2f,0x1                                                                                        
                                                   do                                                                       C:\fw\midicontroller\x009\usb.c
                                                   {                                                                        C:\fw\midicontroller\x009\usb.c
002bb2   072e     DECF      0x2e,0x1,0x1               delay_count--;                                                       C:\fw\midicontroller\x009\usb.c
002bb4   0e00     MOVLW     0x0                                                                                             
002bb6   5b2f     SUBWFB    0x2f,0x1,0x1                                                                                    
002bb8   512e     MOVF      0x2e,0x0,0x1           }while(delay_count);                                                     C:\fw\midicontroller\x009\usb.c
002bba   112f     IORWF     0x2f,0x0,0x1                                                                                    
002bbc   e1fa     BNZ       0x2bb2                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                   /* End Modifiable Section */                                             C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002bbe   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     C:\fw\midicontroller\x009\usb.c
                                               }//endif                                                                     C:\fw\midicontroller\x009\usb.c
002bc0   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USB_SOF_Handler(void)                                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    C:\fw\midicontroller\x009\usb.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     C:\fw\midicontroller\x009\usb.c
                                            *                  pipes. End designers should implement callback routine       C:\fw\midicontroller\x009\usb.c
                                            *                  as necessary.                                                C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USB_SOF_Handler(void)                                                       C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               /* Callback routine here */                                                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002bc2   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           C:\fw\midicontroller\x009\usb.c
002bc4   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBStallHandler(void)                                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         C:\fw\midicontroller\x009\usb.c
                                            *                  packet regardless of which endpoint causes it.               C:\fw\midicontroller\x009\usb.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  C:\fw\midicontroller\x009\usb.c
                                            *                  endpoint stops stalling once it receives a setup packet.     C:\fw\midicontroller\x009\usb.c
                                            *                  In this case, the SIE will accepts the Setup packet and      C:\fw\midicontroller\x009\usb.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    C:\fw\midicontroller\x009\usb.c
                                            *                  for that particular endpoint pipe will be automatically      C:\fw\midicontroller\x009\usb.c
                                            *                  disabled (direction specific).                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            *                  There are a few reasons for an endpoint to be stalled.       C:\fw\midicontroller\x009\usb.c
                                            *                  1. When a non-supported USB request is received.             C:\fw\midicontroller\x009\usb.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 C:\fw\midicontroller\x009\usb.c
                                            *                  2. When an endpoint is currently halted.                     C:\fw\midicontroller\x009\usb.c
                                            *                  3. When the device class specifies that an endpoint must     C:\fw\midicontroller\x009\usb.c
                                            *                     stall in response to a specific event.                    C:\fw\midicontroller\x009\usb.c
                                            *                     Example: Mass Storage Device Class                        C:\fw\midicontroller\x009\usb.c
                                            *                              If the CBW is not valid, the device shall        C:\fw\midicontroller\x009\usb.c
                                            *                              STALL the Bulk-In pipe.                          C:\fw\midicontroller\x009\usb.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   C:\fw\midicontroller\x009\usb.c
                                            *                              Specification for more details.                  C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     C:\fw\midicontroller\x009\usb.c
                                            *                  the stall event.                                             C:\fw\midicontroller\x009\usb.c
                                            *                  If                                                           C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBStallHandler(void)                                                       C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
                                               /*                                                                           C:\fw\midicontroller\x009\usb.c
                                                * Does not really have to do anything here,                                 C:\fw\midicontroller\x009\usb.c
                                                * even for the control endpoint.                                            C:\fw\midicontroller\x009\usb.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         C:\fw\midicontroller\x009\usb.c
                                                * but once a Setup Transaction is received, the ownership                   C:\fw\midicontroller\x009\usb.c
                                                * for EP0_OUT will be returned to CPU.                                      C:\fw\midicontroller\x009\usb.c
                                                * When the Setup Transaction is serviced, the ownership                     C:\fw\midicontroller\x009\usb.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   C:\fw\midicontroller\x009\usb.c
                                                */                                                                          C:\fw\midicontroller\x009\usb.c
002bc6   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    C:\fw\midicontroller\x009\usb.c
002bc8   d002     BRA       0x2bce                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
002bca   df76     RCALL     0x2ab8                 USBPrepareForNextSetupTrf();        // Firmware work-around              C:\fw\midicontroller\x009\usb.c
002bcc   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    C:\fw\midicontroller\x009\usb.c
                                               }                                                                            C:\fw\midicontroller\x009\usb.c
002bce   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         C:\fw\midicontroller\x009\usb.c
002bd0   0012     RETURN    0x0            }//end USBStallHandler                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBErrorHandler(void)                                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        C:\fw\midicontroller\x009\usb.c
                                            *                  during development. Check UEIR to see which error causes     C:\fw\midicontroller\x009\usb.c
                                            *                  the interrupt.                                               C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBErrorHandler(void)                                                       C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002bd2   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          C:\fw\midicontroller\x009\usb.c
002bd4   0012     RETURN    0x0            }//end USBErrorHandler                                                           C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\usb.c
                                            * Function:        void USBProtocolResetHandler(void)                           C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * PreCondition:    A USB bus reset is received from the host.                   C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              C:\fw\midicontroller\x009\usb.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     C:\fw\midicontroller\x009\usb.c
                                            *                  might not be desirable in some applications.                 C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Overview:        Once a USB bus reset is received from the host, this         C:\fw\midicontroller\x009\usb.c
                                            *                  routine should be called. It resets the device address to    C:\fw\midicontroller\x009\usb.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     C:\fw\midicontroller\x009\usb.c
                                            *                  be ready for default communication, clears all USB           C:\fw\midicontroller\x009\usb.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      C:\fw\midicontroller\x009\usb.c
                                            *                  reinitializes internal state-machine variables.              C:\fw\midicontroller\x009\usb.c
                                            *                                                                               C:\fw\midicontroller\x009\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\usb.c
                                           void USBProtocolResetHandler(void)                                               C:\fw\midicontroller\x009\usb.c
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002bd6   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 C:\fw\midicontroller\x009\usb.c
002bd8   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 C:\fw\midicontroller\x009\usb.c
002bda   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           C:\fw\midicontroller\x009\usb.c
002bdc   6e6b     MOVWF     0x6b,0x0                                                                                        
002bde   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       C:\fw\midicontroller\x009\usb.c
002be0   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002be2   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  C:\fw\midicontroller\x009\usb.c
002be4   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          C:\fw\midicontroller\x009\usb.c
002be6   6ee6     MOVWF     0xe6,0x0                                                                                        
002be8   0e71     MOVLW     0x71                                                                                            
002bea   6ee6     MOVWF     0xe6,0x0                                                                                        
002bec   0e0f     MOVLW     0xf                                                                                             
002bee   6ee6     MOVWF     0xe6,0x0                                                                                        
002bf0   d811     RCALL     0x2c14                                                                                          
002bf2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002bf4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002bf6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002bf8   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       C:\fw\midicontroller\x009\usb.c
002bfa   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002bfc   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            C:\fw\midicontroller\x009\usb.c
002bfe   d002     BRA       0x2c04                                                                                          
002c02   d7fc     BRA       0x2bfc                                                                                          
002c00   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002c04   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    C:\fw\midicontroller\x009\usb.c
002c06   df58     RCALL     0x2ab8             USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
002c08   0101     MOVLB     0x1                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            C:\fw\midicontroller\x009\usb.c
002c0a   9123     BCF       0x23,0x0,0x1                                                                                    
002c0c   6b24     CLRF      0x24,0x1           usb_active_cfg = 0;             // Clear active configuration                C:\fw\midicontroller\x009\usb.c
002c0e   0e03     MOVLW     0x3                usb_device_state = DEFAULT_STATE;                                            C:\fw\midicontroller\x009\usb.c
002c10   6f22     MOVWF     0x22,0x1                                                                                        
002c12   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /* Auxiliary Function */                                                         C:\fw\midicontroller\x009\usb.c
002c14   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       C:\fw\midicontroller\x009\usb.c
002c16   ffe6                                                                                                               
002c18   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002c1a   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x009\usb.c
002c1c   0efd     MOVLW     0xfd               *startAdr;                                                                   C:\fw\midicontroller\x009\usb.c
002c1e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002c20   ffe9                                                                                                               
002c22   0efe     MOVLW     0xfe                                                                                            
002c24   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002c26   ffea                                                                                                               
002c28   0efc     MOVLW     0xfc               while(count)                                                                 C:\fw\midicontroller\x009\usb.c
002c2a   50db     MOVF      0xdb,0x0,0x0                                                                                    
002c2c   e004     BZ        0x2c36                                                                                          
002c34   d7f9     BRA       0x2c28                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\usb.c
                                                   _asm                                                                     C:\fw\midicontroller\x009\usb.c
002c2e   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          C:\fw\midicontroller\x009\usb.c
                                                   _endasm                                                                  C:\fw\midicontroller\x009\usb.c
002c30   0efc     MOVLW     0xfc                   count--;                                                                 C:\fw\midicontroller\x009\usb.c
002c32   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 C:\fw\midicontroller\x009\usb.c
002c36   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                C:\fw\midicontroller\x009\usb.c
002c38   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002c3a   ffd9                                                                                                               
002c3c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                           /** EOF usbdrv.c *************************************************************/  C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usb.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x009\usbapplet.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           void PROCESS_COMM_REQUEST(void);                                                 C:\fw\midicontroller\x009\usbapplet.c
                                           //void RemCapCalculation(void);                                                  C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           void HIDSetReportHandler(void) {                                                 C:\fw\midicontroller\x009\usbapplet.c
0038de   0100     MOVLB     0x0            	USBQuery = true;                                                                C:\fw\midicontroller\x009\usbapplet.c
0038e0   8966     BSF       0x66,0x4,0x1                                                                                    
0038e2   ecb9     CALL      0x1d72,0x0     	PROCESS_COMM_REQUEST();                                                         C:\fw\midicontroller\x009\usbapplet.c
0038e4   f00e                                                                                                               
0038e6   0100     MOVLB     0x0            	USBQuery = false;	                                                              C:\fw\midicontroller\x009\usbapplet.c
0038e8   9966     BCF       0x66,0x4,0x1                                                                                    
0038ea   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\usbapplet.c
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x009\usbapplet.c
                                           void HIDGetReportHandler(void) {                                                 C:\fw\midicontroller\x009\usbapplet.c
                                           //load up CtrlTrfData with data.                                                 C:\fw\midicontroller\x009\usbapplet.c
0038ec   0100     MOVLB     0x0            	USBQuery = true;                                                                C:\fw\midicontroller\x009\usbapplet.c
0038ee   8966     BSF       0x66,0x4,0x1                                                                                    
0038f0   ecb9     CALL      0x1d72,0x0     	PROCESS_COMM_REQUEST();                                                         C:\fw\midicontroller\x009\usbapplet.c
0038f2   f00e                                                                                                               
0038f4   0101     MOVLB     0x1            	ctrl_trf_session_owner = MUID_HID;                                              C:\fw\midicontroller\x009\usbapplet.c
0038f6   0e02     MOVLW     0x2                                                                                             
0038f8   6f27     MOVWF     0x27,0x1                                                                                        
0038fa   0101     MOVLB     0x1            	pSrc.bRam = (byte*)&CtrlTrfData;                                                C:\fw\midicontroller\x009\usbapplet.c
0038fc   0e18     MOVLW     0x18                                                                                            
0038fe   6f28     MOVWF     0x28,0x1                                                                                        
003900   0e04     MOVLW     0x4                                                                                             
003902   6f29     MOVWF     0x29,0x1                                                                                        
003904   0101     MOVLB     0x1            	usb_stat.ctrl_trf_mem = _RAM;       // Set memory type                          C:\fw\midicontroller\x009\usbapplet.c
003906   9323     BCF       0x23,0x1,0x1                                                                                    
003908   0100     MOVLB     0x0            	USBQuery = false;                                                               C:\fw\midicontroller\x009\usbapplet.c
00390a   9966     BCF       0x66,0x4,0x1                                                                                    
00390c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           unsigned char EP1Buffer[8];                                                      C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           void ServiceEP1(void) {                                                          C:\fw\midicontroller\x009\usbapplet.c
00390e   0100     MOVLB     0x0            	ServiceEP1Data = false;                                                         C:\fw\midicontroller\x009\usbapplet.c
003910   9b66     BCF       0x66,0x5,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           /*                                                                               C:\fw\midicontroller\x009\usbapplet.c
                                           	BitField ByteToSend, NumBytes;                                                  C:\fw\midicontroller\x009\usbapplet.c
                                           	unsigned char tempvar1, tempvar0;                                               C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           	//report ID 52                                                                  C:\fw\midicontroller\x009\usbapplet.c
                                           	EP1Buffer[0] = 0xB0;				//0th byte is report id                                 C:\fw\midicontroller\x009\usbapplet.c
                                           	EP1Buffer[1] = InputDataPointer;                                                C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           	tempvar1 = 0;                                                                   C:\fw\midicontroller\x009\usbapplet.c
                                           	for (tempvar0 = 0;tempvar0 < 30;tempvar0++) {                                   C:\fw\midicontroller\x009\usbapplet.c
                                           		EP1Buffer[tempvar1] = DataBuffer[tempvar0].b_form.low;                         C:\fw\midicontroller\x009\usbapplet.c
                                           		tempvar1++;                                                                    C:\fw\midicontroller\x009\usbapplet.c
                                           		EP1Buffer[tempvar1] = DataBuffer[tempvar0].b_form.high;                        C:\fw\midicontroller\x009\usbapplet.c
                                           		tempvar1++;                                                                    C:\fw\midicontroller\x009\usbapplet.c
                                           	}                                                                               C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           	NumBytes.byte = 64;                                                             C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                               if(!mHIDTxIsBusy()) {                                                        C:\fw\midicontroller\x009\usbapplet.c
                                           //put data on the endpoint:                                                      C:\fw\midicontroller\x009\usbapplet.c
                                           		HIDTxReport((unsigned char *)&EP1Buffer[0],NumBytes.byte);                     C:\fw\midicontroller\x009\usbapplet.c
                                           	}                                                                               C:\fw\midicontroller\x009\usbapplet.c
                                           */                                                                               C:\fw\midicontroller\x009\usbapplet.c
003912   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x009\usbapplet.c
                                           /*********************************************************************           C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            *********************************************************************           C:\fw\midicontroller\x009\usbdescript.c
                                            * FileName:        usbdsc.c                                                     C:\fw\midicontroller\x009\usbdescript.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x009\usbdescript.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x009\usbdescript.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x009\usbdescript.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x009\usbdescript.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x009\usbdescript.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x009\usbdescript.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x009\usbdescript.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x009\usbdescript.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x009\usbdescript.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x009\usbdescript.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x009\usbdescript.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x009\usbdescript.c
                                            * license.                                                                      C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x009\usbdescript.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x009\usbdescript.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x009\usbdescript.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x009\usbdescript.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x009\usbdescript.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /*********************************************************************           C:\fw\midicontroller\x009\usbdescript.c
                                            * -usbdsc.c-                                                                    C:\fw\midicontroller\x009\usbdescript.c
                                            * This file contains the USB descriptor information. It is used                 C:\fw\midicontroller\x009\usbdescript.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             C:\fw\midicontroller\x009\usbdescript.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                C:\fw\midicontroller\x009\usbdescript.c
                                            * the user must also change the descriptor structure defined in                 C:\fw\midicontroller\x009\usbdescript.c
                                            * the usbdsc.h file. The structure is used to calculate the                     C:\fw\midicontroller\x009\usbdescript.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * A typical configuration descriptor consists of:                               C:\fw\midicontroller\x009\usbdescript.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           C:\fw\midicontroller\x009\usbdescript.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              C:\fw\midicontroller\x009\usbdescript.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * Naming Convention:                                                            C:\fw\midicontroller\x009\usbdescript.c
                                            * To resolve ambiguity, the naming convention are as followed:                  C:\fw\midicontroller\x009\usbdescript.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      C:\fw\midicontroller\x009\usbdescript.c
                                            *   configuration number. This number should match the actual                   C:\fw\midicontroller\x009\usbdescript.c
                                            *   index value of this configuration.                                          C:\fw\midicontroller\x009\usbdescript.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               C:\fw\midicontroller\x009\usbdescript.c
                                            *   interface number and zz is the alternate interface number.                  C:\fw\midicontroller\x009\usbdescript.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 C:\fw\midicontroller\x009\usbdescript.c
                                            *   ## is the endpoint number and d is the direction of transfer.               C:\fw\midicontroller\x009\usbdescript.c
                                            *   The interface name should also be listed as a suffix to identify            C:\fw\midicontroller\x009\usbdescript.c
                                            *   which interface does the endpoint belong to.                                C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * Example:                                                                      C:\fw\midicontroller\x009\usbdescript.c
                                            * If a device has one configuration, two interfaces; interface 0                C:\fw\midicontroller\x009\usbdescript.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         C:\fw\midicontroller\x009\usbdescript.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * #define CFG01 rom struct                            \                         C:\fw\midicontroller\x009\usbdescript.c
                                            * {   USB_CFG_DSC             cd01;                   \                         C:\fw\midicontroller\x009\usbdescript.c
                                            *     USB_INTF_DSC            i00a00;                 \                         C:\fw\midicontroller\x009\usbdescript.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         C:\fw\midicontroller\x009\usbdescript.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         C:\fw\midicontroller\x009\usbdescript.c
                                            *     USB_INTF_DSC            i01a00;                 \                         C:\fw\midicontroller\x009\usbdescript.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         C:\fw\midicontroller\x009\usbdescript.c
                                            * } cfg01                                                                       C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               C:\fw\midicontroller\x009\usbdescript.c
                                            * specification requirement. All endpoints belonging to an interface            C:\fw\midicontroller\x009\usbdescript.c
                                            * should be listed immediately after that interface.                            C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x009\usbdescript.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        C:\fw\midicontroller\x009\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x009\usbdescript.c
                                            * Most items should be self-explanatory, however, a few will be                 C:\fw\midicontroller\x009\usbdescript.c
                                            * explained for clarification.                                                  C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       C:\fw\midicontroller\x009\usbdescript.c
                                            * The configuration attribute must always have the _DEFAULT                     C:\fw\midicontroller\x009\usbdescript.c
                                            * definition at the minimum. Additional options can be ORed                     C:\fw\midicontroller\x009\usbdescript.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              C:\fw\midicontroller\x009\usbdescript.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              C:\fw\midicontroller\x009\usbdescript.c
                                            * _SELF tells the USB host that this device is self-powered. The                C:\fw\midicontroller\x009\usbdescript.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             C:\fw\midicontroller\x009\usbdescript.c
                                            * Assume the following example:                                                 C:\fw\midicontroller\x009\usbdescript.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * The first two parameters are self-explanatory. They specify the               C:\fw\midicontroller\x009\usbdescript.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               C:\fw\midicontroller\x009\usbdescript.c
                                            * The next parameter identifies the endpoint, the definitions are               C:\fw\midicontroller\x009\usbdescript.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     C:\fw\midicontroller\x009\usbdescript.c
                                            * convention:                                                                   C:\fw\midicontroller\x009\usbdescript.c
                                            * _EP<##>_<dir>                                                                 C:\fw\midicontroller\x009\usbdescript.c
                                            * where ## is the endpoint number and dir is the direction of                   C:\fw\midicontroller\x009\usbdescript.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      C:\fw\midicontroller\x009\usbdescript.c
                                            * The next parameter identifies the type of the endpoint. Available             C:\fw\midicontroller\x009\usbdescript.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    C:\fw\midicontroller\x009\usbdescript.c
                                            * typically used because the default control transfer endpoint is               C:\fw\midicontroller\x009\usbdescript.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 C:\fw\midicontroller\x009\usbdescript.c
                                            * addition options can be ORed to _ISO. Example:                                C:\fw\midicontroller\x009\usbdescript.c
                                            * _ISO|_AD|_FE                                                                  C:\fw\midicontroller\x009\usbdescript.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              C:\fw\midicontroller\x009\usbdescript.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    C:\fw\midicontroller\x009\usbdescript.c
                                            * specification for details. The next parameter defines the size of             C:\fw\midicontroller\x009\usbdescript.c
                                            * the endpoint. The last parameter in the polling interval.                     C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x009\usbdescript.c
                                            * Adding a USB String                                                           C:\fw\midicontroller\x009\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x009\usbdescript.c
                                            * A string descriptor array should have the following format:                   C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              C:\fw\midicontroller\x009\usbdescript.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * The above structure provides a means for the C compiler to                    C:\fw\midicontroller\x009\usbdescript.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             C:\fw\midicontroller\x009\usbdescript.c
                                            * index number. The first two bytes of the descriptor are descriptor            C:\fw\midicontroller\x009\usbdescript.c
                                            * length and type. The rest <text> are string texts which must be               C:\fw\midicontroller\x009\usbdescript.c
                                            * in the unicode format. The unicode format is achieved by declaring            C:\fw\midicontroller\x009\usbdescript.c
                                            * each character as a word type. The whole text string is declared              C:\fw\midicontroller\x009\usbdescript.c
                                            * as a word array with the number of characters equals to <size>.               C:\fw\midicontroller\x009\usbdescript.c
                                            * <size> has to be manually counted and entered into the array                  C:\fw\midicontroller\x009\usbdescript.c
                                            * declaration. Let's study this through an example:                             C:\fw\midicontroller\x009\usbdescript.c
                                            * if the string is "USB" , then the string descriptor should be:                C:\fw\midicontroller\x009\usbdescript.c
                                            * (Using index 02)                                                              C:\fw\midicontroller\x009\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 C:\fw\midicontroller\x009\usbdescript.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * A USB project may have multiple strings and the firmware supports             C:\fw\midicontroller\x009\usbdescript.c
                                            * the management of multiple strings through a look-up table.                   C:\fw\midicontroller\x009\usbdescript.c
                                            * The look-up table is defined as:                                              C:\fw\midicontroller\x009\usbdescript.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 C:\fw\midicontroller\x009\usbdescript.c
                                            * Strings can be removed or added. sd000 is a specialized string                C:\fw\midicontroller\x009\usbdescript.c
                                            * descriptor. It defines the language code, usually this is                     C:\fw\midicontroller\x009\usbdescript.c
                                            * US English (0x0409). The index of the string must match the index             C:\fw\midicontroller\x009\usbdescript.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  C:\fw\midicontroller\x009\usbdescript.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            C:\fw\midicontroller\x009\usbdescript.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                C:\fw\midicontroller\x009\usbdescript.c
                                            * function in usb9.c.                                                           C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * The look-up table scheme also applies to the configuration                    C:\fw\midicontroller\x009\usbdescript.c
                                            * descriptor. A USB device may have multiple configuration                      C:\fw\midicontroller\x009\usbdescript.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   C:\fw\midicontroller\x009\usbdescript.c
                                            * descriptor, user must implement a structure similar to CFG01.                 C:\fw\midicontroller\x009\usbdescript.c
                                            * The next step is to add the configuration descriptor name, i.e.               C:\fw\midicontroller\x009\usbdescript.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               C:\fw\midicontroller\x009\usbdescript.c
                                            * is a dummy place holder since configuration 0 is the un-configured            C:\fw\midicontroller\x009\usbdescript.c
                                            * state according to the definition in the USB specification.                   C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /*********************************************************************           C:\fw\midicontroller\x009\usbdescript.c
                                            * Descriptor specific type definitions are defined in:                          C:\fw\midicontroller\x009\usbdescript.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          C:\fw\midicontroller\x009\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                            * Configuration information is defined in:                                      C:\fw\midicontroller\x009\usbdescript.c
                                            * autofiles\usbcfg.h                                                            C:\fw\midicontroller\x009\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           #define POLLING_INTERVAL	40                                                      C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /** I N C L U D E S *************************************************/           C:\fw\midicontroller\x009\usbdescript.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /** C O N S T A N T S ************************************************/          C:\fw\midicontroller\x009\usbdescript.c
                                           #pragma romdata                                                                  C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /* Device Descriptor */                                                          C:\fw\midicontroller\x009\usbdescript.c
                                           rom USB_DEV_DSC device_dsc=                                                      C:\fw\midicontroller\x009\usbdescript.c
                                           {                                                                                C:\fw\midicontroller\x009\usbdescript.c
                                               0x12,     	// bLength                                                        C:\fw\midicontroller\x009\usbdescript.c
                                               0x01,     	// bDescriptorType                                                C:\fw\midicontroller\x009\usbdescript.c
                                               0x0110,    	// bcdUSB (spec release #)                                       C:\fw\midicontroller\x009\usbdescript.c
                                               0x00,     	// bDeviceClass                                                   C:\fw\midicontroller\x009\usbdescript.c
                                               0x00,     	// bDeviceSubClass                                                C:\fw\midicontroller\x009\usbdescript.c
                                               0x00,     	// bDeviceProtocol                                                C:\fw\midicontroller\x009\usbdescript.c
                                               0x08,     	// bMaxPacketSize0                                                C:\fw\midicontroller\x009\usbdescript.c
                                               0x09AE,     // idVendor - 0x09AE is Tripplite's Vendor ID                    C:\fw\midicontroller\x009\usbdescript.c
                                               0x4430,		// idProduct                                                        C:\fw\midicontroller\x009\usbdescript.c
                                               0x0010,    	// bcdDevice : Project version = 0.10                            C:\fw\midicontroller\x009\usbdescript.c
                                               INDEX_MANUFACTURER,	// Index of string Descriptor describing manufacturer      C:\fw\midicontroller\x009\usbdescript.c
                                               INDEX_NAME,			// Index of string Descriptor describing product               C:\fw\midicontroller\x009\usbdescript.c
                                               INDEX_SERIALNUM,	// Index of string Descriptor describing the device's serial number C:\fw\midicontroller\x009\usbdescript.c
                                               0x01				// bNumConfigurations : renaud 1 configuration                       C:\fw\midicontroller\x009\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /* Configuration 1 Descriptor */                                                 C:\fw\midicontroller\x009\usbdescript.c
                                           CFG01={                                                                          C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,		// bLength: Configuration Descriptor size                                C:\fw\midicontroller\x009\usbdescript.c
                                           	0x02,		// bDescriptorType: Configuration                                        C:\fw\midicontroller\x009\usbdescript.c
                                           	P1_CONFDESC_LEN,	//(word) Length of configuration descriptor. **Renaud : To update C:\fw\midicontroller\x009\usbdescript.c
                                           	0x01,		// bNumInterfaces: 1 interface.                                          C:\fw\midicontroller\x009\usbdescript.c
                                           	0x01,		// bConfigurationValue: Configuration value = 1                          C:\fw\midicontroller\x009\usbdescript.c
                                           	0,			// iConfiguration: Index of string descriptor describing the configuration (None) C:\fw\midicontroller\x009\usbdescript.c
                                           //	0x80,		// bmAttributes: Bus powered and NO Remote wakeup                      C:\fw\midicontroller\x009\usbdescript.c
                                           	0xA0,		// bmAttributes: Bus powered and Remote wakeup ** Renaud : changed from 0xE0 C:\fw\midicontroller\x009\usbdescript.c
                                           //	0xC0,		// bmAttributes: Self powered and NO Remote wakeup                     C:\fw\midicontroller\x009\usbdescript.c
                                           //	0xE0,		// bmAttributes: Self powered and Remote wakeup                        C:\fw\midicontroller\x009\usbdescript.c
                                           	0x32,		// MaxPower 50 mA : ** Renaud : MaxPowerself-powered draws 0 mA from the bus.  C:\fw\midicontroller\x009\usbdescript.c
                                           //	0x00,		// 0 mA power consumption.                                             C:\fw\midicontroller\x009\usbdescript.c
                                           // Interface descriptor (Interface 0 = DemoKit)                                  C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,		// bLength: Interface Descriptor size                                    C:\fw\midicontroller\x009\usbdescript.c
                                           	0x04,		// bDescriptorType: Interface descriptor type  ** Renaud : to check      C:\fw\midicontroller\x009\usbdescript.c
                                           	0x00,		// bInterfaceNumber: Interface Number = 0                                C:\fw\midicontroller\x009\usbdescript.c
                                           	0x00,		// bAlternateSetting: No Alternate setting                               C:\fw\midicontroller\x009\usbdescript.c
                                           	0x01,		// bNumEndpoints: one endpoints used    ** Renaud : changed from 2 to 1  C:\fw\midicontroller\x009\usbdescript.c
                                           	0x03,		// bInterfaceClass: HID                                                  C:\fw\midicontroller\x009\usbdescript.c
                                           	0x00,		// bInterfaceSubClass: ** Renaud : changed from 1 (Boot Interface Subclass in tripplite descriptor)to 0 : no boot subclass C:\fw\midicontroller\x009\usbdescript.c
                                           	0x00,		// bInterfaceProtocol: ** Renaud : changed from 2 (protocol - mouse in tripplite descriptor) to 0 : no protocol  C:\fw\midicontroller\x009\usbdescript.c
                                           	0x00,		// iInterface: Index of string descriptor (No string value)              C:\fw\midicontroller\x009\usbdescript.c
                                           // HID descriptor (Demokit)                                                      C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,		// bLength: HID Descriptor size                                          C:\fw\midicontroller\x009\usbdescript.c
                                           	0x21,		// bDescriptorType: HID                                                  C:\fw\midicontroller\x009\usbdescript.c
                                           	0x0110,		// (word) bcdHID: HID Class Spec release number (1.10) ** Renaud : I let rev 1.10, but Tripplite has HID class release number (1.00) C:\fw\midicontroller\x009\usbdescript.c
                                           	0x00,		// bCountryCode: Hardware target country US ** Renaud changed from 0x21 (US) to 0x00 (none specified) C:\fw\midicontroller\x009\usbdescript.c
                                           	0x01,		// bNumDescriptors: Number of HID class descriptors to follow            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x22,		// bDescriptorType: Report                                               C:\fw\midicontroller\x009\usbdescript.c
                                           	HID_RPT_UPS_SIZE,	// (word) Length of report descriptor interface 0 (2 bytes) ** Renaud : To update C:\fw\midicontroller\x009\usbdescript.c
                                           // Endpoint 1 descriptor (Demokit)                                               C:\fw\midicontroller\x009\usbdescript.c
                                           	0x07,		// bLength: Endpoint Descriptor size                                     C:\fw\midicontroller\x009\usbdescript.c
                                           	0x05,		// bDescriptorType: Endpoint descriptor type   ** Renaud : To check      C:\fw\midicontroller\x009\usbdescript.c
                                           	0x81,		// bEndpointAddress: Endpoint  1 IN                                      C:\fw\midicontroller\x009\usbdescript.c
                                           	0x03,		// bmAttributes: Interrupt endpoint                                      C:\fw\midicontroller\x009\usbdescript.c
                                           	0x0008,		// wMaxPacketSize(LSB):                                                C:\fw\midicontroller\x009\usbdescript.c
                                           	POLLING_INTERVAL,       // bInterval: Polling Interval (40 ms = 0x28)           C:\fw\midicontroller\x009\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //2/8/05 JD language selection I think..                                         C:\fw\midicontroller\x009\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    C:\fw\midicontroller\x009\usbdescript.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Manufacturer string                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[11];}MfrString={               C:\fw\midicontroller\x009\usbdescript.c
                                           sizeof(MfrString),DSC_STR,                                                       C:\fw\midicontroller\x009\usbdescript.c
                                           'J','o','e'};                                                                    C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Device Chemistry String                                                        C:\fw\midicontroller\x009\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[4];}DevChem={                  C:\fw\midicontroller\x009\usbdescript.c
                                           sizeof(DevChem),DSC_STR,                                                         C:\fw\midicontroller\x009\usbdescript.c
                                           'P','b','A','C'};                                                                C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Product String                                                                 C:\fw\midicontroller\x009\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[21];}PrdString={               C:\fw\midicontroller\x009\usbdescript.c
                                           sizeof(PrdString),DSC_STR,                                                       C:\fw\midicontroller\x009\usbdescript.c
                                           'M','I','D','I',' ','D','e','v','i','c','e',' '};                                C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Serial Number                                                                  C:\fw\midicontroller\x009\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[16];}SerialNum={               C:\fw\midicontroller\x009\usbdescript.c
                                           sizeof(SerialNum),DSC_STR,                                                       C:\fw\midicontroller\x009\usbdescript.c
                                           '6','9','1','2','0','6','0','B',' '};                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /*                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                           	0x06,  0x00, 0xff          // USAGE_PAGE (Vendor Defined Page 1)                C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x01               // USAGE (Vendor Usage 1)                             C:\fw\midicontroller\x009\usbdescript.c
                                           	0xa1,  0x01               // COLLECTION (Application)                           C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x85,  RID_RECEIVE       // REPORT_ID (1)  - streaming UART rx data             C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x01                // USAGE (Vendor Usage 1)                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x15,  0x00                // LOGICAL_MINIMUM (0)                               C:\fw\midicontroller\x009\usbdescript.c
                                           	0x26,  0xff, 0x00           // LOGICAL_MAXIMUM (255)                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x75,  0x08                // REPORT_SIZE (8) = bits                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x95,  EP1_REPORT_LENGTH // REPORT_COUNT (7) = 1 report id byte + 7 data bytes  C:\fw\midicontroller\x009\usbdescript.c
                                           	0x81,  0x06                // INPUT (Data,Var,Rel)                              C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x01                // USAGE (Vendor Usage 1)                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0xb1,  0x06                // FEATURE (Data,Var,Rel)                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x85,  RID_COMMAND       // REPORT_ID (3) Command (setreport)                   C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x01               // USAGE (Vendor Usage 1)                             C:\fw\midicontroller\x009\usbdescript.c
                                           	0x15,  0x00               // LOGICAL_MINIMUM (0)                                C:\fw\midicontroller\x009\usbdescript.c
                                           	0x26,  0x08, 0x00           // LOGICAL_MAXIMUM (255)                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x75,  0x08               // REPORT_SIZE (8) bits                               C:\fw\midicontroller\x009\usbdescript.c
                                           	0x95,  0x01               // REPORT_COUNT (1) byte                              C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x01               // USAGE (Vendor Usage 1)                             C:\fw\midicontroller\x009\usbdescript.c
                                           	0xb1,  0x06               // FEATURE (Data,Var,Rel)                             C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x85,  RID_TRANSMIT      // REPORT_ID (2) serial transmit these bytes (SetReport) C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x03               // USAGE (Vendor Usage 1)                             C:\fw\midicontroller\x009\usbdescript.c
                                           	0x96,  0x07, 0x00          // REPORT_COUNT (7) 1 count byte, 6 data             C:\fw\midicontroller\x009\usbdescript.c
                                           	0xb1,  0x06               // FEATURE (Data,Var,Rel)                             C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0xc0                     // END_COLLECTION                                      C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           */                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //the reason for this structure is so that sizeof() returns a value.             C:\fw\midicontroller\x009\usbdescript.c
                                           rom struct{byte report[HID_RPT_UPS_SIZE];}hid_rpt_UPS={                          C:\fw\midicontroller\x009\usbdescript.c
                                           //Production test information                                                    C:\fw\midicontroller\x009\usbdescript.c
                                               0x06, 0xff, 0xff,              //     USAGE_PAGE (Vendor Defined Page 0xffff) C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09,  0x01,               		// USAGE (Vendor Usage 1)                          C:\fw\midicontroller\x009\usbdescript.c
                                           	0xa1,  0x01,              	  // COLLECTION (Application)                        C:\fw\midicontroller\x009\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x95, 0x01,                    //       REPORT_COUNT (1)                     C:\fw\midicontroller\x009\usbdescript.c
                                               0x26, 0xff, 0x00,              //       LOGICAL_MAXIMUM (255)                C:\fw\midicontroller\x009\usbdescript.c
                                               0x15, 0x00,                    //       LOGICAL_MINIMUM (0)                  C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //NVR Operations                                                                 C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x96,                    //       REPORT_ID (150)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xC0,                    //       USAGE (***NVR Read/Write Data)       C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0xB4,                    //       REPORT_ID (180)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xD2,                    //       USAGE (***NVR Page Read/Write Data)  C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x97,                    //       REPORT_ID (151)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xC1,                    //       USAGE (***NVR Address 16bit)         C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //RAM Operations                                                                 C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x98,                    //       REPORT_ID (152)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xC2,                    //       USAGE (***RAM Read/Write Data)       C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x99,                    //       REPORT_ID (153)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xC3,                    //       USAGE (***RAM Address 16bit)         C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //ROM Operations                                                                 C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x9C,                    //       REPORT_ID (156)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xD4,                    //       USAGE (***ROM Read/Write Data)       C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x9D,                    //       REPORT_ID (157)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xD5,                    //       USAGE (***ROM Address 16bit)         C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Production test protocol #                                                     C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x9B,                    //       REPORT_ID (155)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xC5,                    //       USAGE (***Production Test Protocol #) C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              C:\fw\midicontroller\x009\usbdescript.c
                                           	0x81, 0xa2,					   //	 	INPUT (Data,Var,Abs, Vol, NPrf)                         C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Firmware Partnumber                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           	0x75, 0x20,						//	   REPORT_SIZE (32)                                         C:\fw\midicontroller\x009\usbdescript.c
                                           	0x85, 0xC2,						//	   REPORT_ID (194)                                          C:\fw\midicontroller\x009\usbdescript.c
                                           	0x09, 0xD6,						//	   USAGE (***Firmware Partnumber 32bit)                     C:\fw\midicontroller\x009\usbdescript.c
                                           	0xb1, 0x02,						//	   FEATURE (Data,Var,Abs)                                   C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           //Production test password = 866E1942                                            C:\fw\midicontroller\x009\usbdescript.c
                                               0x85, 0x9A,                    //       REPORT_ID (154)                      C:\fw\midicontroller\x009\usbdescript.c
                                               0x09, 0xC4,                    //       USAGE (***Production test Password - 32bit) C:\fw\midicontroller\x009\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x009\usbdescript.c
                                               0xc0                          //     END_COLLECTION                          C:\fw\midicontroller\x009\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                           //** Renaud : end_ReportDescriptor                                               C:\fw\midicontroller\x009\usbdescript.c
                                           	                                                                                C:\fw\midicontroller\x009\usbdescript.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       C:\fw\midicontroller\x009\usbdescript.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&MfrString,&PrdString,&SerialNum,&DevChem}; C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           rom pFunc ClassReqHandler[1]=                                                    C:\fw\midicontroller\x009\usbdescript.c
                                           {                                                                                C:\fw\midicontroller\x009\usbdescript.c
                                               &USBCheckHIDRequest                                                          C:\fw\midicontroller\x009\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x009\usbdescript.c
                                           /** EOF usbdsc.c ****************************************************/           C:\fw\midicontroller\x009\usbdescript.c
                                           //############################################################################### C:\fw\midicontroller\x009\rs232.c
                                           //#										       						       		#                                             C:\fw\midicontroller\x009\rs232.c
                                           //#			Author: Joe Dunne											 		#                                           C:\fw\midicontroller\x009\rs232.c
                                           //#			RS232 Communication ROUTINE											#                                    C:\fw\midicontroller\x009\rs232.c
                                           //#			File Name: RXCOMM.ASM												#                                         C:\fw\midicontroller\x009\rs232.c
                                           //#																				#                                                         C:\fw\midicontroller\x009\rs232.c
                                           //#			Updated 2/02/05 by JD												#                                         C:\fw\midicontroller\x009\rs232.c
                                           //#									      	       	       	       	       		#                            C:\fw\midicontroller\x009\rs232.c
                                           //############################################################################### C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           #include	"c_system.h"                                                            C:\fw\midicontroller\x009\rs232.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\rs232.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           #define	FW_REV						0x10                                                         C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           #define	UPS_TYPE					(2|FW_REV)                                                  C:\fw\midicontroller\x009\rs232.c
                                           #define	INVALID_REQUEST				0xff                                                  C:\fw\midicontroller\x009\rs232.c
                                           #define	PRODUCTION_TEST_PROTOCOL	0x0003                                          C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[];}SerialNum;           C:\fw\midicontroller\x009\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[24];}MfrString;         C:\fw\midicontroller\x009\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[10];}DevChem;           C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           void	RemCapCalculation(void);                                                    C:\fw\midicontroller\x009\rs232.c
                                           void	EE_READ(void);                                                              C:\fw\midicontroller\x009\rs232.c
                                           void	D_DIV(void);                                                                C:\fw\midicontroller\x009\rs232.c
                                           void	SQRT_16BIT(void);		//result is stored in RES0.                              C:\fw\midicontroller\x009\rs232.c
                                           void	HIDGetReportHandler(void);                                                  C:\fw\midicontroller\x009\rs232.c
                                           unsigned char	READ_SYSTEM_NVR(void);                                             C:\fw\midicontroller\x009\rs232.c
                                           void	EE_PAGE_WRITE(void);                                                        C:\fw\midicontroller\x009\rs232.c
                                           void	BOOT_LOAD_MODE(void);                                                       C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           //--------------------------------------------------------------                 C:\fw\midicontroller\x009\rs232.c
                                           //						Handle received query                                                    C:\fw\midicontroller\x009\rs232.c
                                           //--------------------------------------------------------------                 C:\fw\midicontroller\x009\rs232.c
001d72   cfd9     MOVFF     0xfd9,0xfe6    void	PROCESS_COMM_REQUEST(void) {                                                C:\fw\midicontroller\x009\rs232.c
001d74   ffe6                                                                                                               
001d76   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
001d78   ffd9                                                                                                               
001d7a   0e11     MOVLW     0x11                                                                                            
001d7c   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char *RcvPtr;                                                          C:\fw\midicontroller\x009\rs232.c
                                           	unsigned char tempvar1, tempvar0;                                               C:\fw\midicontroller\x009\rs232.c
                                           	far unsigned char *Data;                                                        C:\fw\midicontroller\x009\rs232.c
                                           	BitField ByteToSend;                                                            C:\fw\midicontroller\x009\rs232.c
                                           	TwoBytes tempreg, tempnum0, value;                                              C:\fw\midicontroller\x009\rs232.c
                                           	FourBytes longreg;                                                              C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
001d7e   0100     MOVLB     0x0            	ResponseType = 0xFF;		//no response                                             C:\fw\midicontroller\x009\rs232.c
001d80   69db     SETF      0xdb,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
001d82   0100     MOVLB     0x0            	if (!USBQuery) {                                                                C:\fw\midicontroller\x009\rs232.c
001d84   b966     BTFSC     0x66,0x4,0x1                                                                                    
001d86   d010     BRA       0x1da8                                                                                          
                                           		//RS232 query                                                                  C:\fw\midicontroller\x009\rs232.c
001d88   9166     BCF       0x66,0x0,0x1   		ProcessCommRequest = false;                                                    C:\fw\midicontroller\x009\rs232.c
                                           		//Prevent any communication in progress from being messed up.                  C:\fw\midicontroller\x009\rs232.c
001d8a   0100     MOVLB     0x0            		if (TxBufPtr != 0) return;                                                     C:\fw\midicontroller\x009\rs232.c
001d8c   51d5     MOVF      0xd5,0x0,0x1                                                                                    
001d8e   e001     BZ        0x1d92                                                                                          
001d90   d379     BRA       0x2484                                                                                          
001d92   0100     MOVLB     0x0            		SendingOutString = false;                                                      C:\fw\midicontroller\x009\rs232.c
001d94   9566     BCF       0x66,0x2,0x1                                                                                    
001d96   9766     BCF       0x66,0x3,0x1   		StringInEEPROM = false;                                                        C:\fw\midicontroller\x009\rs232.c
001d98   0100     MOVLB     0x0            		TxBufPtr = 4;			//the header will be written later.                            C:\fw\midicontroller\x009\rs232.c
001d9a   0e04     MOVLW     0x4                                                                                             
001d9c   6fd5     MOVWF     0xd5,0x1                                                                                        
001d9e   0ec6     MOVLW     0xc6           		RcvPtr = (unsigned char *)&RxBuffer[4];                                        C:\fw\midicontroller\x009\rs232.c
001da0   6ede     MOVWF     0xde,0x0                                                                                        
001da2   0e00     MOVLW     0x0                                                                                             
001da4   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
001da6   d007     BRA       0x1db6         	else {                                                                          C:\fw\midicontroller\x009\rs232.c
                                           		//USB query                                                                    C:\fw\midicontroller\x009\rs232.c
001da8   0100     MOVLB     0x0            		USBDataPointer = 1;		//the 0th byte is the reportid                            C:\fw\midicontroller\x009\rs232.c
001daa   0e01     MOVLW     0x1                                                                                             
001dac   6fb9     MOVWF     0xb9,0x1                                                                                        
001dae   0ebb     MOVLW     0xbb           		RcvPtr = (unsigned char *)&USBEP0DataInBuffer[1];                              C:\fw\midicontroller\x009\rs232.c
001db0   6ede     MOVWF     0xde,0x0                                                                                        
001db2   0e00     MOVLW     0x0                                                                                             
001db4   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           //Polling command:                                                               C:\fw\midicontroller\x009\rs232.c
001db6   0100     MOVLB     0x0            	if (!USBQuery && RxBuffer[1] == 0x03 || \                                       C:\fw\midicontroller\x009\rs232.c
001db8   5166     MOVF      0x66,0x0,0x1                                                                                    
001dba   0b10     ANDLW     0x10                                                                                            
001dbc   e104     BNZ       0x1dc6                                                                                          
001dbe   0e03     MOVLW     0x3                                                                                             
001dc0   0100     MOVLB     0x0                                                                                             
001dc2   5dc3     SUBWF     0xc3,0x0,0x1                                                                                    
001dc4   e009     BZ        0x1dd8                                                                                          
001dc6   0100     MOVLB     0x0                                                                                             
001dc8   5166     MOVF      0x66,0x0,0x1                                                                                    
001dca   0b10     ANDLW     0x10                                                                                            
001dcc   e101     BNZ       0x1dd0                                                                                          
001dce   d197     BRA       0x20fe                                                                                          
001dd0   0104     MOVLB     0x4                                                                                             
001dd2   0511     DECF      0x11,0x0,0x1                                                                                    
001dd4   e001     BZ        0x1dd8                                                                                          
001dd6   d193     BRA       0x20fe                                                                                          
                                           		USBQuery && SetupPkt.bRequest == GET_REPORT) {                                 C:\fw\midicontroller\x009\rs232.c
001dd8   0100     MOVLB     0x0            		switch ((USBQuery?SetupPkt._byte[2]:RxBuffer[3])) {                            C:\fw\midicontroller\x009\rs232.c
001dda   5166     MOVF      0x66,0x0,0x1                                                                                    
001ddc   0b10     ANDLW     0x10                                                                                            
001dde   e003     BZ        0x1de6                                                                                          
001de0   0104     MOVLB     0x4                                                                                             
001de2   5112     MOVF      0x12,0x0,0x1                                                                                    
001de4   d002     BRA       0x1dea                                                                                          
001de6   0100     MOVLB     0x0                                                                                             
001de8   51c5     MOVF      0xc5,0x0,0x1                                                                                    
001dea   0ab4     XORLW     0xb4                                                                                            
001dec   e101     BNZ       0x1df0                                                                                          
001dee   d16e     BRA       0x20cc                                                                                          
001df0   0a1b     XORLW     0x1b                                                                                            
001df2   e101     BNZ       0x1df6                                                                                          
001df4   d15b     BRA       0x20ac                                                                                          
001df6   0a34     XORLW     0x34                                                                                            
001df8   e101     BNZ       0x1dfc                                                                                          
001dfa   d14d     BRA       0x2096                                                                                          
001dfc   0a06     XORLW     0x6                                                                                             
001dfe   e101     BNZ       0x1e02                                                                                          
001e00   d134     BRA       0x206a                                                                                          
001e02   0a01     XORLW     0x1                                                                                             
001e04   e101     BNZ       0x1e08                                                                                          
001e06   d11d     BRA       0x2042                                                                                          
001e08   0a05     XORLW     0x5                                                                                             
001e0a   e101     BNZ       0x1e0e                                                                                          
001e0c   d104     BRA       0x2016                                                                                          
001e0e   0a01     XORLW     0x1                                                                                             
001e10   e101     BNZ       0x1e14                                                                                          
001e12   d0e6     BRA       0x1fe0                                                                                          
001e14   0a0f     XORLW     0xf                                                                                             
001e16   e101     BNZ       0x1e1a                                                                                          
001e18   d0cd     BRA       0x1fb4                                                                                          
001e1a   0a01     XORLW     0x1                                                                                             
001e1c   e101     BNZ       0x1e20                                                                                          
001e1e   d0bf     BRA       0x1f9e                                                                                          
001e20   0abc     XORLW     0xbc                                                                                            
001e22   e101     BNZ       0x1e26                                                                                          
001e24   d08e     BRA       0x1f42                                                                                          
001e26   0a48     XORLW     0x48                                                                                            
001e28   e05d     BZ        0x1ee4                                                                                          
001e2a   0a49     XORLW     0x49                                                                                            
001e2c   e05b     BZ        0x1ee4                                                                                          
001e2e   0a02     XORLW     0x2                                                                                             
001e30   e02a     BZ        0x1e86                                                                                          
001e32   0a24     XORLW     0x24                                                                                            
001e34   e005     BZ        0x1e40                                                                                          
001e36   0a03     XORLW     0x3                                                                                             
001e38   e003     BZ        0x1e40                                                                                          
001e3a   0a26     XORLW     0x26                                                                                            
001e3c   e001     BZ        0x1e40                                                                                          
001e3e   d15e     BRA       0x20fc                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		case 13:                                                                       C:\fw\midicontroller\x009\rs232.c
                                           		case 14:                                                                       C:\fw\midicontroller\x009\rs232.c
                                           		case 40:                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			//iProduct                                                                    C:\fw\midicontroller\x009\rs232.c
001e40   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001e42   0e05     MOVLW     0x5                                                                                             
001e44   6fdb     MOVWF     0xdb,0x1                                                                                        
001e46   0100     MOVLB     0x0            			TxBuffer[2] = 22;			//number of bytes in response                             C:\fw\midicontroller\x009\rs232.c
001e48   0e16     MOVLW     0x16                                                                                            
001e4a   6fcd     MOVWF     0xcd,0x1                                                                                        
001e4c   0100     MOVLB     0x0            			if (USBQuery) {                                                               C:\fw\midicontroller\x009\rs232.c
001e4e   a966     BTFSS     0x66,0x4,0x1                                                                                    
001e50   d005     BRA       0x1e5c                                                                                          
001e52   0e02     MOVLW     0x2            				TXENQ(INDEX_NAME);                                                           C:\fw\midicontroller\x009\rs232.c
001e54   6ee6     MOVWF     0xe6,0x0                                                                                        
001e56   db20     RCALL     0x2498                                                                                          
001e58   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001e5a   d151     BRA       0x20fe         				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001e5c   0e04     MOVLW     0x4            			TxBufPtr = TxBuffer[2]+4;					//override txbuffer pointer.                    C:\fw\midicontroller\x009\rs232.c
001e5e   0100     MOVLB     0x0                                                                                             
001e60   25cd     ADDWF     0xcd,0x0,0x1                                                                                    
001e62   0100     MOVLB     0x0                                                                                             
001e64   6fd5     MOVWF     0xd5,0x1                                                                                        
001e66   0e04     MOVLW     0x4            			StringChksum = RxBuffer[3]+(TxBufPtr-4)+HEADER_CHAR+DATA_RETURNED;            C:\fw\midicontroller\x009\rs232.c
001e68   5dd5     SUBWF     0xd5,0x0,0x1                                                                                    
001e6a   0100     MOVLB     0x0                                                                                             
001e6c   25c5     ADDWF     0xc5,0x0,0x1                                                                                    
001e6e   0f7e     ADDLW     0x7e                                                                                            
001e70   0f05     ADDLW     0x5                                                                                             
001e72   0100     MOVLB     0x0                                                                                             
001e74   6fda     MOVWF     0xda,0x1                                                                                        
001e76   0100     MOVLB     0x0            			SendingOutString = true;                                                      C:\fw\midicontroller\x009\rs232.c
001e78   8566     BSF       0x66,0x2,0x1                                                                                    
001e7a   8766     BSF       0x66,0x3,0x1   			StringInEEPROM = true;                                                        C:\fw\midicontroller\x009\rs232.c
001e7c   9f66     BCF       0x66,0x7,0x1   			StringInRAM = false;                                                          C:\fw\midicontroller\x009\rs232.c
001e7e   0100     MOVLB     0x0            			StringPtr = EE_USB_ID_STRING+2;	//Send out product string.                    C:\fw\midicontroller\x009\rs232.c
001e80   0e46     MOVLW     0x46                                                                                            
001e82   6fd8     MOVWF     0xd8,0x1                                                                                        
001e84   d13c     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 41:                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			//iSerialNumber                                                               C:\fw\midicontroller\x009\rs232.c
001e86   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001e88   0e05     MOVLW     0x5                                                                                             
001e8a   6fdb     MOVWF     0xdb,0x1                                                                                        
001e8c   0100     MOVLB     0x0            			TxBuffer[2] = 17;			//number of bytes in response                             C:\fw\midicontroller\x009\rs232.c
001e8e   0e11     MOVLW     0x11                                                                                            
001e90   6fcd     MOVWF     0xcd,0x1                                                                                        
001e92   0100     MOVLB     0x0            			if (USBQuery) {                                                               C:\fw\midicontroller\x009\rs232.c
001e94   a966     BTFSS     0x66,0x4,0x1                                                                                    
001e96   d005     BRA       0x1ea2                                                                                          
001e98   0e03     MOVLW     0x3            				TXENQ(INDEX_SERIALNUM);                                                      C:\fw\midicontroller\x009\rs232.c
001e9a   6ee6     MOVWF     0xe6,0x0                                                                                        
001e9c   dafd     RCALL     0x2498                                                                                          
001e9e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ea0   d12e     BRA       0x20fe         				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001ea2   0e04     MOVLW     0x4            			TxBufPtr = TxBuffer[2]+4;					//override txbuffer pointer.                    C:\fw\midicontroller\x009\rs232.c
001ea4   0100     MOVLB     0x0                                                                                             
001ea6   25cd     ADDWF     0xcd,0x0,0x1                                                                                    
001ea8   0100     MOVLB     0x0                                                                                             
001eaa   6fd5     MOVWF     0xd5,0x1                                                                                        
001eac   0e04     MOVLW     0x4            			StringChksum = RxBuffer[3]+(TxBufPtr-4)+HEADER_CHAR+DATA_RETURNED;            C:\fw\midicontroller\x009\rs232.c
001eae   5dd5     SUBWF     0xd5,0x0,0x1                                                                                    
001eb0   0100     MOVLB     0x0                                                                                             
001eb2   25c5     ADDWF     0xc5,0x0,0x1                                                                                    
001eb4   0f7e     ADDLW     0x7e                                                                                            
001eb6   0f05     ADDLW     0x5                                                                                             
001eb8   0100     MOVLB     0x0                                                                                             
001eba   6fda     MOVWF     0xda,0x1                                                                                        
001ebc   0100     MOVLB     0x0            			SendingOutString = true;                                                      C:\fw\midicontroller\x009\rs232.c
001ebe   8566     BSF       0x66,0x2,0x1                                                                                    
001ec0   9766     BCF       0x66,0x3,0x1   			StringInEEPROM = false;                                                       C:\fw\midicontroller\x009\rs232.c
001ec2   8f66     BSF       0x66,0x7,0x1   			StringInRAM = true;                                                           C:\fw\midicontroller\x009\rs232.c
001ec4   50d9     MOVF      0xd9,0x0,0x0   			tempreg.s_form = (unsigned short)(&SerialNum)+2;                              C:\fw\midicontroller\x009\rs232.c
001ec6   0f07     ADDLW     0x7                                                                                             
001ec8   6ee9     MOVWF     0xe9,0x0                                                                                        
001eca   cfda     MOVFF     0xfda,0xfea                                                                                     
001ecc   ffea                                                                                                               
001ece   0e22     MOVLW     0x22                                                                                            
001ed0   6eee     MOVWF     0xee,0x0                                                                                        
001ed2   0e36     MOVLW     0x36                                                                                            
001ed4   6eed     MOVWF     0xed,0x0                                                                                        
001ed6   0e08     MOVLW     0x8            			StringPtr_H = tempreg.b_form.high;                                            C:\fw\midicontroller\x009\rs232.c
001ed8   cfdb     MOVFF     0xfdb,0xd9                                                                                      
001eda   f0d9                                                                                                               
001edc   0e07     MOVLW     0x7            			StringPtr = tempreg.b_form.low;	//Send out serial string.                     C:\fw\midicontroller\x009\rs232.c
001ede   cfdb     MOVFF     0xfdb,0xd8                                                                                      
001ee0   f0d8                                                                                                               
001ee2   d10d     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 98:	//iOEMInformation                                                     C:\fw\midicontroller\x009\rs232.c
                                           		case 43:	//iManufacturer                                                       C:\fw\midicontroller\x009\rs232.c
001ee4   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001ee6   0e05     MOVLW     0x5                                                                                             
001ee8   6fdb     MOVWF     0xdb,0x1                                                                                        
001eea   0100     MOVLB     0x0            			TxBuffer[2] = 12;			//number of bytes in response                             C:\fw\midicontroller\x009\rs232.c
001eec   0e0c     MOVLW     0xc                                                                                             
001eee   6fcd     MOVWF     0xcd,0x1                                                                                        
001ef0   0100     MOVLB     0x0            			if (USBQuery) {                                                               C:\fw\midicontroller\x009\rs232.c
001ef2   a966     BTFSS     0x66,0x4,0x1                                                                                    
001ef4   d005     BRA       0x1f00                                                                                          
001ef6   0e01     MOVLW     0x1            				TXENQ(INDEX_MANUFACTURER);                                                   C:\fw\midicontroller\x009\rs232.c
001ef8   6ee6     MOVWF     0xe6,0x0                                                                                        
001efa   dace     RCALL     0x2498                                                                                          
001efc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001efe   d0ff     BRA       0x20fe         				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001f00   0e04     MOVLW     0x4            			TxBufPtr = TxBuffer[2]+4;					//override txbuffer pointer.                    C:\fw\midicontroller\x009\rs232.c
001f02   0100     MOVLB     0x0                                                                                             
001f04   25cd     ADDWF     0xcd,0x0,0x1                                                                                    
001f06   0100     MOVLB     0x0                                                                                             
001f08   6fd5     MOVWF     0xd5,0x1                                                                                        
001f0a   0e04     MOVLW     0x4            			StringChksum = RxBuffer[3]+(TxBufPtr-4)+HEADER_CHAR+DATA_RETURNED;            C:\fw\midicontroller\x009\rs232.c
001f0c   5dd5     SUBWF     0xd5,0x0,0x1                                                                                    
001f0e   0100     MOVLB     0x0                                                                                             
001f10   25c5     ADDWF     0xc5,0x0,0x1                                                                                    
001f12   0f7e     ADDLW     0x7e                                                                                            
001f14   0f05     ADDLW     0x5                                                                                             
001f16   0100     MOVLB     0x0                                                                                             
001f18   6fda     MOVWF     0xda,0x1                                                                                        
001f1a   0100     MOVLB     0x0            			SendingOutString = true;                                                      C:\fw\midicontroller\x009\rs232.c
001f1c   8566     BSF       0x66,0x2,0x1                                                                                    
001f1e   9766     BCF       0x66,0x3,0x1   			StringInEEPROM = false;                                                       C:\fw\midicontroller\x009\rs232.c
001f20   9f66     BCF       0x66,0x7,0x1   			StringInRAM = false;                                                          C:\fw\midicontroller\x009\rs232.c
001f22   50d9     MOVF      0xd9,0x0,0x0   			tempreg.s_form = (unsigned short)&MfrString;                                  C:\fw\midicontroller\x009\rs232.c
001f24   0f07     ADDLW     0x7                                                                                             
001f26   6ee9     MOVWF     0xe9,0x0                                                                                        
001f28   cfda     MOVFF     0xfda,0xfea                                                                                     
001f2a   ffea                                                                                                               
001f2c   0ed2     MOVLW     0xd2                                                                                            
001f2e   6eee     MOVWF     0xee,0x0                                                                                        
001f30   0e35     MOVLW     0x35                                                                                            
001f32   6eed     MOVWF     0xed,0x0                                                                                        
001f34   0e08     MOVLW     0x8            			StringPtr_H = tempreg.b_form.high;                                            C:\fw\midicontroller\x009\rs232.c
001f36   cfdb     MOVFF     0xfdb,0xd9                                                                                      
001f38   f0d9                                                                                                               
001f3a   0e07     MOVLW     0x7            			StringPtr = tempreg.b_form.low;	//Send out serial string.                     C:\fw\midicontroller\x009\rs232.c
001f3c   cfdb     MOVFF     0xfdb,0xd8                                                                                      
001f3e   f0d8                                                                                                               
001f40   d0de     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		case 42:                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			//iDeviceChemistry                                                            C:\fw\midicontroller\x009\rs232.c
001f42   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001f44   0e05     MOVLW     0x5                                                                                             
001f46   6fdb     MOVWF     0xdb,0x1                                                                                        
001f48   0100     MOVLB     0x0            			TxBuffer[2] = 5;			//number of bytes in response                              C:\fw\midicontroller\x009\rs232.c
001f4a   6fcd     MOVWF     0xcd,0x1                                                                                        
001f4c   0100     MOVLB     0x0            			if (USBQuery) {                                                               C:\fw\midicontroller\x009\rs232.c
001f4e   a966     BTFSS     0x66,0x4,0x1                                                                                    
001f50   d005     BRA       0x1f5c                                                                                          
001f52   0e04     MOVLW     0x4            				TXENQ(INDEX_DEVCHEM);                                                        C:\fw\midicontroller\x009\rs232.c
001f54   6ee6     MOVWF     0xe6,0x0                                                                                        
001f56   daa0     RCALL     0x2498                                                                                          
001f58   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f5a   d0d1     BRA       0x20fe         				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}			                                                                          C:\fw\midicontroller\x009\rs232.c
001f5c   0e04     MOVLW     0x4            			TxBufPtr = TxBuffer[2]+4;					//override txbuffer pointer.                    C:\fw\midicontroller\x009\rs232.c
001f5e   0100     MOVLB     0x0                                                                                             
001f60   25cd     ADDWF     0xcd,0x0,0x1                                                                                    
001f62   0100     MOVLB     0x0                                                                                             
001f64   6fd5     MOVWF     0xd5,0x1                                                                                        
001f66   0e04     MOVLW     0x4            			StringChksum = RxBuffer[3]+(TxBufPtr-4)+HEADER_CHAR+DATA_RETURNED;            C:\fw\midicontroller\x009\rs232.c
001f68   5dd5     SUBWF     0xd5,0x0,0x1                                                                                    
001f6a   0100     MOVLB     0x0                                                                                             
001f6c   25c5     ADDWF     0xc5,0x0,0x1                                                                                    
001f6e   0f7e     ADDLW     0x7e                                                                                            
001f70   0f05     ADDLW     0x5                                                                                             
001f72   0100     MOVLB     0x0                                                                                             
001f74   6fda     MOVWF     0xda,0x1                                                                                        
001f76   0100     MOVLB     0x0            			SendingOutString = true;                                                      C:\fw\midicontroller\x009\rs232.c
001f78   8566     BSF       0x66,0x2,0x1                                                                                    
001f7a   9766     BCF       0x66,0x3,0x1   			StringInEEPROM = false;                                                       C:\fw\midicontroller\x009\rs232.c
001f7c   9f66     BCF       0x66,0x7,0x1   			StringInRAM = false;                                                          C:\fw\midicontroller\x009\rs232.c
001f7e   50d9     MOVF      0xd9,0x0,0x0   			tempreg.s_form = (unsigned short)(&DevChem)+2;                                C:\fw\midicontroller\x009\rs232.c
001f80   0f07     ADDLW     0x7                                                                                             
001f82   6ee9     MOVWF     0xe9,0x0                                                                                        
001f84   cfda     MOVFF     0xfda,0xfea                                                                                     
001f86   ffea                                                                                                               
001f88   0eec     MOVLW     0xec                                                                                            
001f8a   6eee     MOVWF     0xee,0x0                                                                                        
001f8c   0e35     MOVLW     0x35                                                                                            
001f8e   6eed     MOVWF     0xed,0x0                                                                                        
001f90   0e08     MOVLW     0x8            			StringPtr_H = tempreg.b_form.high;	//(backwards for some crazy reason)        C:\fw\midicontroller\x009\rs232.c
001f92   cfdb     MOVFF     0xfdb,0xd9                                                                                      
001f94   f0d9                                                                                                               
001f96   0e07     MOVLW     0x7            			StringPtr = tempreg.b_form.low;	//Send out serial string.                     C:\fw\midicontroller\x009\rs232.c
001f98   cfdb     MOVFF     0xfdb,0xd8                                                                                      
001f9a   f0d8                                                                                                               
001f9c   d0b0     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           //production test commands:			                                                   C:\fw\midicontroller\x009\rs232.c
                                           		case 150:		//NVR Read                                                          C:\fw\midicontroller\x009\rs232.c
001f9e   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001fa0   0e05     MOVLW     0x5                                                                                             
001fa2   6fdb     MOVWF     0xdb,0x1                                                                                        
001fa4   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x009\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        C:\fw\midicontroller\x009\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x009\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();		//returns data through wreg                    C:\fw\midicontroller\x009\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x009\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001fa6   d005     BRA       0x1fb2         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
001fa8   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
001faa   6fdb     MOVWF     0xdb,0x1                                                                                        
001fac   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
001fae   da74     RCALL     0x2498                                                                                          
001fb0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001fb2   d0a5     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           			                                                                              C:\fw\midicontroller\x009\rs232.c
                                           		case 151:		//NVR Address                                                       C:\fw\midicontroller\x009\rs232.c
001fb4   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001fb6   0e05     MOVLW     0x5                                                                                             
001fb8   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
001fba   c060     MOVFF     0x60,0xfe6     				TXENQ(NVRCommAddr.b_form.low);		//low byte                                   C:\fw\midicontroller\x009\rs232.c
001fbc   ffe6                                                                                                               
001fbe   da6c     RCALL     0x2498                                                                                          
001fc0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001fc2   c061     MOVFF     0x61,0xfe6     				TXENQ(NVRCommAddr.b_form.high);		//high byte                                 C:\fw\midicontroller\x009\rs232.c
001fc4   ffe6                                                                                                               
001fc6   da68     RCALL     0x2498                                                                                          
001fc8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001fca   d009     BRA       0x1fde         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
001fcc   0100     MOVLB     0x0            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
001fce   0e01     MOVLW     0x1                                                                                             
001fd0   6fdb     MOVWF     0xdb,0x1                                                                                        
001fd2   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);		//low byte                                          C:\fw\midicontroller\x009\rs232.c
001fd4   da61     RCALL     0x2498                                                                                          
001fd6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001fd8   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);		//high byte                                         C:\fw\midicontroller\x009\rs232.c
001fda   da5e     RCALL     0x2498                                                                                          
001fdc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
001fde   d08f     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 152:		//RAM Read                                                          C:\fw\midicontroller\x009\rs232.c
001fe0   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
001fe2   0e05     MOVLW     0x5                                                                                             
001fe4   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
001fe6   0e04     MOVLW     0x4            				Data = (far unsigned char *)RAMCommAddr.s_form;                              C:\fw\midicontroller\x009\rs232.c
001fe8   c062     MOVFF     0x62,0xfdb                                                                                      
001fea   ffdb                                                                                                               
001fec   0e05     MOVLW     0x5                                                                                             
001fee   c063     MOVFF     0x63,0xfdb                                                                                      
001ff0   ffdb                                                                                                               
001ff2   0e04     MOVLW     0x4            				TXENQ(*Data);                                                                C:\fw\midicontroller\x009\rs232.c
001ff4   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
001ff6   ffe9                                                                                                               
001ff8   0e05     MOVLW     0x5                                                                                             
001ffa   cfdb     MOVFF     0xfdb,0xfea                                                                                     
001ffc   ffea                                                                                                               
001ffe   50ef     MOVF      0xef,0x0,0x0                                                                                    
002000   6ee6     MOVWF     0xe6,0x0                                                                                        
002002   da4a     RCALL     0x2498                                                                                          
002004   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002006   d006     BRA       0x2014         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
002008   0100     MOVLB     0x0            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
00200a   0e01     MOVLW     0x1                                                                                             
00200c   6fdb     MOVWF     0xdb,0x1                                                                                        
00200e   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
002010   da43     RCALL     0x2498                                                                                          
002012   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002014   d074     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	                                                                                C:\fw\midicontroller\x009\rs232.c
                                           		case 153:		//RAM Address                                                       C:\fw\midicontroller\x009\rs232.c
002016   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
002018   0e05     MOVLW     0x5                                                                                             
00201a   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
00201c   c062     MOVFF     0x62,0xfe6     				TXENQ(RAMCommAddr.b_form.low);		//low byte                                   C:\fw\midicontroller\x009\rs232.c
00201e   ffe6                                                                                                               
002020   da3b     RCALL     0x2498                                                                                          
002022   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002024   c063     MOVFF     0x63,0xfe6     				TXENQ(RAMCommAddr.b_form.high);		//high byte                                 C:\fw\midicontroller\x009\rs232.c
002026   ffe6                                                                                                               
002028   da37     RCALL     0x2498                                                                                          
00202a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
00202c   d009     BRA       0x2040         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
00202e   0100     MOVLB     0x0            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
002030   0e01     MOVLW     0x1                                                                                             
002032   6fdb     MOVWF     0xdb,0x1                                                                                        
002034   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
002036   da30     RCALL     0x2498                                                                                          
002038   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00203a   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
00203c   da2d     RCALL     0x2498                                                                                          
00203e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002040   d05e     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	                                                                                C:\fw\midicontroller\x009\rs232.c
                                           		case 156:		//ROM Read                                                          C:\fw\midicontroller\x009\rs232.c
002042   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
002044   0e05     MOVLW     0x5                                                                                             
002046   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
002048   c064     MOVFF     0x64,0xff6     				TXENQ(*(near unsigned char rom *)ROMCommAddr.s_form);                        C:\fw\midicontroller\x009\rs232.c
00204a   fff6                                                                                                               
00204c   c065     MOVFF     0x65,0xff7                                                                                      
00204e   fff7                                                                                                               
002050   0008     TBLRD                                                                                                     
002052   50f5     MOVF      0xf5,0x0,0x0                                                                                    
002054   6ee6     MOVWF     0xe6,0x0                                                                                        
002056   da20     RCALL     0x2498                                                                                          
002058   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
00205a   d006     BRA       0x2068         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
00205c   0100     MOVLB     0x0            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
00205e   0e01     MOVLW     0x1                                                                                             
002060   6fdb     MOVWF     0xdb,0x1                                                                                        
002062   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
002064   da19     RCALL     0x2498                                                                                          
002066   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002068   d04a     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	                                                                                C:\fw\midicontroller\x009\rs232.c
                                           		case 157:		//ROM Address                                                       C:\fw\midicontroller\x009\rs232.c
00206a   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
00206c   0e05     MOVLW     0x5                                                                                             
00206e   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
002070   c064     MOVFF     0x64,0xfe6     				TXENQ(ROMCommAddr.b_form.low);		//low byte                                   C:\fw\midicontroller\x009\rs232.c
002072   ffe6                                                                                                               
002074   da11     RCALL     0x2498                                                                                          
002076   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002078   c065     MOVFF     0x65,0xfe6     				TXENQ(ROMCommAddr.b_form.high);		//high byte                                 C:\fw\midicontroller\x009\rs232.c
00207a   ffe6                                                                                                               
00207c   da0d     RCALL     0x2498                                                                                          
00207e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002080   d009     BRA       0x2094         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
002082   0100     MOVLB     0x0            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
002084   0e01     MOVLW     0x1                                                                                             
002086   6fdb     MOVWF     0xdb,0x1                                                                                        
002088   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
00208a   da06     RCALL     0x2498                                                                                          
00208c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00208e   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
002090   da03     RCALL     0x2498                                                                                          
002092   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002094   d034     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		case 155:		//production test protocol                                          C:\fw\midicontroller\x009\rs232.c
002096   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
002098   0e05     MOVLW     0x5                                                                                             
00209a   6fdb     MOVWF     0xdb,0x1                                                                                        
00209c   0e03     MOVLW     0x3            			TXENQ(PRODUCTION_TEST_PROTOCOL&255);                                          C:\fw\midicontroller\x009\rs232.c
00209e   6ee6     MOVWF     0xe6,0x0                                                                                        
0020a0   d9fb     RCALL     0x2498                                                                                          
0020a2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			//TXENQ(PRODUCTION_TEST_PROTOCOL/256);                                        C:\fw\midicontroller\x009\rs232.c
0020a4   6ae6     CLRF      0xe6,0x0       			TXENQ(PRODUCTION_TEST_PROTOCOL>>8);                                           C:\fw\midicontroller\x009\rs232.c
0020a6   d9f8     RCALL     0x2498                                                                                          
0020a8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020aa   d029     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	                                                                                C:\fw\midicontroller\x009\rs232.c
                                           		case 175:		//voltage data                                                      C:\fw\midicontroller\x009\rs232.c
0020ac   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
0020ae   0e05     MOVLW     0x5                                                                                             
0020b0   6fdb     MOVWF     0xdb,0x1                                                                                        
0020b2   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x009\rs232.c
0020b4   d9f1     RCALL     0x2498                                                                                          
0020b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020b8   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x009\rs232.c
0020ba   d9ee     RCALL     0x2498                                                                                          
0020bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020be   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x009\rs232.c
0020c0   d9eb     RCALL     0x2498                                                                                          
0020c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020c4   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x009\rs232.c
0020c6   d9e8     RCALL     0x2498                                                                                          
0020c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020ca   d019     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		case 180:		//NVR Page Read                                                     C:\fw\midicontroller\x009\rs232.c
0020cc   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x009\rs232.c
0020ce   0e05     MOVLW     0x5                                                                                             
0020d0   6fdb     MOVWF     0xdb,0x1                                                                                        
0020d2   b8a0     BTFSC     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x009\rs232.c
0020d4   d004     BRA       0x20de                                                                                          
0020d6   9ef2     BCF       0xf2,0x7,0x0   				DISABLE_ALL_INTERRUPTS();                                                    C:\fw\midicontroller\x009\rs232.c
0020d8   9cf2     BCF       0xf2,0x6,0x0                                                                                    
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        C:\fw\midicontroller\x009\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x009\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x009\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x009\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x009\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x009\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x009\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x009\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x009\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x009\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x009\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x009\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x009\rs232.c
0020da   d011     BRA       0x20fe         				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
0020dc   d00f     BRA       0x20fc         			else {                                                                        C:\fw\midicontroller\x009\rs232.c
0020de   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
0020e0   6fdb     MOVWF     0xdb,0x1                                                                                        
0020e2   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
0020e4   d9d9     RCALL     0x2498                                                                                          
0020e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020e8   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
0020ea   d9d6     RCALL     0x2498                                                                                          
0020ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020ee   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
0020f0   d9d3     RCALL     0x2498                                                                                          
0020f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020f4   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x009\rs232.c
0020f6   d9d0     RCALL     0x2498                                                                                          
0020f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020fa   d001     BRA       0x20fe         				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}				                                                                         C:\fw\midicontroller\x009\rs232.c
                                           		default:                                                                       C:\fw\midicontroller\x009\rs232.c
0020fc   d000     BRA       0x20fe         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		}                                                                              C:\fw\midicontroller\x009\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           //Set command:                                                                   C:\fw\midicontroller\x009\rs232.c
0020fe   0100     MOVLB     0x0            	if (!USBQuery && RxBuffer[1] == 0x04 || \                                       C:\fw\midicontroller\x009\rs232.c
002100   5166     MOVF      0x66,0x0,0x1                                                                                    
002102   0b10     ANDLW     0x10                                                                                            
002104   e104     BNZ       0x210e                                                                                          
002106   0e04     MOVLW     0x4                                                                                             
002108   0100     MOVLB     0x0                                                                                             
00210a   5dc3     SUBWF     0xc3,0x0,0x1                                                                                    
00210c   e00a     BZ        0x2122                                                                                          
00210e   0100     MOVLB     0x0                                                                                             
002110   5166     MOVF      0x66,0x0,0x1                                                                                    
002112   0b10     ANDLW     0x10                                                                                            
002114   e101     BNZ       0x2118                                                                                          
002116   d15f     BRA       0x23d6                                                                                          
002118   0e09     MOVLW     0x9                                                                                             
00211a   0104     MOVLB     0x4                                                                                             
00211c   5d11     SUBWF     0x11,0x0,0x1                                                                                    
00211e   e001     BZ        0x2122                                                                                          
002120   d15a     BRA       0x23d6                                                                                          
                                           		USBQuery && SetupPkt.bRequest == SET_REPORT) {                                 C:\fw\midicontroller\x009\rs232.c
002122   0100     MOVLB     0x0            		switch ((USBQuery?SetupPkt._byte[2]:RxBuffer[3])) {                            C:\fw\midicontroller\x009\rs232.c
002124   5166     MOVF      0x66,0x0,0x1                                                                                    
002126   0b10     ANDLW     0x10                                                                                            
002128   e003     BZ        0x2130                                                                                          
00212a   0104     MOVLB     0x4                                                                                             
00212c   5112     MOVF      0x12,0x0,0x1                                                                                    
00212e   d002     BRA       0x2134                                                                                          
002130   0100     MOVLB     0x0                                                                                             
002132   51c5     MOVF      0xc5,0x0,0x1                                                                                    
002134   0ab4     XORLW     0xb4                                                                                            
002136   e101     BNZ       0x213a                                                                                          
002138   d11e     BRA       0x2376                                                                                          
00213a   0a29     XORLW     0x29                                                                                            
00213c   e101     BNZ       0x2140                                                                                          
00213e   d0ef     BRA       0x231e                                                                                          
002140   0a01     XORLW     0x1                                                                                             
002142   e101     BNZ       0x2146                                                                                          
002144   d0e0     BRA       0x2306                                                                                          
002146   0a06     XORLW     0x6                                                                                             
002148   e101     BNZ       0x214c                                                                                          
00214a   d083     BRA       0x2252                                                                                          
00214c   0a03     XORLW     0x3                                                                                             
00214e   e059     BZ        0x2202                                                                                          
002150   0a01     XORLW     0x1                                                                                             
002152   e041     BZ        0x21d6                                                                                          
002154   0a0f     XORLW     0xf                                                                                             
002156   e013     BZ        0x217e                                                                                          
002158   0a01     XORLW     0x1                                                                                             
00215a   e001     BZ        0x215e                                                                                          
                                           /*                                                                               C:\fw\midicontroller\x009\rs232.c
                                           		case 17:                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			//AudibleAlarmControl                                                         C:\fw\midicontroller\x009\rs232.c
                                           			if (RcvPtr[0] == 3) {                                                         C:\fw\midicontroller\x009\rs232.c
                                           				MuteBeeper = true;                                                           C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_ACCEPTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 16:		//Test                                                               C:\fw\midicontroller\x009\rs232.c
                                           			if (MASTER_RELAY_LAT_BIT && LineValid) {	//check if Master receptacles off or Line invalid? C:\fw\midicontroller\x009\rs232.c
                                           				if (RcvPtr[0] == 1) {                                                        C:\fw\midicontroller\x009\rs232.c
                                           					RequestSelfTest = true;                                                     C:\fw\midicontroller\x009\rs232.c
                                           					ResponseType = COMMAND_ACCEPTED;                                            C:\fw\midicontroller\x009\rs232.c
                                           				}                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 21:		//DelayBeforeShutdown                                                C:\fw\midicontroller\x009\rs232.c
                                           			if (ContactClosureShutdownLatch || SelfTestMode) {                            C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           				TXENQ(RcvPtr[0]);			//data                                                   C:\fw\midicontroller\x009\rs232.c
                                           				TXENQ(RcvPtr[1]);			//data                                                   C:\fw\midicontroller\x009\rs232.c
                                           				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else ResponseType = COMMAND_ACCEPTED;                                         C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			PreDelayHighByte = RcvPtr[1];		//Store high byte value                        C:\fw\midicontroller\x009\rs232.c
                                           			PreDelayLowByte = RcvPtr[0];		//Store low byte value                          C:\fw\midicontroller\x009\rs232.c
                                           			PreDelayCntr_H = PreDelayHighByte;		//Load high byte counter                  C:\fw\midicontroller\x009\rs232.c
                                           			PreDelayCntr_L = PreDelayLowByte;		//Load low byte counter                    C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			if (RcvPtr[0] == 0xff && RcvPtr[1] == 0xff) {                                 C:\fw\midicontroller\x009\rs232.c
                                           				//Abort the inverter shutdown command                                        C:\fw\midicontroller\x009\rs232.c
                                           				CountOutPreDelay = false;                                                    C:\fw\midicontroller\x009\rs232.c
                                           				RequestUnitShutDown = false;                                                 C:\fw\midicontroller\x009\rs232.c
                                           				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			if (RcvPtr[0] == 0 && RcvPtr[1] == 0) {                                       C:\fw\midicontroller\x009\rs232.c
                                           				PreDelayLowByte = DEFAULT_PREDELAY;		//load default predelay                 C:\fw\midicontroller\x009\rs232.c
                                           				PreDelayCntr_L = PreDelayLowByte;		//Load low byte counter                   C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			RequestUnitShutDown = true;                                                   C:\fw\midicontroller\x009\rs232.c
                                           			CountOutPreDelay = true;                                                      C:\fw\midicontroller\x009\rs232.c
                                           			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 23:		//DelayBeforeReboot                                                  C:\fw\midicontroller\x009\rs232.c
                                           			if (InverterON || Standby) {                                                  C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else {                                                                        C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_ACCEPTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           				RebootCounter = RcvPtr[0];                                                   C:\fw\midicontroller\x009\rs232.c
                                           				RebootCounter_H = RcvPtr[1];                                                 C:\fw\midicontroller\x009\rs232.c
                                           				RequestReboot = true;		//Request all active power outlets be turned off for 10 seconds C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 22:	//DelayBeforeStartup (vendor defined) (minutes)                       C:\fw\midicontroller\x009\rs232.c
                                           		case 97:	//DelayBeforeStartup (seconds)                                        C:\fw\midicontroller\x009\rs232.c
                                           			if (ContactClosureShutdownLatch || SelfTestMode || !BatteryOK) {              C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           				TXENQ(RcvPtr[0]);			//data                                                   C:\fw\midicontroller\x009\rs232.c
                                           				TXENQ(RcvPtr[1]);			//data                                                   C:\fw\midicontroller\x009\rs232.c
                                           				break;                                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else ResponseType = COMMAND_ACCEPTED;                                         C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			if (RcvPtr[3] == 22) {				//data is in minutes, so convert to seconds.        C:\fw\midicontroller\x009\rs232.c
                                           				tempreg.b_form.low = RcvPtr[0];                                              C:\fw\midicontroller\x009\rs232.c
                                           				tempreg.b_form.high = RcvPtr[1];                                             C:\fw\midicontroller\x009\rs232.c
                                           				longreg.l_form = tempreg.s_form*60;		//overflow not possible                 C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_H = longreg.b_form.byte2;                                      C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_M = longreg.b_form.byte1;                                      C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_L = longreg.b_form.byte0;                                      C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else {									//data is in seconds, so just copy it over.                    C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_H = 0;                                                         C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_M = RcvPtr[1];                                                 C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_L = RcvPtr[0];                                                 C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			                                                                              C:\fw\midicontroller\x009\rs232.c
                                           			if (RcvPtr[0] == 0xff && RcvPtr[1] == 0xff) {	//cancel command                C:\fw\midicontroller\x009\rs232.c
                                           				CountOutPreDelay = false;                                                    C:\fw\midicontroller\x009\rs232.c
                                           				RequestUnitShutDown = false;	//Abort the inverter shutdown command           C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWakeup = false;                                                       C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			if (DelayedWUCntr_L == 0 && DelayedWUCntr_M == 0 && DelayedWUCntr_H == 0) {   C:\fw\midicontroller\x009\rs232.c
                                           				DelayedWUCntr_L = 2;			//load default wakeup predelay                        C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			if (PreDelayCntr_H == 0 && PreDelayCntr_L == 0 || !MASTER_RELAY_LAT_BIT || !RequestUnitShutDown) { C:\fw\midicontroller\x009\rs232.c
                                           				PreDelayCntr_H = 0;                                                          C:\fw\midicontroller\x009\rs232.c
                                           				PreDelayCntr_L = DEFAULT_PREDELAY;	//load default predelay                   C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			                                                                              C:\fw\midicontroller\x009\rs232.c
                                           			if (!DelayedWakeup) {			//if we are not already in delayed wakeup..           C:\fw\midicontroller\x009\rs232.c
                                           				RequestDelayedWakeUp = true;                                                 C:\fw\midicontroller\x009\rs232.c
                                           				CountOutPreDelay = true;                                                     C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 82:	//Watchdog                                                            C:\fw\midicontroller\x009\rs232.c
                                           			if (RcvPtr[0] != 0) {                                                         C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_ACCEPTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           				ComWatchValue = RcvPtr[0];		//load watchdog counter.                         C:\fw\midicontroller\x009\rs232.c
                                           				ComWatchCntr = ComWatchValue;                                                C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 105:	//SwitchOutletControlMap                                             C:\fw\midicontroller\x009\rs232.c
                                           			if (!CountOutPreDelay && !SelfTestMode) {                                     C:\fw\midicontroller\x009\rs232.c
                                           				ResponseType = COMMAND_ACCEPTED;                                             C:\fw\midicontroller\x009\rs232.c
                                           				ReceptacleStatus = ~RcvPtr[0];		//load desired outlet state.                 C:\fw\midicontroller\x009\rs232.c
                                           				RequestOutletChange = true;                                                  C:\fw\midicontroller\x009\rs232.c
                                           				CountOutPreDelay = true;                                                     C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			break;	                                                                       C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		case 193:	//EnterBootload mode                                                 C:\fw\midicontroller\x009\rs232.c
                                           			if (Standby) {                                                                C:\fw\midicontroller\x009\rs232.c
                                           				if (RcvPtr[0] == 0xF6 && \                                                   C:\fw\midicontroller\x009\rs232.c
                                           					RcvPtr[1] == 0x8C && \                                                      C:\fw\midicontroller\x009\rs232.c
                                           					RcvPtr[2] == 0x2A && \                                                      C:\fw\midicontroller\x009\rs232.c
                                           					RcvPtr[3] == 0x6B) {                                                        C:\fw\midicontroller\x009\rs232.c
                                           						                                                                           C:\fw\midicontroller\x009\rs232.c
                                           //exit UPS functionality and enter bootload mode.                                C:\fw\midicontroller\x009\rs232.c
                                           					DISABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x009\rs232.c
                                           					_asm	goto	BOOT_LOAD_MODE	_endasm                                            C:\fw\midicontroller\x009\rs232.c
                                           						                                                                           C:\fw\midicontroller\x009\rs232.c
                                           				}                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			ResponseType = COMMAND_REJECTED;                                              C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[2]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			TXENQ(RcvPtr[3]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
                                           			break;	                                                                       C:\fw\midicontroller\x009\rs232.c
                                           */			                                                                            C:\fw\midicontroller\x009\rs232.c
                                           //Production test commands                                                       C:\fw\midicontroller\x009\rs232.c
                                           		case 150:		//NVR Write                                                         C:\fw\midicontroller\x009\rs232.c
00215e   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
002160   0e02     MOVLW     0x2                                                                                             
002162   6fdb     MOVWF     0xdb,0x1                                                                                        
002164   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x009\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x009\rs232.c
                                           //				EECounterB = 1;						//Number of bytes to write.                           C:\fw\midicontroller\x009\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;	//EEPROM register starting address byte. C:\fw\midicontroller\x009\rs232.c
                                           //				EEData = RcvPtr[0];					//First byte of data to write.                     C:\fw\midicontroller\x009\rs232.c
                                           //diag disable ee_page_write                                                     C:\fw\midicontroller\x009\rs232.c
                                           //				EE_PAGE_WRITE();                                                           C:\fw\midicontroller\x009\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002166   d002     BRA       0x216c         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
002168   0e01     MOVLW     0x1                                                                                             
00216a   6fdb     MOVWF     0xdb,0x1                                                                                        
00216c   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
00216e   ffe9                                                                                                               
002170   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002172   ffea                                                                                                               
002174   50ef     MOVF      0xef,0x0,0x0                                                                                    
002176   6ee6     MOVWF     0xe6,0x0                                                                                        
002178   d98f     RCALL     0x2498                                                                                          
00217a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00217c   d12c     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           			                                                                              C:\fw\midicontroller\x009\rs232.c
                                           		case 151:		//NVR Address                                                       C:\fw\midicontroller\x009\rs232.c
00217e   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
002180   0e02     MOVLW     0x2                                                                                             
002182   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
002184   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.low = RcvPtr[0];		//low byte                              C:\fw\midicontroller\x009\rs232.c
002186   ffe9                                                                                                               
002188   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00218a   ffea                                                                                                               
00218c   cfef     MOVFF     0xfef,0x60                                                                                      
00218e   f060                                                                                                               
002190   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.high = RcvPtr[1];	//high byte                             C:\fw\midicontroller\x009\rs232.c
002192   ffe9                                                                                                               
002194   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002196   ffea                                                                                                               
002198   0e01     MOVLW     0x1                                                                                             
00219a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00219c   0e00     MOVLW     0x0                                                                                             
00219e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0021a0   cfef     MOVFF     0xfef,0x61                                                                                      
0021a2   f061                                                                                                               
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
0021a4   d003     BRA       0x21ac         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
0021a6   0100     MOVLB     0x0                                                                                             
0021a8   0e01     MOVLW     0x1                                                                                             
0021aa   6fdb     MOVWF     0xdb,0x1                                                                                        
0021ac   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0021ae   ffe9                                                                                                               
0021b0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0021b2   ffea                                                                                                               
0021b4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0021b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0021b8   d96f     RCALL     0x2498                                                                                          
0021ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0021bc   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0021be   ffe9                                                                                                               
0021c0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0021c2   ffea                                                                                                               
0021c4   0e01     MOVLW     0x1                                                                                             
0021c6   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0021c8   0e00     MOVLW     0x0                                                                                             
0021ca   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0021cc   50ef     MOVF      0xef,0x0,0x0                                                                                    
0021ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0021d0   d963     RCALL     0x2498                                                                                          
0021d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0021d4   d100     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 152:		//RAM Write                                                         C:\fw\midicontroller\x009\rs232.c
0021d6   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
0021d8   0e02     MOVLW     0x2                                                                                             
0021da   6fdb     MOVWF     0xdb,0x1                                                                                        
0021dc   cfde     MOVFF     0xfde,0xfe9    			*(far unsigned char *)RAMCommAddr.s_form = RcvPtr[0];                         C:\fw\midicontroller\x009\rs232.c
0021de   ffe9                                                                                                               
0021e0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0021e2   ffea                                                                                                               
0021e4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0021e6   c062     MOVFF     0x62,0xfe9                                                                                      
0021e8   ffe9                                                                                                               
0021ea   c063     MOVFF     0x63,0xfea                                                                                      
0021ec   ffea                                                                                                               
0021ee   6eef     MOVWF     0xef,0x0                                                                                        
0021f0   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0021f2   ffe9                                                                                                               
0021f4   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0021f6   ffea                                                                                                               
0021f8   50ef     MOVF      0xef,0x0,0x0                                                                                    
0021fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0021fc   d94d     RCALL     0x2498                                                                                          
0021fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002200   d0ea     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	                                                                                C:\fw\midicontroller\x009\rs232.c
                                           		case 153:		//RAM Address                                                       C:\fw\midicontroller\x009\rs232.c
002202   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
002204   0e02     MOVLW     0x2                                                                                             
002206   6fdb     MOVWF     0xdb,0x1                                                                                        
002208   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.low = RcvPtr[0];		//low byte                               C:\fw\midicontroller\x009\rs232.c
00220a   ffe9                                                                                                               
00220c   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00220e   ffea                                                                                                               
002210   cfef     MOVFF     0xfef,0x62                                                                                      
002212   f062                                                                                                               
002214   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.high = RcvPtr[1];	//high byte                              C:\fw\midicontroller\x009\rs232.c
002216   ffe9                                                                                                               
002218   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00221a   ffea                                                                                                               
00221c   0e01     MOVLW     0x1                                                                                             
00221e   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002220   0e00     MOVLW     0x0                                                                                             
002222   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002224   cfef     MOVFF     0xfef,0x63                                                                                      
002226   f063                                                                                                               
002228   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
00222a   ffe9                                                                                                               
00222c   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00222e   ffea                                                                                                               
002230   50ef     MOVF      0xef,0x0,0x0                                                                                    
002232   6ee6     MOVWF     0xe6,0x0                                                                                        
002234   d931     RCALL     0x2498                                                                                          
002236   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002238   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
00223a   ffe9                                                                                                               
00223c   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00223e   ffea                                                                                                               
002240   0e01     MOVLW     0x1                                                                                             
002242   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002244   0e00     MOVLW     0x0                                                                                             
002246   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002248   50ef     MOVF      0xef,0x0,0x0                                                                                    
00224a   6ee6     MOVWF     0xe6,0x0                                                                                        
00224c   d925     RCALL     0x2498                                                                                          
00224e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002250   d0c2     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 154:		//Password write (starting with low byte)                           C:\fw\midicontroller\x009\rs232.c
002252   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
002254   0e02     MOVLW     0x2                                                                                             
002256   6fdb     MOVWF     0xdb,0x1                                                                                        
002258   cfde     MOVFF     0xfde,0xfe9    			if (RcvPtr[0] == 0x42 && \                                                    C:\fw\midicontroller\x009\rs232.c
00225a   ffe9                                                                                                               
00225c   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00225e   ffea                                                                                                               
002260   50ef     MOVF      0xef,0x0,0x0                                                                                    
002262   0842     SUBLW     0x42                                                                                            
002264   e123     BNZ       0x22ac                                                                                          
002266   cfde     MOVFF     0xfde,0xfe9                                                                                     
002268   ffe9                                                                                                               
00226a   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00226c   ffea                                                                                                               
00226e   0e01     MOVLW     0x1                                                                                             
002270   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002272   0e00     MOVLW     0x0                                                                                             
002274   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002276   50ef     MOVF      0xef,0x0,0x0                                                                                    
002278   0819     SUBLW     0x19                                                                                            
00227a   e118     BNZ       0x22ac                                                                                          
00227c   cfde     MOVFF     0xfde,0xfe9                                                                                     
00227e   ffe9                                                                                                               
002280   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002282   ffea                                                                                                               
002284   0e02     MOVLW     0x2                                                                                             
002286   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002288   0e00     MOVLW     0x0                                                                                             
00228a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00228c   50ef     MOVF      0xef,0x0,0x0                                                                                    
00228e   086e     SUBLW     0x6e                                                                                            
002290   e10d     BNZ       0x22ac                                                                                          
002292   cfde     MOVFF     0xfde,0xfe9                                                                                     
002294   ffe9                                                                                                               
002296   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002298   ffea                                                                                                               
00229a   0e03     MOVLW     0x3                                                                                             
00229c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00229e   0e00     MOVLW     0x0                                                                                             
0022a0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0022a2   50ef     MOVF      0xef,0x0,0x0                                                                                    
0022a4   0886     SUBLW     0x86                                                                                            
0022a6   e102     BNZ       0x22ac                                                                                          
                                           				RcvPtr[1] == 0x19 && \                                                       C:\fw\midicontroller\x009\rs232.c
                                           				RcvPtr[2] == 0x6E && \                                                       C:\fw\midicontroller\x009\rs232.c
                                           				RcvPtr[3] == 0x86) {                                                         C:\fw\midicontroller\x009\rs232.c
0022a8   0100     MOVLB     0x0            				ProdTestCmdsAllowed = true;                                                  C:\fw\midicontroller\x009\rs232.c
0022aa   8d66     BSF       0x66,0x6,0x1                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           			//don't report command rejected because it'll make it easy to break the password. C:\fw\midicontroller\x009\rs232.c
0022ac   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0022ae   ffe9                                                                                                               
0022b0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0022b2   ffea                                                                                                               
0022b4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0022b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0022b8   d8ef     RCALL     0x2498                                                                                          
0022ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022bc   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0022be   ffe9                                                                                                               
0022c0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0022c2   ffea                                                                                                               
0022c4   0e01     MOVLW     0x1                                                                                             
0022c6   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0022c8   0e00     MOVLW     0x0                                                                                             
0022ca   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0022cc   50ef     MOVF      0xef,0x0,0x0                                                                                    
0022ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0022d0   d8e3     RCALL     0x2498                                                                                          
0022d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022d4   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[2]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0022d6   ffe9                                                                                                               
0022d8   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0022da   ffea                                                                                                               
0022dc   0e02     MOVLW     0x2                                                                                             
0022de   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0022e0   0e00     MOVLW     0x0                                                                                             
0022e2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0022e4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0022e6   6ee6     MOVWF     0xe6,0x0                                                                                        
0022e8   d8d7     RCALL     0x2498                                                                                          
0022ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022ec   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[3]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
0022ee   ffe9                                                                                                               
0022f0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0022f2   ffea                                                                                                               
0022f4   0e03     MOVLW     0x3                                                                                             
0022f6   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0022f8   0e00     MOVLW     0x0                                                                                             
0022fa   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0022fc   50ef     MOVF      0xef,0x0,0x0                                                                                    
0022fe   6ee6     MOVWF     0xe6,0x0                                                                                        
002300   d8cb     RCALL     0x2498                                                                                          
002302   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002304   d068     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		case 156:		//ROM Write (not supported)                                         C:\fw\midicontroller\x009\rs232.c
                                           //Writing a single byte is not supported by the chip.                            C:\fw\midicontroller\x009\rs232.c
002306   0100     MOVLB     0x0            			ResponseType = COMMAND_REJECTED;                                              C:\fw\midicontroller\x009\rs232.c
002308   0e01     MOVLW     0x1                                                                                             
00230a   6fdb     MOVWF     0xdb,0x1                                                                                        
00230c   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
00230e   ffe9                                                                                                               
002310   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002312   ffea                                                                                                               
002314   50ef     MOVF      0xef,0x0,0x0                                                                                    
002316   6ee6     MOVWF     0xe6,0x0                                                                                        
002318   d8bf     RCALL     0x2498                                                                                          
00231a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00231c   d05c     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	                                                                                C:\fw\midicontroller\x009\rs232.c
                                           		case 157:		//ROM Address                                                       C:\fw\midicontroller\x009\rs232.c
00231e   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
002320   0e02     MOVLW     0x2                                                                                             
002322   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x009\rs232.c
002324   cfde     MOVFF     0xfde,0xfe9    				ROMCommAddr.b_form.low = RcvPtr[0];		//low byte                              C:\fw\midicontroller\x009\rs232.c
002326   ffe9                                                                                                               
002328   cfdd     MOVFF     0xfdd,0xfea                                                                                     
00232a   ffea                                                                                                               
00232c   cfef     MOVFF     0xfef,0x64                                                                                      
00232e   f064                                                                                                               
002330   cfde     MOVFF     0xfde,0xfe9    				ROMCommAddr.b_form.high = RcvPtr[1];	//high byte                             C:\fw\midicontroller\x009\rs232.c
002332   ffe9                                                                                                               
002334   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002336   ffea                                                                                                               
002338   0e01     MOVLW     0x1                                                                                             
00233a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00233c   0e00     MOVLW     0x0                                                                                             
00233e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002340   cfef     MOVFF     0xfef,0x65                                                                                      
002342   f065                                                                                                               
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
002344   d003     BRA       0x234c         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x009\rs232.c
002346   0100     MOVLB     0x0                                                                                             
002348   0e01     MOVLW     0x1                                                                                             
00234a   6fdb     MOVWF     0xdb,0x1                                                                                        
00234c   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
00234e   ffe9                                                                                                               
002350   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002352   ffea                                                                                                               
002354   50ef     MOVF      0xef,0x0,0x0                                                                                    
002356   6ee6     MOVWF     0xe6,0x0                                                                                        
002358   d89f     RCALL     0x2498                                                                                          
00235a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00235c   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[1]);			//data                                                    C:\fw\midicontroller\x009\rs232.c
00235e   ffe9                                                                                                               
002360   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002362   ffea                                                                                                               
002364   0e01     MOVLW     0x1                                                                                             
002366   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002368   0e00     MOVLW     0x0                                                                                             
00236a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00236c   50ef     MOVF      0xef,0x0,0x0                                                                                    
00236e   6ee6     MOVWF     0xe6,0x0                                                                                        
002370   d893     RCALL     0x2498                                                                                          
002372   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002374   d030     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		case 180:		//NVR Page Write                                                    C:\fw\midicontroller\x009\rs232.c
002376   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x009\rs232.c
002378   0e02     MOVLW     0x2                                                                                             
00237a   6fdb     MOVWF     0xdb,0x1                                                                                        
                                           //			if (1 && !PIE2bits.EEIE && !RETRY_EEPROM_WRITE) {                           C:\fw\midicontroller\x009\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x009\rs232.c
                                           //				EECounterB = 4;						//Number of bytes to write.                           C:\fw\midicontroller\x009\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;	//EEPROM register starting address byte. C:\fw\midicontroller\x009\rs232.c
                                           //				EEData = RcvPtr[0];					//First byte of data to write.                     C:\fw\midicontroller\x009\rs232.c
                                           //				EEData1 = RcvPtr[1];				//Second byte of data to write.                    C:\fw\midicontroller\x009\rs232.c
                                           //				EEData2 = RcvPtr[2];				//Third byte of data to write.                     C:\fw\midicontroller\x009\rs232.c
                                           //				EEData3 = RcvPtr[3];				//Fourth byte of data to write.                    C:\fw\midicontroller\x009\rs232.c
                                           //diag.. disable ee_page_write                                                   C:\fw\midicontroller\x009\rs232.c
                                           //				EE_PAGE_WRITE();                                                           C:\fw\midicontroller\x009\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x009\rs232.c
                                           //			}                                                                           C:\fw\midicontroller\x009\rs232.c
                                           //			else ResponseType = COMMAND_REJECTED;                                       C:\fw\midicontroller\x009\rs232.c
00237c   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[0]);                                                             C:\fw\midicontroller\x009\rs232.c
00237e   ffe9                                                                                                               
002380   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002382   ffea                                                                                                               
002384   50ef     MOVF      0xef,0x0,0x0                                                                                    
002386   6ee6     MOVWF     0xe6,0x0                                                                                        
002388   d887     RCALL     0x2498                                                                                          
00238a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00238c   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[1]);                                                             C:\fw\midicontroller\x009\rs232.c
00238e   ffe9                                                                                                               
002390   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002392   ffea                                                                                                               
002394   0e01     MOVLW     0x1                                                                                             
002396   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002398   0e00     MOVLW     0x0                                                                                             
00239a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00239c   50ef     MOVF      0xef,0x0,0x0                                                                                    
00239e   6ee6     MOVWF     0xe6,0x0                                                                                        
0023a0   d87b     RCALL     0x2498                                                                                          
0023a2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0023a4   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[2]);                                                             C:\fw\midicontroller\x009\rs232.c
0023a6   ffe9                                                                                                               
0023a8   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0023aa   ffea                                                                                                               
0023ac   0e02     MOVLW     0x2                                                                                             
0023ae   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0023b0   0e00     MOVLW     0x0                                                                                             
0023b2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0023b4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0023b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0023b8   d86f     RCALL     0x2498                                                                                          
0023ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0023bc   cfde     MOVFF     0xfde,0xfe9    			TXENQ(RcvPtr[3]);                                                             C:\fw\midicontroller\x009\rs232.c
0023be   ffe9                                                                                                               
0023c0   cfdd     MOVFF     0xfdd,0xfea                                                                                     
0023c2   ffea                                                                                                               
0023c4   0e03     MOVLW     0x3                                                                                             
0023c6   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0023c8   0e00     MOVLW     0x0                                                                                             
0023ca   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0023cc   50ef     MOVF      0xef,0x0,0x0                                                                                    
0023ce   6ee6     MOVWF     0xe6,0x0                                                                                        
0023d0   d863     RCALL     0x2498                                                                                          
0023d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0023d4   d000     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		default:                                                                       C:\fw\midicontroller\x009\rs232.c
00215c   d13c     BRA       0x23d6         			break;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           		}                                                                              C:\fw\midicontroller\x009\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
0023d6   0100     MOVLB     0x0            	if (USBQuery) {                                                                 C:\fw\midicontroller\x009\rs232.c
0023d8   a966     BTFSS     0x66,0x4,0x1                                                                                    
0023da   d013     BRA       0x2402                                                                                          
0023dc   0eff     MOVLW     0xff           		if (ResponseType == 0xff) return;                                              C:\fw\midicontroller\x009\rs232.c
0023de   0100     MOVLB     0x0                                                                                             
0023e0   5ddb     SUBWF     0xdb,0x0,0x1                                                                                    
0023e2   e101     BNZ       0x23e6                                                                                          
0023e4   d04f     BRA       0x2484                                                                                          
                                           //no response or ack?                                                            C:\fw\midicontroller\x009\rs232.c
0023e6   0e09     MOVLW     0x9            		if (SetupPkt.bRequest == SET_REPORT) return;		//no response to set_report      C:\fw\midicontroller\x009\rs232.c
0023e8   0104     MOVLB     0x4                                                                                             
0023ea   5d11     SUBWF     0x11,0x0,0x1                                                                                    
0023ec   e101     BNZ       0x23f0                                                                                          
0023ee   d04a     BRA       0x2484                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		//USB query setup data:                                                        C:\fw\midicontroller\x009\rs232.c
0023f0   c412     MOVFF     0x412,0x418    		CtrlTrfData._byte[0] = SetupPkt._byte[2];                                      C:\fw\midicontroller\x009\rs232.c
0023f2   f418                                                                                                               
0023f4   0100     MOVLB     0x0            		wCount._word = USBDataPointer;		//Calculate number of bytes to send            C:\fw\midicontroller\x009\rs232.c
0023f6   51b9     MOVF      0xb9,0x0,0x1                                                                                    
0023f8   0101     MOVLB     0x1                                                                                             
0023fa   6f2c     MOVWF     0x2c,0x1                                                                                        
0023fc   6b2d     CLRF      0x2d,0x1                                                                                        
0023fe   d042     BRA       0x2484         		return;                                                                        C:\fw\midicontroller\x009\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
002400   d040     BRA       0x2482         	else {                                                                          C:\fw\midicontroller\x009\rs232.c
                                           		//RS232 query setup data:                                                      C:\fw\midicontroller\x009\rs232.c
002402   0100     MOVLB     0x0            		TxBuffer[0] = HEADER_CHAR;                                                     C:\fw\midicontroller\x009\rs232.c
002404   0e7e     MOVLW     0x7e                                                                                            
002406   6fcb     MOVWF     0xcb,0x1                                                                                        
002408   c0db     MOVFF     0xdb,0xcc      		TxBuffer[1] = ResponseType;                                                    C:\fw\midicontroller\x009\rs232.c
00240a   f0cc                                                                                                               
00240c   c0c5     MOVFF     0xc5,0xce      		TxBuffer[3] = RxBuffer[3];				//report ID.                                     C:\fw\midicontroller\x009\rs232.c
00240e   f0ce                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
002410   0100     MOVLB     0x0            		if (!SendingOutString) TxBuffer[2] = TxBufPtr-3;			//calculate the length of data returned C:\fw\midicontroller\x009\rs232.c
002412   b566     BTFSC     0x66,0x2,0x1                                                                                    
002414   d005     BRA       0x2420                                                                                          
002416   0e03     MOVLW     0x3                                                                                             
002418   0100     MOVLB     0x0                                                                                             
00241a   5dd5     SUBWF     0xd5,0x0,0x1                                                                                    
00241c   0100     MOVLB     0x0                                                                                             
00241e   6fcd     MOVWF     0xcd,0x1                                                                                        
                                           		//else TxBuffer[2] already written                                             C:\fw\midicontroller\x009\rs232.c
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           		//if we've enqueued a byte, this indicates that the command was accepted.      C:\fw\midicontroller\x009\rs232.c
                                           		//In that case, we should compute the checksum and send the data out.          C:\fw\midicontroller\x009\rs232.c
002420   0100     MOVLB     0x0            			if (!SendingOutString) {                                                      C:\fw\midicontroller\x009\rs232.c
002422   b566     BTFSC     0x66,0x2,0x1                                                                                    
002424   d028     BRA       0x2476                                                                                          
002426   0100     MOVLB     0x0            				if (TxBufPtr > 2) {		                                                        C:\fw\midicontroller\x009\rs232.c
002428   51d5     MOVF      0xd5,0x0,0x1                                                                                    
00242a   0802     SUBLW     0x2                                                                                             
00242c   e224     BC        0x2476                                                                                          
                                           				//We've enqueued all other bytes, so write the checksum:                     C:\fw\midicontroller\x009\rs232.c
00242e   0e03     MOVLW     0x3            					tempvar0 = 0;                                                               C:\fw\midicontroller\x009\rs232.c
002430   6adb     CLRF      0xdb,0x0                                                                                        
002432   0e02     MOVLW     0x2            					for (tempvar1 = 0;tempvar1 < TxBufPtr;tempvar1++) {                         C:\fw\midicontroller\x009\rs232.c
002434   6adb     CLRF      0xdb,0x0                                                                                        
002436   51d5     MOVF      0xd5,0x0,0x1                                                                                    
002438   6ef3     MOVWF     0xf3,0x0                                                                                        
00243a   0e02     MOVLW     0x2                                                                                             
00243c   cfdb     MOVFF     0xfdb,0xff4                                                                                     
00243e   fff4                                                                                                               
002440   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002442   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002444   e212     BC        0x246a                                                                                          
002464   0e02     MOVLW     0x2                                                                                             
002466   2adb     INCF      0xdb,0x1,0x0                                                                                    
002468   d7e6     BRA       0x2436                                                                                          
002446   0e02     MOVLW     0x2            						tempvar0 += TxBuffer[tempvar1];                                            C:\fw\midicontroller\x009\rs232.c
002448   50db     MOVF      0xdb,0x0,0x0                                                                                    
00244a   6aea     CLRF      0xea,0x0                                                                                        
00244c   0fcb     ADDLW     0xcb                                                                                            
00244e   6ee9     MOVWF     0xe9,0x0                                                                                        
002450   0e00     MOVLW     0x0                                                                                             
002452   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002454   0e03     MOVLW     0x3                                                                                             
002456   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002458   ffe7                                                                                                               
00245a   50ef     MOVF      0xef,0x0,0x0                                                                                    
00245c   26e7     ADDWF     0xe7,0x1,0x0                                                                                    
00245e   0e03     MOVLW     0x3                                                                                             
002460   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002462   ffdb                                                                                                               
                                           					}                                                                           C:\fw\midicontroller\x009\rs232.c
00246a   0e03     MOVLW     0x3            					TXENQ(tempvar0);			//enqueue checksum as final byte to send out.            C:\fw\midicontroller\x009\rs232.c
00246c   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00246e   ffe6                                                                                                               
002470   d813     RCALL     0x2498                                                                                          
002472   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002474   d007     BRA       0x2484         					return;		//and exit                                                         C:\fw\midicontroller\x009\rs232.c
                                           				}                                                                            C:\fw\midicontroller\x009\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x009\rs232.c
                                           		//If the type of command received is neither a poll nor set command,           C:\fw\midicontroller\x009\rs232.c
                                           		//or we dont recognize the reportID, cancel the command because it             C:\fw\midicontroller\x009\rs232.c
                                           		//is not recognized.                                                           C:\fw\midicontroller\x009\rs232.c
002476   0100     MOVLB     0x0            		TildeFlg = false;					//reset colon-received flag.                             C:\fw\midicontroller\x009\rs232.c
002478   9366     BCF       0x66,0x1,0x1                                                                                    
00247a   0100     MOVLB     0x0            		RxBufPtr = 0;						//Reset buffer.                                             C:\fw\midicontroller\x009\rs232.c
00247c   6bd4     CLRF      0xd4,0x1                                                                                        
00247e   0100     MOVLB     0x0            		CmdLength = 0;                                                                 C:\fw\midicontroller\x009\rs232.c
002480   6bd7     CLRF      0xd7,0x1                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
002482   d000     BRA       0x2484         	return;                                                                         C:\fw\midicontroller\x009\rs232.c
002484   0e11     MOVLW     0x11           }                                                                                C:\fw\midicontroller\x009\rs232.c
002486   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002488   e202     BC        0x248e                                                                                          
00248a   6ae1     CLRF      0xe1,0x0                                                                                        
00248c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00248e   6ee1     MOVWF     0xe1,0x0                                                                                        
002490   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002492   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002494   ffd9                                                                                                               
002496   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\rs232.c
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x009\rs232.c
                                           //This routine will store a character into the TxBuffer.                         C:\fw\midicontroller\x009\rs232.c
002498   cfd9     MOVFF     0xfd9,0xfe6    void	TXENQ(unsigned char Input) {                                                C:\fw\midicontroller\x009\rs232.c
00249a   ffe6                                                                                                               
00249c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00249e   ffd9                                                                                                               
0024a0   0100     MOVLB     0x0            	if (!USBQuery) {                                                                C:\fw\midicontroller\x009\rs232.c
0024a2   b966     BTFSC     0x66,0x4,0x1                                                                                    
0024a4   d010     BRA       0x24c6                                                                                          
                                           		//RS232 Query                                                                  C:\fw\midicontroller\x009\rs232.c
0024a6   0e09     MOVLW     0x9            		if (TxBufPtr >= MAX_TX_LENGTH) return;		//Exit if buffer full.                 C:\fw\midicontroller\x009\rs232.c
0024a8   0100     MOVLB     0x0                                                                                             
0024aa   5dd5     SUBWF     0xd5,0x0,0x1                                                                                    
0024ac   e301     BNC       0x24b0                                                                                          
0024ae   d01a     BRA       0x24e4                                                                                          
0024b0   51d5     MOVF      0xd5,0x0,0x1   		TxBuffer[TxBufPtr] = Input;	//Store value in buffer.                           C:\fw\midicontroller\x009\rs232.c
0024b2   6aea     CLRF      0xea,0x0                                                                                        
0024b4   0fcb     ADDLW     0xcb                                                                                            
0024b6   6ee9     MOVWF     0xe9,0x0                                                                                        
0024b8   0e00     MOVLW     0x0                                                                                             
0024ba   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0024bc   0efe     MOVLW     0xfe                                                                                            
0024be   cfdb     MOVFF     0xfdb,0xfef                                                                                     
0024c0   ffef                                                                                                               
0024c2   2bd5     INCF      0xd5,0x1,0x1   		TxBufPtr++;					//Update input ptr.                                            C:\fw\midicontroller\x009\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
0024c4   d00f     BRA       0x24e4         	else {                                                                          C:\fw\midicontroller\x009\rs232.c
                                           		//USB Query                                                                    C:\fw\midicontroller\x009\rs232.c
0024c6   0e40     MOVLW     0x40           		if (USBDataPointer >= 64) return;		//Exit if buffer full.                      C:\fw\midicontroller\x009\rs232.c
0024c8   0100     MOVLB     0x0                                                                                             
0024ca   5db9     SUBWF     0xb9,0x0,0x1                                                                                    
0024cc   e301     BNC       0x24d0                                                                                          
0024ce   d00a     BRA       0x24e4                                                                                          
0024d0   51b9     MOVF      0xb9,0x0,0x1   		CtrlTrfData._byte[USBDataPointer] = Input;                                     C:\fw\midicontroller\x009\rs232.c
0024d2   6aea     CLRF      0xea,0x0                                                                                        
0024d4   0f18     ADDLW     0x18                                                                                            
0024d6   6ee9     MOVWF     0xe9,0x0                                                                                        
0024d8   0e04     MOVLW     0x4                                                                                             
0024da   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0024dc   0efe     MOVLW     0xfe                                                                                            
0024de   cfdb     MOVFF     0xfdb,0xfef                                                                                     
0024e0   ffef                                                                                                               
0024e2   2bb9     INCF      0xb9,0x1,0x1   		USBDataPointer++;                                                              C:\fw\midicontroller\x009\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x009\rs232.c
0024e4   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\rs232.c
0024e6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024e8   ffd9                                                                                                               
0024ea   0012     RETURN    0x0                                                                                             
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x009\rs232.c
                                           //Reset TX Buffer.                                                               C:\fw\midicontroller\x009\rs232.c
                                           void	RTXB(void) {                                                                C:\fw\midicontroller\x009\rs232.c
0024ec   0100     MOVLB     0x0            	TxBufPtr = 0;		//Point to buffer start.                                         C:\fw\midicontroller\x009\rs232.c
0024ee   6bd5     CLRF      0xd5,0x1                                                                                        
0024f0   0100     MOVLB     0x0            	TxBufOutPtr = 0;		//Point to buffer start.                                      C:\fw\midicontroller\x009\rs232.c
0024f2   6bd6     CLRF      0xd6,0x1                                                                                        
0024f4   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\rs232.c
                                           /*********************************************************************           C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            *             Microchip USB C18 Firmware -  HID Version 1.0                     C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            *********************************************************************           C:\fw\midicontroller\x009\hid.c
                                            * FileName:        hid.c                                                        C:\fw\midicontroller\x009\hid.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x009\hid.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x009\hid.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x009\hid.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x009\hid.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x009\hid.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x009\hid.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x009\hid.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x009\hid.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x009\hid.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x009\hid.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x009\hid.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x009\hid.c
                                            * license.                                                                      C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x009\hid.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x009\hid.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x009\hid.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x009\hid.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x009\hid.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Author               Date        Comment                                      C:\fw\midicontroller\x009\hid.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\fw\midicontroller\x009\hid.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\fw\midicontroller\x009\hid.c
                                            ********************************************************************/           C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x009\hid.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x009\hid.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\hid.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\hid.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           #ifdef USB_USE_HID                                                               C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x009\hid.c
                                           void HIDGetReportHandler(void);                                                  C:\fw\midicontroller\x009\hid.c
                                           void HIDSetReportHandler(void);                                                  C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x009\hid.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x009\hid.c
                                           byte idle_rate;                                                                  C:\fw\midicontroller\x009\hid.c
                                           byte active_protocol;               // [0] Boot Protocol [1] Report Protocol     C:\fw\midicontroller\x009\hid.c
                                           byte hid_rpt_rx_len;                                                             C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x009\hid.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  C:\fw\midicontroller\x009\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\hid.c
                                            * Function:        void USBCheckHIDRequest(void)                                C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\fw\midicontroller\x009\hid.c
                                            *                  knows how to handle it                                       C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\hid.c
                                           void USBCheckHIDRequest(void)                                                    C:\fw\midicontroller\x009\hid.c
                                           {                                                                                C:\fw\midicontroller\x009\hid.c
003360   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  C:\fw\midicontroller\x009\hid.c
003362   5110     MOVF      0x10,0x0,0x1                                                                                    
003364   0b1f     ANDLW     0x1f                                                                                            
003366   0801     SUBLW     0x1                                                                                             
003368   e001     BZ        0x336c                                                                                          
00336a   d086     BRA       0x3478                                                                                          
00336c   5114     MOVF      0x14,0x0,0x1       if(SetupPkt.bIntfID != HID_INTF_ID) return;                                  C:\fw\midicontroller\x009\hid.c
00336e   e001     BZ        0x3372                                                                                          
003370   d083     BRA       0x3478                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                               /*                                                                           C:\fw\midicontroller\x009\hid.c
                                                * There are two standard requests that hid.c may support.                   C:\fw\midicontroller\x009\hid.c
                                                * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\fw\midicontroller\x009\hid.c
                                                * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\fw\midicontroller\x009\hid.c
                                                */                                                                          C:\fw\midicontroller\x009\hid.c
003372   0e06     MOVLW     0x6                if(SetupPkt.bRequest == GET_DSC)                                             C:\fw\midicontroller\x009\hid.c
003374   5d11     SUBWF     0x11,0x0,0x1                                                                                    
003376   e12e     BNZ       0x33d4                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\hid.c
003378   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\fw\midicontroller\x009\hid.c
00337a   0a23     XORLW     0x23                                                                                            
00337c   e028     BZ        0x33ce                                                                                          
00337e   0a01     XORLW     0x1                                                                                             
003380   e013     BZ        0x33a8                                                                                          
003382   0a03     XORLW     0x3                                                                                             
003384   e001     BZ        0x3388                                                                                          
003386   d024     BRA       0x33d0                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x009\hid.c
                                                       case DSC_HID:                                                        C:\fw\midicontroller\x009\hid.c
003388   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               C:\fw\midicontroller\x009\hid.c
00338a   0e02     MOVLW     0x2                                                                                             
00338c   6f27     MOVWF     0x27,0x1                                                                                        
00338e   0101     MOVLB     0x1                            mUSBGetHIDDscAdr(pSrc.bRom);        // See usbcfg.h              C:\fw\midicontroller\x009\hid.c
003390   0524     DECF      0x24,0x0,0x1                                                                                    
003392   e105     BNZ       0x339e                                                                                          
003394   0101     MOVLB     0x1                                                                                             
003396   0ebe     MOVLW     0xbe                                                                                            
003398   6f28     MOVWF     0x28,0x1                                                                                        
00339a   0e35     MOVLW     0x35                                                                                            
00339c   6f29     MOVWF     0x29,0x1                                                                                        
00339e   0e09     MOVLW     0x9                            wCount._word = sizeof(USB_HID_DSC);                              C:\fw\midicontroller\x009\hid.c
0033a0   0101     MOVLB     0x1                                                                                             
0033a2   6f2c     MOVWF     0x2c,0x1                                                                                        
0033a4   6b2d     CLRF      0x2d,0x1                                                                                        
0033a6   d014     BRA       0x33d0                         break;                                                           C:\fw\midicontroller\x009\hid.c
                                                       case DSC_RPT:                                                        C:\fw\midicontroller\x009\hid.c
0033a8   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               C:\fw\midicontroller\x009\hid.c
0033aa   0e02     MOVLW     0x2                                                                                             
0033ac   6f27     MOVWF     0x27,0x1                                                                                        
0033ae   0101     MOVLB     0x1                            mUSBGetHIDRptDscAdr(pSrc.bRom);     // See usbcfg.h              C:\fw\midicontroller\x009\hid.c
0033b0   0524     DECF      0x24,0x0,0x1                                                                                    
0033b2   e105     BNZ       0x33be                                                                                          
0033b4   0101     MOVLB     0x1                                                                                             
0033b6   0e42     MOVLW     0x42                                                                                            
0033b8   6f28     MOVWF     0x28,0x1                                                                                        
0033ba   0e36     MOVLW     0x36                                                                                            
0033bc   6f29     MOVWF     0x29,0x1                                                                                        
0033be   0101     MOVLB     0x1                            mUSBGetHIDRptDscSize(wCount._word); // See usbcfg.h              C:\fw\midicontroller\x009\hid.c
0033c0   0524     DECF      0x24,0x0,0x1                                                                                    
0033c2   e104     BNZ       0x33cc                                                                                          
0033c4   0e65     MOVLW     0x65                                                                                            
0033c6   0101     MOVLB     0x1                                                                                             
0033c8   6f2c     MOVWF     0x2c,0x1                                                                                        
0033ca   6b2d     CLRF      0x2d,0x1                                                                                        
0033cc   d001     BRA       0x33d0                         break;                                                           C:\fw\midicontroller\x009\hid.c
                                                       case DSC_PHY:                                                        C:\fw\midicontroller\x009\hid.c
                                                           // ctrl_trf_session_owner = MUID_HID;                            C:\fw\midicontroller\x009\hid.c
0033ce   d000     BRA       0x33d0                         break;                                                           C:\fw\midicontroller\x009\hid.c
                                                   }//end switch(SetupPkt.bDscType)                                         C:\fw\midicontroller\x009\hid.c
0033d0   0101     MOVLB     0x1                    usb_stat.ctrl_trf_mem = _ROM;                                            C:\fw\midicontroller\x009\hid.c
0033d2   8323     BSF       0x23,0x1,0x1                                                                                    
                                               }//end if(SetupPkt.bRequest == GET_DSC)                                      C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
0033d4   0104     MOVLB     0x4                if(SetupPkt.RequestType != CLASS) return;                                    C:\fw\midicontroller\x009\hid.c
0033d6   5110     MOVF      0x10,0x0,0x1                                                                                    
0033d8   0b60     ANDLW     0x60                                                                                            
0033da   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0033dc   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0033de   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0033e0   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0033e2   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0033e4   0801     SUBLW     0x1                                                                                             
0033e6   e001     BZ        0x33ea                                                                                          
0033e8   d047     BRA       0x3478                                                                                          
0033ea   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\fw\midicontroller\x009\hid.c
0033ec   0a0b     XORLW     0xb                                                                                             
0033ee   e03e     BZ        0x346c                                                                                          
0033f0   0a08     XORLW     0x8                                                                                             
0033f2   e02e     BZ        0x3450                                                                                          
0033f4   0a09     XORLW     0x9                                                                                             
0033f6   e026     BZ        0x3444                                                                                          
0033f8   0a08     XORLW     0x8                                                                                             
0033fa   e016     BZ        0x3428                                                                                          
0033fc   0a0b     XORLW     0xb                                                                                             
0033fe   e006     BZ        0x340c                                                                                          
003400   0a08     XORLW     0x8                                                                                             
003402   e001     BZ        0x3406                                                                                          
003404   d039     BRA       0x3478                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\hid.c
                                                   case GET_REPORT:                                                         C:\fw\midicontroller\x009\hid.c
003406   ec76     CALL      0x38ec,0x0                 HIDGetReportHandler();                                               C:\fw\midicontroller\x009\hid.c
003408   f01c                                                                                                               
00340a   d036     BRA       0x3478                     break;                                                               C:\fw\midicontroller\x009\hid.c
                                                   case SET_REPORT:                                                         C:\fw\midicontroller\x009\hid.c
                                           //            HIDSetReportHandler();      //2/8/05 JD this was not at the right location. C:\fw\midicontroller\x009\hid.c
00340c   0101     MOVLB     0x1            			pDst.bRam = (byte*)&USBEP0DataInBuffer;	//Set destination for report data.    C:\fw\midicontroller\x009\hid.c
00340e   0eba     MOVLW     0xba                                                                                            
003410   6f2a     MOVWF     0x2a,0x1                                                                                        
003412   0e00     MOVLW     0x0                                                                                             
003414   6f2b     MOVWF     0x2b,0x1                                                                                        
003416   0101     MOVLB     0x1            			usb_stat.ctrl_trf_mem = _RAM;		//Set memory type                              C:\fw\midicontroller\x009\hid.c
003418   9323     BCF       0x23,0x1,0x1                                                                                    
00341a   0101     MOVLB     0x1            			wCount._word = 0;					//reset counter                                         C:\fw\midicontroller\x009\hid.c
00341c   6b2c     CLRF      0x2c,0x1                                                                                        
00341e   6b2d     CLRF      0x2d,0x1                                                                                        
003420   0101     MOVLB     0x1            			ctrl_trf_session_owner = MUID_HID;  //set owner to HID, service this when we have some data..	 C:\fw\midicontroller\x009\hid.c
003422   0e02     MOVLW     0x2                                                                                             
003424   6f27     MOVWF     0x27,0x1                                                                                        
003426   d028     BRA       0x3478                     break;                                                               C:\fw\midicontroller\x009\hid.c
                                                   case GET_IDLE:                                                           C:\fw\midicontroller\x009\hid.c
003428   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x009\hid.c
00342a   0e02     MOVLW     0x2                                                                                             
00342c   6f27     MOVWF     0x27,0x1                                                                                        
00342e   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&idle_rate;      // Set source                    C:\fw\midicontroller\x009\hid.c
003430   0e30     MOVLW     0x30                                                                                            
003432   6f28     MOVWF     0x28,0x1                                                                                        
003434   0e01     MOVLW     0x1                                                                                             
003436   6f29     MOVWF     0x29,0x1                                                                                        
003438   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\fw\midicontroller\x009\hid.c
00343a   9323     BCF       0x23,0x1,0x1                                                                                    
00343c   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                C:\fw\midicontroller\x009\hid.c
00343e   0e01     MOVLW     0x1                                                                                             
003440   6f2c     MOVWF     0x2c,0x1                                                                                        
003442   d01a     BRA       0x3478                     break;                                                               C:\fw\midicontroller\x009\hid.c
                                                   case SET_IDLE:                                                           C:\fw\midicontroller\x009\hid.c
003444   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x009\hid.c
003446   0e02     MOVLW     0x2                                                                                             
003448   6f27     MOVWF     0x27,0x1                                                                                        
00344a   c413     MOVFF     0x413,0x130                idle_rate = MSB(SetupPkt.W_Value);                                   C:\fw\midicontroller\x009\hid.c
00344c   f130                                                                                                               
00344e   d014     BRA       0x3478                     break;                                                               C:\fw\midicontroller\x009\hid.c
                                                   case GET_PROTOCOL:                                                       C:\fw\midicontroller\x009\hid.c
003450   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x009\hid.c
003452   0e02     MOVLW     0x2                                                                                             
003454   6f27     MOVWF     0x27,0x1                                                                                        
003456   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&active_protocol;// Set source                    C:\fw\midicontroller\x009\hid.c
003458   0e31     MOVLW     0x31                                                                                            
00345a   6f28     MOVWF     0x28,0x1                                                                                        
00345c   0e01     MOVLW     0x1                                                                                             
00345e   6f29     MOVWF     0x29,0x1                                                                                        
003460   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\fw\midicontroller\x009\hid.c
003462   9323     BCF       0x23,0x1,0x1                                                                                    
003464   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                C:\fw\midicontroller\x009\hid.c
003466   0e01     MOVLW     0x1                                                                                             
003468   6f2c     MOVWF     0x2c,0x1                                                                                        
00346a   d006     BRA       0x3478                     break;                                                               C:\fw\midicontroller\x009\hid.c
                                                   case SET_PROTOCOL:                                                       C:\fw\midicontroller\x009\hid.c
00346c   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x009\hid.c
00346e   0e02     MOVLW     0x2                                                                                             
003470   6f27     MOVWF     0x27,0x1                                                                                        
003472   c412     MOVFF     0x412,0x131                active_protocol = LSB(SetupPkt.W_Value);                             C:\fw\midicontroller\x009\hid.c
003474   f131                                                                                                               
003476   d000     BRA       0x3478                     break;                                                               C:\fw\midicontroller\x009\hid.c
                                               }//end switch(SetupPkt.bRequest)                                             C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
003478   0012     RETURN    0x0            }//end USBCheckHIDRequest                                                        C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** U S E R  A P I ***********************************************************/  C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\hid.c
                                            * Function:        void HIDInitEP(void)                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Input:           None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Overview:        HIDInitEP initializes HID endpoints, buffer descriptors,     C:\fw\midicontroller\x009\hid.c
                                            *                  internal state-machine, and variables.                       C:\fw\midicontroller\x009\hid.c
                                            *                  It should be called after the USB host has sent out a        C:\fw\midicontroller\x009\hid.c
                                            *                  SET_CONFIGURATION request.                                   C:\fw\midicontroller\x009\hid.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\hid.c
                                           void HIDInitEP(void)                                                             C:\fw\midicontroller\x009\hid.c
                                           {                                                                                C:\fw\midicontroller\x009\hid.c
00347a   0101     MOVLB     0x1                hid_rpt_rx_len =0;                                                           C:\fw\midicontroller\x009\hid.c
00347c   6b32     CLRF      0x32,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hid.c
00347e   0e1e     MOVLW     0x1e               HID_UEP = EP_OUT_IN|HSHK_EN;                // Enable 2 data pipes           C:\fw\midicontroller\x009\hid.c
003480   6e71     MOVWF     0x71,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hid.c
003482   0104     MOVLB     0x4                HID_BD_OUT.Cnt = sizeof(hid_report_out);    // Set buffer size               C:\fw\midicontroller\x009\hid.c
003484   0e08     MOVLW     0x8                                                                                             
003486   6f09     MOVWF     0x9,0x1                                                                                         
003488   0e58     MOVLW     0x58               HID_BD_OUT.ADR = (byte*)&hid_report_out;    // Set buffer address            C:\fw\midicontroller\x009\hid.c
00348a   6f0a     MOVWF     0xa,0x1                                                                                         
00348c   0e04     MOVLW     0x4                                                                                             
00348e   6f0b     MOVWF     0xb,0x1                                                                                         
003490   0e88     MOVLW     0x88               HID_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN; // Set status                    C:\fw\midicontroller\x009\hid.c
003492   6f08     MOVWF     0x8,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                               /*                                                                           C:\fw\midicontroller\x009\hid.c
                                                * Do not have to init Cnt of IN pipes here.                                 C:\fw\midicontroller\x009\hid.c
                                                * Reason:  Number of bytes to send to the host                              C:\fw\midicontroller\x009\hid.c
                                                *          varies from one transaction to                                   C:\fw\midicontroller\x009\hid.c
                                                *          another. Cnt should equal the exact                              C:\fw\midicontroller\x009\hid.c
                                                *          number of bytes to transmit for                                  C:\fw\midicontroller\x009\hid.c
                                                *          a given IN transaction.                                          C:\fw\midicontroller\x009\hid.c
                                                *          This number of bytes will only                                   C:\fw\midicontroller\x009\hid.c
                                                *          be known right before the data is                                C:\fw\midicontroller\x009\hid.c
                                                *          sent.                                                            C:\fw\midicontroller\x009\hid.c
                                                */                                                                          C:\fw\midicontroller\x009\hid.c
003494   0104     MOVLB     0x4                HID_BD_IN.ADR = (byte*)&hid_report_in;      // Set buffer address            C:\fw\midicontroller\x009\hid.c
003496   0e60     MOVLW     0x60                                                                                            
003498   6f0e     MOVWF     0xe,0x1                                                                                         
00349a   0e04     MOVLW     0x4                                                                                             
00349c   6f0f     MOVWF     0xf,0x1                                                                                         
00349e   0e40     MOVLW     0x40               HID_BD_IN.Stat._byte = _UCPU|_DAT1;         // Set status                    C:\fw\midicontroller\x009\hid.c
0034a0   6f0c     MOVWF     0xc,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x009\hid.c
0034a2   0012     RETURN    0x0            }//end HIDInitEP                                                                 C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\hid.c
                                            * Function:        void HIDTxReport(char *buffer, byte len)                     C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * PreCondition:    mHIDTxIsBusy() must return false.                            C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            *                  Value of 'len' must be equal to or smaller than              C:\fw\midicontroller\x009\hid.c
                                            *                  HID_INT_IN_EP_SIZE                                           C:\fw\midicontroller\x009\hid.c
                                            *                  For an interrupt endpoint, the largest buffer size is        C:\fw\midicontroller\x009\hid.c
                                            *                  64 bytes.                                                    C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Input:           buffer  : Pointer to the starting location of data bytes     C:\fw\midicontroller\x009\hid.c
                                            *                  len     : Number of bytes to be transferred                  C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Overview:        Use this macro to transfer data located in data memory.      C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            *                  Remember: mHIDTxIsBusy() must return false before user       C:\fw\midicontroller\x009\hid.c
                                            *                  can call this function.                                      C:\fw\midicontroller\x009\hid.c
                                            *                  Unexpected behavior will occur if this function is called    C:\fw\midicontroller\x009\hid.c
                                            *                  when mHIDTxIsBusy() == 0                                     C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            *                  Typical Usage:                                               C:\fw\midicontroller\x009\hid.c
                                            *                  if(!mHIDTxIsBusy())                                          C:\fw\midicontroller\x009\hid.c
                                            *                      HIDTxReport(buffer, 3);                                  C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x009\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\hid.c
0034a4   cfd9     MOVFF     0xfd9,0xfe6    void HIDTxReport(char *buffer, byte len)                                         C:\fw\midicontroller\x009\hid.c
0034a6   ffe6                                                                                                               
0034a8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0034aa   ffd9                                                                                                               
0034ac   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x009\hid.c
                                           	byte i;                                                                         C:\fw\midicontroller\x009\hid.c
                                           	                                                                                C:\fw\midicontroller\x009\hid.c
                                               /*                                                                           C:\fw\midicontroller\x009\hid.c
                                                * Value of len should be equal to or smaller than HID_INT_IN_EP_SIZE.       C:\fw\midicontroller\x009\hid.c
                                                * This check forces the value of len to meet the precondition.              C:\fw\midicontroller\x009\hid.c
                                                */                                                                          C:\fw\midicontroller\x009\hid.c
0034ae   0efc     MOVLW     0xfc           	if(len > HID_INT_IN_EP_SIZE)                                                    C:\fw\midicontroller\x009\hid.c
0034b0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0034b2   0808     SUBLW     0x8                                                                                             
0034b4   e205     BC        0x34c0                                                                                          
0034b6   0e08     MOVLW     0x8            	    len = HID_INT_IN_EP_SIZE;                                                   C:\fw\midicontroller\x009\hid.c
0034b8   6ef3     MOVWF     0xf3,0x0                                                                                        
0034ba   0efc     MOVLW     0xfc                                                                                            
0034bc   cff3     MOVFF     0xff3,0xfdb                                                                                     
0034be   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                              /*                                                                            C:\fw\midicontroller\x009\hid.c
                                               * Copy data from user's buffer to dual-ram buffer                            C:\fw\midicontroller\x009\hid.c
                                               */                                                                           C:\fw\midicontroller\x009\hid.c
0034c0   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    C:\fw\midicontroller\x009\hid.c
0034c2   0efc     MOVLW     0xfc                                                                                            
0034c4   50db     MOVF      0xdb,0x0,0x0                                                                                    
0034c6   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
0034c8   e219     BC        0x34fc                                                                                          
0034f8   2adf     INCF      0xdf,0x1,0x0                                                                                    
0034fa   d7e3     BRA       0x34c2                                                                                          
0034ca   50df     MOVF      0xdf,0x0,0x0       	hid_report_in[i] = buffer[i];                                               C:\fw\midicontroller\x009\hid.c
0034cc   6ee7     MOVWF     0xe7,0x0                                                                                        
0034ce   0efd     MOVLW     0xfd                                                                                            
0034d0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0034d2   ffe9                                                                                                               
0034d4   0efe     MOVLW     0xfe                                                                                            
0034d6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0034d8   ffea                                                                                                               
0034da   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0034dc   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0034de   0e00     MOVLW     0x0                                                                                             
0034e0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0034e2   50ef     MOVF      0xef,0x0,0x0                                                                                    
0034e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0034e6   50df     MOVF      0xdf,0x0,0x0                                                                                    
0034e8   6aea     CLRF      0xea,0x0                                                                                        
0034ea   0f60     ADDLW     0x60                                                                                            
0034ec   6ee9     MOVWF     0xe9,0x0                                                                                        
0034ee   0e04     MOVLW     0x4                                                                                             
0034f0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0034f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0034f4   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0034f6   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hid.c
0034fc   0efc     MOVLW     0xfc               HID_BD_IN.Cnt = len;                                                         C:\fw\midicontroller\x009\hid.c
0034fe   cfdb     MOVFF     0xfdb,0x40d                                                                                     
003500   f40d                                                                                                               
003502   0e40     MOVLW     0x40               mUSBBufferReady(HID_BD_IN);                                                  C:\fw\midicontroller\x009\hid.c
003504   0104     MOVLB     0x4                                                                                             
003506   170c     ANDWF     0xc,0x1,0x1                                                                                     
003508   7d0c     BTG       0xc,0x6,0x1                                                                                     
00350a   0e88     MOVLW     0x88                                                                                            
00350c   130c     IORWF     0xc,0x1,0x1                                                                                     
                                                                                                                            C:\fw\midicontroller\x009\hid.c
00350e   52e5     MOVF      0xe5,0x1,0x0   }//end HIDTxReport                                                               C:\fw\midicontroller\x009\hid.c
003510   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003512   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003514   ffd9                                                                                                               
003516   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x009\hid.c
                                            * Function:        byte HIDRxReport(char *buffer, byte len)                     C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     C:\fw\midicontroller\x009\hid.c
                                            *                  maximum endpoint size responsible for receiving report       C:\fw\midicontroller\x009\hid.c
                                            *                  data from USB host for HID class.                            C:\fw\midicontroller\x009\hid.c
                                            *                  Input argument 'buffer' should point to a buffer area that   C:\fw\midicontroller\x009\hid.c
                                            *                  is bigger or equal to the size specified by 'len'.           C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   C:\fw\midicontroller\x009\hid.c
                                            *                  len     : The number of bytes expected.                      C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Output:          The number of bytes copied to buffer.                        C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Side Effects:    Publicly accessible variable hid_rpt_rx_len is updated       C:\fw\midicontroller\x009\hid.c
                                            *                  with the number of bytes copied to buffer.                   C:\fw\midicontroller\x009\hid.c
                                            *                  Once HIDRxReport is called, subsequent retrieval of          C:\fw\midicontroller\x009\hid.c
                                            *                  hid_rpt_rx_len can be done by calling macro                  C:\fw\midicontroller\x009\hid.c
                                            *                  mHIDGetRptRxLength().                                        C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Overview:        HIDRxReport copies a string of bytes received through        C:\fw\midicontroller\x009\hid.c
                                            *                  USB HID OUT endpoint to a user's specified location.         C:\fw\midicontroller\x009\hid.c
                                            *                  It is a non-blocking function. It does not wait              C:\fw\midicontroller\x009\hid.c
                                            *                  for data if there is no data available. Instead it returns   C:\fw\midicontroller\x009\hid.c
                                            *                  '0' to notify the caller that there is no data available.    C:\fw\midicontroller\x009\hid.c
                                            *                                                                               C:\fw\midicontroller\x009\hid.c
                                            * Note:            If the actual number of bytes received is larger than the    C:\fw\midicontroller\x009\hid.c
                                            *                  number of bytes expected (len), only the expected number     C:\fw\midicontroller\x009\hid.c
                                            *                  of bytes specified will be copied to buffer.                 C:\fw\midicontroller\x009\hid.c
                                            *                  If the actual number of bytes received is smaller than the   C:\fw\midicontroller\x009\hid.c
                                            *                  number of bytes expected (len), only the actual number       C:\fw\midicontroller\x009\hid.c
                                            *                  of bytes received will be copied to buffer.                  C:\fw\midicontroller\x009\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x009\hid.c
003518   cfd9     MOVFF     0xfd9,0xfe6    byte HIDRxReport(char *buffer, byte len)                                         C:\fw\midicontroller\x009\hid.c
00351a   ffe6                                                                                                               
00351c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00351e   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x009\hid.c
003520   0101     MOVLB     0x1                hid_rpt_rx_len = 0;                                                          C:\fw\midicontroller\x009\hid.c
003522   6b32     CLRF      0x32,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hid.c
003524   0104     MOVLB     0x4                if(!mHIDRxIsBusy())                                                          C:\fw\midicontroller\x009\hid.c
003526   bf08     BTFSC     0x8,0x7,0x1                                                                                     
003528   d031     BRA       0x358c                                                                                          
                                               {                                                                            C:\fw\midicontroller\x009\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x009\hid.c
                                                    * Adjust the expected number of bytes to equal                          C:\fw\midicontroller\x009\hid.c
                                                    * the actual number of bytes received.                                  C:\fw\midicontroller\x009\hid.c
                                                    */                                                                      C:\fw\midicontroller\x009\hid.c
00352a   0efc     MOVLW     0xfc                   if(len > HID_BD_OUT.Cnt)                                                 C:\fw\midicontroller\x009\hid.c
00352c   cfdb     MOVFF     0xfdb,0x10                                                                                      
00352e   f010                                                                                                               
003530   5109     MOVF      0x9,0x0,0x1                                                                                     
003532   80d8     BSF       0xd8,0x0,0x0                                                                                    
003534   5410     SUBFWB    0x10,0x0,0x0                                                                                    
003536   e203     BC        0x353e                                                                                          
003538   0efc     MOVLW     0xfc                       len = HID_BD_OUT.Cnt;                                                C:\fw\midicontroller\x009\hid.c
00353a   c409     MOVFF     0x409,0xfdb                                                                                     
00353c   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x009\hid.c
                                                    * Copy data from dual-ram buffer to user's buffer                       C:\fw\midicontroller\x009\hid.c
                                                    */                                                                      C:\fw\midicontroller\x009\hid.c
00353e   0101     MOVLB     0x1                    for(hid_rpt_rx_len = 0; hid_rpt_rx_len < len; hid_rpt_rx_len++)          C:\fw\midicontroller\x009\hid.c
003540   6b32     CLRF      0x32,0x1                                                                                        
003542   0efc     MOVLW     0xfc                                                                                            
003544   50db     MOVF      0xdb,0x0,0x0                                                                                    
003546   5d32     SUBWF     0x32,0x0,0x1                                                                                    
003548   e219     BC        0x357c                                                                                          
003578   2b32     INCF      0x32,0x1,0x1                                                                                    
00357a   d7e3     BRA       0x3542                                                                                          
00354a   5132     MOVF      0x32,0x0,0x1               buffer[hid_rpt_rx_len] = hid_report_out[hid_rpt_rx_len];             C:\fw\midicontroller\x009\hid.c
00354c   6aea     CLRF      0xea,0x0                                                                                        
00354e   0f58     ADDLW     0x58                                                                                            
003550   6ee9     MOVWF     0xe9,0x0                                                                                        
003552   0e04     MOVLW     0x4                                                                                             
003554   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003556   50ef     MOVF      0xef,0x0,0x0                                                                                    
003558   6ee6     MOVWF     0xe6,0x0                                                                                        
00355a   5132     MOVF      0x32,0x0,0x1                                                                                    
00355c   6ee7     MOVWF     0xe7,0x0                                                                                        
00355e   0efd     MOVLW     0xfd                                                                                            
003560   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
003562   ffe9                                                                                                               
003564   0efe     MOVLW     0xfe                                                                                            
003566   cfdb     MOVFF     0xfdb,0xfea                                                                                     
003568   ffea                                                                                                               
00356a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00356c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00356e   0e00     MOVLW     0x0                                                                                             
003570   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003572   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003574   50e7     MOVF      0xe7,0x0,0x0                                                                                    
003576   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x009\hid.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      C:\fw\midicontroller\x009\hid.c
                                                    */                                                                      C:\fw\midicontroller\x009\hid.c
00357c   0104     MOVLB     0x4                    HID_BD_OUT.Cnt = sizeof(hid_report_out);                                 C:\fw\midicontroller\x009\hid.c
00357e   0e08     MOVLW     0x8                                                                                             
003580   6f09     MOVWF     0x9,0x1                                                                                         
003582   0e40     MOVLW     0x40                   mUSBBufferReady(HID_BD_OUT);                                             C:\fw\midicontroller\x009\hid.c
003584   1708     ANDWF     0x8,0x1,0x1                                                                                     
003586   7d08     BTG       0x8,0x6,0x1                                                                                     
003588   0e88     MOVLW     0x88                                                                                            
00358a   1308     IORWF     0x8,0x1,0x1                                                                                     
                                               }//end if                                                                    C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
00358c   0101     MOVLB     0x1                return hid_rpt_rx_len;                                                       C:\fw\midicontroller\x009\hid.c
00358e   5132     MOVF      0x32,0x0,0x1                                                                                    
003590   d000     BRA       0x3592                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hid.c
003592   52e5     MOVF      0xe5,0x1,0x0   }//end HIDRxReport                                                               C:\fw\midicontroller\x009\hid.c
003594   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003596   ffd9                                                                                                               
003598   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           #endif //def USB_USE_HID                                                         C:\fw\midicontroller\x009\hid.c
                                                                                                                            C:\fw\midicontroller\x009\hid.c
                                           /** EOF hid.c ***************************************************************/   C:\fw\midicontroller\x009\hid.c
                                           //This file contains the global ram definitions for the project                  C:\fw\midicontroller\x009\ram_def.c
                                           #include	"c_system.h"                                                            C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           //----------------------------Main variables---------------------------------------- C:\fw\midicontroller\x009\ram_def.c
                                           TwoBytes NVRCommAddr;                                                            C:\fw\midicontroller\x009\ram_def.c
                                           TwoBytes RAMCommAddr;                                                            C:\fw\midicontroller\x009\ram_def.c
                                           TwoBytes ROMCommAddr;                                                            C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           BitField	CommFlags1;                                                             C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char WpmCounter;                                                        C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char WpmCounter1;                                                       C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char ProgmemBuffer[64];                                                 C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           #pragma udata RamData                                                            C:\fw\midicontroller\x009\ram_def.c
                                           BitField ArbFlags1;                                                              C:\fw\midicontroller\x009\ram_def.c
                                           BitField MiscFlags1;                                                             C:\fw\midicontroller\x009\ram_def.c
                                           BitField DispSegData[5];                                                         C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char DispNumOfCommons;                                                  C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char LedStates;			//footswitch leds                                     C:\fw\midicontroller\x009\ram_def.c
                                           unsigned long	ButtonState;                                                       C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char ExpPedalInst;                                                      C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           TwoBytes ExpPedalAvg;                                                            C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           //----------------------------USB stuff----------------------------------        C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char USBDataPointer;                                                    C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char USBEP0DataInBuffer[8];                                             C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char RxBuffer[9];                                                       C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char TxBuffer[MAX_TX_LENGTH];                                           C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char RxBufPtr;                                                          C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char TxBufPtr;                                                          C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char TxBufOutPtr;                                                       C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char CmdLength;                                                         C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char StringPtr;                                                         C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char StringPtr_H;                                                       C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char StringChksum;                                                      C:\fw\midicontroller\x009\ram_def.c
                                           unsigned char ResponseType;                                                      C:\fw\midicontroller\x009\ram_def.c
                                                                                                                            C:\fw\midicontroller\x009\ram_def.c
                                           ;###########################################################################     C:\fw\midicontroller\x009\config.asm
                                           ;#			Author: Joe Dunne				  #                                                    C:\fw\midicontroller\x009\config.asm
                                           ;#			Date 4/06/07					  #                                                        C:\fw\midicontroller\x009\config.asm
                                           ;#			Main arbitrator					  #                                                     C:\fw\midicontroller\x009\config.asm
                                           ;#			File Name: config.asm  				  #                                              C:\fw\midicontroller\x009\config.asm
                                           ;#									  #                                                                   C:\fw\midicontroller\x009\config.asm
                                           ;############################################################################    C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           	ERRORLEVEL -208, -216                                                           C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           	LIST R=DEC                                                                      C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           	INCLUDE "a_MICRDEF.INC"                                                         C:\fw\midicontroller\x009\config.asm
                                                   LIST                                                                     C:\fw\midicontroller\x009\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x009\a_MICRDEF.INC
                                           ;==========================================================================      C:\fw\midicontroller\x009\a_MICRDEF.INC
                                           ;  $Id: P18F4550.INC,v 1.7 2004/10/06 13:56:45 curtiss Exp $                     C:\fw\midicontroller\x009\a_MICRDEF.INC
                                           ;  MPASM PIC18F4550 processor include                                            C:\fw\midicontroller\x009\a_MICRDEF.INC
                                           ;                                                                                C:\fw\midicontroller\x009\a_MICRDEF.INC
                                           ;  (c) Copyright 1999-2004 Microchip Technology, All rights reserved             C:\fw\midicontroller\x009\a_MICRDEF.INC
                                           ;==========================================================================      C:\fw\midicontroller\x009\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x009\a_MICRDEF.INC
                                                   LIST                                                                     C:\fw\midicontroller\x009\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           ;This section contains configuration bits for the processor                      C:\fw\midicontroller\x009\config.asm
                                           ;Don't change this unless you know what you're doing.                            C:\fw\midicontroller\x009\config.asm
                                           ;300000                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG USBDIV=2, CPUDIV=OSC2_PLL3, PLLDIV=2                                     C:\fw\midicontroller\x009\config.asm
                                           ;300001                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG FOSC=HSPLL_HS, FCMEN=OFF, IESO=OFF                                       C:\fw\midicontroller\x009\config.asm
                                           ;300002                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG VREGEN=ON, PWRT=ON, BOR=ON, BORV=2		;2 = 2.7V..                          C:\fw\midicontroller\x009\config.asm
                                           ;300003                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG WDT=OFF, WDTPS=128                                                       C:\fw\midicontroller\x009\config.asm
                                           ;300005                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG CCP2MX=ON, PBADEN=OFF, LPT1OSC=OFF, MCLRE=ON                             C:\fw\midicontroller\x009\config.asm
                                           ;300006                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG STVREN=ON, LVP=OFF, ICPRT=OFF, XINST=OFF, DEBUG=OFF                      C:\fw\midicontroller\x009\config.asm
                                           ;300008                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG CP0=OFF, CP1=OFF, CP2=OFF                                                C:\fw\midicontroller\x009\config.asm
                                           ;300009                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG CPB=OFF, CPD=OFF                                                         C:\fw\midicontroller\x009\config.asm
                                           ;30000A                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG WRT0=OFF, WRT1=OFF, WRT2=OFF                                             C:\fw\midicontroller\x009\config.asm
                                           ;30000B                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG WRTC=OFF, WRTB=OFF, WRTD=OFF                                             C:\fw\midicontroller\x009\config.asm
                                           ;30000C                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG EBTR0=OFF, EBTR1=OFF, EBTR2=OFF                                          C:\fw\midicontroller\x009\config.asm
                                           ;30000D                                                                          C:\fw\midicontroller\x009\config.asm
                                           	CONFIG EBTRB=OFF                                                                C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           	global	CLEAR_RAM                                                                C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           	code                                                                            C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           ;clear general purpose registers 0x000 through 0x7FF.                            C:\fw\midicontroller\x009\config.asm
                                           CLEAR_RAM                                                                        C:\fw\midicontroller\x009\config.asm
0037b8   6aea     CLRF      0xea,0x0       	clrf	FSR0H                                                                      C:\fw\midicontroller\x009\config.asm
0037ba   6ae9     CLRF      0xe9,0x0       	clrf	FSR0L                                                                      C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           RAMCLEAR                                                                         C:\fw\midicontroller\x009\config.asm
0037bc   0004     CLRWDT                   	CLRWDT                                                                          C:\fw\midicontroller\x009\config.asm
0037be   6aee     CLRF      0xee,0x0       	clrf	POSTINC0                                                                   C:\fw\midicontroller\x009\config.asm
0037c0   a6ea     BTFSS     0xea,0x3,0x0   	btfss	FSR0H, 3                                                                  C:\fw\midicontroller\x009\config.asm
0037c2   d7fc     BRA       0x37bc         	bra	RAMCLEAR                                                                    C:\fw\midicontroller\x009\config.asm
0037c4   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x009\config.asm
                                                                                                                            C:\fw\midicontroller\x009\config.asm
                                           	END                                                                             C:\fw\midicontroller\x009\config.asm
                                           //#######################################################################        C:\fw\midicontroller\x009\intslct.c
                                           /**                                                                              C:\fw\midicontroller\x009\intslct.c
                                           * @file intslct.c                                                                C:\fw\midicontroller\x009\intslct.c
                                           * interrupt handler                                                              C:\fw\midicontroller\x009\intslct.c
                                           *                                                                                C:\fw\midicontroller\x009\intslct.c
                                           * @author Joe Dunne                                                              C:\fw\midicontroller\x009\intslct.c
                                           * @date 2/02/05                                                                  C:\fw\midicontroller\x009\intslct.c
                                           * @brief RS232/USB communication routine                                         C:\fw\midicontroller\x009\intslct.c
                                           */                                                                               C:\fw\midicontroller\x009\intslct.c
                                           //			*See Updates section at bottom of file*                                     C:\fw\midicontroller\x009\intslct.c
                                           //#######################################################################        C:\fw\midicontroller\x009\intslct.c
                                                                                                                            C:\fw\midicontroller\x009\intslct.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\intslct.c
                                                                                                                            C:\fw\midicontroller\x009\intslct.c
                                           #pragma code InterruptVectorHigh = 0xA08                                         C:\fw\midicontroller\x009\intslct.c
                                           void                                                                             C:\fw\midicontroller\x009\intslct.c
                                           InterruptVectorHigh (void)                                                       C:\fw\midicontroller\x009\intslct.c
                                           {                                                                                C:\fw\midicontroller\x009\intslct.c
                                             _asm                                                                           C:\fw\midicontroller\x009\intslct.c
000a08   ef8a     GOTO      0x3914         	goto InterruptHandlerHigh //jump to interrupt routine                           C:\fw\midicontroller\x009\intslct.c
000a0a   f01c                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x009\intslct.c
000a0c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\intslct.c
                                                                                                                            C:\fw\midicontroller\x009\intslct.c
                                                                                                                            C:\fw\midicontroller\x009\intslct.c
                                           //----------------------------------------------------------------------------   C:\fw\midicontroller\x009\intslct.c
                                           // High priority interrupt routine                                               C:\fw\midicontroller\x009\intslct.c
                                                                                                                            C:\fw\midicontroller\x009\intslct.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\intslct.c
                                                                                                                            C:\fw\midicontroller\x009\intslct.c
                                           #pragma interruptlow InterruptHandlerHigh                                        C:\fw\midicontroller\x009\intslct.c
003914   cfd8     MOVFF     0xfd8,0xfe4    void	InterruptHandlerHigh ()                                                     C:\fw\midicontroller\x009\intslct.c
003916   ffe4                                                                                                               
003918   cfe0     MOVFF     0xfe0,0xfe4                                                                                     
00391a   ffe4                                                                                                               
00391c   6ee4     MOVWF     0xe4,0x0                                                                                        
00391e   cfda     MOVFF     0xfda,0xfe4                                                                                     
003920   ffe4                                                                                                               
003922   cfe2     MOVFF     0xfe2,0xfda                                                                                     
003924   ffda                                                                                                               
003926   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x009\intslct.c
003928   a4f2     BTFSS     0xf2,0x2,0x0     if (INTCONbits.TMR0IF)                                                         C:\fw\midicontroller\x009\intslct.c
00392a   d003     BRA       0x3932                                                                                          
                                               {                                   //check for TMR0 overflow                C:\fw\midicontroller\x009\intslct.c
00392c   94f2     BCF       0xf2,0x2,0x0         INTCONbits.TMR0IF = 0;            //clear interrupt flag                   C:\fw\midicontroller\x009\intslct.c
00392e   0100     MOVLB     0x0                  Systick = true;                                                            C:\fw\midicontroller\x009\intslct.c
003930   81a9     BSF       0xa9,0x0,0x1                                                                                    
                                               }                                                                            C:\fw\midicontroller\x009\intslct.c
003932   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\intslct.c
003934   cfe5     MOVFF     0xfe5,0xfda                                                                                     
003936   ffda                                                                                                               
003938   50e5     MOVF      0xe5,0x0,0x0                                                                                    
00393a   cfe5     MOVFF     0xfe5,0xfe0                                                                                     
00393c   ffe0                                                                                                               
00393e   cfe5     MOVFF     0xfe5,0xfd8                                                                                     
003940   ffd8                                                                                                               
003942   0010     RETFIE    0x0                                                                                             
                                           #pragma code                                                                     C:\fw\midicontroller\x009\intslct.c
                                           //----------------------------------------------------------------------------   C:\fw\midicontroller\x009\intslct.c
                                           //*;###########################################################################  C:\fw\midicontroller\x009\init.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\init.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x009\init.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x009\init.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x009\init.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\init.c
                                           //;############################################################################  C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\init.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           void init(void) {                                                                C:\fw\midicontroller\x009\init.c
003820   ecdc     CALL      0x37b8,0x0     	CLEAR_RAM();                                                                    C:\fw\midicontroller\x009\init.c
003822   f01b                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\init.c
003824   6a89     CLRF      0x89,0x0       	LATA = 0;                                                                       C:\fw\midicontroller\x009\init.c
003826   6a8a     CLRF      0x8a,0x0       	LATB = 0;                                                                       C:\fw\midicontroller\x009\init.c
003828   6a8b     CLRF      0x8b,0x0       	LATC = 0;                                                                       C:\fw\midicontroller\x009\init.c
00382a   6a8c     CLRF      0x8c,0x0       	LATD = 0;                                                                       C:\fw\midicontroller\x009\init.c
00382c   6a8d     CLRF      0x8d,0x0       	LATE = 0;                                                                       C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
00382e   0e01     MOVLW     0x1            	TRISA = INIT_TRISA;                                                             C:\fw\midicontroller\x009\init.c
003830   6e92     MOVWF     0x92,0x0                                                                                        
003832   0e10     MOVLW     0x10           	TRISB = INIT_TRISB;                                                             C:\fw\midicontroller\x009\init.c
003834   6e93     MOVWF     0x93,0x0                                                                                        
003836   0ef8     MOVLW     0xf8           	TRISC = INIT_TRISC;                                                             C:\fw\midicontroller\x009\init.c
003838   6e94     MOVWF     0x94,0x0                                                                                        
00383a   6a95     CLRF      0x95,0x0       	TRISD = INIT_TRISD;                                                             C:\fw\midicontroller\x009\init.c
00383c   0e02     MOVLW     0x2            	TRISE = INIT_TRISE;                                                             C:\fw\midicontroller\x009\init.c
00383e   6e96     MOVWF     0x96,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\init.c
003840   0100     MOVLB     0x0            	DispNumOfCommons = DISP_NUMBER_OF_COMMONS;                                      C:\fw\midicontroller\x009\init.c
003842   0e05     MOVLW     0x5                                                                                             
003844   6fb0     MOVWF     0xb0,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           //	TRISCbits.TRISC6 = false;                                                     C:\fw\midicontroller\x009\init.c
                                           //	RCSTA = 0x90;                                                                 C:\fw\midicontroller\x009\init.c
                                           //	TXSTA = 0xA2;		//0x46;                                                        C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           //	SPBRG = 204;                                                                  C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           #ifdef UARTISRS232                                                               C:\fw\midicontroller\x009\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          C:\fw\midicontroller\x009\init.c
                                           //Initialize the USART control registers                                         C:\fw\midicontroller\x009\init.c
                                           	TXSTA = 0xA6;			//master,8bit,async,high speed                                  C:\fw\midicontroller\x009\init.c
                                           	RCSTA = 0x90;			//enabled,8bit, continuous                                      C:\fw\midicontroller\x009\init.c
                                           //	BAUDCONbits.BRG16 = true;                                                     C:\fw\midicontroller\x009\init.c
                                           	SPBRG = 16;			//115200 baud                                                     C:\fw\midicontroller\x009\init.c
                                           	SPBRGH = 0x01;                                                                  C:\fw\midicontroller\x009\init.c
                                           #else                                                                            C:\fw\midicontroller\x009\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          C:\fw\midicontroller\x009\init.c
                                           //Initialize the USART control registers                                         C:\fw\midicontroller\x009\init.c
003846   0ee6     MOVLW     0xe6           	TXSTA = 0xE6;			//master,8bit,async, BRGH=1                                     C:\fw\midicontroller\x009\init.c
003848   6eac     MOVWF     0xac,0x0                                                                                        
00384a   0e90     MOVLW     0x90           	RCSTA = 0x90;			//enabled,8bit, continuous                                      C:\fw\midicontroller\x009\init.c
00384c   6eab     MOVWF     0xab,0x0                                                                                        
                                           //	BAUDCONbits.BRG16 = true;                                                     C:\fw\midicontroller\x009\init.c
00384e   0e3f     MOVLW     0x3f           	SPBRG = 63;			//31250 baud                                                      C:\fw\midicontroller\x009\init.c
003850   6eaf     MOVWF     0xaf,0x0                                                                                        
003852   6ab0     CLRF      0xb0,0x0       	SPBRGH = 0x00;                                                                  C:\fw\midicontroller\x009\init.c
                                           #endif                                                                           C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           //These constants setup the application's MCU Analog-to-Digital Converter module. C:\fw\midicontroller\x009\init.c
003854   0e40     MOVLW     0x40           	ADCON0	= 0b01000000;		//AN0, off                                                C:\fw\midicontroller\x009\init.c
003856   6ec2     MOVWF     0xc2,0x0                                                                                        
003858   0e0e     MOVLW     0xe            	ADCON1	= 0b00001110;		//1 analog channels                                       C:\fw\midicontroller\x009\init.c
00385a   6ec1     MOVWF     0xc1,0x0                                                                                        
00385c   0e86     MOVLW     0x86           	ADCON2	= 0b10000110;		//Right justified, 0 TAD(manual), FOSC/32                 C:\fw\midicontroller\x009\init.c
00385e   6ec0     MOVWF     0xc0,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                           //set up timer0 to interrupt at some interval..                                  C:\fw\midicontroller\x009\init.c
003860   0e20     MOVLW     0x20           	INTCON = 0x20;                //disable global and enable TMR0 interrupt        C:\fw\midicontroller\x009\init.c
003862   6ef2     MOVWF     0xf2,0x0                                                                                        
003864   0e84     MOVLW     0x84           	INTCON2 = 0x84;               //TMR0 high priority                              C:\fw\midicontroller\x009\init.c
003866   6ef1     MOVWF     0xf1,0x0                                                                                        
003868   8ed0     BSF       0xd0,0x7,0x0   	RCONbits.IPEN = 1;            //enable priority levels                          C:\fw\midicontroller\x009\init.c
00386a   6ad7     CLRF      0xd7,0x0       	TMR0H = 0;                    //clear timer                                     C:\fw\midicontroller\x009\init.c
00386c   6ad6     CLRF      0xd6,0x0       	TMR0L = 0;                    //clear timer                                     C:\fw\midicontroller\x009\init.c
00386e   0e80     MOVLW     0x80           	T0CON = 0x80;                 //set up timer0 - prescaler 1:8                   C:\fw\midicontroller\x009\init.c
003870   6ed5     MOVWF     0xd5,0x0                                                                                        
003872   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIEH = 1;          //enable interrupts                               C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
                                                                                                                            C:\fw\midicontroller\x009\init.c
003874   0e14     MOVLW     0x14           	mInitializeUSBDriver();                                                         C:\fw\midicontroller\x009\init.c
003876   6e6f     MOVWF     0x6f,0x0                                                                                        
003878   0101     MOVLB     0x1                                                                                             
00387a   6b22     CLRF      0x22,0x1                                                                                        
00387c   0101     MOVLB     0x1                                                                                             
00387e   6b23     CLRF      0x23,0x1                                                                                        
003880   0101     MOVLB     0x1                                                                                             
003882   6b24     CLRF      0x24,0x1                                                                                        
003884   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\init.c
                                           //*;###########################################################################  C:\fw\midicontroller\x009\hwcalls.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\hwcalls.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x009\hwcalls.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x009\hwcalls.c
                                           //;#			File Name: hwcalls.c   										  #                                      C:\fw\midicontroller\x009\hwcalls.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\hwcalls.c
                                           //;############################################################################  C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002c3e   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ADC_CONVERSION(unsigned char Channel) {                            C:\fw\midicontroller\x009\hwcalls.c
002c40   ffe6                                                                                                               
002c42   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002c44   ffd9                                                                                                               
002c46   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char tempcntr;                                                         C:\fw\midicontroller\x009\hwcalls.c
002c48   0efe     MOVLW     0xfe           	ADCON0 = Channel;                                                               C:\fw\midicontroller\x009\hwcalls.c
002c4a   50db     MOVF      0xdb,0x0,0x0                                                                                    
002c4c   6ec2     MOVWF     0xc2,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //Wait for the converter's holding capacitor to charge up.                       C:\fw\midicontroller\x009\hwcalls.c
                                           ADC_CHARGING_DELAY_LOOP:                                                         C:\fw\midicontroller\x009\hwcalls.c
002c4e   0e0a     MOVLW     0xa            	for(tempcntr = 10;tempcntr!=0;tempcntr--);                                      C:\fw\midicontroller\x009\hwcalls.c
002c50   6edf     MOVWF     0xdf,0x0                                                                                        
002c52   50df     MOVF      0xdf,0x0,0x0                                                                                    
002c54   e002     BZ        0x2c5a                                                                                          
002c56   06df     DECF      0xdf,0x1,0x0                                                                                    
002c58   d7fc     BRA       0x2c52                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //Start the conversion                                                           C:\fw\midicontroller\x009\hwcalls.c
002c5a   82c2     BSF       0xc2,0x1,0x0   	ADCON0bits.GO = true;                                                           C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //Wait for the conversion to complete, then exit                                 C:\fw\midicontroller\x009\hwcalls.c
                                           ADC_CONVERSION_DELAY:                                                            C:\fw\midicontroller\x009\hwcalls.c
002c5c   b2c2     BTFSC     0xc2,0x1,0x0   	for(;ADCON0bits.GO;);                                                           C:\fw\midicontroller\x009\hwcalls.c
002c5e   d7fe     BRA       0x2c5c                                                                                          
                                           	                                                                                C:\fw\midicontroller\x009\hwcalls.c
002c60   50c4     MOVF      0xc4,0x0,0x0   	return ADRESH;                                                                  C:\fw\midicontroller\x009\hwcalls.c
002c62   d000     BRA       0x2c64                                                                                          
002c64   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002c66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c68   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002c6a   ffd9                                                                                                               
002c6c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Send a single MIDI byte. */                                                   C:\fw\midicontroller\x009\hwcalls.c
002c6e   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_byte(u8 data) {                                                   C:\fw\midicontroller\x009\hwcalls.c
002c70   ffe6                                                                                                               
002c72   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002c74   ffd9                                                                                                               
002c76   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char temp;                                                             C:\fw\midicontroller\x009\hwcalls.c
                                           	//send out first byte.                                                          C:\fw\midicontroller\x009\hwcalls.c
002c78   0efe     MOVLW     0xfe           	TXREG = data;                                                                   C:\fw\midicontroller\x009\hwcalls.c
002c7a   50db     MOVF      0xdb,0x0,0x0                                                                                    
002c7c   6ead     MOVWF     0xad,0x0                                                                                        
002c7e   509e     MOVF      0x9e,0x0,0x0   	temp = PIR1;			//clear TXIF..                                                   C:\fw\midicontroller\x009\hwcalls.c
002c80   6edf     MOVWF     0xdf,0x0                                                                                        
002c82   a89e     BTFSS     0x9e,0x4,0x0   	while(!PIR1bits.TXIF);                                                          C:\fw\midicontroller\x009\hwcalls.c
002c84   d7fe     BRA       0x2c82                                                                                          
002c86   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002c88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c8a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002c8c   ffd9                                                                                                               
002c8e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //****************************************************************************** C:\fw\midicontroller\x009\hwcalls.c
                                           //JDunne 5/27/07 - Converted routine from assembly to C.  (used to be called SEND_TO_LATCHES) C:\fw\midicontroller\x009\hwcalls.c
                                           //------------------------------------------------------------------------------ C:\fw\midicontroller\x009\hwcalls.c
002c90   cfd9     MOVFF     0xfd9,0xfe6    void	SendDataToShiftReg(unsigned char dataToSend) {                              C:\fw\midicontroller\x009\hwcalls.c
002c92   ffe6                                                                                                               
002c94   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002c96   ffd9                                                                                                               
002c98   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char DataCounter;                                                      C:\fw\midicontroller\x009\hwcalls.c
                                           //SEND_SPEC_TO_LATCHES                                                           C:\fw\midicontroller\x009\hwcalls.c
002c9a   0e08     MOVLW     0x8            	DataCounter = 8;								//Load number of bits to be transfered                  C:\fw\midicontroller\x009\hwcalls.c
002c9c   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //	bcf	SRCK_LAT_BIT						//Control clock signal, also prevent IIC start          C:\fw\midicontroller\x009\hwcalls.c
002c9e   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Flush out garbage                              C:\fw\midicontroller\x009\hwcalls.c
002ca0   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //STL_TRANSMIT_BIT                                                               C:\fw\midicontroller\x009\hwcalls.c
                                           	do {                                                                            C:\fw\midicontroller\x009\hwcalls.c
002ca2   9289     BCF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = false;				//Clear strobe pin                           C:\fw\midicontroller\x009\hwcalls.c
002ca4   0efe     MOVLW     0xfe           		if (!chkbit(dataToSend, 7)) {		//MSB high?                                     C:\fw\midicontroller\x009\hwcalls.c
002ca6   bedb     BTFSC     0xdb,0x7,0x0                                                                                    
002ca8   d002     BRA       0x2cae                                                                                          
002caa   9689     BCF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = false;		//No, set data signal low                   C:\fw\midicontroller\x009\hwcalls.c
                                           		}                                                                              C:\fw\midicontroller\x009\hwcalls.c
002cac   d001     BRA       0x2cb0         		else {								//MSB low?                                                       C:\fw\midicontroller\x009\hwcalls.c
002cae   8689     BSF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = true;		//No, release data signal                    C:\fw\midicontroller\x009\hwcalls.c
                                           		}                                                                              C:\fw\midicontroller\x009\hwcalls.c
002cb0   cfdb     MOVFF     0xfdb,0xff3    		dataToSend <<=1;					//Shift next bit to MSB position                          C:\fw\midicontroller\x009\hwcalls.c
002cb2   fff3                                                                                                               
002cb4   9ef3     BCF       0xf3,0x7,0x0                                                                                    
002cb6   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
002cb8   cff3     MOVFF     0xff3,0xfdb                                                                                     
002cba   ffdb                                                                                                               
002cbc   8289     BSF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = true;                                                  C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //STL_RESET_CLOCK_LEVEL                                                          C:\fw\midicontroller\x009\hwcalls.c
002cbe   06df     DECF      0xdf,0x1,0x0   	} while (--DataCounter!=0);				//All 8 bits transfered? No, go transfer next bit C:\fw\midicontroller\x009\hwcalls.c
002cc0   e1f0     BNZ       0x2ca2                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //STL_STROBE                                                                     C:\fw\midicontroller\x009\hwcalls.c
002cc2   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Strobe the data                                C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //STL_STROBE_DELAY                                                               C:\fw\midicontroller\x009\hwcalls.c
002cc4   0e10     MOVLW     0x10           	for (DataCounter = LATCH_STROBE_DELAY; DataCounter !=0;DataCounter--);		//Pause for data transfer from external latch_1's input to its output C:\fw\midicontroller\x009\hwcalls.c
002cc6   6edf     MOVWF     0xdf,0x0                                                                                        
002cc8   50df     MOVF      0xdf,0x0,0x0                                                                                    
002cca   e002     BZ        0x2cd0                                                                                          
002ccc   06df     DECF      0xdf,0x1,0x0                                                                                    
002cce   d7fc     BRA       0x2cc8                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002cd0   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   C:\fw\midicontroller\x009\hwcalls.c
002cd2   8689     BSF       0x89,0x3,0x0   	SHIFTREG_SER_IN_LAT_BIT = true;				//Release data signal                        C:\fw\midicontroller\x009\hwcalls.c
002cd4   8289     BSF       0x89,0x1,0x0   	SHIFTREG_SRCK_LAT_BIT = true;			//Release serial clk                            C:\fw\midicontroller\x009\hwcalls.c
002cd6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002cd8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002cda   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002cdc   ffd9                                                                                                               
002cde   0012     RETURN    0x0                                                                                             
                                           //------------------------------------------------------------------------------ C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //returns data into ButtonState.                                                 C:\fw\midicontroller\x009\hwcalls.c
002ce0   cfd9     MOVFF     0xfd9,0xfe6    void	ReadButtons(void) {                                                         C:\fw\midicontroller\x009\hwcalls.c
002ce2   ffe6                                                                                                               
002ce4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002ce6   ffd9                                                                                                               
002ce8   0e04     MOVLW     0x4                                                                                             
002cea   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char BtnAddress, bitloc, i;                                            C:\fw\midicontroller\x009\hwcalls.c
                                           	BitField TempButtons;                                                           C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           //the following only reads 7 buttons from the multiplexor, and the 8th from the pin directly. C:\fw\midicontroller\x009\hwcalls.c
                                           //the 7th bit of the multiplexor is the modeswitch which is read below.          C:\fw\midicontroller\x009\hwcalls.c
002cec   52de     MOVF      0xde,0x1,0x0   	bitloc = 1;                                                                     C:\fw\midicontroller\x009\hwcalls.c
002cee   0e01     MOVLW     0x1                                                                                             
002cf0   6edd     MOVWF     0xdd,0x0                                                                                        
002cf2   0e03     MOVLW     0x3            	TempButtons.byte = 0;                                                           C:\fw\midicontroller\x009\hwcalls.c
002cf4   6adb     CLRF      0xdb,0x0                                                                                        
002cf6   6adf     CLRF      0xdf,0x0       	for (BtnAddress = 0;BtnAddress<=6;BtnAddress++) {                               C:\fw\midicontroller\x009\hwcalls.c
002cf8   50df     MOVF      0xdf,0x0,0x0                                                                                    
002cfa   0806     SUBLW     0x6                                                                                             
002cfc   e322     BNC       0x2d42                                                                                          
002d3e   2adf     INCF      0xdf,0x1,0x0                                                                                    
002d40   d7db     BRA       0x2cf8                                                                                          
002cfe   cfdf     MOVFF     0xfdf,0xfe6    		SetDipAddress(BtnAddress);                                                     C:\fw\midicontroller\x009\hwcalls.c
002d00   ffe6                                                                                                               
002d02   d8dd     RCALL     0x2ebe                                                                                          
002d04   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002d06   0e05     MOVLW     0x5            		for (i = BTN_SAMPLE_DELAY;i!=0;i--);		//delay for a sampling delay             C:\fw\midicontroller\x009\hwcalls.c
002d08   6ef3     MOVWF     0xf3,0x0                                                                                        
002d0a   0e02     MOVLW     0x2                                                                                             
002d0c   cff3     MOVFF     0xff3,0xfdb                                                                                     
002d0e   ffdb                                                                                                               
002d10   50db     MOVF      0xdb,0x0,0x0                                                                                    
002d12   e003     BZ        0x2d1a                                                                                          
002d14   0e02     MOVLW     0x2                                                                                             
002d16   06db     DECF      0xdb,0x1,0x0                                                                                    
002d18   d7fb     BRA       0x2d10                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002d1a   a284     BTFSS     0x84,0x1,0x0   		if (BTN_IN_PIN) TempButtons.byte |= bitloc;		//Or in the current bit if it is set. C:\fw\midicontroller\x009\hwcalls.c
002d1c   d009     BRA       0x2d30                                                                                          
002d1e   0e03     MOVLW     0x3                                                                                             
002d20   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002d22   ffe7                                                                                                               
002d24   0e01     MOVLW     0x1                                                                                             
002d26   50db     MOVF      0xdb,0x0,0x0                                                                                    
002d28   12e7     IORWF     0xe7,0x1,0x0                                                                                    
002d2a   0e03     MOVLW     0x3                                                                                             
002d2c   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002d2e   ffdb                                                                                                               
002d30   0e01     MOVLW     0x1            		bitloc <<= 1;										//shift the bit over to the next                        C:\fw\midicontroller\x009\hwcalls.c
002d32   cfdb     MOVFF     0xfdb,0xff3                                                                                     
002d34   fff3                                                                                                               
002d36   9ef3     BCF       0xf3,0x7,0x0                                                                                    
002d38   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
002d3a   cff3     MOVFF     0xff3,0xfdb                                                                                     
002d3c   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002d42   0e03     MOVLW     0x3            	ButtonState = TempButtons.byte;                                                 C:\fw\midicontroller\x009\hwcalls.c
002d44   cfdb     MOVFF     0xfdb,0xb2                                                                                      
002d46   f0b2                                                                                                               
002d48   0100     MOVLB     0x0                                                                                             
002d4a   6bb3     CLRF      0xb3,0x1                                                                                        
002d4c   6bb4     CLRF      0xb4,0x1                                                                                        
002d4e   6bb5     CLRF      0xb5,0x1                                                                                        
002d50   90d8     BCF       0xd8,0x0,0x0   	ButtonState <<=1;			//shift everything over one because the 0th bit is supposed C:\fw\midicontroller\x009\hwcalls.c
002d52   37b2     RLCF      0xb2,0x1,0x1                                                                                    
002d54   37b3     RLCF      0xb3,0x1,0x1                                                                                    
002d56   37b4     RLCF      0xb4,0x1,0x1                                                                                    
002d58   37b5     RLCF      0xb5,0x1,0x1                                                                                    
                                           								//to be PRESET_1, which is on another pin.                               C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002d5a   69b3     SETF      0xb3,0x1       	ButtonState |= 0xFFFFFF00;                                                      C:\fw\midicontroller\x009\hwcalls.c
002d5c   69b4     SETF      0xb4,0x1                                                                                        
002d5e   69b5     SETF      0xb5,0x1                                                                                        
002d60   b881     BTFSC     0x81,0x4,0x0   	if (BTN_PRESET_1_PIN) setbit(ButtonState,0);                                    C:\fw\midicontroller\x009\hwcalls.c
002d62   81b2     BSF       0xb2,0x0,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           	//all buttons are backwards logic, so simply invert the state of ButtonState.   C:\fw\midicontroller\x009\hwcalls.c
002d64   1fb2     COMF      0xb2,0x1,0x1   	ButtonState = ~ButtonState;                                                     C:\fw\midicontroller\x009\hwcalls.c
002d66   1fb3     COMF      0xb3,0x1,0x1                                                                                    
002d68   1fb4     COMF      0xb4,0x1,0x1                                                                                    
002d6a   1fb5     COMF      0xb5,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           	//read the 7th bit of the shift register.  (Which is the slider mode switch)    C:\fw\midicontroller\x009\hwcalls.c
002d6c   0e07     MOVLW     0x7            	BtnAddress = 0x07;                                                              C:\fw\midicontroller\x009\hwcalls.c
002d6e   6edf     MOVWF     0xdf,0x0                                                                                        
002d70   cfdf     MOVFF     0xfdf,0xfe6    	SetDipAddress(BtnAddress);                                                      C:\fw\midicontroller\x009\hwcalls.c
002d72   ffe6                                                                                                               
002d74   d8a4     RCALL     0x2ebe                                                                                          
002d76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d78   0100     MOVLB     0x0            	ModeSwitchState = true;                                                         C:\fw\midicontroller\x009\hwcalls.c
002d7a   81aa     BSF       0xaa,0x0,0x1                                                                                    
002d7c   b284     BTFSC     0x84,0x1,0x0   	if (BTN_IN_PIN) ModeSwitchState = false;                                        C:\fw\midicontroller\x009\hwcalls.c
002d7e   91aa     BCF       0xaa,0x0,0x1                                                                                    
002d80   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002d82   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002d84   e202     BC        0x2d8a                                                                                          
002d86   6ae1     CLRF      0xe1,0x0                                                                                        
002d88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d8a   6ee1     MOVWF     0xe1,0x0                                                                                        
002d8c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d8e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002d90   ffd9                                                                                                               
002d92   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           ///Average = ((Inst-Avg)/(2^Tau))+Avg                                            C:\fw\midicontroller\x009\hwcalls.c
002d94   cfd9     MOVFF     0xfd9,0xfe6    TwoBytes Filtered2SampleAvg(TwoBytes Avg, unsigned char Inst, unsigned char Tau) { C:\fw\midicontroller\x009\hwcalls.c
002d96   ffe6                                                                                                               
002d98   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002d9a   ffd9                                                                                                               
002d9c   0e03     MOVLW     0x3                                                                                             
002d9e   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char positive;                                                         C:\fw\midicontroller\x009\hwcalls.c
                                           	TwoBytes diff;                                                                  C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002da0   0e01     MOVLW     0x1            	diff.s_form = 0;                                                                C:\fw\midicontroller\x009\hwcalls.c
002da2   6adb     CLRF      0xdb,0x0                                                                                        
002da4   0e02     MOVLW     0x2                                                                                             
002da6   6adb     CLRF      0xdb,0x0                                                                                        
002da8   0efe     MOVLW     0xfe           	if (Inst >= Avg.b_form.high) {                                                  C:\fw\midicontroller\x009\hwcalls.c
002daa   50db     MOVF      0xdb,0x0,0x0                                                                                    
002dac   6ef3     MOVWF     0xf3,0x0                                                                                        
002dae   0efc     MOVLW     0xfc                                                                                            
002db0   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002db2   fff4                                                                                                               
002db4   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002db6   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002db8   e30e     BNC       0x2dd6                                                                                          
002dba   0efc     MOVLW     0xfc           		diff.b_form.high = Inst - Avg.b_form.high;                                     C:\fw\midicontroller\x009\hwcalls.c
002dbc   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
002dbe   ffe6                                                                                                               
002dc0   0efe     MOVLW     0xfe                                                                                            
002dc2   50db     MOVF      0xdb,0x0,0x0                                                                                    
002dc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002dc6   5ce7     SUBWF     0xe7,0x0,0x0                                                                                    
002dc8   6ee7     MOVWF     0xe7,0x0                                                                                        
002dca   0e02     MOVLW     0x2                                                                                             
002dcc   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002dce   ffdb                                                                                                               
002dd0   0e00     MOVLW     0x0            		setbit(positive,0);                                                            C:\fw\midicontroller\x009\hwcalls.c
002dd2   80df     BSF       0xdf,0x0,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\hwcalls.c
002dd4   d00d     BRA       0x2df0         	else {                                                                          C:\fw\midicontroller\x009\hwcalls.c
002dd6   0efe     MOVLW     0xfe           		diff.b_form.high = Avg.b_form.high - Inst;                                     C:\fw\midicontroller\x009\hwcalls.c
002dd8   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
002dda   ffe6                                                                                                               
002ddc   0efc     MOVLW     0xfc                                                                                            
002dde   50db     MOVF      0xdb,0x0,0x0                                                                                    
002de0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002de2   5ce7     SUBWF     0xe7,0x0,0x0                                                                                    
002de4   6ee7     MOVWF     0xe7,0x0                                                                                        
002de6   0e02     MOVLW     0x2                                                                                             
002de8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002dea   ffdb                                                                                                               
002dec   0e00     MOVLW     0x0            		clrbit(positive,0);                                                            C:\fw\midicontroller\x009\hwcalls.c
002dee   90df     BCF       0xdf,0x0,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002df0   0efb     MOVLW     0xfb           	diff.s_form >>= Tau;                                                            C:\fw\midicontroller\x009\hwcalls.c
002df2   cfdb     MOVFF     0xfdb,0x10                                                                                      
002df4   f010                                                                                                               
002df6   50d9     MOVF      0xd9,0x0,0x0                                                                                    
002df8   0f01     ADDLW     0x1                                                                                             
002dfa   6ee9     MOVWF     0xe9,0x0                                                                                        
002dfc   cfda     MOVFF     0xfda,0xfea                                                                                     
002dfe   ffea                                                                                                               
002e00   5010     MOVF      0x10,0x0,0x0                                                                                    
002e02   0b0f     ANDLW     0xf                                                                                             
002e04   e006     BZ        0x2e12                                                                                          
002e06   52ec     MOVF      0xec,0x1,0x0                                                                                    
002e08   90d8     BCF       0xd8,0x0,0x0                                                                                    
002e0a   32ed     RRCF      0xed,0x1,0x0                                                                                    
002e0c   32ef     RRCF      0xef,0x1,0x0                                                                                    
002e0e   06e8     DECF      0xe8,0x1,0x0                                                                                    
002e10   e1fa     BNZ       0x2e06                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002e12   a0df     BTFSS     0xdf,0x0,0x0   	if (chkbit(positive,0)) {                                                       C:\fw\midicontroller\x009\hwcalls.c
002e14   d011     BRA       0x2e38                                                                                          
002e16   0e01     MOVLW     0x1            		Avg.s_form += diff.s_form;                                                     C:\fw\midicontroller\x009\hwcalls.c
002e18   cfdb     MOVFF     0xfdb,0x10                                                                                      
002e1a   f010                                                                                                               
002e1c   0e02     MOVLW     0x2                                                                                             
002e1e   cfdb     MOVFF     0xfdb,0x11                                                                                      
002e20   f011                                                                                                               
002e22   50d9     MOVF      0xd9,0x0,0x0                                                                                    
002e24   0ffd     ADDLW     0xfd                                                                                            
002e26   6ee9     MOVWF     0xe9,0x0                                                                                        
002e28   0eff     MOVLW     0xff                                                                                            
002e2a   20da     ADDWFC    0xda,0x0,0x0                                                                                    
002e2c   6eea     MOVWF     0xea,0x0                                                                                        
002e2e   5010     MOVF      0x10,0x0,0x0                                                                                    
002e30   26ee     ADDWF     0xee,0x1,0x0                                                                                    
002e32   5011     MOVF      0x11,0x0,0x0                                                                                    
002e34   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\hwcalls.c
002e36   d010     BRA       0x2e58         	else {                                                                          C:\fw\midicontroller\x009\hwcalls.c
002e38   0e01     MOVLW     0x1            		Avg.s_form -= diff.s_form;                                                     C:\fw\midicontroller\x009\hwcalls.c
002e3a   cfdb     MOVFF     0xfdb,0x10                                                                                      
002e3c   f010                                                                                                               
002e3e   0e02     MOVLW     0x2                                                                                             
002e40   cfdb     MOVFF     0xfdb,0x11                                                                                      
002e42   f011                                                                                                               
002e44   50d9     MOVF      0xd9,0x0,0x0                                                                                    
002e46   0ffd     ADDLW     0xfd                                                                                            
002e48   6ee9     MOVWF     0xe9,0x0                                                                                        
002e4a   0eff     MOVLW     0xff                                                                                            
002e4c   20da     ADDWFC    0xda,0x0,0x0                                                                                    
002e4e   6eea     MOVWF     0xea,0x0                                                                                        
002e50   5010     MOVF      0x10,0x0,0x0                                                                                    
002e52   5eee     SUBWF     0xee,0x1,0x0                                                                                    
002e54   5011     MOVF      0x11,0x0,0x0                                                                                    
002e56   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\hwcalls.c
002e58   0efd     MOVLW     0xfd           	return Avg;                                                                     C:\fw\midicontroller\x009\hwcalls.c
002e5a   cfdb     MOVFF     0xfdb,0x10                                                                                      
002e5c   f010                                                                                                               
002e5e   0efe     MOVLW     0xfe                                                                                            
002e60   cfdb     MOVFF     0xfdb,0x11                                                                                      
002e62   f011                                                                                                               
002e64   c010     MOVFF     0x10,0xff3                                                                                      
002e66   fff3                                                                                                               
002e68   c011     MOVFF     0x11,0xff4                                                                                      
002e6a   fff4                                                                                                               
002e6c   0e03     MOVLW     0x3            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002e6e   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002e70   e203     BC        0x2e78                                                                                          
002e72   d000     BRA       0x2e74                                                                                          
002e74   6ae1     CLRF      0xe1,0x0                                                                                        
002e76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e78   6ee1     MOVWF     0xe1,0x0                                                                                        
002e7a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e7c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002e7e   ffd9                                                                                                               
002e80   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002e82   cfd9     MOVFF     0xfd9,0xfe6    void	Write64BytesProgMem(rom unsigned char *RomPtr, unsigned char *RamPtr) {     C:\fw\midicontroller\x009\hwcalls.c
002e84   ffe6                                                                                                               
002e86   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002e88   ffd9                                                                                                               
002e8a   0efd     MOVLW     0xfd           	TBLPTR = (unsigned long)RomPtr;                                                 C:\fw\midicontroller\x009\hwcalls.c
002e8c   cfdb     MOVFF     0xfdb,0x10                                                                                      
002e8e   f010                                                                                                               
002e90   0efe     MOVLW     0xfe                                                                                            
002e92   cfdb     MOVFF     0xfdb,0x11                                                                                      
002e94   f011                                                                                                               
002e96   6a12     CLRF      0x12,0x0                                                                                        
002e98   6a13     CLRF      0x13,0x0                                                                                        
002e9a   c010     MOVFF     0x10,0xff6                                                                                      
002e9c   fff6                                                                                                               
002e9e   c011     MOVFF     0x11,0xff7                                                                                      
002ea0   fff7                                                                                                               
002ea2   c012     MOVFF     0x12,0xff8                                                                                      
002ea4   fff8                                                                                                               
002ea6   0efb     MOVLW     0xfb           	FSR0 = (unsigned short)RamPtr;                                                  C:\fw\midicontroller\x009\hwcalls.c
002ea8   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002eaa   ffe9                                                                                                               
002eac   0efc     MOVLW     0xfc                                                                                            
002eae   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002eb0   ffea                                                                                                               
002eb2   ecec     CALL      0x37d8,0x0     	WRITE_BLOCK_INTO_ROM();                                                         C:\fw\midicontroller\x009\hwcalls.c
002eb4   f01b                                                                                                               
002eb6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002eb8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002eba   ffd9                                                                                                               
002ebc   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002ebe   cfd9     MOVFF     0xfd9,0xfe6    void	SetDipAddress(unsigned char Address) {                                      C:\fw\midicontroller\x009\hwcalls.c
002ec0   ffe6                                                                                                               
002ec2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002ec4   ffd9                                                                                                               
002ec6   9889     BCF       0x89,0x4,0x0   	BTN_S0_LAT_BIT = false;                                                         C:\fw\midicontroller\x009\hwcalls.c
002ec8   9a89     BCF       0x89,0x5,0x0   	BTN_S1_LAT_BIT = false;                                                         C:\fw\midicontroller\x009\hwcalls.c
002eca   908d     BCF       0x8d,0x0,0x0   	BTN_S2_LAT_BIT = false;                                                         C:\fw\midicontroller\x009\hwcalls.c
002ecc   0efe     MOVLW     0xfe           	if (chkbit(Address,0)) BTN_S0_LAT_BIT = true;                                   C:\fw\midicontroller\x009\hwcalls.c
002ece   b0db     BTFSC     0xdb,0x0,0x0                                                                                    
002ed0   8889     BSF       0x89,0x4,0x0                                                                                    
002ed2   b2db     BTFSC     0xdb,0x1,0x0   	if (chkbit(Address,1)) BTN_S1_LAT_BIT = true;                                   C:\fw\midicontroller\x009\hwcalls.c
002ed4   8a89     BSF       0x89,0x5,0x0                                                                                    
002ed6   b4db     BTFSC     0xdb,0x2,0x0   	if (chkbit(Address,2)) BTN_S2_LAT_BIT = true;                                   C:\fw\midicontroller\x009\hwcalls.c
002ed8   808d     BSF       0x8d,0x0,0x0                                                                                    
002eda   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002edc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002ede   ffd9                                                                                                               
002ee0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* --------------- LED read-out display functions: */                            C:\fw\midicontroller\x009\hwcalls.c
002ee2   cfd9     MOVFF     0xfd9,0xfe6    u32 fsw_poll(){                                                                  C:\fw\midicontroller\x009\hwcalls.c
002ee4   ffe6                                                                                                               
002ee6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002ee8   ffd9                                                                                                               
002eea   0e04     MOVLW     0x4                                                                                             
002eec   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	FourBytes TempButtons;                                                          C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002eee   6ade     CLRF      0xde,0x0       	TempButtons.l_form = 0;                                                         C:\fw\midicontroller\x009\hwcalls.c
002ef0   6ade     CLRF      0xde,0x0                                                                                        
002ef2   6ade     CLRF      0xde,0x0                                                                                        
002ef4   6add     CLRF      0xdd,0x0                                                                                        
002ef6   52dd     MOVF      0xdd,0x1,0x0                                                                                    
002ef8   52dd     MOVF      0xdd,0x1,0x0                                                                                    
002efa   c0b2     MOVFF     0xb2,0x10      	TempButtons.b_form.byte3 = ButtonState&0xF0;                                    C:\fw\midicontroller\x009\hwcalls.c
002efc   f010                                                                                                               
002efe   c0b3     MOVFF     0xb3,0x11                                                                                       
002f00   f011                                                                                                               
002f02   c0b4     MOVFF     0xb4,0x12                                                                                       
002f04   f012                                                                                                               
002f06   c0b5     MOVFF     0xb5,0x13                                                                                       
002f08   f013                                                                                                               
002f0a   0ef0     MOVLW     0xf0                                                                                            
002f0c   1610     ANDWF     0x10,0x1,0x0                                                                                    
002f0e   6a11     CLRF      0x11,0x0                                                                                        
002f10   6a12     CLRF      0x12,0x0                                                                                        
002f12   6a13     CLRF      0x13,0x0                                                                                        
002f14   0e03     MOVLW     0x3                                                                                             
002f16   c010     MOVFF     0x10,0xfdb                                                                                      
002f18   ffdb                                                                                                               
002f1a   c0b2     MOVFF     0xb2,0x10      	TempButtons.b_form.byte0 = ButtonState&0x0F;                                    C:\fw\midicontroller\x009\hwcalls.c
002f1c   f010                                                                                                               
002f1e   c0b3     MOVFF     0xb3,0x11                                                                                       
002f20   f011                                                                                                               
002f22   c0b4     MOVFF     0xb4,0x12                                                                                       
002f24   f012                                                                                                               
002f26   c0b5     MOVFF     0xb5,0x13                                                                                       
002f28   f013                                                                                                               
002f2a   0e0f     MOVLW     0xf                                                                                             
002f2c   1610     ANDWF     0x10,0x1,0x0                                                                                    
002f2e   6a11     CLRF      0x11,0x0                                                                                        
002f30   6a12     CLRF      0x12,0x0                                                                                        
002f32   6a13     CLRF      0x13,0x0                                                                                        
002f34   5010     MOVF      0x10,0x0,0x0                                                                                    
002f36   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
002f38   cfdf     MOVFF     0xfdf,0x10     	return TempButtons.l_form;                                                      C:\fw\midicontroller\x009\hwcalls.c
002f3a   f010                                                                                                               
002f3c   0e01     MOVLW     0x1                                                                                             
002f3e   cfdb     MOVFF     0xfdb,0x11                                                                                      
002f40   f011                                                                                                               
002f42   c010     MOVFF     0x10,0xff3                                                                                      
002f44   fff3                                                                                                               
002f46   c011     MOVFF     0x11,0xff4                                                                                      
002f48   fff4                                                                                                               
002f4a   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002f4c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002f4e   e203     BC        0x2f56                                                                                          
002f50   d000     BRA       0x2f52                                                                                          
002f52   6ae1     CLRF      0xe1,0x0                                                                                        
002f54   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f56   6ee1     MOVWF     0xe1,0x0                                                                                        
002f58   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f5a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002f5c   ffd9                                                                                                               
002f5e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           void	UpdateLeds(void) {                                                          C:\fw\midicontroller\x009\hwcalls.c
002f60   c0b1     MOVFF     0xb1,0xfe6     	SendDataToShiftReg(LedStates);                                                  C:\fw\midicontroller\x009\hwcalls.c
002f62   ffe6                                                                                                               
002f64   de95     RCALL     0x2c90                                                                                          
002f66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f68   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
                                           /* Set currently active program foot-switch's LED indicator and disable all others */ C:\fw\midicontroller\x009\hwcalls.c
002f6a   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_set_active(int idx){                                                C:\fw\midicontroller\x009\hwcalls.c
002f6c   ffe6                                                                                                               
002f6e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002f70   ffd9                                                                                                               
002f72   0100     MOVLB     0x0            	LedStates = 0;                                                                  C:\fw\midicontroller\x009\hwcalls.c
002f74   6bb1     CLRF      0xb1,0x1                                                                                        
002f76   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          C:\fw\midicontroller\x009\hwcalls.c
002f78   6ef3     MOVWF     0xf3,0x0                                                                                        
002f7a   0efd     MOVLW     0xfd                                                                                            
002f7c   50db     MOVF      0xdb,0x0,0x0                                                                                    
002f7e   e004     BZ        0x2f88                                                                                          
002f80   90d8     BCF       0xd8,0x0,0x0                                                                                    
002f82   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002f84   06e8     DECF      0xe8,0x1,0x0                                                                                    
002f86   e1fc     BNZ       0x2f80                                                                                          
002f88   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002f8a   0100     MOVLB     0x0                                                                                             
002f8c   13b1     IORWF     0xb1,0x1,0x1                                                                                    
002f8e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002f90   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002f92   ffd9                                                                                                               
002f94   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Explicitly enable a single LED without affecting the others */                C:\fw\midicontroller\x009\hwcalls.c
002f96   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_enable(int idx){                                                    C:\fw\midicontroller\x009\hwcalls.c
002f98   ffe6                                                                                                               
002f9a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002f9c   ffd9                                                                                                               
002f9e   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          C:\fw\midicontroller\x009\hwcalls.c
002fa0   6ef3     MOVWF     0xf3,0x0                                                                                        
002fa2   0efd     MOVLW     0xfd                                                                                            
002fa4   50db     MOVF      0xdb,0x0,0x0                                                                                    
002fa6   e004     BZ        0x2fb0                                                                                          
002fa8   90d8     BCF       0xd8,0x0,0x0                                                                                    
002faa   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002fac   06e8     DECF      0xe8,0x1,0x0                                                                                    
002fae   e1fc     BNZ       0x2fa8                                                                                          
002fb0   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002fb2   0100     MOVLB     0x0                                                                                             
002fb4   13b1     IORWF     0xb1,0x1,0x1                                                                                    
002fb6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002fb8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002fba   ffd9                                                                                                               
002fbc   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Explicitly disable a single LED without affecting the others */               C:\fw\midicontroller\x009\hwcalls.c
002fbe   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_disable(int idx){                                                   C:\fw\midicontroller\x009\hwcalls.c
002fc0   ffe6                                                                                                               
002fc2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002fc4   ffd9                                                                                                               
002fc6   0e01     MOVLW     0x1            	clrbit(LedStates,idx);                                                          C:\fw\midicontroller\x009\hwcalls.c
002fc8   6ef3     MOVWF     0xf3,0x0                                                                                        
002fca   0efd     MOVLW     0xfd                                                                                            
002fcc   50db     MOVF      0xdb,0x0,0x0                                                                                    
002fce   e004     BZ        0x2fd8                                                                                          
002fd0   90d8     BCF       0xd8,0x0,0x0                                                                                    
002fd2   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002fd4   06e8     DECF      0xe8,0x1,0x0                                                                                    
002fd6   e1fc     BNZ       0x2fd0                                                                                          
002fd8   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002fda   6e10     MOVWF     0x10,0x0                                                                                        
002fdc   6a11     CLRF      0x11,0x0                                                                                        
002fde   be10     BTFSC     0x10,0x7,0x0                                                                                    
002fe0   6811     SETF      0x11,0x0                                                                                        
002fe2   0eff     MOVLW     0xff                                                                                            
002fe4   1810     XORWF     0x10,0x0,0x0                                                                                    
002fe6   0100     MOVLB     0x0                                                                                             
002fe8   17b1     ANDWF     0xb1,0x1,0x1                                                                                    
002fea   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
002fec   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002fee   ffd9                                                                                                               
002ff0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Poll the slider switch to see which mode we're in: */                         C:\fw\midicontroller\x009\hwcalls.c
                                           u8 slider_poll(){                                                                C:\fw\midicontroller\x009\hwcalls.c
002ff2   0100     MOVLB     0x0            	return	ModeSwitchState;                                                         C:\fw\midicontroller\x009\hwcalls.c
002ff4   51aa     MOVF      0xaa,0x0,0x1                                                                                    
002ff6   0b01     ANDLW     0x1                                                                                             
002ff8   d000     BRA       0x2ffa                                                                                          
002ffa   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Poll the expression pedal's data (0-127): */                                  C:\fw\midicontroller\x009\hwcalls.c
                                           u8 expr_poll(){                                                                  C:\fw\midicontroller\x009\hwcalls.c
                                           	                                                                                C:\fw\midicontroller\x009\hwcalls.c
002ffc   0e01     MOVLW     0x1            	ADC_CONVERSION(EXP_PEDAL_CHANNEL);                                              C:\fw\midicontroller\x009\hwcalls.c
002ffe   6ee6     MOVWF     0xe6,0x0                                                                                        
003000   de1e     RCALL     0x2c3e                                                                                          
003002   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003004   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* --------------- Data persistence functions: */                                C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Gets number of stored banks */                                                C:\fw\midicontroller\x009\hwcalls.c
                                           u16 banks_count(){                                                               C:\fw\midicontroller\x009\hwcalls.c
003006   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Loads a bank into the specified arrays: */                                    C:\fw\midicontroller\x009\hwcalls.c
003008   cfd9     MOVFF     0xfd9,0xfe6    void bank_load(u16 bank_index, char name[BANK_NAME_MAXLENGTH], u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 *bankmap_count){ C:\fw\midicontroller\x009\hwcalls.c
00300a   ffe6                                                                                                               
00300c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00300e   ffd9                                                                                                               
003010   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
003012   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003014   ffd9                                                                                                               
003016   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Stores the programs back to the bank: */                                      C:\fw\midicontroller\x009\hwcalls.c
003018   cfd9     MOVFF     0xfd9,0xfe6    void bank_store(u16 bank_index, u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 bankmap_count){ C:\fw\midicontroller\x009\hwcalls.c
00301a   ffe6                                                                                                               
00301c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00301e   ffd9                                                                                                               
003020   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
003022   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003024   ffd9                                                                                                               
003026   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Load bank name for browsing through banks: */                                 C:\fw\midicontroller\x009\hwcalls.c
003028   cfd9     MOVFF     0xfd9,0xfe6    void bank_loadname(u16 bank_index, char name[BANK_NAME_MAXLENGTH]){              C:\fw\midicontroller\x009\hwcalls.c
00302a   ffe6                                                                                                               
00302c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00302e   ffd9                                                                                                               
003030   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
003032   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003034   ffd9                                                                                                               
003036   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Get the alphabetically sorted bank index */                                   C:\fw\midicontroller\x009\hwcalls.c
003038   cfd9     MOVFF     0xfd9,0xfe6    u16 bank_getsortedindex(u16 sort_index){                                         C:\fw\midicontroller\x009\hwcalls.c
00303a   ffe6                                                                                                               
00303c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00303e   ffd9                                                                                                               
003040   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
003042   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003044   ffd9                                                                                                               
003046   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* --------------- MIDI I/O functions: */                                        C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /* Send formatted MIDI commands.                                                 C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                               0 <= cmd <= F       - MIDI command                                           C:\fw\midicontroller\x009\hwcalls.c
                                               0 <= channel <= F   - MIDI channel to send command to                        C:\fw\midicontroller\x009\hwcalls.c
                                               00 <= data1 <= FF   - first data byte of MIDI command                        C:\fw\midicontroller\x009\hwcalls.c
                                               00 <= data2 <= FF   - second (optional) data byte of MIDI command            C:\fw\midicontroller\x009\hwcalls.c
                                           */                                                                               C:\fw\midicontroller\x009\hwcalls.c
003048   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd1(u8 cmd, u8 channel, u8 data1){                               C:\fw\midicontroller\x009\hwcalls.c
00304a   ffe6                                                                                                               
00304c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00304e   ffd9                                                                                                               
003050   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
003052   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003054   ffd9                                                                                                               
003056   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
003058   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd2(u8 cmd, u8 channel, u8 data1, u8 data2){                     C:\fw\midicontroller\x009\hwcalls.c
00305a   ffe6                                                                                                               
00305c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00305e   ffd9                                                                                                               
003060   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\hwcalls.c
003062   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003064   ffd9                                                                                                               
003066   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x009\hwcalls.c
                                           /*                                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	A programmable MIDI foot controller.                                            C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	Written by James S. Dunne                                                       C:\fw\midicontroller\x009\controller.c
                                           	04/05/2007                                                                      C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	Possible hardware layout diagram:                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	(o)     = SPST rugged foot-switch                                               C:\fw\midicontroller\x009\controller.c
                                           	(*)     = Single on/off LED                                                     C:\fw\midicontroller\x009\controller.c
                                           	[ ... ] = LED 7-segment (or more) display                                       C:\fw\midicontroller\x009\controller.c
                                           	{\}		= slider switch                                                            C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                            PWR  MIDI OUT EXPR IN (opt)                                                     C:\fw\midicontroller\x009\controller.c
                                             |      ||      ||                                                              C:\fw\midicontroller\x009\controller.c
                                           /--------------------\                                                           C:\fw\midicontroller\x009\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x009\controller.c
                                           | [8 8 8 8] {\}  [8] |                                                           C:\fw\midicontroller\x009\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x009\controller.c
                                           | (*)  (*)  (*)  (*) |                                                           C:\fw\midicontroller\x009\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           C:\fw\midicontroller\x009\controller.c
                                           |  1    2    3    4  |                                                           C:\fw\midicontroller\x009\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x009\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           C:\fw\midicontroller\x009\controller.c
                                           | DEC  INC  ENTR NEXT|                                                           C:\fw\midicontroller\x009\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x009\controller.c
                                           \--------------------/                                                           C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           NOTE:   CONCERT mode: Implement hold-down of preset button to                    C:\fw\midicontroller\x009\controller.c
                                           quick-switch to said preset, but on release switch back to last                  C:\fw\midicontroller\x009\controller.c
                                           preset.                                                                          C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           */                                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           #include "types.h"                                                               C:\fw\midicontroller\x009\controller.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           const u8 midi_channel = 0;                                                       C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           u8      bank[BANK_PRESET_COUNT];                                                 C:\fw\midicontroller\x009\controller.c
                                           u8		bankcontroller[BANK_PRESET_COUNT];                                           C:\fw\midicontroller\x009\controller.c
                                           u8		bankmap[BANK_MAP_COUNT];                                                     C:\fw\midicontroller\x009\controller.c
                                           u8		bankmap_count;                                                               C:\fw\midicontroller\x009\controller.c
                                           char	bankname[BANK_NAME_MAXLENGTH];                                              C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* current settings */                                                           C:\fw\midicontroller\x009\controller.c
                                           u8      curr_program;                                                            C:\fw\midicontroller\x009\controller.c
                                           u8      curr_preset;                                                             C:\fw\midicontroller\x009\controller.c
                                           u8      curr_mapindex;                                                           C:\fw\midicontroller\x009\controller.c
                                           u16     curr_bank, loaded_bank;                                                  C:\fw\midicontroller\x009\controller.c
                                           u16		curr_sortedbank;                                                            C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           u16		bank_count;                                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           u32		preset_held = 0;                                                            C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* decrement timer in ms: */                                                     C:\fw\midicontroller\x009\controller.c
                                           u16		accel_time;                                                                 C:\fw\midicontroller\x009\controller.c
                                           u8		accel_count;                                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           u16		cdtimer_value = 0;                                                          C:\fw\midicontroller\x009\controller.c
                                           u16		cdtimer_flash = 0;                                                          C:\fw\midicontroller\x009\controller.c
                                           u16		cdtimer_store = 0;                                                          C:\fw\midicontroller\x009\controller.c
                                           u16		cdtimer_incdec_held = 0;                                                    C:\fw\midicontroller\x009\controller.c
                                           u16		cdtimer_holdenter = 0;                                                      C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           enum acceleration_state {                                                        C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_NONE,                                                                     C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_INC_SLOW,                                                                 C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_INC_MEDIUM,                                                               C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_INC_FAST,                                                                 C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_DEC_SLOW,                                                                 C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_DEC_MEDIUM,                                                               C:\fw\midicontroller\x009\controller.c
                                           	ACCEL_DEC_FAST                                                                  C:\fw\midicontroller\x009\controller.c
                                           } accel_state = ACCEL_NONE;                                                      C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           enum flashing_led_state {                                                        C:\fw\midicontroller\x009\controller.c
                                           	FLASH_NONE,                                                                     C:\fw\midicontroller\x009\controller.c
                                           	FLASH_STORE,                                                                    C:\fw\midicontroller\x009\controller.c
                                           	FLASH_BANK_SELECT_MODE,                                                         C:\fw\midicontroller\x009\controller.c
                                           	FLASH_PRGM_SELECT_MODE                                                          C:\fw\midicontroller\x009\controller.c
                                           } flash_state = FLASH_NONE;                                                      C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           enum program_modes {                                                             C:\fw\midicontroller\x009\controller.c
                                           	PROGRAM_NONE,                                                                   C:\fw\midicontroller\x009\controller.c
                                           	PROGRAM_SEQUENCE,                                                               C:\fw\midicontroller\x009\controller.c
                                           	PROGRAM_COMPLETE                                                                C:\fw\midicontroller\x009\controller.c
                                           } program_mode = PROGRAM_NONE;                                                   C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           u8		flash_led = 0;                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* time period in ms before value is changed */                                  C:\fw\midicontroller\x009\controller.c
                                           const u16 accel_time_slow	= 15;                                                  C:\fw\midicontroller\x009\controller.c
                                           const u16 accel_time_medium	=  5;                                                C:\fw\midicontroller\x009\controller.c
                                           const u16 accel_time_fast	=  2;                                                  C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           const u16 value_flashtime	= 75;                                                  C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* concert/practice main mode switch */                                          C:\fw\midicontroller\x009\controller.c
                                           enum mainmode {                                                                  C:\fw\midicontroller\x009\controller.c
                                           	MODE_PRACTICE = 0,                                                              C:\fw\midicontroller\x009\controller.c
                                           	MODE_CONCERT = 1                                                                C:\fw\midicontroller\x009\controller.c
                                           } mode;                                                                          C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* convert integer to ASCII in fixed number of chars, right-aligned */           C:\fw\midicontroller\x009\controller.c
000b20   cfd9     MOVFF     0xfd9,0xfe6    void itoa_fixed(u8 n, char s[LEDS_MAX_ALPHAS]) {                                 C:\fw\midicontroller\x009\controller.c
000b22   ffe6                                                                                                               
000b24   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000b26   ffd9                                                                                                               
000b28   52e6     MOVF      0xe6,0x1,0x0                                                                                    
000b2a   0e03     MOVLW     0x3            	u8 i = LEDS_MAX_ALPHAS - 1;                                                     C:\fw\midicontroller\x009\controller.c
000b2c   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	do {                                                                            C:\fw\midicontroller\x009\controller.c
000b2e   0e0a     MOVLW     0xa            		s[i--] = (n%10) + '0';                                                         C:\fw\midicontroller\x009\controller.c
000b30   6e10     MOVWF     0x10,0x0                                                                                        
000b32   c010     MOVFF     0x10,0xc                                                                                        
000b34   f00c                                                                                                               
000b36   0efe     MOVLW     0xfe                                                                                            
000b38   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b3a   f007                                                                                                               
000b3c   ecb4     CALL      0x3968,0x0                                                                                      
000b3e   f01c                                                                                                               
000b40   5003     MOVF      0x3,0x0,0x0                                                                                     
000b42   0f30     ADDLW     0x30                                                                                            
000b44   6ee6     MOVWF     0xe6,0x0                                                                                        
000b46   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b48   06df     DECF      0xdf,0x1,0x0                                                                                    
000b4a   6ee7     MOVWF     0xe7,0x0                                                                                        
000b4c   0efc     MOVLW     0xfc                                                                                            
000b4e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b50   ffe9                                                                                                               
000b52   0efd     MOVLW     0xfd                                                                                            
000b54   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b56   ffea                                                                                                               
000b58   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b5a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b5c   0e00     MOVLW     0x0                                                                                             
000b5e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000b60   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b62   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b64   6eef     MOVWF     0xef,0x0                                                                                        
000b66   0e0a     MOVLW     0xa            	} while ((n /= 10) > 0);                                                        C:\fw\midicontroller\x009\controller.c
000b68   6e10     MOVWF     0x10,0x0                                                                                        
000b6a   c010     MOVFF     0x10,0xc                                                                                        
000b6c   f00c                                                                                                               
000b6e   0efe     MOVLW     0xfe                                                                                            
000b70   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b72   f007                                                                                                               
000b74   ecb4     CALL      0x3968,0x0                                                                                      
000b76   f01c                                                                                                               
000b78   0efe     MOVLW     0xfe                                                                                            
000b7a   c007     MOVFF     0x7,0xfdb                                                                                       
000b7c   ffdb                                                                                                               
000b7e   5007     MOVF      0x7,0x0,0x0                                                                                     
000b80   0800     SUBLW     0x0                                                                                             
000b82   e3d5     BNC       0xb2e                                                                                           
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* pad the left chars with spaces: */                                           C:\fw\midicontroller\x009\controller.c
000b84   50df     MOVF      0xdf,0x0,0x0   	for (;i > 0;--i) s[i] = ' ';                                                    C:\fw\midicontroller\x009\controller.c
000b86   0800     SUBLW     0x0                                                                                             
000b88   e210     BC        0xbaa                                                                                           
000b8a   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b8c   6ee7     MOVWF     0xe7,0x0                                                                                        
000b8e   0efc     MOVLW     0xfc                                                                                            
000b90   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b92   ffe9                                                                                                               
000b94   0efd     MOVLW     0xfd                                                                                            
000b96   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b98   ffea                                                                                                               
000b9a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b9c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b9e   0e00     MOVLW     0x0                                                                                             
000ba0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000ba2   0e20     MOVLW     0x20                                                                                            
000ba4   6eef     MOVWF     0xef,0x0                                                                                        
000ba6   06df     DECF      0xdf,0x1,0x0                                                                                    
000ba8   d7ed     BRA       0xb84                                                                                           
000baa   50df     MOVF      0xdf,0x0,0x0   	s[i] = ' ';                                                                     C:\fw\midicontroller\x009\controller.c
000bac   6ee7     MOVWF     0xe7,0x0                                                                                        
000bae   0efc     MOVLW     0xfc                                                                                            
000bb0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000bb2   ffe9                                                                                                               
000bb4   0efd     MOVLW     0xfd                                                                                            
000bb6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000bb8   ffea                                                                                                               
000bba   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000bbc   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000bbe   0e00     MOVLW     0x0                                                                                             
000bc0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000bc2   0e20     MOVLW     0x20                                                                                            
000bc4   6eef     MOVWF     0xef,0x0                                                                                        
000bc6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000bc8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bca   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000bcc   ffd9                                                                                                               
000bce   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* display a program value in decimal with a leading 'P': */                     C:\fw\midicontroller\x009\controller.c
000bd0   cfd9     MOVFF     0xfd9,0xfe6    void show_program() {                                                            C:\fw\midicontroller\x009\controller.c
000bd2   ffe6                                                                                                               
000bd4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bd6   ffd9                                                                                                               
000bd8   0e04     MOVLW     0x4                                                                                             
000bda   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	char	a[LEDS_MAX_ALPHAS];                                                        C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* convert curr_program to ASCII: */                                            C:\fw\midicontroller\x009\controller.c
000bdc   cfd9     MOVFF     0xfd9,0xfe6    	itoa_fixed(curr_program + 1, a);                                                C:\fw\midicontroller\x009\controller.c
000bde   ffe6                                                                                                               
000be0   cfda     MOVFF     0xfda,0xfe6                                                                                     
000be2   ffe6                                                                                                               
000be4   0100     MOVLB     0x0                                                                                             
000be6   29f1     INCF      0xf1,0x0,0x1                                                                                    
000be8   6ee6     MOVWF     0xe6,0x0                                                                                        
000bea   df9a     RCALL     0xb20                                                                                           
000bec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bf0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* leading 'P' char: */                                                         C:\fw\midicontroller\x009\controller.c
000bf2   0e50     MOVLW     0x50           	a[0] = 'P';                                                                     C:\fw\midicontroller\x009\controller.c
000bf4   6edf     MOVWF     0xdf,0x0                                                                                        
000bf6   cfd9     MOVFF     0xfd9,0xfe6    	leds_show_4alphas(a);                                                           C:\fw\midicontroller\x009\controller.c
000bf8   ffe6                                                                                                               
000bfa   cfda     MOVFF     0xfda,0xfe6                                                                                     
000bfc   ffe6                                                                                                               
000bfe   ec05     CALL      0x320a,0x0                                                                                      
000c00   f019                                                                                                               
000c02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c04   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* start timer to revert the display: */                                        C:\fw\midicontroller\x009\controller.c
000c06   c117     MOVFF     0x117,0x103    	cdtimer_value = value_flashtime;                                                C:\fw\midicontroller\x009\controller.c
000c08   f103                                                                                                               
000c0a   c118     MOVFF     0x118,0x104                                                                                     
000c0c   f104                                                                                                               
000c0e   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x009\controller.c
000c10   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000c12   e202     BC        0xc18                                                                                           
000c14   6ae1     CLRF      0xe1,0x0                                                                                        
000c16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c18   6ee1     MOVWF     0xe1,0x0                                                                                        
000c1a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c1c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c1e   ffd9                                                                                                               
000c20   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* send the MIDI program change message */                                       C:\fw\midicontroller\x009\controller.c
000c22   cfd9     MOVFF     0xfd9,0xfe6    void program_activate(u8 notify) {                                               C:\fw\midicontroller\x009\controller.c
000c24   ffe6                                                                                                               
000c26   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c28   ffd9                                                                                                               
000c2a   c0f1     MOVFF     0xf1,0xfe6     	midi_send_cmd1(0xC, midi_channel, curr_program);                                C:\fw\midicontroller\x009\controller.c
000c2c   ffe6                                                                                                               
000c2e   c100     MOVFF     0x100,0xfe6                                                                                     
000c30   ffe6                                                                                                               
000c32   0e0c     MOVLW     0xc                                                                                             
000c34   6ee6     MOVWF     0xe6,0x0                                                                                        
000c36   ec24     CALL      0x3048,0x0                                                                                      
000c38   f018                                                                                                               
000c3a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c3c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c40   0efe     MOVLW     0xfe           	if (notify) {                                                                   C:\fw\midicontroller\x009\controller.c
000c42   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c44   e001     BZ        0xc48                                                                                           
                                           		/* show the program value: */                                                  C:\fw\midicontroller\x009\controller.c
000c46   dfc4     RCALL     0xbd0          		show_program();                                                                C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
000c48   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000c4a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c4c   ffd9                                                                                                               
000c4e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* activate current preset */                                                    C:\fw\midicontroller\x009\controller.c
000c50   cfd9     MOVFF     0xfd9,0xfe6    void preset_activate(u8 notify) {                                                C:\fw\midicontroller\x009\controller.c
000c52   ffe6                                                                                                               
000c54   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c56   ffd9                                                                                                               
                                           	/* grab the program # from the bank */                                          C:\fw\midicontroller\x009\controller.c
000c58   0100     MOVLB     0x0            	curr_program = bank[curr_preset];                                               C:\fw\midicontroller\x009\controller.c
000c5a   51f2     MOVF      0xf2,0x0,0x1                                                                                    
000c5c   6aea     CLRF      0xea,0x0                                                                                        
000c5e   0fdc     ADDLW     0xdc                                                                                            
000c60   6ee9     MOVWF     0xe9,0x0                                                                                        
000c62   0e00     MOVLW     0x0                                                                                             
000c64   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c66   cfef     MOVFF     0xfef,0xf1                                                                                      
000c68   f0f1                                                                                                               
000c6a   0efe     MOVLW     0xfe           	program_activate(notify);                                                       C:\fw\midicontroller\x009\controller.c
000c6c   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000c6e   ffe6                                                                                                               
000c70   dfd8     RCALL     0xc22                                                                                           
000c72   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* activate the footswitch LED: */                                              C:\fw\midicontroller\x009\controller.c
000c74   0100     MOVLB     0x0            	fsw_led_set_active(curr_preset);                                                C:\fw\midicontroller\x009\controller.c
000c76   51f2     MOVF      0xf2,0x0,0x1                                                                                    
000c78   6ee6     MOVWF     0xe6,0x0                                                                                        
000c7a   6ae6     CLRF      0xe6,0x0                                                                                        
000c7c   ecb5     CALL      0x2f6a,0x0                                                                                      
000c7e   f017                                                                                                               
000c80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c82   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c84   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000c86   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c88   ffd9                                                                                                               
000c8a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* display the sequence index on the 1-digit LED display: */                     C:\fw\midicontroller\x009\controller.c
                                           void bankmap_show() {                                                            C:\fw\midicontroller\x009\controller.c
000c8c   0100     MOVLB     0x0            	leds_show_1digit(curr_mapindex + 1);                                            C:\fw\midicontroller\x009\controller.c
000c8e   29f3     INCF      0xf3,0x0,0x1                                                                                    
000c90   6ee6     MOVWF     0xe6,0x0                                                                                        
000c92   ec40     CALL      0x3280,0x0                                                                                      
000c94   f019                                                                                                               
000c96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c98   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* activate the preset for the current bank map index */                         C:\fw\midicontroller\x009\controller.c
000c9a   cfd9     MOVFF     0xfd9,0xfe6    void bankmap_activate(u8 notify) {                                               C:\fw\midicontroller\x009\controller.c
000c9c   ffe6                                                                                                               
000c9e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ca0   ffd9                                                                                                               
                                           	/* switch preset */                                                             C:\fw\midicontroller\x009\controller.c
000ca2   c0f4     MOVFF     0xf4,0xf6      	loaded_bank = curr_bank;                                                        C:\fw\midicontroller\x009\controller.c
000ca4   f0f6                                                                                                               
000ca6   c0f5     MOVFF     0xf5,0xf7                                                                                       
000ca8   f0f7                                                                                                               
000caa   0100     MOVLB     0x0            	curr_preset = bankmap[curr_mapindex];                                           C:\fw\midicontroller\x009\controller.c
000cac   51f3     MOVF      0xf3,0x0,0x1                                                                                    
000cae   6aea     CLRF      0xea,0x0                                                                                        
000cb0   0fe4     ADDLW     0xe4                                                                                            
000cb2   6ee9     MOVWF     0xe9,0x0                                                                                        
000cb4   0e00     MOVLW     0x0                                                                                             
000cb6   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000cb8   cfef     MOVFF     0xfef,0xf2                                                                                      
000cba   f0f2                                                                                                               
000cbc   0efe     MOVLW     0xfe           	preset_activate(notify);                                                        C:\fw\midicontroller\x009\controller.c
000cbe   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000cc0   ffe6                                                                                                               
000cc2   dfc6     RCALL     0xc50                                                                                           
000cc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* always show the bank map index */                                            C:\fw\midicontroller\x009\controller.c
000cc6   dfe2     RCALL     0xc8c          	bankmap_show();                                                                 C:\fw\midicontroller\x009\controller.c
000cc8   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000cca   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ccc   ffd9                                                                                                               
000cce   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* load current bank but do not switch to a preset */                            C:\fw\midicontroller\x009\controller.c
000cd0   cfd9     MOVFF     0xfd9,0xfe6    void bank_activate(u8 notify) {                                                  C:\fw\midicontroller\x009\controller.c
000cd2   ffe6                                                                                                               
000cd4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000cd6   ffd9                                                                                                               
                                           	/* load up the selected bank: */                                                C:\fw\midicontroller\x009\controller.c
000cd8   0eec     MOVLW     0xec           	bank_load(curr_bank, bankname, bank, bankcontroller, bankmap, &bankmap_count);  C:\fw\midicontroller\x009\controller.c
000cda   6ee6     MOVWF     0xe6,0x0                                                                                        
000cdc   0e00     MOVLW     0x0                                                                                             
000cde   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce0   0ee4     MOVLW     0xe4                                                                                            
000ce2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce4   0e00     MOVLW     0x0                                                                                             
000ce6   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce8   0ee0     MOVLW     0xe0                                                                                            
000cea   6ee6     MOVWF     0xe6,0x0                                                                                        
000cec   0e00     MOVLW     0x0                                                                                             
000cee   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf0   0edc     MOVLW     0xdc                                                                                            
000cf2   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf4   0e00     MOVLW     0x0                                                                                             
000cf6   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf8   0eed     MOVLW     0xed                                                                                            
000cfa   6ee6     MOVWF     0xe6,0x0                                                                                        
000cfc   0e00     MOVLW     0x0                                                                                             
000cfe   6ee6     MOVWF     0xe6,0x0                                                                                        
000d00   c0f4     MOVFF     0xf4,0xfe6                                                                                      
000d02   ffe6                                                                                                               
000d04   c0f5     MOVFF     0xf5,0xfe6                                                                                      
000d06   ffe6                                                                                                               
000d08   ec04     CALL      0x3008,0x0                                                                                      
000d0a   f018                                                                                                               
000d0c   6e10     MOVWF     0x10,0x0                                                                                        
000d0e   0e0c     MOVLW     0xc                                                                                             
000d10   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000d12   5010     MOVF      0x10,0x0,0x0                                                                                    
000d14   0100     MOVLB     0x0            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x009\controller.c
000d16   6bf3     CLRF      0xf3,0x1                                                                                        
                                           	/* always show the bank map index */                                            C:\fw\midicontroller\x009\controller.c
000d18   29f3     INCF      0xf3,0x0,0x1   	leds_show_1digit(curr_mapindex + 1);                                            C:\fw\midicontroller\x009\controller.c
000d1a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d1c   ec40     CALL      0x3280,0x0                                                                                      
000d1e   f019                                                                                                               
000d20   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d22   0efe     MOVLW     0xfe           	if (notify) {                                                                   C:\fw\midicontroller\x009\controller.c
000d24   50db     MOVF      0xdb,0x0,0x0                                                                                    
000d26   e008     BZ        0xd38                                                                                           
                                           		/* display bank name: */                                                       C:\fw\midicontroller\x009\controller.c
000d28   0eed     MOVLW     0xed           		leds_show_4alphas(bankname);                                                   C:\fw\midicontroller\x009\controller.c
000d2a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d2c   0e00     MOVLW     0x0                                                                                             
000d2e   6ee6     MOVWF     0xe6,0x0                                                                                        
000d30   ec05     CALL      0x320a,0x0                                                                                      
000d32   f019                                                                                                               
000d34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d36   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
000d38   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000d3a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d3c   ffd9                                                                                                               
000d3e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* load the real bank # from the sorted index */                                 C:\fw\midicontroller\x009\controller.c
000d40   cfd9     MOVFF     0xfd9,0xfe6    void sortedbank_activate(u8 notify) {                                            C:\fw\midicontroller\x009\controller.c
000d42   ffe6                                                                                                               
000d44   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d46   ffd9                                                                                                               
000d48   c0f8     MOVFF     0xf8,0xfe6     	curr_bank = bank_getsortedindex(curr_sortedbank);                               C:\fw\midicontroller\x009\controller.c
000d4a   ffe6                                                                                                               
000d4c   c0f9     MOVFF     0xf9,0xfe6                                                                                      
000d4e   ffe6                                                                                                               
000d50   ec1c     CALL      0x3038,0x0                                                                                      
000d52   f018                                                                                                               
000d54   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d56   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d58   cff3     MOVFF     0xff3,0xf4                                                                                      
000d5a   f0f4                                                                                                               
000d5c   cff4     MOVFF     0xff4,0xf5                                                                                      
000d5e   f0f5                                                                                                               
000d60   0efe     MOVLW     0xfe           	bank_activate(notify);                                                          C:\fw\midicontroller\x009\controller.c
000d62   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000d64   ffe6                                                                                                               
000d66   dfb4     RCALL     0xcd0                                                                                           
000d68   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d6a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000d6c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d6e   ffd9                                                                                                               
000d70   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* load only current bank name and display it on 4-digit display */              C:\fw\midicontroller\x009\controller.c
                                           void bank_showname() {                                                           C:\fw\midicontroller\x009\controller.c
000d72   0eed     MOVLW     0xed           	bank_loadname(curr_bank, bankname);                                             C:\fw\midicontroller\x009\controller.c
000d74   6ee6     MOVWF     0xe6,0x0                                                                                        
000d76   0e00     MOVLW     0x0                                                                                             
000d78   6ee6     MOVWF     0xe6,0x0                                                                                        
000d7a   c0f4     MOVFF     0xf4,0xfe6                                                                                      
000d7c   ffe6                                                                                                               
000d7e   c0f5     MOVFF     0xf5,0xfe6                                                                                      
000d80   ffe6                                                                                                               
000d82   ec14     CALL      0x3028,0x0                                                                                      
000d84   f018                                                                                                               
000d86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8e   0eed     MOVLW     0xed           	leds_show_4alphas(bankname);                                                    C:\fw\midicontroller\x009\controller.c
000d90   6ee6     MOVWF     0xe6,0x0                                                                                        
000d92   0e00     MOVLW     0x0                                                                                             
000d94   6ee6     MOVWF     0xe6,0x0                                                                                        
000d96   ec05     CALL      0x320a,0x0                                                                                      
000d98   f019                                                                                                               
000d9a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9e   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* load only current bank name from the sorted index and display it on 4-digit display */ C:\fw\midicontroller\x009\controller.c
                                           void sortedbank_showname() {                                                     C:\fw\midicontroller\x009\controller.c
000da0   0101     MOVLB     0x1            	if (program_mode != PROGRAM_NONE) {                                             C:\fw\midicontroller\x009\controller.c
000da2   510f     MOVF      0xf,0x0,0x1                                                                                     
000da4   e009     BZ        0xdb8                                                                                           
000da6   0e98     MOVLW     0x98           		leds_show_4alphas("SEQ-");                                                     C:\fw\midicontroller\x009\controller.c
000da8   6ee6     MOVWF     0xe6,0x0                                                                                        
000daa   0e39     MOVLW     0x39                                                                                            
000dac   6ee6     MOVWF     0xe6,0x0                                                                                        
000dae   ec05     CALL      0x320a,0x0                                                                                      
000db0   f019                                                                                                               
000db2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db6   d022     BRA       0xdfc          	} else {                                                                        C:\fw\midicontroller\x009\controller.c
000db8   c0f8     MOVFF     0xf8,0xfe6     		curr_bank = bank_getsortedindex(curr_sortedbank);                              C:\fw\midicontroller\x009\controller.c
000dba   ffe6                                                                                                               
000dbc   c0f9     MOVFF     0xf9,0xfe6                                                                                      
000dbe   ffe6                                                                                                               
000dc0   ec1c     CALL      0x3038,0x0                                                                                      
000dc2   f018                                                                                                               
000dc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dc6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dc8   cff3     MOVFF     0xff3,0xf4                                                                                      
000dca   f0f4                                                                                                               
000dcc   cff4     MOVFF     0xff4,0xf5                                                                                      
000dce   f0f5                                                                                                               
000dd0   0eed     MOVLW     0xed           		bank_loadname(curr_bank, bankname);                                            C:\fw\midicontroller\x009\controller.c
000dd2   6ee6     MOVWF     0xe6,0x0                                                                                        
000dd4   0e00     MOVLW     0x0                                                                                             
000dd6   6ee6     MOVWF     0xe6,0x0                                                                                        
000dd8   c0f4     MOVFF     0xf4,0xfe6                                                                                      
000dda   ffe6                                                                                                               
000ddc   c0f5     MOVFF     0xf5,0xfe6                                                                                      
000dde   ffe6                                                                                                               
000de0   ec14     CALL      0x3028,0x0                                                                                      
000de2   f018                                                                                                               
000de4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000de6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000de8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dec   0eed     MOVLW     0xed           		leds_show_4alphas(bankname);                                                   C:\fw\midicontroller\x009\controller.c
000dee   6ee6     MOVWF     0xe6,0x0                                                                                        
000df0   0e00     MOVLW     0x0                                                                                             
000df2   6ee6     MOVWF     0xe6,0x0                                                                                        
000df4   ec05     CALL      0x320a,0x0                                                                                      
000df6   f019                                                                                                               
000df8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
000dfc   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* current and previous foot-switch states: */                                   C:\fw\midicontroller\x009\controller.c
                                           u32		sw_curr = 0, sw_last = 0;                                                   C:\fw\midicontroller\x009\controller.c
                                           u8		cc_curr = 0, cc_last = 0;                                                    C:\fw\midicontroller\x009\controller.c
                                           u8		switch_state = 0, store_state = 0;                                           C:\fw\midicontroller\x009\controller.c
                                           u8		incdec_mode = 0;                                                             C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* determine if a footswitch was pressed: */                                     C:\fw\midicontroller\x009\controller.c
000dfe   cfd9     MOVFF     0xfd9,0xfe6    u8 button_pressed(u32 mask) {                                                    C:\fw\midicontroller\x009\controller.c
000e00   ffe6                                                                                                               
000e02   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e04   ffd9                                                                                                               
000e06   0efd     MOVLW     0xfd           	return ((sw_curr & mask) == mask) && ((sw_last & mask) == 0);                   C:\fw\midicontroller\x009\controller.c
000e08   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e0a   0101     MOVLB     0x1                                                                                             
000e0c   1519     ANDWF     0x19,0x0,0x1                                                                                    
000e0e   0100     MOVLB     0x0                                                                                             
000e10   6e10     MOVWF     0x10,0x0                                                                                        
000e12   0efe     MOVLW     0xfe                                                                                            
000e14   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e16   0101     MOVLB     0x1                                                                                             
000e18   151a     ANDWF     0x1a,0x0,0x1                                                                                    
000e1a   0100     MOVLB     0x0                                                                                             
000e1c   6e11     MOVWF     0x11,0x0                                                                                        
000e1e   0efd     MOVLW     0xfd                                                                                            
000e20   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e22   1810     XORWF     0x10,0x0,0x0                                                                                    
000e24   e103     BNZ       0xe2c                                                                                           
000e26   0efe     MOVLW     0xfe                                                                                            
000e28   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e2a   1811     XORWF     0x11,0x0,0x0                                                                                    
000e2c   e10f     BNZ       0xe4c                                                                                           
000e2e   0efd     MOVLW     0xfd                                                                                            
000e30   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e32   0101     MOVLB     0x1                                                                                             
000e34   151b     ANDWF     0x1b,0x0,0x1                                                                                    
000e36   0100     MOVLB     0x0                                                                                             
000e38   6e12     MOVWF     0x12,0x0                                                                                        
000e3a   0efe     MOVLW     0xfe                                                                                            
000e3c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e3e   0101     MOVLB     0x1                                                                                             
000e40   151c     ANDWF     0x1c,0x0,0x1                                                                                    
000e42   0100     MOVLB     0x0                                                                                             
000e44   6e13     MOVWF     0x13,0x0                                                                                        
000e46   5012     MOVF      0x12,0x0,0x0                                                                                    
000e48   1013     IORWF     0x13,0x0,0x0                                                                                    
000e4a   e002     BZ        0xe50                                                                                           
000e4c   0e00     MOVLW     0x0                                                                                             
000e4e   d001     BRA       0xe52                                                                                           
000e50   0e01     MOVLW     0x1                                                                                             
000e52   d000     BRA       0xe54                                                                                           
000e54   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000e56   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e58   ffd9                                                                                                               
000e5a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* determine if still holding footswitch: */                                     C:\fw\midicontroller\x009\controller.c
000e5c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_held(u32 mask) {                                                       C:\fw\midicontroller\x009\controller.c
000e5e   ffe6                                                                                                               
000e60   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e62   ffd9                                                                                                               
000e64   0efd     MOVLW     0xfd           	return (sw_curr & mask) == mask;                                                C:\fw\midicontroller\x009\controller.c
000e66   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e68   0101     MOVLB     0x1                                                                                             
000e6a   1519     ANDWF     0x19,0x0,0x1                                                                                    
000e6c   0100     MOVLB     0x0                                                                                             
000e6e   6e10     MOVWF     0x10,0x0                                                                                        
000e70   0efe     MOVLW     0xfe                                                                                            
000e72   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e74   0101     MOVLB     0x1                                                                                             
000e76   151a     ANDWF     0x1a,0x0,0x1                                                                                    
000e78   0100     MOVLB     0x0                                                                                             
000e7a   6e11     MOVWF     0x11,0x0                                                                                        
000e7c   0efd     MOVLW     0xfd                                                                                            
000e7e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e80   1810     XORWF     0x10,0x0,0x0                                                                                    
000e82   e103     BNZ       0xe8a                                                                                           
000e84   0efe     MOVLW     0xfe                                                                                            
000e86   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e88   1811     XORWF     0x11,0x0,0x0                                                                                    
000e8a   e002     BZ        0xe90                                                                                           
000e8c   0e00     MOVLW     0x0                                                                                             
000e8e   d001     BRA       0xe92                                                                                           
000e90   0e01     MOVLW     0x1                                                                                             
000e92   d000     BRA       0xe94                                                                                           
000e94   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000e96   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e98   ffd9                                                                                                               
000e9a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* determine if a footswitch was released: */                                    C:\fw\midicontroller\x009\controller.c
000e9c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_released(u32 mask) {                                                   C:\fw\midicontroller\x009\controller.c
000e9e   ffe6                                                                                                               
000ea0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ea2   ffd9                                                                                                               
000ea4   0efd     MOVLW     0xfd           	return ((sw_last & mask) == mask) && ((sw_curr & mask) == 0);                   C:\fw\midicontroller\x009\controller.c
000ea6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ea8   0101     MOVLB     0x1                                                                                             
000eaa   151b     ANDWF     0x1b,0x0,0x1                                                                                    
000eac   0100     MOVLB     0x0                                                                                             
000eae   6e10     MOVWF     0x10,0x0                                                                                        
000eb0   0efe     MOVLW     0xfe                                                                                            
000eb2   50db     MOVF      0xdb,0x0,0x0                                                                                    
000eb4   0101     MOVLB     0x1                                                                                             
000eb6   151c     ANDWF     0x1c,0x0,0x1                                                                                    
000eb8   0100     MOVLB     0x0                                                                                             
000eba   6e11     MOVWF     0x11,0x0                                                                                        
000ebc   0efd     MOVLW     0xfd                                                                                            
000ebe   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ec0   1810     XORWF     0x10,0x0,0x0                                                                                    
000ec2   e103     BNZ       0xeca                                                                                           
000ec4   0efe     MOVLW     0xfe                                                                                            
000ec6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ec8   1811     XORWF     0x11,0x0,0x0                                                                                    
000eca   e10f     BNZ       0xeea                                                                                           
000ecc   0efd     MOVLW     0xfd                                                                                            
000ece   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ed0   0101     MOVLB     0x1                                                                                             
000ed2   1519     ANDWF     0x19,0x0,0x1                                                                                    
000ed4   0100     MOVLB     0x0                                                                                             
000ed6   6e12     MOVWF     0x12,0x0                                                                                        
000ed8   0efe     MOVLW     0xfe                                                                                            
000eda   50db     MOVF      0xdb,0x0,0x0                                                                                    
000edc   0101     MOVLB     0x1                                                                                             
000ede   151a     ANDWF     0x1a,0x0,0x1                                                                                    
000ee0   0100     MOVLB     0x0                                                                                             
000ee2   6e13     MOVWF     0x13,0x0                                                                                        
000ee4   5012     MOVF      0x12,0x0,0x0                                                                                    
000ee6   1013     IORWF     0x13,0x0,0x0                                                                                    
000ee8   e002     BZ        0xeee                                                                                           
000eea   0e00     MOVLW     0x0                                                                                             
000eec   d001     BRA       0xef0                                                                                           
000eee   0e01     MOVLW     0x1                                                                                             
000ef0   d000     BRA       0xef2                                                                                           
000ef2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\controller.c
000ef4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ef6   ffd9                                                                                                               
000ef8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* called every 10ms */                                                          C:\fw\midicontroller\x009\controller.c
                                           void controller_10msec_timer() {                                                 C:\fw\midicontroller\x009\controller.c
                                           	/* handle inc/dec acceleration: */                                              C:\fw\midicontroller\x009\controller.c
000efa   0101     MOVLB     0x1            	if (accel_state != ACCEL_NONE) {                                                C:\fw\midicontroller\x009\controller.c
000efc   510d     MOVF      0xd,0x0,0x1                                                                                     
000efe   e00a     BZ        0xf14                                                                                           
000f00   0100     MOVLB     0x0            		if (accel_time > 0) --accel_time;                                              C:\fw\midicontroller\x009\controller.c
000f02   0e00     MOVLW     0x0                                                                                             
000f04   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f06   55fc     SUBFWB    0xfc,0x0,0x1                                                                                    
000f08   0e00     MOVLW     0x0                                                                                             
000f0a   55fd     SUBFWB    0xfd,0x0,0x1                                                                                    
000f0c   e203     BC        0xf14                                                                                           
000f0e   07fc     DECF      0xfc,0x1,0x1                                                                                    
000f10   0e00     MOVLW     0x0                                                                                             
000f12   5bfd     SUBWFB    0xfd,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* handle simple count-down timers: */                                          C:\fw\midicontroller\x009\controller.c
000f14   0101     MOVLB     0x1            	if (cdtimer_store > 0) --cdtimer_store;                                         C:\fw\midicontroller\x009\controller.c
000f16   0e00     MOVLW     0x0                                                                                             
000f18   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f1a   5507     SUBFWB    0x7,0x0,0x1                                                                                     
000f1c   0e00     MOVLW     0x0                                                                                             
000f1e   5508     SUBFWB    0x8,0x0,0x1                                                                                     
000f20   e203     BC        0xf28                                                                                           
000f22   0707     DECF      0x7,0x1,0x1                                                                                     
000f24   0e00     MOVLW     0x0                                                                                             
000f26   5b08     SUBWFB    0x8,0x1,0x1                                                                                     
000f28   0e00     MOVLW     0x0            	if (cdtimer_incdec_held > 0) --cdtimer_incdec_held;                             C:\fw\midicontroller\x009\controller.c
000f2a   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f2c   5509     SUBFWB    0x9,0x0,0x1                                                                                     
000f2e   0e00     MOVLW     0x0                                                                                             
000f30   550a     SUBFWB    0xa,0x0,0x1                                                                                     
000f32   e203     BC        0xf3a                                                                                           
000f34   0709     DECF      0x9,0x1,0x1                                                                                     
000f36   0e00     MOVLW     0x0                                                                                             
000f38   5b0a     SUBWFB    0xa,0x1,0x1                                                                                     
000f3a   0e00     MOVLW     0x0            	if (cdtimer_value > 0) {                                                        C:\fw\midicontroller\x009\controller.c
000f3c   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f3e   5503     SUBFWB    0x3,0x0,0x1                                                                                     
000f40   0e00     MOVLW     0x0                                                                                             
000f42   5504     SUBFWB    0x4,0x0,0x1                                                                                     
000f44   e20c     BC        0xf5e                                                                                           
000f46   0703     DECF      0x3,0x1,0x1    		--cdtimer_value;                                                               C:\fw\midicontroller\x009\controller.c
000f48   0e00     MOVLW     0x0                                                                                             
000f4a   5b04     SUBWFB    0x4,0x1,0x1                                                                                     
000f4c   5103     MOVF      0x3,0x0,0x1    		if (cdtimer_value == 0) {                                                      C:\fw\midicontroller\x009\controller.c
000f4e   1104     IORWF     0x4,0x0,0x1                                                                                     
000f50   e106     BNZ       0xf5e                                                                                           
000f52   0100     MOVLB     0x0            			if (mode == MODE_CONCERT) bank_showname();                                    C:\fw\midicontroller\x009\controller.c
000f54   05ff     DECF      0xff,0x0,0x1                                                                                    
000f56   e102     BNZ       0xf5c                                                                                           
000f58   df0c     RCALL     0xd72                                                                                           
000f5a   d001     BRA       0xf5e          			else sortedbank_showname();                                                   C:\fw\midicontroller\x009\controller.c
000f5c   df21     RCALL     0xda0                                                                                           
                                           		}                                                                              C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
000f5e   0101     MOVLB     0x1            	if (cdtimer_holdenter > 0) --cdtimer_holdenter;                                 C:\fw\midicontroller\x009\controller.c
000f60   0e00     MOVLW     0x0                                                                                             
000f62   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f64   550b     SUBFWB    0xb,0x0,0x1                                                                                     
000f66   0e00     MOVLW     0x0                                                                                             
000f68   550c     SUBFWB    0xc,0x0,0x1                                                                                     
000f6a   e203     BC        0xf72                                                                                           
000f6c   070b     DECF      0xb,0x1,0x1                                                                                     
000f6e   0e00     MOVLW     0x0                                                                                             
000f70   5b0c     SUBWFB    0xc,0x1,0x1                                                                                     
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* handle LED flashing states: */                                               C:\fw\midicontroller\x009\controller.c
000f72   0e00     MOVLW     0x0            	if (cdtimer_flash > 0) {                                                        C:\fw\midicontroller\x009\controller.c
000f74   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f76   5505     SUBFWB    0x5,0x0,0x1                                                                                     
000f78   0e00     MOVLW     0x0                                                                                             
000f7a   5506     SUBFWB    0x6,0x0,0x1                                                                                     
000f7c   e301     BNC       0xf80                                                                                           
000f7e   d0bf     BRA       0x10fe                                                                                          
000f80   510e     MOVF      0xe,0x0,0x1    		switch (flash_state) {                                                         C:\fw\midicontroller\x009\controller.c
000f82   0a03     XORLW     0x3                                                                                             
000f84   e067     BZ        0x1054                                                                                          
000f86   0a01     XORLW     0x1                                                                                             
000f88   e01f     BZ        0xfc8                                                                                           
000f8a   0a03     XORLW     0x3                                                                                             
000f8c   e001     BZ        0xf90                                                                                           
000f8e   d0a8     BRA       0x10e0                                                                                          
                                           			case FLASH_STORE:                                                             C:\fw\midicontroller\x009\controller.c
000f90   5105     MOVF      0x5,0x0,0x1    				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x009\controller.c
000f92   0b1f     ANDLW     0x1f                                                                                            
000f94   e108     BNZ       0xfa6                                                                                           
000f96   5110     MOVF      0x10,0x0,0x1   					fsw_led_enable(flash_led);                                                  C:\fw\midicontroller\x009\controller.c
000f98   6ee6     MOVWF     0xe6,0x0                                                                                        
000f9a   6ae6     CLRF      0xe6,0x0                                                                                        
000f9c   eccb     CALL      0x2f96,0x0                                                                                      
000f9e   f017                                                                                                               
000fa0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa4   d010     BRA       0xfc6          				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x009\controller.c
000fa6   0e1f     MOVLW     0x1f                                                                                            
000fa8   1505     ANDWF     0x5,0x0,0x1                                                                                     
000faa   6e10     MOVWF     0x10,0x0                                                                                        
000fac   6a11     CLRF      0x11,0x0                                                                                        
000fae   0e0f     MOVLW     0xf                                                                                             
000fb0   1810     XORWF     0x10,0x0,0x0                                                                                    
000fb2   e101     BNZ       0xfb6                                                                                           
000fb4   5011     MOVF      0x11,0x0,0x0                                                                                    
000fb6   e107     BNZ       0xfc6                                                                                           
000fb8   5110     MOVF      0x10,0x0,0x1   					fsw_led_disable(flash_led);                                                 C:\fw\midicontroller\x009\controller.c
000fba   6ee6     MOVWF     0xe6,0x0                                                                                        
000fbc   6ae6     CLRF      0xe6,0x0                                                                                        
000fbe   ecdf     CALL      0x2fbe,0x0                                                                                      
000fc0   f017                                                                                                               
000fc2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x009\controller.c
000fc6   d08c     BRA       0x10e0         				break;                                                                       C:\fw\midicontroller\x009\controller.c
                                           			case FLASH_BANK_SELECT_MODE:                                                  C:\fw\midicontroller\x009\controller.c
000fc8   5105     MOVF      0x5,0x0,0x1    				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x009\controller.c
000fca   0b1f     ANDLW     0x1f                                                                                            
000fcc   e11d     BNZ       0x1008                                                                                          
000fce   0e00     MOVLW     0x0            					fsw_led_enable(0);                                                          C:\fw\midicontroller\x009\controller.c
000fd0   6ee6     MOVWF     0xe6,0x0                                                                                        
000fd2   6ae6     CLRF      0xe6,0x0                                                                                        
000fd4   eccb     CALL      0x2f96,0x0                                                                                      
000fd6   f017                                                                                                               
000fd8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fda   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fdc   0e01     MOVLW     0x1            					fsw_led_enable(1);                                                          C:\fw\midicontroller\x009\controller.c
000fde   6ee6     MOVWF     0xe6,0x0                                                                                        
000fe0   6ae6     CLRF      0xe6,0x0                                                                                        
000fe2   eccb     CALL      0x2f96,0x0                                                                                      
000fe4   f017                                                                                                               
000fe6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fe8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fea   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x009\controller.c
000fec   6ee6     MOVWF     0xe6,0x0                                                                                        
000fee   6ae6     CLRF      0xe6,0x0                                                                                        
000ff0   ecdf     CALL      0x2fbe,0x0                                                                                      
000ff2   f017                                                                                                               
000ff4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ff6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ff8   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x009\controller.c
000ffa   6ee6     MOVWF     0xe6,0x0                                                                                        
000ffc   6ae6     CLRF      0xe6,0x0                                                                                        
000ffe   ecdf     CALL      0x2fbe,0x0                                                                                      
001000   f017                                                                                                               
001002   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001004   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001006   d025     BRA       0x1052         				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x009\controller.c
001008   0e1f     MOVLW     0x1f                                                                                            
00100a   1505     ANDWF     0x5,0x0,0x1                                                                                     
00100c   6e10     MOVWF     0x10,0x0                                                                                        
00100e   6a11     CLRF      0x11,0x0                                                                                        
001010   0e0f     MOVLW     0xf                                                                                             
001012   1810     XORWF     0x10,0x0,0x0                                                                                    
001014   e101     BNZ       0x1018                                                                                          
001016   5011     MOVF      0x11,0x0,0x0                                                                                    
001018   e11c     BNZ       0x1052                                                                                          
00101a   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x009\controller.c
00101c   6ee6     MOVWF     0xe6,0x0                                                                                        
00101e   6ae6     CLRF      0xe6,0x0                                                                                        
001020   ecdf     CALL      0x2fbe,0x0                                                                                      
001022   f017                                                                                                               
001024   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001026   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001028   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x009\controller.c
00102a   6ee6     MOVWF     0xe6,0x0                                                                                        
00102c   6ae6     CLRF      0xe6,0x0                                                                                        
00102e   ecdf     CALL      0x2fbe,0x0                                                                                      
001030   f017                                                                                                               
001032   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001034   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001036   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x009\controller.c
001038   6ee6     MOVWF     0xe6,0x0                                                                                        
00103a   6ae6     CLRF      0xe6,0x0                                                                                        
00103c   ecdf     CALL      0x2fbe,0x0                                                                                      
00103e   f017                                                                                                               
001040   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001042   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001044   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x009\controller.c
001046   6ee6     MOVWF     0xe6,0x0                                                                                        
001048   6ae6     CLRF      0xe6,0x0                                                                                        
00104a   ecdf     CALL      0x2fbe,0x0                                                                                      
00104c   f017                                                                                                               
00104e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001050   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x009\controller.c
001052   d046     BRA       0x10e0         				break;                                                                       C:\fw\midicontroller\x009\controller.c
                                           			case FLASH_PRGM_SELECT_MODE:                                                  C:\fw\midicontroller\x009\controller.c
001054   5105     MOVF      0x5,0x0,0x1    				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x009\controller.c
001056   0b1f     ANDLW     0x1f                                                                                            
001058   e11d     BNZ       0x1094                                                                                          
00105a   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x009\controller.c
00105c   6ee6     MOVWF     0xe6,0x0                                                                                        
00105e   6ae6     CLRF      0xe6,0x0                                                                                        
001060   ecdf     CALL      0x2fbe,0x0                                                                                      
001062   f017                                                                                                               
001064   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001066   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001068   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x009\controller.c
00106a   6ee6     MOVWF     0xe6,0x0                                                                                        
00106c   6ae6     CLRF      0xe6,0x0                                                                                        
00106e   ecdf     CALL      0x2fbe,0x0                                                                                      
001070   f017                                                                                                               
001072   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001074   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001076   0e02     MOVLW     0x2            					fsw_led_enable(2);                                                          C:\fw\midicontroller\x009\controller.c
001078   6ee6     MOVWF     0xe6,0x0                                                                                        
00107a   6ae6     CLRF      0xe6,0x0                                                                                        
00107c   eccb     CALL      0x2f96,0x0                                                                                      
00107e   f017                                                                                                               
001080   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001082   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001084   0e03     MOVLW     0x3            					fsw_led_enable(3);                                                          C:\fw\midicontroller\x009\controller.c
001086   6ee6     MOVWF     0xe6,0x0                                                                                        
001088   6ae6     CLRF      0xe6,0x0                                                                                        
00108a   eccb     CALL      0x2f96,0x0                                                                                      
00108c   f017                                                                                                               
00108e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001090   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001092   d025     BRA       0x10de         				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x009\controller.c
001094   0e1f     MOVLW     0x1f                                                                                            
001096   1505     ANDWF     0x5,0x0,0x1                                                                                     
001098   6e10     MOVWF     0x10,0x0                                                                                        
00109a   6a11     CLRF      0x11,0x0                                                                                        
00109c   0e0f     MOVLW     0xf                                                                                             
00109e   1810     XORWF     0x10,0x0,0x0                                                                                    
0010a0   e101     BNZ       0x10a4                                                                                          
0010a2   5011     MOVF      0x11,0x0,0x0                                                                                    
0010a4   e11c     BNZ       0x10de                                                                                          
0010a6   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x009\controller.c
0010a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0010aa   6ae6     CLRF      0xe6,0x0                                                                                        
0010ac   ecdf     CALL      0x2fbe,0x0                                                                                      
0010ae   f017                                                                                                               
0010b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b4   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x009\controller.c
0010b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0010b8   6ae6     CLRF      0xe6,0x0                                                                                        
0010ba   ecdf     CALL      0x2fbe,0x0                                                                                      
0010bc   f017                                                                                                               
0010be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c2   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x009\controller.c
0010c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0010c6   6ae6     CLRF      0xe6,0x0                                                                                        
0010c8   ecdf     CALL      0x2fbe,0x0                                                                                      
0010ca   f017                                                                                                               
0010cc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010ce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010d0   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x009\controller.c
0010d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0010d4   6ae6     CLRF      0xe6,0x0                                                                                        
0010d6   ecdf     CALL      0x2fbe,0x0                                                                                      
0010d8   f017                                                                                                               
0010da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x009\controller.c
0010de   d000     BRA       0x10e0         				break;                                                                       C:\fw\midicontroller\x009\controller.c
                                           		}                                                                              C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
0010e0   0101     MOVLB     0x1            		--cdtimer_flash;                                                               C:\fw\midicontroller\x009\controller.c
0010e2   0705     DECF      0x5,0x1,0x1                                                                                     
0010e4   0e00     MOVLW     0x0                                                                                             
0010e6   5b06     SUBWFB    0x6,0x1,0x1                                                                                     
0010e8   5105     MOVF      0x5,0x0,0x1    		if (cdtimer_flash == 0) {                                                      C:\fw\midicontroller\x009\controller.c
0010ea   1106     IORWF     0x6,0x0,0x1                                                                                     
0010ec   e108     BNZ       0x10fe                                                                                          
                                           			/* reset LEDs to proper state */                                              C:\fw\midicontroller\x009\controller.c
0010ee   0100     MOVLB     0x0            			fsw_led_set_active(curr_preset);                                              C:\fw\midicontroller\x009\controller.c
0010f0   51f2     MOVF      0xf2,0x0,0x1                                                                                    
0010f2   6ee6     MOVWF     0xe6,0x0                                                                                        
0010f4   6ae6     CLRF      0xe6,0x0                                                                                        
0010f6   ecb5     CALL      0x2f6a,0x0                                                                                      
0010f8   f017                                                                                                               
0010fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
0010fe   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           void inc_practice_value() {                                                      C:\fw\midicontroller\x009\controller.c
001100   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x009\controller.c
001102   5121     MOVF      0x21,0x0,0x1                                                                                    
001104   e115     BNZ       0x1130                                                                                          
001106   c0fa     MOVFF     0xfa,0x10      		if (curr_sortedbank == bank_count - 1) curr_sortedbank = 0;                    C:\fw\midicontroller\x009\controller.c
001108   f010                                                                                                               
00110a   c0fb     MOVFF     0xfb,0x11                                                                                       
00110c   f011                                                                                                               
00110e   0610     DECF      0x10,0x1,0x0                                                                                    
001110   0e00     MOVLW     0x0                                                                                             
001112   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001114   5010     MOVF      0x10,0x0,0x0                                                                                    
001116   0100     MOVLB     0x0                                                                                             
001118   19f8     XORWF     0xf8,0x0,0x1                                                                                    
00111a   e102     BNZ       0x1120                                                                                          
00111c   5011     MOVF      0x11,0x0,0x0                                                                                    
00111e   19f9     XORWF     0xf9,0x0,0x1                                                                                    
001120   e103     BNZ       0x1128                                                                                          
001122   6bf8     CLRF      0xf8,0x1                                                                                        
001124   6bf9     CLRF      0xf9,0x1                                                                                        
001126   d003     BRA       0x112e         		else ++curr_sortedbank;                                                        C:\fw\midicontroller\x009\controller.c
001128   2bf8     INCF      0xf8,0x1,0x1                                                                                    
00112a   0e00     MOVLW     0x0                                                                                             
00112c   23f9     ADDWFC    0xf9,0x1,0x1                                                                                    
00112e   d007     BRA       0x113e         	} else {                                                                        C:\fw\midicontroller\x009\controller.c
001130   0e7f     MOVLW     0x7f           		if (curr_program == 127) curr_program = 0;                                     C:\fw\midicontroller\x009\controller.c
001132   0100     MOVLB     0x0                                                                                             
001134   5df1     SUBWF     0xf1,0x0,0x1                                                                                    
001136   e102     BNZ       0x113c                                                                                          
001138   6bf1     CLRF      0xf1,0x1                                                                                        
00113a   d001     BRA       0x113e         		else ++curr_program;                                                           C:\fw\midicontroller\x009\controller.c
00113c   2bf1     INCF      0xf1,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
00113e   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           void dec_practice_value() {                                                      C:\fw\midicontroller\x009\controller.c
001140   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x009\controller.c
001142   5121     MOVF      0x21,0x0,0x1                                                                                    
001144   e111     BNZ       0x1168                                                                                          
001146   0100     MOVLB     0x0            		if (curr_sortedbank == 0) curr_sortedbank = bank_count - 1;                    C:\fw\midicontroller\x009\controller.c
001148   51f8     MOVF      0xf8,0x0,0x1                                                                                    
00114a   11f9     IORWF     0xf9,0x0,0x1                                                                                    
00114c   e109     BNZ       0x1160                                                                                          
00114e   c0fa     MOVFF     0xfa,0xf8                                                                                       
001150   f0f8                                                                                                               
001152   c0fb     MOVFF     0xfb,0xf9                                                                                       
001154   f0f9                                                                                                               
001156   0e01     MOVLW     0x1                                                                                             
001158   5ff8     SUBWF     0xf8,0x1,0x1                                                                                    
00115a   0e00     MOVLW     0x0                                                                                             
00115c   5bf9     SUBWFB    0xf9,0x1,0x1                                                                                    
00115e   d003     BRA       0x1166         		else --curr_sortedbank;                                                        C:\fw\midicontroller\x009\controller.c
001160   07f8     DECF      0xf8,0x1,0x1                                                                                    
001162   0e00     MOVLW     0x0                                                                                             
001164   5bf9     SUBWFB    0xf9,0x1,0x1                                                                                    
001166   d007     BRA       0x1176         	} else {                                                                        C:\fw\midicontroller\x009\controller.c
001168   0100     MOVLB     0x0            		if (curr_program == 0) curr_program = 127;                                     C:\fw\midicontroller\x009\controller.c
00116a   51f1     MOVF      0xf1,0x0,0x1                                                                                    
00116c   e103     BNZ       0x1174                                                                                          
00116e   0e7f     MOVLW     0x7f                                                                                            
001170   6ff1     MOVWF     0xf1,0x1                                                                                        
001172   d001     BRA       0x1176         		else --curr_program;                                                           C:\fw\midicontroller\x009\controller.c
001174   07f1     DECF      0xf1,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
001176   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           void notify_practice_value() {                                                   C:\fw\midicontroller\x009\controller.c
001178   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x009\controller.c
00117a   5121     MOVF      0x21,0x0,0x1                                                                                    
00117c   e102     BNZ       0x1182                                                                                          
00117e   de10     RCALL     0xda0          		sortedbank_showname();                                                         C:\fw\midicontroller\x009\controller.c
001180   d001     BRA       0x1184         	} else {                                                                        C:\fw\midicontroller\x009\controller.c
001182   dd26     RCALL     0xbd0          		show_program();                                                                C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
001184   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           void activate_practice_value() {                                                 C:\fw\midicontroller\x009\controller.c
001186   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x009\controller.c
001188   5121     MOVF      0x21,0x0,0x1                                                                                    
00118a   e104     BNZ       0x1194                                                                                          
00118c   6ae6     CLRF      0xe6,0x0       		sortedbank_activate(0);                                                        C:\fw\midicontroller\x009\controller.c
00118e   ddd8     RCALL     0xd40                                                                                           
001190   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001192   d004     BRA       0x119c         	} else {                                                                        C:\fw\midicontroller\x009\controller.c
001194   0e01     MOVLW     0x1            		program_activate(1);                                                           C:\fw\midicontroller\x009\controller.c
001196   6ee6     MOVWF     0xe6,0x0                                                                                        
001198   dd44     RCALL     0xc22                                                                                           
00119a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
00119c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* sequence programming completed, set state to repeat the sequence back: */     C:\fw\midicontroller\x009\controller.c
                                           void sequence_complete() {                                                       C:\fw\midicontroller\x009\controller.c
                                           	/* set the sequence length and store to the ROM: */                             C:\fw\midicontroller\x009\controller.c
00119e   c0f3     MOVFF     0xf3,0xec      	bankmap_count = curr_mapindex;                                                  C:\fw\midicontroller\x009\controller.c
0011a0   f0ec                                                                                                               
0011a2   c0ec     MOVFF     0xec,0xfe6     	bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);            C:\fw\midicontroller\x009\controller.c
0011a4   ffe6                                                                                                               
0011a6   0ee4     MOVLW     0xe4                                                                                            
0011a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011aa   0e00     MOVLW     0x0                                                                                             
0011ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0011ae   0ee0     MOVLW     0xe0                                                                                            
0011b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b2   0e00     MOVLW     0x0                                                                                             
0011b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b6   0edc     MOVLW     0xdc                                                                                            
0011b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011ba   0e00     MOVLW     0x0                                                                                             
0011bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0011be   c0f4     MOVFF     0xf4,0xfe6                                                                                      
0011c0   ffe6                                                                                                               
0011c2   c0f5     MOVFF     0xf5,0xfe6                                                                                      
0011c4   ffe6                                                                                                               
0011c6   ec0c     CALL      0x3018,0x0                                                                                      
0011c8   f018                                                                                                               
0011ca   6e10     MOVWF     0x10,0x0                                                                                        
0011cc   0e09     MOVLW     0x9                                                                                             
0011ce   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0011d0   5010     MOVF      0x10,0x0,0x0                                                                                    
                                           	/* set up state to repeat the stored sequence back on the preset LEDs: */       C:\fw\midicontroller\x009\controller.c
0011d2   0101     MOVLB     0x1            	program_mode = PROGRAM_COMPLETE;                                                C:\fw\midicontroller\x009\controller.c
0011d4   0e02     MOVLW     0x2                                                                                             
0011d6   6f0f     MOVWF     0xf,0x1                                                                                         
0011d8   0e32     MOVLW     0x32           	cdtimer_holdenter = 50;                                                         C:\fw\midicontroller\x009\controller.c
0011da   6f0b     MOVWF     0xb,0x1                                                                                         
0011dc   6b0c     CLRF      0xc,0x1                                                                                         
0011de   0100     MOVLB     0x0            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x009\controller.c
0011e0   6bf3     CLRF      0xf3,0x1                                                                                        
0011e2   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* set the controller to an initial state */                                     C:\fw\midicontroller\x009\controller.c
                                           void controller_init() {                                                         C:\fw\midicontroller\x009\controller.c
0011e4   ec03     CALL      0x3006,0x0     	bank_count = banks_count();                                                     C:\fw\midicontroller\x009\controller.c
0011e6   f018                                                                                                               
0011e8   cff3     MOVFF     0xff3,0xfa                                                                                      
0011ea   f0fa                                                                                                               
0011ec   cff4     MOVFF     0xff4,0xfb                                                                                      
0011ee   f0fb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
0011f0   0100     MOVLB     0x0            	curr_bank = 0;                                                                  C:\fw\midicontroller\x009\controller.c
0011f2   6bf4     CLRF      0xf4,0x1                                                                                        
0011f4   6bf5     CLRF      0xf5,0x1                                                                                        
0011f6   0e01     MOVLW     0x1            	bank_activate(1);                                                               C:\fw\midicontroller\x009\controller.c
0011f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011fa   dd6a     RCALL     0xcd0                                                                                           
0011fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\controller.c
0011fe   0100     MOVLB     0x0            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x009\controller.c
001200   6bf3     CLRF      0xf3,0x1                                                                                        
001202   0e01     MOVLW     0x1            	bankmap_activate(1);                                                            C:\fw\midicontroller\x009\controller.c
001204   6ee6     MOVWF     0xe6,0x0                                                                                        
001206   dd49     RCALL     0xc9a                                                                                           
001208   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x009\controller.c
00120a   0e00     MOVLW     0x0            	sw_curr = sw_last = 0;                                                          C:\fw\midicontroller\x009\controller.c
00120c   0101     MOVLB     0x1                                                                                             
00120e   6f1b     MOVWF     0x1b,0x1                                                                                        
001210   6b1c     CLRF      0x1c,0x1                                                                                        
001212   6f19     MOVWF     0x19,0x1                                                                                        
001214   6b1a     CLRF      0x1a,0x1                                                                                        
001216   ecfe     CALL      0x2ffc,0x0     	cc_curr = cc_last = expr_poll();                                                C:\fw\midicontroller\x009\controller.c
001218   f017                                                                                                               
00121a   0101     MOVLB     0x1                                                                                             
00121c   6f1e     MOVWF     0x1e,0x1                                                                                        
00121e   6f1d     MOVWF     0x1d,0x1                                                                                        
001220   ecf9     CALL      0x2ff2,0x0     	mode = slider_poll();                                                           C:\fw\midicontroller\x009\controller.c
001222   f017                                                                                                               
001224   0100     MOVLB     0x0                                                                                             
001226   6fff     MOVWF     0xff,0x1                                                                                        
001228   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           /* main control loop */                                                          C:\fw\midicontroller\x009\controller.c
                                           void controller_handle() {                                                       C:\fw\midicontroller\x009\controller.c
                                           	/* poll foot-switch depression status: */                                       C:\fw\midicontroller\x009\controller.c
00122a   ec71     CALL      0x2ee2,0x0     	sw_curr = fsw_poll();                                                           C:\fw\midicontroller\x009\controller.c
00122c   f017                                                                                                               
00122e   cff3     MOVFF     0xff3,0x119                                                                                     
001230   f119                                                                                                               
001232   cff4     MOVFF     0xff4,0x11a                                                                                     
001234   f11a                                                                                                               
                                           	/* poll expression pedal value: */                                              C:\fw\midicontroller\x009\controller.c
001236   ecfe     CALL      0x2ffc,0x0     	cc_curr = expr_poll();                                                          C:\fw\midicontroller\x009\controller.c
001238   f017                                                                                                               
00123a   0101     MOVLB     0x1                                                                                             
00123c   6f1d     MOVWF     0x1d,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* send CC message only if changed: */                                          C:\fw\midicontroller\x009\controller.c
00123e   511e     MOVF      0x1e,0x0,0x1   	if (cc_curr != cc_last) {                                                       C:\fw\midicontroller\x009\controller.c
001240   5d1d     SUBWF     0x1d,0x0,0x1                                                                                    
001242   e016     BZ        0x1270                                                                                          
001244   0e7f     MOVLW     0x7f           		midi_send_cmd2(0xB, midi_channel, bankcontroller[curr_preset], cc_curr & 0x7F); C:\fw\midicontroller\x009\controller.c
001246   151d     ANDWF     0x1d,0x0,0x1                                                                                    
001248   6ee6     MOVWF     0xe6,0x0                                                                                        
00124a   0100     MOVLB     0x0                                                                                             
00124c   51f2     MOVF      0xf2,0x0,0x1                                                                                    
00124e   6aea     CLRF      0xea,0x0                                                                                        
001250   0fe0     ADDLW     0xe0                                                                                            
001252   6ee9     MOVWF     0xe9,0x0                                                                                        
001254   0e00     MOVLW     0x0                                                                                             
001256   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001258   50ef     MOVF      0xef,0x0,0x0                                                                                    
00125a   6ee6     MOVWF     0xe6,0x0                                                                                        
00125c   c100     MOVFF     0x100,0xfe6                                                                                     
00125e   ffe6                                                                                                               
001260   0e0b     MOVLW     0xb                                                                                             
001262   6ee6     MOVWF     0xe6,0x0                                                                                        
001264   ec2c     CALL      0x3058,0x0                                                                                      
001266   f018                                                                                                               
001268   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* determine mode */                                                            C:\fw\midicontroller\x009\controller.c
001270   ecf9     CALL      0x2ff2,0x0     	if (slider_poll() == 0) {                                                       C:\fw\midicontroller\x009\controller.c
001272   f017                                                                                                               
001274   0900     IORLW     0x0                                                                                             
001276   e110     BNZ       0x1298                                                                                          
001278   0100     MOVLB     0x0            		if (mode == MODE_CONCERT) {                                                    C:\fw\midicontroller\x009\controller.c
00127a   05ff     DECF      0xff,0x0,0x1                                                                                    
00127c   e10c     BNZ       0x1296                                                                                          
                                           			/* switched from CONCERT to PRACTICE */                                       C:\fw\midicontroller\x009\controller.c
00127e   6bff     CLRF      0xff,0x1       			mode = MODE_PRACTICE;                                                         C:\fw\midicontroller\x009\controller.c
                                           			/* load the alphabetically first bank and start from the beginning of its program */ C:\fw\midicontroller\x009\controller.c
001280   6bf8     CLRF      0xf8,0x1       			curr_sortedbank = 0;                                                          C:\fw\midicontroller\x009\controller.c
001282   6bf9     CLRF      0xf9,0x1                                                                                        
001284   0e01     MOVLW     0x1            			sortedbank_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
001286   6ee6     MOVWF     0xe6,0x0                                                                                        
001288   dd5b     RCALL     0xd40                                                                                           
00128a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00128c   0100     MOVLB     0x0            			curr_mapindex = 0;                                                            C:\fw\midicontroller\x009\controller.c
00128e   6bf3     CLRF      0xf3,0x1                                                                                        
001290   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          C:\fw\midicontroller\x009\controller.c
001292   dd03     RCALL     0xc9a                                                                                           
001294   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x009\controller.c
001296   d00f     BRA       0x12b6         	} else {                                                                        C:\fw\midicontroller\x009\controller.c
001298   0100     MOVLB     0x0            		if (mode == MODE_PRACTICE) {                                                   C:\fw\midicontroller\x009\controller.c
00129a   51ff     MOVF      0xff,0x0,0x1                                                                                    
00129c   e10c     BNZ       0x12b6                                                                                          
                                           			/* switched from PRACTICE to CONCERT */                                       C:\fw\midicontroller\x009\controller.c
00129e   0e01     MOVLW     0x1            			mode = MODE_CONCERT;                                                          C:\fw\midicontroller\x009\controller.c
0012a0   6fff     MOVWF     0xff,0x1                                                                                        
                                           			/* load the sequentially first bank and start from the beginning of its program */ C:\fw\midicontroller\x009\controller.c
0012a2   6bf4     CLRF      0xf4,0x1       			curr_bank = 0;                                                                C:\fw\midicontroller\x009\controller.c
0012a4   6bf5     CLRF      0xf5,0x1                                                                                        
0012a6   6ee6     MOVWF     0xe6,0x0       			bank_activate(1);                                                             C:\fw\midicontroller\x009\controller.c
0012a8   dd13     RCALL     0xcd0                                                                                           
0012aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012ac   0100     MOVLB     0x0            			curr_mapindex = 0;                                                            C:\fw\midicontroller\x009\controller.c
0012ae   6bf3     CLRF      0xf3,0x1                                                                                        
0012b0   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          C:\fw\midicontroller\x009\controller.c
0012b2   dcf3     RCALL     0xc9a                                                                                           
0012b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* NEXT never changes function depending on mode */                             C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* NEXT pressed: */                                                             C:\fw\midicontroller\x009\controller.c
0012b6   0e00     MOVLW     0x0            	if (button_pressed(FSM_NEXT)) {                                                 C:\fw\midicontroller\x009\controller.c
0012b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0012ba   6ae6     CLRF      0xe6,0x0                                                                                        
0012bc   dda0     RCALL     0xdfe                                                                                           
0012be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012c2   0900     IORLW     0x0                                                                                             
0012c4   e04b     BZ        0x135c                                                                                          
0012c6   0100     MOVLB     0x0            		if (loaded_bank != curr_bank) {                                                C:\fw\midicontroller\x009\controller.c
0012c8   51f4     MOVF      0xf4,0x0,0x1                                                                                    
0012ca   19f6     XORWF     0xf6,0x0,0x1                                                                                    
0012cc   e102     BNZ       0x12d2                                                                                          
0012ce   51f5     MOVF      0xf5,0x0,0x1                                                                                    
0012d0   19f7     XORWF     0xf7,0x0,0x1                                                                                    
0012d2   e005     BZ        0x12de                                                                                          
                                           			/* prepared to switch to a bank, but did not activate the first map */        C:\fw\midicontroller\x009\controller.c
0012d4   0e01     MOVLW     0x1            			bankmap_activate(1);                                                          C:\fw\midicontroller\x009\controller.c
0012d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0012d8   dce0     RCALL     0xc9a                                                                                           
0012da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012dc   d03f     BRA       0x135c         		} else {                                                                       C:\fw\midicontroller\x009\controller.c
0012de   05ec     DECF      0xec,0x0,0x1   			if (curr_mapindex == bankmap_count - 1) {                                     C:\fw\midicontroller\x009\controller.c
0012e0   5df3     SUBWF     0xf3,0x0,0x1                                                                                    
0012e2   e137     BNZ       0x1352                                                                                          
                                           				/* crossed the upper bank-map boundary, load the next bank */                C:\fw\midicontroller\x009\controller.c
0012e4   51ff     MOVF      0xff,0x0,0x1   				if (mode == MODE_PRACTICE) {                                                 C:\fw\midicontroller\x009\controller.c
0012e6   e118     BNZ       0x1318                                                                                          
                                           					/* PRACTICE mode cycles through banks by sorted index #: */                 C:\fw\midicontroller\x009\controller.c
0012e8   c0fa     MOVFF     0xfa,0x10      					if (curr_sortedbank == bank_count - 1) {                                    C:\fw\midicontroller\x009\controller.c
0012ea   f010                                                                                                               
0012ec   c0fb     MOVFF     0xfb,0x11                                                                                       
0012ee   f011                                                                                                               
0012f0   0610     DECF      0x10,0x1,0x0                                                                                    
0012f2   0e00     MOVLW     0x0                                                                                             
0012f4   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
0012f6   5010     MOVF      0x10,0x0,0x0                                                                                    
0012f8   19f8     XORWF     0xf8,0x0,0x1                                                                                    
0012fa   e102     BNZ       0x1300                                                                                          
0012fc   5011     MOVF      0x11,0x0,0x0                                                                                    
0012fe   19f9     XORWF     0xf9,0x0,0x1                                                                                    
001300   e103     BNZ       0x1308                                                                                          
001302   6bf8     CLRF      0xf8,0x1       						curr_sortedbank = 0;                                                       C:\fw\midicontroller\x009\controller.c
001304   6bf9     CLRF      0xf9,0x1                                                                                        
001306   d003     BRA       0x130e         					} else {                                                                    C:\fw\midicontroller\x009\controller.c
001308   2bf8     INCF      0xf8,0x1,0x1   						++curr_sortedbank;                                                         C:\fw\midicontroller\x009\controller.c
00130a   0e00     MOVLW     0x0                                                                                             
00130c   23f9     ADDWFC    0xf9,0x1,0x1                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* show the bank name */                                                    C:\fw\midicontroller\x009\controller.c
00130e   0e01     MOVLW     0x1            					sortedbank_activate(1);                                                     C:\fw\midicontroller\x009\controller.c
001310   6ee6     MOVWF     0xe6,0x0                                                                                        
001312   dd16     RCALL     0xd40                                                                                           
001314   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001316   d017     BRA       0x1346         				} else {                                                                     C:\fw\midicontroller\x009\controller.c
                                           					/* CONCERT mode cycles through banks by index #: */                         C:\fw\midicontroller\x009\controller.c
001318   c0fa     MOVFF     0xfa,0x10      					if (curr_bank == bank_count - 1) {                                          C:\fw\midicontroller\x009\controller.c
00131a   f010                                                                                                               
00131c   c0fb     MOVFF     0xfb,0x11                                                                                       
00131e   f011                                                                                                               
001320   0610     DECF      0x10,0x1,0x0                                                                                    
001322   0e00     MOVLW     0x0                                                                                             
001324   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001326   5010     MOVF      0x10,0x0,0x0                                                                                    
001328   19f4     XORWF     0xf4,0x0,0x1                                                                                    
00132a   e102     BNZ       0x1330                                                                                          
00132c   5011     MOVF      0x11,0x0,0x0                                                                                    
00132e   19f5     XORWF     0xf5,0x0,0x1                                                                                    
001330   e103     BNZ       0x1338                                                                                          
001332   6bf4     CLRF      0xf4,0x1       						curr_bank = 0;                                                             C:\fw\midicontroller\x009\controller.c
001334   6bf5     CLRF      0xf5,0x1                                                                                        
001336   d003     BRA       0x133e         					} else {                                                                    C:\fw\midicontroller\x009\controller.c
001338   2bf4     INCF      0xf4,0x1,0x1   						++curr_bank;                                                               C:\fw\midicontroller\x009\controller.c
00133a   0e00     MOVLW     0x0                                                                                             
00133c   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* show the bank name */                                                    C:\fw\midicontroller\x009\controller.c
00133e   0e01     MOVLW     0x1            					bank_activate(1);                                                           C:\fw\midicontroller\x009\controller.c
001340   6ee6     MOVWF     0xe6,0x0                                                                                        
001342   dcc6     RCALL     0xcd0                                                                                           
001344   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x009\controller.c
                                           				/* activate the first map for the new bank, but do not display the MIDI program # */ C:\fw\midicontroller\x009\controller.c
001346   0100     MOVLB     0x0            				curr_mapindex = 0;                                                           C:\fw\midicontroller\x009\controller.c
001348   6bf3     CLRF      0xf3,0x1                                                                                        
00134a   6ae6     CLRF      0xe6,0x0       				bankmap_activate(0);                                                         C:\fw\midicontroller\x009\controller.c
00134c   dca6     RCALL     0xc9a                                                                                           
00134e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001350   d005     BRA       0x135c         			} else {                                                                      C:\fw\midicontroller\x009\controller.c
                                           				/* activate the next map for the new bank, and display the MIDI program # */ C:\fw\midicontroller\x009\controller.c
001352   2bf3     INCF      0xf3,0x1,0x1   				++curr_mapindex;                                                             C:\fw\midicontroller\x009\controller.c
001354   0e01     MOVLW     0x1            				bankmap_activate(1);                                                         C:\fw\midicontroller\x009\controller.c
001356   6ee6     MOVWF     0xe6,0x0                                                                                        
001358   dca0     RCALL     0xc9a                                                                                           
00135a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                           		}                                                                              C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           	/* PRACTICE vs. CONCERT modes: */                                               C:\fw\midicontroller\x009\controller.c
00135c   0100     MOVLB     0x0            	switch (mode) {                                                                 C:\fw\midicontroller\x009\controller.c
00135e   51ff     MOVF      0xff,0x0,0x1                                                                                    
001360   0a01     XORLW     0x1                                                                                             
001362   e101     BNZ       0x1366                                                                                          
001364   d317     BRA       0x1994                                                                                          
001366   0a01     XORLW     0x1                                                                                             
001368   e002     BZ        0x136e                                                                                          
00136a   efb4     GOTO      0x1d68                                                                                          
00136c   f00e                                                                                                               
                                           		case MODE_PRACTICE:                                                            C:\fw\midicontroller\x009\controller.c
                                           			/* PRACTICE mode has sub-modes of its own: */                                 C:\fw\midicontroller\x009\controller.c
00136e   0101     MOVLB     0x1            			switch (program_mode) {                                                       C:\fw\midicontroller\x009\controller.c
001370   510f     MOVF      0xf,0x0,0x1                                                                                     
001372   0a02     XORLW     0x2                                                                                             
001374   e101     BNZ       0x1378                                                                                          
001376   d2d8     BRA       0x1928                                                                                          
001378   0a03     XORLW     0x3                                                                                             
00137a   e101     BNZ       0x137e                                                                                          
00137c   d23a     BRA       0x17f2                                                                                          
00137e   0a01     XORLW     0x1                                                                                             
001380   e001     BZ        0x1384                                                                                          
001382   d307     BRA       0x1992                                                                                          
                                           				case PROGRAM_NONE:                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* one of preset 1-4 pressed: */                                            C:\fw\midicontroller\x009\controller.c
001384   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         C:\fw\midicontroller\x009\controller.c
001386   6ee6     MOVWF     0xe6,0x0                                                                                        
001388   6ae6     CLRF      0xe6,0x0                                                                                        
00138a   dd39     RCALL     0xdfe                                                                                           
00138c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00138e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001390   0900     IORLW     0x0                                                                                             
001392   e00e     BZ        0x13b0                                                                                          
001394   0100     MOVLB     0x0            						curr_preset = 0;                                                           C:\fw\midicontroller\x009\controller.c
001396   6bf2     CLRF      0xf2,0x1                                                                                        
001398   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x009\controller.c
00139a   0521     DECF      0x21,0x0,0x1                                                                                    
00139c   e105     BNZ       0x13a8                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x009\controller.c
00139e   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x009\controller.c
0013a0   6f07     MOVWF     0x7,0x1                                                                                         
0013a2   6b08     CLRF      0x8,0x1                                                                                         
0013a4   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x009\controller.c
0013a6   d004     BRA       0x13b0         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
0013a8   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
0013aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0013ac   dc51     RCALL     0xc50                                                                                           
0013ae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
0013b0   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         C:\fw\midicontroller\x009\controller.c
0013b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0013b4   6ae6     CLRF      0xe6,0x0                                                                                        
0013b6   dd23     RCALL     0xdfe                                                                                           
0013b8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013bc   0900     IORLW     0x0                                                                                             
0013be   e00f     BZ        0x13de                                                                                          
0013c0   0100     MOVLB     0x0            						curr_preset = 1;                                                           C:\fw\midicontroller\x009\controller.c
0013c2   0e01     MOVLW     0x1                                                                                             
0013c4   6ff2     MOVWF     0xf2,0x1                                                                                        
0013c6   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x009\controller.c
0013c8   0521     DECF      0x21,0x0,0x1                                                                                    
0013ca   e105     BNZ       0x13d6                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x009\controller.c
0013cc   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x009\controller.c
0013ce   6f07     MOVWF     0x7,0x1                                                                                         
0013d0   6b08     CLRF      0x8,0x1                                                                                         
0013d2   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x009\controller.c
0013d4   d004     BRA       0x13de         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
0013d6   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
0013d8   6ee6     MOVWF     0xe6,0x0                                                                                        
0013da   dc3a     RCALL     0xc50                                                                                           
0013dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
0013de   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         C:\fw\midicontroller\x009\controller.c
0013e0   6ee6     MOVWF     0xe6,0x0                                                                                        
0013e2   6ae6     CLRF      0xe6,0x0                                                                                        
0013e4   dd0c     RCALL     0xdfe                                                                                           
0013e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013e8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013ea   0900     IORLW     0x0                                                                                             
0013ec   e00f     BZ        0x140c                                                                                          
0013ee   0100     MOVLB     0x0            						curr_preset = 2;                                                           C:\fw\midicontroller\x009\controller.c
0013f0   0e02     MOVLW     0x2                                                                                             
0013f2   6ff2     MOVWF     0xf2,0x1                                                                                        
0013f4   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x009\controller.c
0013f6   0521     DECF      0x21,0x0,0x1                                                                                    
0013f8   e105     BNZ       0x1404                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x009\controller.c
0013fa   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x009\controller.c
0013fc   6f07     MOVWF     0x7,0x1                                                                                         
0013fe   6b08     CLRF      0x8,0x1                                                                                         
001400   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x009\controller.c
001402   d004     BRA       0x140c         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
001404   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
001406   6ee6     MOVWF     0xe6,0x0                                                                                        
001408   dc23     RCALL     0xc50                                                                                           
00140a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
00140c   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         C:\fw\midicontroller\x009\controller.c
00140e   6ee6     MOVWF     0xe6,0x0                                                                                        
001410   6ae6     CLRF      0xe6,0x0                                                                                        
001412   dcf5     RCALL     0xdfe                                                                                           
001414   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001416   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001418   0900     IORLW     0x0                                                                                             
00141a   e00f     BZ        0x143a                                                                                          
00141c   0100     MOVLB     0x0            						curr_preset = 3;                                                           C:\fw\midicontroller\x009\controller.c
00141e   0e03     MOVLW     0x3                                                                                             
001420   6ff2     MOVWF     0xf2,0x1                                                                                        
001422   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x009\controller.c
001424   0521     DECF      0x21,0x0,0x1                                                                                    
001426   e105     BNZ       0x1432                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x009\controller.c
001428   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x009\controller.c
00142a   6f07     MOVWF     0x7,0x1                                                                                         
00142c   6b08     CLRF      0x8,0x1                                                                                         
00142e   6b20     CLRF      0x20,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x009\controller.c
001430   d004     BRA       0x143a         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
001432   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
001434   6ee6     MOVWF     0xe6,0x0                                                                                        
001436   dc0c     RCALL     0xc50                                                                                           
001438   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
00143a   0101     MOVLB     0x1            					if (incdec_mode == 1) {                                                     C:\fw\midicontroller\x009\controller.c
00143c   0521     DECF      0x21,0x0,0x1                                                                                    
00143e   e001     BZ        0x1442                                                                                          
001440   d087     BRA       0x1550                                                                                          
                                           						/* check if the store-timer ran out and we're able to store: */            C:\fw\midicontroller\x009\controller.c
001442   5107     MOVF      0x7,0x0,0x1    						if ((cdtimer_store == 0) && (store_state == 0)) {                          C:\fw\midicontroller\x009\controller.c
001444   1108     IORWF     0x8,0x0,0x1                                                                                     
001446   e153     BNZ       0x14ee                                                                                          
001448   5120     MOVF      0x20,0x0,0x1                                                                                    
00144a   e151     BNZ       0x14ee                                                                                          
                                           							/* still holding a button? */                                             C:\fw\midicontroller\x009\controller.c
00144c   0e01     MOVLW     0x1            							if (button_held(FSM_PRESET_1) || button_held(FSM_PRESET_2) || button_held(FSM_PRESET_3) || button_held(FSM_PRESET_4)) { C:\fw\midicontroller\x009\controller.c
00144e   6ee6     MOVWF     0xe6,0x0                                                                                        
001450   6ae6     CLRF      0xe6,0x0                                                                                        
001452   dd04     RCALL     0xe5c                                                                                           
001454   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001456   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001458   0900     IORLW     0x0                                                                                             
00145a   e118     BNZ       0x148c                                                                                          
00145c   0e02     MOVLW     0x2                                                                                             
00145e   6ee6     MOVWF     0xe6,0x0                                                                                        
001460   6ae6     CLRF      0xe6,0x0                                                                                        
001462   dcfc     RCALL     0xe5c                                                                                           
001464   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001466   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001468   0900     IORLW     0x0                                                                                             
00146a   e110     BNZ       0x148c                                                                                          
00146c   0e04     MOVLW     0x4                                                                                             
00146e   6ee6     MOVWF     0xe6,0x0                                                                                        
001470   6ae6     CLRF      0xe6,0x0                                                                                        
001472   dcf4     RCALL     0xe5c                                                                                           
001474   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001476   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001478   0900     IORLW     0x0                                                                                             
00147a   e108     BNZ       0x148c                                                                                          
00147c   0e08     MOVLW     0x8                                                                                             
00147e   6ee6     MOVWF     0xe6,0x0                                                                                        
001480   6ae6     CLRF      0xe6,0x0                                                                                        
001482   dcec     RCALL     0xe5c                                                                                           
001484   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001486   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001488   0900     IORLW     0x0                                                                                             
00148a   e031     BZ        0x14ee                                                                                          
                                           								/* store the program */                                                  C:\fw\midicontroller\x009\controller.c
00148c   0101     MOVLB     0x1            								store_state = 1;                                                         C:\fw\midicontroller\x009\controller.c
00148e   0e01     MOVLW     0x1                                                                                             
001490   6f20     MOVWF     0x20,0x1                                                                                        
001492   0100     MOVLB     0x0            								bank[curr_preset] = curr_program;                                        C:\fw\midicontroller\x009\controller.c
001494   51f2     MOVF      0xf2,0x0,0x1                                                                                    
001496   6aea     CLRF      0xea,0x0                                                                                        
001498   0fdc     ADDLW     0xdc                                                                                            
00149a   6ee9     MOVWF     0xe9,0x0                                                                                        
00149c   0e00     MOVLW     0x0                                                                                             
00149e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0014a0   c0f1     MOVFF     0xf1,0xfef                                                                                      
0014a2   ffef                                                                                                               
0014a4   c0ec     MOVFF     0xec,0xfe6     								bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);     C:\fw\midicontroller\x009\controller.c
0014a6   ffe6                                                                                                               
0014a8   0ee4     MOVLW     0xe4                                                                                            
0014aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0014ac   0e00     MOVLW     0x0                                                                                             
0014ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b0   0ee0     MOVLW     0xe0                                                                                            
0014b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b4   0e00     MOVLW     0x0                                                                                             
0014b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b8   0edc     MOVLW     0xdc                                                                                            
0014ba   6ee6     MOVWF     0xe6,0x0                                                                                        
0014bc   0e00     MOVLW     0x0                                                                                             
0014be   6ee6     MOVWF     0xe6,0x0                                                                                        
0014c0   c0f4     MOVFF     0xf4,0xfe6                                                                                      
0014c2   ffe6                                                                                                               
0014c4   c0f5     MOVFF     0xf5,0xfe6                                                                                      
0014c6   ffe6                                                                                                               
0014c8   ec0c     CALL      0x3018,0x0                                                                                      
0014ca   f018                                                                                                               
0014cc   6e10     MOVWF     0x10,0x0                                                                                        
0014ce   0e09     MOVLW     0x9                                                                                             
0014d0   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0014d2   5010     MOVF      0x10,0x0,0x0                                                                                    
0014d4   0e01     MOVLW     0x1            								preset_activate(1);                                                      C:\fw\midicontroller\x009\controller.c
0014d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014d8   ec28     CALL      0xc50,0x0                                                                                       
0014da   f006                                                                                                               
0014dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           								/* flash the stored LED */                                               C:\fw\midicontroller\x009\controller.c
0014de   0101     MOVLB     0x1            								flash_state = FLASH_STORE;                                               C:\fw\midicontroller\x009\controller.c
0014e0   0e01     MOVLW     0x1                                                                                             
0014e2   6f0e     MOVWF     0xe,0x1                                                                                         
0014e4   c0f2     MOVFF     0xf2,0x110     								flash_led = curr_preset;                                                 C:\fw\midicontroller\x009\controller.c
0014e6   f110                                                                                                               
0014e8   0e64     MOVLW     0x64           								cdtimer_flash = 100;                                                     C:\fw\midicontroller\x009\controller.c
0014ea   6f05     MOVWF     0x5,0x1                                                                                         
0014ec   6b06     CLRF      0x6,0x1                                                                                         
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           						/* check if a button was released: */                                      C:\fw\midicontroller\x009\controller.c
0014ee   0e01     MOVLW     0x1            						if (button_released(FSM_PRESET_1) || button_released(FSM_PRESET_2) || button_released(FSM_PRESET_3) || button_released(FSM_PRESET_4)) { C:\fw\midicontroller\x009\controller.c
0014f0   6ee6     MOVWF     0xe6,0x0                                                                                        
0014f2   6ae6     CLRF      0xe6,0x0                                                                                        
0014f4   dcd3     RCALL     0xe9c                                                                                           
0014f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014fa   0900     IORLW     0x0                                                                                             
0014fc   e118     BNZ       0x152e                                                                                          
0014fe   0e02     MOVLW     0x2                                                                                             
001500   6ee6     MOVWF     0xe6,0x0                                                                                        
001502   6ae6     CLRF      0xe6,0x0                                                                                        
001504   dccb     RCALL     0xe9c                                                                                           
001506   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001508   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00150a   0900     IORLW     0x0                                                                                             
00150c   e110     BNZ       0x152e                                                                                          
00150e   0e04     MOVLW     0x4                                                                                             
001510   6ee6     MOVWF     0xe6,0x0                                                                                        
001512   6ae6     CLRF      0xe6,0x0                                                                                        
001514   dcc3     RCALL     0xe9c                                                                                           
001516   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001518   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00151a   0900     IORLW     0x0                                                                                             
00151c   e108     BNZ       0x152e                                                                                          
00151e   0e08     MOVLW     0x8                                                                                             
001520   6ee6     MOVWF     0xe6,0x0                                                                                        
001522   6ae6     CLRF      0xe6,0x0                                                                                        
001524   dcbb     RCALL     0xe9c                                                                                           
001526   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001528   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00152a   0900     IORLW     0x0                                                                                             
00152c   e011     BZ        0x1550                                                                                          
00152e   0101     MOVLB     0x1            							if ((cdtimer_store > 0) && (store_state == 0)) {                          C:\fw\midicontroller\x009\controller.c
001530   0e00     MOVLW     0x0                                                                                             
001532   80d8     BSF       0xd8,0x0,0x0                                                                                    
001534   5507     SUBFWB    0x7,0x0,0x1                                                                                     
001536   0e00     MOVLW     0x0                                                                                             
001538   5508     SUBFWB    0x8,0x0,0x1                                                                                     
00153a   e20a     BC        0x1550                                                                                          
00153c   5120     MOVF      0x20,0x0,0x1                                                                                    
00153e   e108     BNZ       0x1550                                                                                          
                                           								/* was only tapped (held less than ~300msec) */                          C:\fw\midicontroller\x009\controller.c
001540   0e01     MOVLW     0x1            								preset_activate(1);                                                      C:\fw\midicontroller\x009\controller.c
001542   6ee6     MOVWF     0xe6,0x0                                                                                        
001544   ec28     CALL      0xc50,0x0                                                                                       
001546   f006                                                                                                               
001548   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00154a   0101     MOVLB     0x1            								cdtimer_store = 0;                                                       C:\fw\midicontroller\x009\controller.c
00154c   6b07     CLRF      0x7,0x1                                                                                         
00154e   6b08     CLRF      0x8,0x1                                                                                         
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           					/* INC pressed: */                                                          C:\fw\midicontroller\x009\controller.c
001550   0e00     MOVLW     0x0            					if (button_pressed(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x009\controller.c
001552   6ee6     MOVWF     0xe6,0x0                                                                                        
001554   6ae6     CLRF      0xe6,0x0                                                                                        
001556   dc53     RCALL     0xdfe                                                                                           
001558   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00155a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00155c   0900     IORLW     0x0                                                                                             
00155e   e00f     BZ        0x157e                                                                                          
001560   0e00     MOVLW     0x0                                                                                             
001562   6ee6     MOVWF     0xe6,0x0                                                                                        
001564   6ae6     CLRF      0xe6,0x0                                                                                        
001566   dc7a     RCALL     0xe5c                                                                                           
001568   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00156a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00156c   0900     IORLW     0x0                                                                                             
00156e   e107     BNZ       0x157e                                                                                          
001570   0101     MOVLB     0x1                                                                                             
001572   5109     MOVF      0x9,0x0,0x1                                                                                     
001574   110a     IORWF     0xa,0x0,0x1                                                                                     
001576   e103     BNZ       0x157e                                                                                          
                                           						/* INC pushed first */                                                     C:\fw\midicontroller\x009\controller.c
001578   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  C:\fw\midicontroller\x009\controller.c
00157a   6f09     MOVWF     0x9,0x1                                                                                         
00157c   6b0a     CLRF      0xa,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* Still holding INC alone after ~300 ms: */                                C:\fw\midicontroller\x009\controller.c
00157e   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x009\controller.c
001580   510d     MOVF      0xd,0x0,0x1                                                                                     
001582   e11b     BNZ       0x15ba                                                                                          
001584   0e00     MOVLW     0x0                                                                                             
001586   6ee6     MOVWF     0xe6,0x0                                                                                        
001588   6ae6     CLRF      0xe6,0x0                                                                                        
00158a   dc68     RCALL     0xe5c                                                                                           
00158c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00158e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001590   0900     IORLW     0x0                                                                                             
001592   e013     BZ        0x15ba                                                                                          
001594   0e00     MOVLW     0x0                                                                                             
001596   6ee6     MOVWF     0xe6,0x0                                                                                        
001598   6ae6     CLRF      0xe6,0x0                                                                                        
00159a   dc60     RCALL     0xe5c                                                                                           
00159c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00159e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015a0   0900     IORLW     0x0                                                                                             
0015a2   e10b     BNZ       0x15ba                                                                                          
0015a4   0101     MOVLB     0x1                                                                                             
0015a6   5109     MOVF      0x9,0x0,0x1                                                                                     
0015a8   110a     IORWF     0xa,0x0,0x1                                                                                     
0015aa   e107     BNZ       0x15ba                                                                                          
0015ac   0100     MOVLB     0x0            						accel_time = 0;                                                            C:\fw\midicontroller\x009\controller.c
0015ae   6bfc     CLRF      0xfc,0x1                                                                                        
0015b0   6bfd     CLRF      0xfd,0x1                                                                                        
0015b2   6bfe     CLRF      0xfe,0x1       						accel_count = 0;                                                           C:\fw\midicontroller\x009\controller.c
0015b4   0101     MOVLB     0x1            						accel_state = ACCEL_INC_SLOW;                                              C:\fw\midicontroller\x009\controller.c
0015b6   0e01     MOVLW     0x1                                                                                             
0015b8   6f0d     MOVWF     0xd,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* INC released: */                                                         C:\fw\midicontroller\x009\controller.c
0015ba   0e00     MOVLW     0x0            					if (button_released(FSM_INC)) {                                             C:\fw\midicontroller\x009\controller.c
0015bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0015be   6ae6     CLRF      0xe6,0x0                                                                                        
0015c0   dc6d     RCALL     0xe9c                                                                                           
0015c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c6   0900     IORLW     0x0                                                                                             
0015c8   e00c     BZ        0x15e2                                                                                          
0015ca   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             C:\fw\midicontroller\x009\controller.c
0015cc   0e00     MOVLW     0x0                                                                                             
0015ce   80d8     BSF       0xd8,0x0,0x0                                                                                    
0015d0   5509     SUBFWB    0x9,0x0,0x1                                                                                     
0015d2   0e00     MOVLW     0x0                                                                                             
0015d4   550a     SUBFWB    0xa,0x0,0x1                                                                                     
0015d6   e202     BC        0x15dc                                                                                          
0015d8   dd93     RCALL     0x1100         							inc_practice_value();                                                     C:\fw\midicontroller\x009\controller.c
0015da   ddce     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
0015dc   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  C:\fw\midicontroller\x009\controller.c
0015de   6b0d     CLRF      0xd,0x1                                                                                         
0015e0   ddd2     RCALL     0x1186         						activate_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           					/* DEC pressed: */                                                          C:\fw\midicontroller\x009\controller.c
0015e2   0e00     MOVLW     0x0            					if (button_pressed(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x009\controller.c
0015e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0015e6   6ae6     CLRF      0xe6,0x0                                                                                        
0015e8   dc0a     RCALL     0xdfe                                                                                           
0015ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ee   0900     IORLW     0x0                                                                                             
0015f0   e00f     BZ        0x1610                                                                                          
0015f2   0e00     MOVLW     0x0                                                                                             
0015f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0015f6   6ae6     CLRF      0xe6,0x0                                                                                        
0015f8   dc31     RCALL     0xe5c                                                                                           
0015fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015fe   0900     IORLW     0x0                                                                                             
001600   e107     BNZ       0x1610                                                                                          
001602   0101     MOVLB     0x1                                                                                             
001604   5109     MOVF      0x9,0x0,0x1                                                                                     
001606   110a     IORWF     0xa,0x0,0x1                                                                                     
001608   e103     BNZ       0x1610                                                                                          
                                           						/* DEC pushed first */                                                     C:\fw\midicontroller\x009\controller.c
00160a   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  C:\fw\midicontroller\x009\controller.c
00160c   6f09     MOVWF     0x9,0x1                                                                                         
00160e   6b0a     CLRF      0xa,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* Still holding DEC alone after ~300 ms: */                                C:\fw\midicontroller\x009\controller.c
001610   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x009\controller.c
001612   510d     MOVF      0xd,0x0,0x1                                                                                     
001614   e11b     BNZ       0x164c                                                                                          
001616   0e00     MOVLW     0x0                                                                                             
001618   6ee6     MOVWF     0xe6,0x0                                                                                        
00161a   6ae6     CLRF      0xe6,0x0                                                                                        
00161c   dc1f     RCALL     0xe5c                                                                                           
00161e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001620   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001622   0900     IORLW     0x0                                                                                             
001624   e013     BZ        0x164c                                                                                          
001626   0e00     MOVLW     0x0                                                                                             
001628   6ee6     MOVWF     0xe6,0x0                                                                                        
00162a   6ae6     CLRF      0xe6,0x0                                                                                        
00162c   dc17     RCALL     0xe5c                                                                                           
00162e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001630   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001632   0900     IORLW     0x0                                                                                             
001634   e10b     BNZ       0x164c                                                                                          
001636   0101     MOVLB     0x1                                                                                             
001638   5109     MOVF      0x9,0x0,0x1                                                                                     
00163a   110a     IORWF     0xa,0x0,0x1                                                                                     
00163c   e107     BNZ       0x164c                                                                                          
00163e   0100     MOVLB     0x0            						accel_time = 0;                                                            C:\fw\midicontroller\x009\controller.c
001640   6bfc     CLRF      0xfc,0x1                                                                                        
001642   6bfd     CLRF      0xfd,0x1                                                                                        
001644   6bfe     CLRF      0xfe,0x1       						accel_count = 0;                                                           C:\fw\midicontroller\x009\controller.c
001646   0101     MOVLB     0x1            						accel_state = ACCEL_DEC_SLOW;                                              C:\fw\midicontroller\x009\controller.c
001648   0e04     MOVLW     0x4                                                                                             
00164a   6f0d     MOVWF     0xd,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* DEC released: */                                                         C:\fw\midicontroller\x009\controller.c
00164c   0e00     MOVLW     0x0            					if (button_released(FSM_DEC)) {                                             C:\fw\midicontroller\x009\controller.c
00164e   6ee6     MOVWF     0xe6,0x0                                                                                        
001650   6ae6     CLRF      0xe6,0x0                                                                                        
001652   dc24     RCALL     0xe9c                                                                                           
001654   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001656   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001658   0900     IORLW     0x0                                                                                             
00165a   e00c     BZ        0x1674                                                                                          
00165c   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             C:\fw\midicontroller\x009\controller.c
00165e   0e00     MOVLW     0x0                                                                                             
001660   80d8     BSF       0xd8,0x0,0x0                                                                                    
001662   5509     SUBFWB    0x9,0x0,0x1                                                                                     
001664   0e00     MOVLW     0x0                                                                                             
001666   550a     SUBFWB    0xa,0x0,0x1                                                                                     
001668   e202     BC        0x166e                                                                                          
00166a   dd6a     RCALL     0x1140         							dec_practice_value();                                                     C:\fw\midicontroller\x009\controller.c
00166c   dd85     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
00166e   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  C:\fw\midicontroller\x009\controller.c
001670   6b0d     CLRF      0xd,0x1                                                                                         
001672   dd89     RCALL     0x1186         						activate_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           					/* ENTER pressed */                                                         C:\fw\midicontroller\x009\controller.c
001674   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            C:\fw\midicontroller\x009\controller.c
001676   6ee6     MOVWF     0xe6,0x0                                                                                        
001678   6ae6     CLRF      0xe6,0x0                                                                                        
00167a   ecff     CALL      0xdfe,0x0                                                                                       
00167c   f006                                                                                                               
00167e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001680   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001682   0900     IORLW     0x0                                                                                             
001684   e004     BZ        0x168e                                                                                          
001686   0e1e     MOVLW     0x1e           						cdtimer_holdenter = 30;                                                    C:\fw\midicontroller\x009\controller.c
001688   0101     MOVLB     0x1                                                                                             
00168a   6f0b     MOVWF     0xb,0x1                                                                                         
00168c   6b0c     CLRF      0xc,0x1                                                                                         
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* ENTER held at least ~300msec: */                                         C:\fw\midicontroller\x009\controller.c
00168e   0e00     MOVLW     0x0            					if (button_held(FSM_ENTER) && (cdtimer_holdenter == 0) && (program_mode == PROGRAM_NONE)) { C:\fw\midicontroller\x009\controller.c
001690   6ee6     MOVWF     0xe6,0x0                                                                                        
001692   6ae6     CLRF      0xe6,0x0                                                                                        
001694   ec2e     CALL      0xe5c,0x0                                                                                       
001696   f007                                                                                                               
001698   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00169a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00169c   0900     IORLW     0x0                                                                                             
00169e   e00e     BZ        0x16bc                                                                                          
0016a0   0101     MOVLB     0x1                                                                                             
0016a2   510b     MOVF      0xb,0x0,0x1                                                                                     
0016a4   110c     IORWF     0xc,0x0,0x1                                                                                     
0016a6   e10a     BNZ       0x16bc                                                                                          
0016a8   510f     MOVF      0xf,0x0,0x1                                                                                     
0016aa   e108     BNZ       0x16bc                                                                                          
                                           						/* enter sequence program mode */                                          C:\fw\midicontroller\x009\controller.c
0016ac   0e01     MOVLW     0x1            						program_mode = PROGRAM_SEQUENCE;                                           C:\fw\midicontroller\x009\controller.c
0016ae   6f0f     MOVWF     0xf,0x1                                                                                         
0016b0   0100     MOVLB     0x0            						curr_mapindex = 0;                                                         C:\fw\midicontroller\x009\controller.c
0016b2   6bf3     CLRF      0xf3,0x1                                                                                        
0016b4   0e04     MOVLW     0x4            						curr_preset = 4;                                                           C:\fw\midicontroller\x009\controller.c
0016b6   6ff2     MOVWF     0xf2,0x1                                                                                        
0016b8   ecd0     CALL      0xda0,0x0      						sortedbank_showname();                                                     C:\fw\midicontroller\x009\controller.c
0016ba   f006                                                                                                               
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           					/* ENTER released before ~300msec was up: */                                C:\fw\midicontroller\x009\controller.c
0016bc   0e00     MOVLW     0x0            					if (button_released(FSM_ENTER) && (cdtimer_holdenter > 0)) {                C:\fw\midicontroller\x009\controller.c
0016be   6ee6     MOVWF     0xe6,0x0                                                                                        
0016c0   6ae6     CLRF      0xe6,0x0                                                                                        
0016c2   ec4e     CALL      0xe9c,0x0                                                                                       
0016c4   f007                                                                                                               
0016c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016ca   0900     IORLW     0x0                                                                                             
0016cc   e019     BZ        0x1700                                                                                          
0016ce   0101     MOVLB     0x1                                                                                             
0016d0   0e00     MOVLW     0x0                                                                                             
0016d2   80d8     BSF       0xd8,0x0,0x0                                                                                    
0016d4   550b     SUBFWB    0xb,0x0,0x1                                                                                     
0016d6   0e00     MOVLW     0x0                                                                                             
0016d8   550c     SUBFWB    0xc,0x0,0x1                                                                                     
0016da   e212     BC        0x1700                                                                                          
0016dc   5121     MOVF      0x21,0x0,0x1   						if (incdec_mode == 0) {                                                    C:\fw\midicontroller\x009\controller.c
0016de   e109     BNZ       0x16f2                                                                                          
                                           							/* program-select mode */                                                 C:\fw\midicontroller\x009\controller.c
0016e0   0e01     MOVLW     0x1            							incdec_mode = 1;                                                          C:\fw\midicontroller\x009\controller.c
0016e2   6f21     MOVWF     0x21,0x1                                                                                        
0016e4   0e03     MOVLW     0x3            							flash_state = FLASH_PRGM_SELECT_MODE;                                     C:\fw\midicontroller\x009\controller.c
0016e6   6f0e     MOVWF     0xe,0x1                                                                                         
0016e8   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      C:\fw\midicontroller\x009\controller.c
0016ea   6f05     MOVWF     0x5,0x1                                                                                         
0016ec   6b06     CLRF      0x6,0x1                                                                                         
0016ee   dd44     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x009\controller.c
0016f0   d007     BRA       0x1700         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
                                           							/* bank-select mode by alphabetical order */                              C:\fw\midicontroller\x009\controller.c
0016f2   6b21     CLRF      0x21,0x1       							incdec_mode = 0;                                                          C:\fw\midicontroller\x009\controller.c
0016f4   0e02     MOVLW     0x2            							flash_state = FLASH_BANK_SELECT_MODE;                                     C:\fw\midicontroller\x009\controller.c
0016f6   6f0e     MOVWF     0xe,0x1                                                                                         
0016f8   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      C:\fw\midicontroller\x009\controller.c
0016fa   6f05     MOVWF     0x5,0x1                                                                                         
0016fc   6b06     CLRF      0x6,0x1                                                                                         
0016fe   dd3c     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           					/* acceleration countdown timer hit 0 and we're incrementing slowly */      C:\fw\midicontroller\x009\controller.c
001700   0101     MOVLB     0x1            					if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                     C:\fw\midicontroller\x009\controller.c
001702   510d     MOVF      0xd,0x0,0x1                                                                                     
001704   e075     BZ        0x17f0                                                                                          
001706   0100     MOVLB     0x0                                                                                             
001708   51fc     MOVF      0xfc,0x0,0x1                                                                                    
00170a   11fd     IORWF     0xfd,0x0,0x1                                                                                    
00170c   e171     BNZ       0x17f0                                                                                          
00170e   0101     MOVLB     0x1            						switch (accel_state) {                                                     C:\fw\midicontroller\x009\controller.c
001710   510d     MOVF      0xd,0x0,0x1                                                                                     
001712   0a06     XORLW     0x6                                                                                             
001714   e066     BZ        0x17e2                                                                                          
001716   0a03     XORLW     0x3                                                                                             
001718   e04f     BZ        0x17b8                                                                                          
00171a   0a01     XORLW     0x1                                                                                             
00171c   e038     BZ        0x178e                                                                                          
00171e   0a07     XORLW     0x7                                                                                             
001720   e02f     BZ        0x1780                                                                                          
001722   0a01     XORLW     0x1                                                                                             
001724   e018     BZ        0x1756                                                                                          
001726   0a03     XORLW     0x3                                                                                             
001728   e001     BZ        0x172c                                                                                          
00172a   d062     BRA       0x17f0                                                                                          
                                           							case ACCEL_INC_SLOW:                                                      C:\fw\midicontroller\x009\controller.c
00172c   dce9     RCALL     0x1100         								inc_practice_value();                                                    C:\fw\midicontroller\x009\controller.c
00172e   dd24     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x009\controller.c
001730   0100     MOVLB     0x0            								if (accel_count++ == 5) {                                                C:\fw\midicontroller\x009\controller.c
001732   51fe     MOVF      0xfe,0x0,0x1                                                                                    
001734   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001736   0805     SUBLW     0x5                                                                                             
001738   e109     BNZ       0x174c                                                                                          
00173a   6bfe     CLRF      0xfe,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x009\controller.c
00173c   0101     MOVLB     0x1            									accel_state = ACCEL_INC_MEDIUM;                                         C:\fw\midicontroller\x009\controller.c
00173e   0e02     MOVLW     0x2                                                                                             
001740   6f0d     MOVWF     0xd,0x1                                                                                         
001742   c113     MOVFF     0x113,0xfc     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x009\controller.c
001744   f0fc                                                                                                               
001746   c114     MOVFF     0x114,0xfd                                                                                      
001748   f0fd                                                                                                               
00174a   d004     BRA       0x1754         								} else {                                                                 C:\fw\midicontroller\x009\controller.c
00174c   c111     MOVFF     0x111,0xfc     									accel_time = accel_time_slow;                                           C:\fw\midicontroller\x009\controller.c
00174e   f0fc                                                                                                               
001750   c112     MOVFF     0x112,0xfd                                                                                      
001752   f0fd                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x009\controller.c
001754   d04d     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x009\controller.c
                                           							case ACCEL_INC_MEDIUM:                                                    C:\fw\midicontroller\x009\controller.c
001756   dcd4     RCALL     0x1100         								inc_practice_value();                                                    C:\fw\midicontroller\x009\controller.c
001758   dd0f     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x009\controller.c
00175a   0100     MOVLB     0x0            								if (accel_count++ == 20) {                                               C:\fw\midicontroller\x009\controller.c
00175c   51fe     MOVF      0xfe,0x0,0x1                                                                                    
00175e   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001760   0814     SUBLW     0x14                                                                                            
001762   e109     BNZ       0x1776                                                                                          
001764   6bfe     CLRF      0xfe,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x009\controller.c
001766   0101     MOVLB     0x1            									accel_state = ACCEL_INC_FAST;                                           C:\fw\midicontroller\x009\controller.c
001768   0e03     MOVLW     0x3                                                                                             
00176a   6f0d     MOVWF     0xd,0x1                                                                                         
00176c   c115     MOVFF     0x115,0xfc     									accel_time = accel_time_fast;                                           C:\fw\midicontroller\x009\controller.c
00176e   f0fc                                                                                                               
001770   c116     MOVFF     0x116,0xfd                                                                                      
001772   f0fd                                                                                                               
001774   d004     BRA       0x177e         								} else {                                                                 C:\fw\midicontroller\x009\controller.c
001776   c113     MOVFF     0x113,0xfc     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x009\controller.c
001778   f0fc                                                                                                               
00177a   c114     MOVFF     0x114,0xfd                                                                                      
00177c   f0fd                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x009\controller.c
00177e   d038     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x009\controller.c
                                           							case ACCEL_INC_FAST:                                                      C:\fw\midicontroller\x009\controller.c
001780   dcbf     RCALL     0x1100         								inc_practice_value();                                                    C:\fw\midicontroller\x009\controller.c
001782   dcfa     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
001784   c115     MOVFF     0x115,0xfc     								accel_time = accel_time_fast;                                            C:\fw\midicontroller\x009\controller.c
001786   f0fc                                                                                                               
001788   c116     MOVFF     0x116,0xfd                                                                                      
00178a   f0fd                                                                                                               
00178c   d031     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           							case ACCEL_DEC_SLOW:                                                      C:\fw\midicontroller\x009\controller.c
00178e   dcd8     RCALL     0x1140         								dec_practice_value();                                                    C:\fw\midicontroller\x009\controller.c
001790   dcf3     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x009\controller.c
001792   0100     MOVLB     0x0            								if (accel_count++ == 5) {                                                C:\fw\midicontroller\x009\controller.c
001794   51fe     MOVF      0xfe,0x0,0x1                                                                                    
001796   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001798   0805     SUBLW     0x5                                                                                             
00179a   e109     BNZ       0x17ae                                                                                          
00179c   6bfe     CLRF      0xfe,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x009\controller.c
00179e   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_MEDIUM;                                         C:\fw\midicontroller\x009\controller.c
0017a0   0e05     MOVLW     0x5                                                                                             
0017a2   6f0d     MOVWF     0xd,0x1                                                                                         
0017a4   c113     MOVFF     0x113,0xfc     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x009\controller.c
0017a6   f0fc                                                                                                               
0017a8   c114     MOVFF     0x114,0xfd                                                                                      
0017aa   f0fd                                                                                                               
0017ac   d004     BRA       0x17b6         								} else {                                                                 C:\fw\midicontroller\x009\controller.c
0017ae   c111     MOVFF     0x111,0xfc     									accel_time = accel_time_slow;                                           C:\fw\midicontroller\x009\controller.c
0017b0   f0fc                                                                                                               
0017b2   c112     MOVFF     0x112,0xfd                                                                                      
0017b4   f0fd                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x009\controller.c
0017b6   d01c     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x009\controller.c
                                           							case ACCEL_DEC_MEDIUM:                                                    C:\fw\midicontroller\x009\controller.c
0017b8   dcc3     RCALL     0x1140         								dec_practice_value();                                                    C:\fw\midicontroller\x009\controller.c
0017ba   dcde     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x009\controller.c
0017bc   0100     MOVLB     0x0            								if (accel_count++ == 20) {                                               C:\fw\midicontroller\x009\controller.c
0017be   51fe     MOVF      0xfe,0x0,0x1                                                                                    
0017c0   2bfe     INCF      0xfe,0x1,0x1                                                                                    
0017c2   0814     SUBLW     0x14                                                                                            
0017c4   e109     BNZ       0x17d8                                                                                          
0017c6   6bfe     CLRF      0xfe,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x009\controller.c
0017c8   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_FAST;                                           C:\fw\midicontroller\x009\controller.c
0017ca   0e06     MOVLW     0x6                                                                                             
0017cc   6f0d     MOVWF     0xd,0x1                                                                                         
0017ce   c115     MOVFF     0x115,0xfc     									accel_time = accel_time_fast;                                           C:\fw\midicontroller\x009\controller.c
0017d0   f0fc                                                                                                               
0017d2   c116     MOVFF     0x116,0xfd                                                                                      
0017d4   f0fd                                                                                                               
0017d6   d004     BRA       0x17e0         								} else {                                                                 C:\fw\midicontroller\x009\controller.c
0017d8   c113     MOVFF     0x113,0xfc     									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x009\controller.c
0017da   f0fc                                                                                                               
0017dc   c114     MOVFF     0x114,0xfd                                                                                      
0017de   f0fd                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x009\controller.c
0017e0   d007     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x009\controller.c
                                           							case ACCEL_DEC_FAST:                                                      C:\fw\midicontroller\x009\controller.c
0017e2   dcae     RCALL     0x1140         								dec_practice_value();                                                    C:\fw\midicontroller\x009\controller.c
0017e4   dcc9     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
0017e6   c115     MOVFF     0x115,0xfc     								accel_time = accel_time_fast;                                            C:\fw\midicontroller\x009\controller.c
0017e8   f0fc                                                                                                               
0017ea   c116     MOVFF     0x116,0xfd                                                                                      
0017ec   f0fd                                                                                                               
0017ee   d000     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
0017f0   d0d0     BRA       0x1992         					break;                                                                      C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           				/* sequence programming mode: */                                             C:\fw\midicontroller\x009\controller.c
                                           				case PROGRAM_SEQUENCE:                                                       C:\fw\midicontroller\x009\controller.c
                                           					/* one of preset 1-4 pressed: */                                            C:\fw\midicontroller\x009\controller.c
0017f2   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         C:\fw\midicontroller\x009\controller.c
0017f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0017f6   6ae6     CLRF      0xe6,0x0                                                                                        
0017f8   ecff     CALL      0xdfe,0x0                                                                                       
0017fa   f006                                                                                                               
0017fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001800   0900     IORLW     0x0                                                                                             
001802   e01a     BZ        0x1838                                                                                          
001804   0100     MOVLB     0x0            						if (curr_preset != 0) {                                                    C:\fw\midicontroller\x009\controller.c
001806   51f2     MOVF      0xf2,0x0,0x1                                                                                    
001808   e017     BZ        0x1838                                                                                          
00180a   6bf2     CLRF      0xf2,0x1       							curr_preset = 0;                                                          C:\fw\midicontroller\x009\controller.c
00180c   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
00180e   6ee6     MOVWF     0xe6,0x0                                                                                        
001810   ec28     CALL      0xc50,0x0                                                                                       
001812   f006                                                                                                               
001814   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001816   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x009\controller.c
001818   51f3     MOVF      0xf3,0x0,0x1                                                                                    
00181a   2bf3     INCF      0xf3,0x1,0x1                                                                                    
00181c   6aea     CLRF      0xea,0x0                                                                                        
00181e   0fe4     ADDLW     0xe4                                                                                            
001820   6ee9     MOVWF     0xe9,0x0                                                                                        
001822   0e00     MOVLW     0x0                                                                                             
001824   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001826   c0f2     MOVFF     0xf2,0xfef                                                                                      
001828   ffef                                                                                                               
00182a   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x009\controller.c
00182c   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x009\controller.c
00182e   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x009\controller.c
001830   0100     MOVLB     0x0                                                                                             
001832   5df3     SUBWF     0xf3,0x0,0x1                                                                                    
001834   e101     BNZ       0x1838                                                                                          
001836   dcb3     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x009\controller.c
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
001838   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         C:\fw\midicontroller\x009\controller.c
00183a   6ee6     MOVWF     0xe6,0x0                                                                                        
00183c   6ae6     CLRF      0xe6,0x0                                                                                        
00183e   ecff     CALL      0xdfe,0x0                                                                                       
001840   f006                                                                                                               
001842   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001844   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001846   0900     IORLW     0x0                                                                                             
001848   e01a     BZ        0x187e                                                                                          
00184a   0100     MOVLB     0x0            						if (curr_preset != 1) {                                                    C:\fw\midicontroller\x009\controller.c
00184c   05f2     DECF      0xf2,0x0,0x1                                                                                    
00184e   e017     BZ        0x187e                                                                                          
001850   0e01     MOVLW     0x1            							curr_preset = 1;                                                          C:\fw\midicontroller\x009\controller.c
001852   6ff2     MOVWF     0xf2,0x1                                                                                        
001854   6ee6     MOVWF     0xe6,0x0       							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
001856   ec28     CALL      0xc50,0x0                                                                                       
001858   f006                                                                                                               
00185a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00185c   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x009\controller.c
00185e   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001860   2bf3     INCF      0xf3,0x1,0x1                                                                                    
001862   6aea     CLRF      0xea,0x0                                                                                        
001864   0fe4     ADDLW     0xe4                                                                                            
001866   6ee9     MOVWF     0xe9,0x0                                                                                        
001868   0e00     MOVLW     0x0                                                                                             
00186a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00186c   c0f2     MOVFF     0xf2,0xfef                                                                                      
00186e   ffef                                                                                                               
001870   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x009\controller.c
001872   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x009\controller.c
001874   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x009\controller.c
001876   0100     MOVLB     0x0                                                                                             
001878   5df3     SUBWF     0xf3,0x0,0x1                                                                                    
00187a   e101     BNZ       0x187e                                                                                          
00187c   dc90     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x009\controller.c
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
00187e   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         C:\fw\midicontroller\x009\controller.c
001880   6ee6     MOVWF     0xe6,0x0                                                                                        
001882   6ae6     CLRF      0xe6,0x0                                                                                        
001884   ecff     CALL      0xdfe,0x0                                                                                       
001886   f006                                                                                                               
001888   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188c   0900     IORLW     0x0                                                                                             
00188e   e01c     BZ        0x18c8                                                                                          
001890   0e02     MOVLW     0x2            						if (curr_preset != 2) {                                                    C:\fw\midicontroller\x009\controller.c
001892   0100     MOVLB     0x0                                                                                             
001894   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
001896   e018     BZ        0x18c8                                                                                          
001898   0e02     MOVLW     0x2            							curr_preset = 2;                                                          C:\fw\midicontroller\x009\controller.c
00189a   6ff2     MOVWF     0xf2,0x1                                                                                        
00189c   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
00189e   6ee6     MOVWF     0xe6,0x0                                                                                        
0018a0   ec28     CALL      0xc50,0x0                                                                                       
0018a2   f006                                                                                                               
0018a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018a6   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x009\controller.c
0018a8   51f3     MOVF      0xf3,0x0,0x1                                                                                    
0018aa   2bf3     INCF      0xf3,0x1,0x1                                                                                    
0018ac   6aea     CLRF      0xea,0x0                                                                                        
0018ae   0fe4     ADDLW     0xe4                                                                                            
0018b0   6ee9     MOVWF     0xe9,0x0                                                                                        
0018b2   0e00     MOVLW     0x0                                                                                             
0018b4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0018b6   c0f2     MOVFF     0xf2,0xfef                                                                                      
0018b8   ffef                                                                                                               
0018ba   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x009\controller.c
0018bc   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x009\controller.c
0018be   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x009\controller.c
0018c0   0100     MOVLB     0x0                                                                                             
0018c2   5df3     SUBWF     0xf3,0x0,0x1                                                                                    
0018c4   e101     BNZ       0x18c8                                                                                          
0018c6   dc6b     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x009\controller.c
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
0018c8   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         C:\fw\midicontroller\x009\controller.c
0018ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0018cc   6ae6     CLRF      0xe6,0x0                                                                                        
0018ce   ecff     CALL      0xdfe,0x0                                                                                       
0018d0   f006                                                                                                               
0018d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018d6   0900     IORLW     0x0                                                                                             
0018d8   e01c     BZ        0x1912                                                                                          
0018da   0e03     MOVLW     0x3            						if (curr_preset != 3) {                                                    C:\fw\midicontroller\x009\controller.c
0018dc   0100     MOVLB     0x0                                                                                             
0018de   5df2     SUBWF     0xf2,0x0,0x1                                                                                    
0018e0   e018     BZ        0x1912                                                                                          
0018e2   0e03     MOVLW     0x3            							curr_preset = 3;                                                          C:\fw\midicontroller\x009\controller.c
0018e4   6ff2     MOVWF     0xf2,0x1                                                                                        
0018e6   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
0018e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0018ea   ec28     CALL      0xc50,0x0                                                                                       
0018ec   f006                                                                                                               
0018ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018f0   0100     MOVLB     0x0            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x009\controller.c
0018f2   51f3     MOVF      0xf3,0x0,0x1                                                                                    
0018f4   2bf3     INCF      0xf3,0x1,0x1                                                                                    
0018f6   6aea     CLRF      0xea,0x0                                                                                        
0018f8   0fe4     ADDLW     0xe4                                                                                            
0018fa   6ee9     MOVWF     0xe9,0x0                                                                                        
0018fc   0e00     MOVLW     0x0                                                                                             
0018fe   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001900   c0f2     MOVFF     0xf2,0xfef                                                                                      
001902   ffef                                                                                                               
001904   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x009\controller.c
001906   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x009\controller.c
001908   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x009\controller.c
00190a   0100     MOVLB     0x0                                                                                             
00190c   5df3     SUBWF     0xf3,0x0,0x1                                                                                    
00190e   e101     BNZ       0x1912                                                                                          
001910   dc46     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x009\controller.c
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           					/* ENTER pressed */                                                         C:\fw\midicontroller\x009\controller.c
001912   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            C:\fw\midicontroller\x009\controller.c
001914   6ee6     MOVWF     0xe6,0x0                                                                                        
001916   6ae6     CLRF      0xe6,0x0                                                                                        
001918   ecff     CALL      0xdfe,0x0                                                                                       
00191a   f006                                                                                                               
00191c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00191e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001920   0900     IORLW     0x0                                                                                             
001922   e001     BZ        0x1926                                                                                          
                                           						/* stop programming early and save the sequence: */                        C:\fw\midicontroller\x009\controller.c
001924   dc3c     RCALL     0x119e         						sequence_complete();                                                       C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
001926   d035     BRA       0x1992         					break;                                                                      C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           				/* sequence repeat mode: */                                                  C:\fw\midicontroller\x009\controller.c
                                           				case PROGRAM_COMPLETE:                                                       C:\fw\midicontroller\x009\controller.c
001928   510b     MOVF      0xb,0x0,0x1    					if (cdtimer_holdenter == 0) {                                               C:\fw\midicontroller\x009\controller.c
00192a   110c     IORWF     0xc,0x0,0x1                                                                                     
00192c   e131     BNZ       0x1990                                                                                          
00192e   0100     MOVLB     0x0            						if (curr_mapindex == bankmap_count) {                                      C:\fw\midicontroller\x009\controller.c
001930   51ec     MOVF      0xec,0x0,0x1                                                                                    
001932   5df3     SUBWF     0xf3,0x0,0x1                                                                                    
001934   e10a     BNZ       0x194a                                                                                          
                                           							/* we're done! */                                                         C:\fw\midicontroller\x009\controller.c
001936   0101     MOVLB     0x1            							program_mode = PROGRAM_NONE;                                              C:\fw\midicontroller\x009\controller.c
001938   6b0f     CLRF      0xf,0x1                                                                                         
00193a   0100     MOVLB     0x0            							curr_mapindex = 0;                                                        C:\fw\midicontroller\x009\controller.c
00193c   6bf3     CLRF      0xf3,0x1                                                                                        
00193e   0e01     MOVLW     0x1            							bankmap_activate(1);                                                      C:\fw\midicontroller\x009\controller.c
001940   6ee6     MOVWF     0xe6,0x0                                                                                        
001942   ec4d     CALL      0xc9a,0x0                                                                                       
001944   f006                                                                                                               
001946   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001948   d023     BRA       0x1990         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
                                           							/* set the next LED active */                                             C:\fw\midicontroller\x009\controller.c
00194a   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x009\controller.c
00194c   f006                                                                                                               
00194e   0100     MOVLB     0x0            							curr_preset = bankmap[curr_mapindex];                                     C:\fw\midicontroller\x009\controller.c
001950   51f3     MOVF      0xf3,0x0,0x1                                                                                    
001952   6aea     CLRF      0xea,0x0                                                                                        
001954   0fe4     ADDLW     0xe4                                                                                            
001956   6ee9     MOVWF     0xe9,0x0                                                                                        
001958   0e00     MOVLW     0x0                                                                                             
00195a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00195c   cfef     MOVFF     0xfef,0xf2                                                                                      
00195e   f0f2                                                                                                               
001960   51f2     MOVF      0xf2,0x0,0x1   							fsw_led_set_active(curr_preset);                                          C:\fw\midicontroller\x009\controller.c
001962   6ee6     MOVWF     0xe6,0x0                                                                                        
001964   6ae6     CLRF      0xe6,0x0                                                                                        
001966   ecb5     CALL      0x2f6a,0x0                                                                                      
001968   f017                                                                                                               
00196a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00196c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00196e   0100     MOVLB     0x0            							curr_program = bank[curr_preset];                                         C:\fw\midicontroller\x009\controller.c
001970   51f2     MOVF      0xf2,0x0,0x1                                                                                    
001972   6aea     CLRF      0xea,0x0                                                                                        
001974   0fdc     ADDLW     0xdc                                                                                            
001976   6ee9     MOVWF     0xe9,0x0                                                                                        
001978   0e00     MOVLW     0x0                                                                                             
00197a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00197c   cfef     MOVFF     0xfef,0xf1                                                                                      
00197e   f0f1                                                                                                               
001980   ece8     CALL      0xbd0,0x0      							show_program();                                                           C:\fw\midicontroller\x009\controller.c
001982   f005                                                                                                               
001984   0100     MOVLB     0x0            							++curr_mapindex;                                                          C:\fw\midicontroller\x009\controller.c
001986   2bf3     INCF      0xf3,0x1,0x1                                                                                    
001988   0e32     MOVLW     0x32           							cdtimer_holdenter = 50;                                                   C:\fw\midicontroller\x009\controller.c
00198a   0101     MOVLB     0x1                                                                                             
00198c   6f0b     MOVWF     0xb,0x1                                                                                         
00198e   6b0c     CLRF      0xc,0x1                                                                                         
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
001990   d000     BRA       0x1992         					break;                                                                      C:\fw\midicontroller\x009\controller.c
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
001992   d1ea     BRA       0x1d68         			break;                                                                        C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           		case MODE_CONCERT:                                                             C:\fw\midicontroller\x009\controller.c
                                           			/*                                                                            C:\fw\midicontroller\x009\controller.c
                                           				next/prev buttons move bank map index pointer up/down by 1, cycling up/down bank # when bank C:\fw\midicontroller\x009\controller.c
                                           				map boundaries are crossed.  Single-digit 7-segment display shows map index # as 1-8. C:\fw\midicontroller\x009\controller.c
                                           				inc/dec buttons move through banks, resetting bank map index to 0.  Bank name displays on 4-digit display. C:\fw\midicontroller\x009\controller.c
                                           				preset button 1-4: change program # immediately, showing program # on 4-digit display for .5 sec, C:\fw\midicontroller\x009\controller.c
                                           				reverting display back to bank name.                                         C:\fw\midicontroller\x009\controller.c
                                           			*/                                                                            C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           			/* one of preset 1-4 pressed: */                                              C:\fw\midicontroller\x009\controller.c
001994   0e01     MOVLW     0x1            			if (button_pressed(FSM_PRESET_1)) {                                           C:\fw\midicontroller\x009\controller.c
001996   6ee6     MOVWF     0xe6,0x0                                                                                        
001998   6ae6     CLRF      0xe6,0x0                                                                                        
00199a   ecff     CALL      0xdfe,0x0                                                                                       
00199c   f006                                                                                                               
00199e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a2   0900     IORLW     0x0                                                                                             
0019a4   e007     BZ        0x19b4                                                                                          
0019a6   0100     MOVLB     0x0            				curr_preset = 0;                                                             C:\fw\midicontroller\x009\controller.c
0019a8   6bf2     CLRF      0xf2,0x1                                                                                        
0019aa   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x009\controller.c
0019ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0019ae   ec28     CALL      0xc50,0x0                                                                                       
0019b0   f006                                                                                                               
0019b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
0019b4   0e02     MOVLW     0x2            			if (button_pressed(FSM_PRESET_2)) {                                           C:\fw\midicontroller\x009\controller.c
0019b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0019b8   6ae6     CLRF      0xe6,0x0                                                                                        
0019ba   ecff     CALL      0xdfe,0x0                                                                                       
0019bc   f006                                                                                                               
0019be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c2   0900     IORLW     0x0                                                                                             
0019c4   e007     BZ        0x19d4                                                                                          
0019c6   0100     MOVLB     0x0            				curr_preset = 1;                                                             C:\fw\midicontroller\x009\controller.c
0019c8   0e01     MOVLW     0x1                                                                                             
0019ca   6ff2     MOVWF     0xf2,0x1                                                                                        
0019cc   6ee6     MOVWF     0xe6,0x0       				preset_activate(1);                                                          C:\fw\midicontroller\x009\controller.c
0019ce   ec28     CALL      0xc50,0x0                                                                                       
0019d0   f006                                                                                                               
0019d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
0019d4   0e04     MOVLW     0x4            			if (button_pressed(FSM_PRESET_3)) {                                           C:\fw\midicontroller\x009\controller.c
0019d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0019d8   6ae6     CLRF      0xe6,0x0                                                                                        
0019da   ecff     CALL      0xdfe,0x0                                                                                       
0019dc   f006                                                                                                               
0019de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019e2   0900     IORLW     0x0                                                                                             
0019e4   e008     BZ        0x19f6                                                                                          
0019e6   0100     MOVLB     0x0            				curr_preset = 2;                                                             C:\fw\midicontroller\x009\controller.c
0019e8   0e02     MOVLW     0x2                                                                                             
0019ea   6ff2     MOVWF     0xf2,0x1                                                                                        
0019ec   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x009\controller.c
0019ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0019f0   ec28     CALL      0xc50,0x0                                                                                       
0019f2   f006                                                                                                               
0019f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
0019f6   0e08     MOVLW     0x8            			if (button_pressed(FSM_PRESET_4)) {                                           C:\fw\midicontroller\x009\controller.c
0019f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0019fa   6ae6     CLRF      0xe6,0x0                                                                                        
0019fc   ecff     CALL      0xdfe,0x0                                                                                       
0019fe   f006                                                                                                               
001a00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a04   0900     IORLW     0x0                                                                                             
001a06   e008     BZ        0x1a18                                                                                          
001a08   0100     MOVLB     0x0            				curr_preset = 3;                                                             C:\fw\midicontroller\x009\controller.c
001a0a   0e03     MOVLW     0x3                                                                                             
001a0c   6ff2     MOVWF     0xf2,0x1                                                                                        
001a0e   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x009\controller.c
001a10   6ee6     MOVWF     0xe6,0x0                                                                                        
001a12   ec28     CALL      0xc50,0x0                                                                                       
001a14   f006                                                                                                               
001a16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           			/* INC pressed: */                                                            C:\fw\midicontroller\x009\controller.c
001a18   0e00     MOVLW     0x0            			if (button_pressed(FSM_INC)) {                                                C:\fw\midicontroller\x009\controller.c
001a1a   6ee6     MOVWF     0xe6,0x0                                                                                        
001a1c   6ae6     CLRF      0xe6,0x0                                                                                        
001a1e   ecff     CALL      0xdfe,0x0                                                                                       
001a20   f006                                                                                                               
001a22   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a24   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a26   0900     IORLW     0x0                                                                                             
001a28   e021     BZ        0x1a6c                                                                                          
001a2a   c0fa     MOVFF     0xfa,0x10      				if (curr_bank == bank_count - 1) curr_bank = 0;                              C:\fw\midicontroller\x009\controller.c
001a2c   f010                                                                                                               
001a2e   c0fb     MOVFF     0xfb,0x11                                                                                       
001a30   f011                                                                                                               
001a32   0610     DECF      0x10,0x1,0x0                                                                                    
001a34   0e00     MOVLW     0x0                                                                                             
001a36   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001a38   5010     MOVF      0x10,0x0,0x0                                                                                    
001a3a   0100     MOVLB     0x0                                                                                             
001a3c   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001a3e   e102     BNZ       0x1a44                                                                                          
001a40   5011     MOVF      0x11,0x0,0x0                                                                                    
001a42   19f5     XORWF     0xf5,0x0,0x1                                                                                    
001a44   e103     BNZ       0x1a4c                                                                                          
001a46   6bf4     CLRF      0xf4,0x1                                                                                        
001a48   6bf5     CLRF      0xf5,0x1                                                                                        
001a4a   d003     BRA       0x1a52         				else ++curr_bank;                                                            C:\fw\midicontroller\x009\controller.c
001a4c   2bf4     INCF      0xf4,0x1,0x1                                                                                    
001a4e   0e00     MOVLW     0x0                                                                                             
001a50   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
001a52   ecb9     CALL      0xd72,0x0      				bank_showname();                                                             C:\fw\midicontroller\x009\controller.c
001a54   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
001a56   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x009\controller.c
001a58   6b0d     CLRF      0xd,0x1                                                                                         
001a5a   c111     MOVFF     0x111,0xfc     				accel_time = accel_time_slow;                                                C:\fw\midicontroller\x009\controller.c
001a5c   f0fc                                                                                                               
001a5e   c112     MOVFF     0x112,0xfd                                                                                      
001a60   f0fd                                                                                                               
001a62   0100     MOVLB     0x0            				accel_count = 0;                                                             C:\fw\midicontroller\x009\controller.c
001a64   6bfe     CLRF      0xfe,0x1                                                                                        
001a66   0101     MOVLB     0x1            				accel_state = ACCEL_INC_SLOW;                                                C:\fw\midicontroller\x009\controller.c
001a68   0e01     MOVLW     0x1                                                                                             
001a6a   6f0d     MOVWF     0xd,0x1                                                                                         
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                           			/* INC released: */                                                           C:\fw\midicontroller\x009\controller.c
001a6c   0e00     MOVLW     0x0            			if (button_released(FSM_INC)) {                                               C:\fw\midicontroller\x009\controller.c
001a6e   6ee6     MOVWF     0xe6,0x0                                                                                        
001a70   6ae6     CLRF      0xe6,0x0                                                                                        
001a72   ec4e     CALL      0xe9c,0x0                                                                                       
001a74   f007                                                                                                               
001a76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a7a   0900     IORLW     0x0                                                                                             
001a7c   e006     BZ        0x1a8a                                                                                          
001a7e   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x009\controller.c
001a80   6b0d     CLRF      0xd,0x1                                                                                         
                                           				/* load the bank, but don't change program # */                              C:\fw\midicontroller\x009\controller.c
001a82   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            C:\fw\midicontroller\x009\controller.c
001a84   ec68     CALL      0xcd0,0x0                                                                                       
001a86   f006                                                                                                               
001a88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           			/* DEC pressed: */                                                            C:\fw\midicontroller\x009\controller.c
001a8a   0e00     MOVLW     0x0            			if (button_pressed(FSM_DEC)) {                                                C:\fw\midicontroller\x009\controller.c
001a8c   6ee6     MOVWF     0xe6,0x0                                                                                        
001a8e   6ae6     CLRF      0xe6,0x0                                                                                        
001a90   ecff     CALL      0xdfe,0x0                                                                                       
001a92   f006                                                                                                               
001a94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a98   0900     IORLW     0x0                                                                                             
001a9a   e01d     BZ        0x1ad6                                                                                          
001a9c   0100     MOVLB     0x0            				if (curr_bank == 0) curr_bank = bank_count - 1;                              C:\fw\midicontroller\x009\controller.c
001a9e   51f4     MOVF      0xf4,0x0,0x1                                                                                    
001aa0   11f5     IORWF     0xf5,0x0,0x1                                                                                    
001aa2   e109     BNZ       0x1ab6                                                                                          
001aa4   c0fa     MOVFF     0xfa,0xf4                                                                                       
001aa6   f0f4                                                                                                               
001aa8   c0fb     MOVFF     0xfb,0xf5                                                                                       
001aaa   f0f5                                                                                                               
001aac   0e01     MOVLW     0x1                                                                                             
001aae   5ff4     SUBWF     0xf4,0x1,0x1                                                                                    
001ab0   0e00     MOVLW     0x0                                                                                             
001ab2   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001ab4   d003     BRA       0x1abc         				else --curr_bank;                                                            C:\fw\midicontroller\x009\controller.c
001ab6   07f4     DECF      0xf4,0x1,0x1                                                                                    
001ab8   0e00     MOVLW     0x0                                                                                             
001aba   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001abc   ecb9     CALL      0xd72,0x0      				bank_showname();                                                             C:\fw\midicontroller\x009\controller.c
001abe   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
001ac0   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x009\controller.c
001ac2   6b0d     CLRF      0xd,0x1                                                                                         
001ac4   c111     MOVFF     0x111,0xfc     				accel_time = accel_time_slow;                                                C:\fw\midicontroller\x009\controller.c
001ac6   f0fc                                                                                                               
001ac8   c112     MOVFF     0x112,0xfd                                                                                      
001aca   f0fd                                                                                                               
001acc   0100     MOVLB     0x0            				accel_count = 0;                                                             C:\fw\midicontroller\x009\controller.c
001ace   6bfe     CLRF      0xfe,0x1                                                                                        
001ad0   0101     MOVLB     0x1            				accel_state = ACCEL_DEC_SLOW;                                                C:\fw\midicontroller\x009\controller.c
001ad2   0e04     MOVLW     0x4                                                                                             
001ad4   6f0d     MOVWF     0xd,0x1                                                                                         
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                           			/* DEC released: */                                                           C:\fw\midicontroller\x009\controller.c
001ad6   0e00     MOVLW     0x0            			if (button_released(FSM_DEC)) {                                               C:\fw\midicontroller\x009\controller.c
001ad8   6ee6     MOVWF     0xe6,0x0                                                                                        
001ada   6ae6     CLRF      0xe6,0x0                                                                                        
001adc   ec4e     CALL      0xe9c,0x0                                                                                       
001ade   f007                                                                                                               
001ae0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ae2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ae4   0900     IORLW     0x0                                                                                             
001ae6   e006     BZ        0x1af4                                                                                          
001ae8   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x009\controller.c
001aea   6b0d     CLRF      0xd,0x1                                                                                         
                                           				/* load the bank, but don't change program # */                              C:\fw\midicontroller\x009\controller.c
001aec   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            C:\fw\midicontroller\x009\controller.c
001aee   ec68     CALL      0xcd0,0x0                                                                                       
001af0   f006                                                                                                               
001af2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           			/* PREV/ENTER pressed: */                                                     C:\fw\midicontroller\x009\controller.c
001af4   0e00     MOVLW     0x0            			if (button_pressed(FSM_ENTER)) {                                              C:\fw\midicontroller\x009\controller.c
001af6   6ee6     MOVWF     0xe6,0x0                                                                                        
001af8   6ae6     CLRF      0xe6,0x0                                                                                        
001afa   ecff     CALL      0xdfe,0x0                                                                                       
001afc   f006                                                                                                               
001afe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b02   0900     IORLW     0x0                                                                                             
001b04   e048     BZ        0x1b96                                                                                          
001b06   0100     MOVLB     0x0            				if (loaded_bank != curr_bank) {                                              C:\fw\midicontroller\x009\controller.c
001b08   51f4     MOVF      0xf4,0x0,0x1                                                                                    
001b0a   19f6     XORWF     0xf6,0x0,0x1                                                                                    
001b0c   e102     BNZ       0x1b12                                                                                          
001b0e   51f5     MOVF      0xf5,0x0,0x1                                                                                    
001b10   19f7     XORWF     0xf7,0x0,0x1                                                                                    
001b12   e006     BZ        0x1b20                                                                                          
                                           					/* prepared to switch to a bank, but did not activate the first map */      C:\fw\midicontroller\x009\controller.c
001b14   0e01     MOVLW     0x1            					bankmap_activate(1);                                                        C:\fw\midicontroller\x009\controller.c
001b16   6ee6     MOVWF     0xe6,0x0                                                                                        
001b18   ec4d     CALL      0xc9a,0x0                                                                                       
001b1a   f006                                                                                                               
001b1c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b1e   d03b     BRA       0x1b96         				} else {                                                                     C:\fw\midicontroller\x009\controller.c
001b20   51f3     MOVF      0xf3,0x0,0x1   					if (curr_mapindex == 0) {                                                   C:\fw\midicontroller\x009\controller.c
001b22   e133     BNZ       0x1b8a                                                                                          
                                           						/* crossed the lower bank-map boundary, load the previous bank */          C:\fw\midicontroller\x009\controller.c
001b24   51ff     MOVF      0xff,0x0,0x1   						if (mode == MODE_PRACTICE) {                                               C:\fw\midicontroller\x009\controller.c
001b26   e115     BNZ       0x1b52                                                                                          
                                           							/* PRACTICE mode cycles through banks by sorted index #: */               C:\fw\midicontroller\x009\controller.c
001b28   51f8     MOVF      0xf8,0x0,0x1   							if (curr_sortedbank == 0) {                                               C:\fw\midicontroller\x009\controller.c
001b2a   11f9     IORWF     0xf9,0x0,0x1                                                                                    
001b2c   e109     BNZ       0x1b40                                                                                          
001b2e   c0fa     MOVFF     0xfa,0xf8      								curr_sortedbank = bank_count - 1;                                        C:\fw\midicontroller\x009\controller.c
001b30   f0f8                                                                                                               
001b32   c0fb     MOVFF     0xfb,0xf9                                                                                       
001b34   f0f9                                                                                                               
001b36   0e01     MOVLW     0x1                                                                                             
001b38   5ff8     SUBWF     0xf8,0x1,0x1                                                                                    
001b3a   0e00     MOVLW     0x0                                                                                             
001b3c   5bf9     SUBWFB    0xf9,0x1,0x1                                                                                    
001b3e   d003     BRA       0x1b46         							} else {                                                                  C:\fw\midicontroller\x009\controller.c
001b40   07f8     DECF      0xf8,0x1,0x1   								--curr_sortedbank;                                                       C:\fw\midicontroller\x009\controller.c
001b42   0e00     MOVLW     0x0                                                                                             
001b44   5bf9     SUBWFB    0xf9,0x1,0x1                                                                                    
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           							/* show the bank name */                                                  C:\fw\midicontroller\x009\controller.c
001b46   0e01     MOVLW     0x1            							sortedbank_activate(1);                                                   C:\fw\midicontroller\x009\controller.c
001b48   6ee6     MOVWF     0xe6,0x0                                                                                        
001b4a   eca0     CALL      0xd40,0x0                                                                                       
001b4c   f006                                                                                                               
001b4e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b50   d014     BRA       0x1b7a         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
                                           							/* CONCERT mode cycles through banks by index #: */                       C:\fw\midicontroller\x009\controller.c
001b52   51f4     MOVF      0xf4,0x0,0x1   							if (curr_bank == 0) {                                                     C:\fw\midicontroller\x009\controller.c
001b54   11f5     IORWF     0xf5,0x0,0x1                                                                                    
001b56   e109     BNZ       0x1b6a                                                                                          
001b58   c0fa     MOVFF     0xfa,0xf4      								curr_bank = bank_count - 1;                                              C:\fw\midicontroller\x009\controller.c
001b5a   f0f4                                                                                                               
001b5c   c0fb     MOVFF     0xfb,0xf5                                                                                       
001b5e   f0f5                                                                                                               
001b60   0e01     MOVLW     0x1                                                                                             
001b62   5ff4     SUBWF     0xf4,0x1,0x1                                                                                    
001b64   0e00     MOVLW     0x0                                                                                             
001b66   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001b68   d003     BRA       0x1b70         							} else {                                                                  C:\fw\midicontroller\x009\controller.c
001b6a   07f4     DECF      0xf4,0x1,0x1   								--curr_bank;                                                             C:\fw\midicontroller\x009\controller.c
001b6c   0e00     MOVLW     0x0                                                                                             
001b6e   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
                                           							}                                                                         C:\fw\midicontroller\x009\controller.c
                                           							/* show the bank name */                                                  C:\fw\midicontroller\x009\controller.c
001b70   0e01     MOVLW     0x1            							bank_activate(1);                                                         C:\fw\midicontroller\x009\controller.c
001b72   6ee6     MOVWF     0xe6,0x0                                                                                        
001b74   ec68     CALL      0xcd0,0x0                                                                                       
001b76   f006                                                                                                               
001b78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
                                           						/* activate the last map for the new bank, but do not display the MIDI program # */ C:\fw\midicontroller\x009\controller.c
001b7a   0100     MOVLB     0x0            						curr_mapindex = bankmap_count - 1;                                         C:\fw\midicontroller\x009\controller.c
001b7c   05ec     DECF      0xec,0x0,0x1                                                                                    
001b7e   6ff3     MOVWF     0xf3,0x1                                                                                        
001b80   6ae6     CLRF      0xe6,0x0       						bankmap_activate(0);                                                       C:\fw\midicontroller\x009\controller.c
001b82   ec4d     CALL      0xc9a,0x0                                                                                       
001b84   f006                                                                                                               
001b86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b88   d006     BRA       0x1b96         					} else {                                                                    C:\fw\midicontroller\x009\controller.c
                                           						/* activate the previous map for the new bank, and display the MIDI program # */ C:\fw\midicontroller\x009\controller.c
001b8a   07f3     DECF      0xf3,0x1,0x1   						--curr_mapindex;                                                           C:\fw\midicontroller\x009\controller.c
001b8c   0e01     MOVLW     0x1            						bankmap_activate(1);                                                       C:\fw\midicontroller\x009\controller.c
001b8e   6ee6     MOVWF     0xe6,0x0                                                                                        
001b90   ec4d     CALL      0xc9a,0x0                                                                                       
001b92   f006                                                                                                               
001b94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x009\controller.c
                                           				}                                                                            C:\fw\midicontroller\x009\controller.c
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           			/* acceleration countdown timer hit 0 and we're incrementing slowly */        C:\fw\midicontroller\x009\controller.c
001b96   0101     MOVLB     0x1            			if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                       C:\fw\midicontroller\x009\controller.c
001b98   510d     MOVF      0xd,0x0,0x1                                                                                     
001b9a   e101     BNZ       0x1b9e                                                                                          
001b9c   d0e4     BRA       0x1d66                                                                                          
001b9e   0100     MOVLB     0x0                                                                                             
001ba0   51fc     MOVF      0xfc,0x0,0x1                                                                                    
001ba2   11fd     IORWF     0xfd,0x0,0x1                                                                                    
001ba4   e001     BZ        0x1ba8                                                                                          
001ba6   d0df     BRA       0x1d66                                                                                          
001ba8   0101     MOVLB     0x1            				switch (accel_state) {                                                       C:\fw\midicontroller\x009\controller.c
001baa   510d     MOVF      0xd,0x0,0x1                                                                                     
001bac   0a06     XORLW     0x6                                                                                             
001bae   e101     BNZ       0x1bb2                                                                                          
001bb0   d0c3     BRA       0x1d38                                                                                          
001bb2   0a03     XORLW     0x3                                                                                             
001bb4   e101     BNZ       0x1bb8                                                                                          
001bb6   d09b     BRA       0x1cee                                                                                          
001bb8   0a01     XORLW     0x1                                                                                             
001bba   e074     BZ        0x1ca4                                                                                          
001bbc   0a07     XORLW     0x7                                                                                             
001bbe   e057     BZ        0x1c6e                                                                                          
001bc0   0a01     XORLW     0x1                                                                                             
001bc2   e02c     BZ        0x1c1c                                                                                          
001bc4   0a03     XORLW     0x3                                                                                             
001bc6   e001     BZ        0x1bca                                                                                          
001bc8   d0ce     BRA       0x1d66                                                                                          
                                           					case ACCEL_INC_SLOW:                                                        C:\fw\midicontroller\x009\controller.c
001bca   c0fa     MOVFF     0xfa,0x10      						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x009\controller.c
001bcc   f010                                                                                                               
001bce   c0fb     MOVFF     0xfb,0x11                                                                                       
001bd0   f011                                                                                                               
001bd2   0610     DECF      0x10,0x1,0x0                                                                                    
001bd4   0e00     MOVLW     0x0                                                                                             
001bd6   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001bd8   5010     MOVF      0x10,0x0,0x0                                                                                    
001bda   0100     MOVLB     0x0                                                                                             
001bdc   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001bde   e102     BNZ       0x1be4                                                                                          
001be0   5011     MOVF      0x11,0x0,0x0                                                                                    
001be2   19f5     XORWF     0xf5,0x0,0x1                                                                                    
001be4   e103     BNZ       0x1bec                                                                                          
001be6   6bf4     CLRF      0xf4,0x1                                                                                        
001be8   6bf5     CLRF      0xf5,0x1                                                                                        
001bea   d003     BRA       0x1bf2         						else ++curr_bank;                                                          C:\fw\midicontroller\x009\controller.c
001bec   2bf4     INCF      0xf4,0x1,0x1                                                                                    
001bee   0e00     MOVLW     0x0                                                                                             
001bf0   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
001bf2   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x009\controller.c
001bf4   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x009\controller.c
001bf6   0100     MOVLB     0x0            						if (accel_count++ == 5) {                                                  C:\fw\midicontroller\x009\controller.c
001bf8   51fe     MOVF      0xfe,0x0,0x1                                                                                    
001bfa   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001bfc   0805     SUBLW     0x5                                                                                             
001bfe   e109     BNZ       0x1c12                                                                                          
001c00   6bfe     CLRF      0xfe,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x009\controller.c
001c02   0101     MOVLB     0x1            							accel_state = ACCEL_INC_MEDIUM;                                           C:\fw\midicontroller\x009\controller.c
001c04   0e02     MOVLW     0x2                                                                                             
001c06   6f0d     MOVWF     0xd,0x1                                                                                         
001c08   c113     MOVFF     0x113,0xfc     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x009\controller.c
001c0a   f0fc                                                                                                               
001c0c   c114     MOVFF     0x114,0xfd                                                                                      
001c0e   f0fd                                                                                                               
001c10   d004     BRA       0x1c1a         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
001c12   c111     MOVFF     0x111,0xfc     							accel_time = accel_time_slow;                                             C:\fw\midicontroller\x009\controller.c
001c14   f0fc                                                                                                               
001c16   c112     MOVFF     0x112,0xfd                                                                                      
001c18   f0fd                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
001c1a   d0a5     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x009\controller.c
                                           					case ACCEL_INC_MEDIUM:                                                      C:\fw\midicontroller\x009\controller.c
001c1c   c0fa     MOVFF     0xfa,0x10      						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x009\controller.c
001c1e   f010                                                                                                               
001c20   c0fb     MOVFF     0xfb,0x11                                                                                       
001c22   f011                                                                                                               
001c24   0610     DECF      0x10,0x1,0x0                                                                                    
001c26   0e00     MOVLW     0x0                                                                                             
001c28   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c2a   5010     MOVF      0x10,0x0,0x0                                                                                    
001c2c   0100     MOVLB     0x0                                                                                             
001c2e   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001c30   e102     BNZ       0x1c36                                                                                          
001c32   5011     MOVF      0x11,0x0,0x0                                                                                    
001c34   19f5     XORWF     0xf5,0x0,0x1                                                                                    
001c36   e103     BNZ       0x1c3e                                                                                          
001c38   6bf4     CLRF      0xf4,0x1                                                                                        
001c3a   6bf5     CLRF      0xf5,0x1                                                                                        
001c3c   d003     BRA       0x1c44         						else ++curr_bank;                                                          C:\fw\midicontroller\x009\controller.c
001c3e   2bf4     INCF      0xf4,0x1,0x1                                                                                    
001c40   0e00     MOVLW     0x0                                                                                             
001c42   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
001c44   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x009\controller.c
001c46   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x009\controller.c
001c48   0100     MOVLB     0x0            						if (accel_count++ == 20) {                                                 C:\fw\midicontroller\x009\controller.c
001c4a   51fe     MOVF      0xfe,0x0,0x1                                                                                    
001c4c   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001c4e   0814     SUBLW     0x14                                                                                            
001c50   e109     BNZ       0x1c64                                                                                          
001c52   6bfe     CLRF      0xfe,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x009\controller.c
001c54   0101     MOVLB     0x1            							accel_state = ACCEL_INC_FAST;                                             C:\fw\midicontroller\x009\controller.c
001c56   0e03     MOVLW     0x3                                                                                             
001c58   6f0d     MOVWF     0xd,0x1                                                                                         
001c5a   c115     MOVFF     0x115,0xfc     							accel_time = accel_time_fast;                                             C:\fw\midicontroller\x009\controller.c
001c5c   f0fc                                                                                                               
001c5e   c116     MOVFF     0x116,0xfd                                                                                      
001c60   f0fd                                                                                                               
001c62   d004     BRA       0x1c6c         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
001c64   c113     MOVFF     0x113,0xfc     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x009\controller.c
001c66   f0fc                                                                                                               
001c68   c114     MOVFF     0x114,0xfd                                                                                      
001c6a   f0fd                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
001c6c   d07c     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x009\controller.c
                                           					case ACCEL_INC_FAST:                                                        C:\fw\midicontroller\x009\controller.c
001c6e   c0fa     MOVFF     0xfa,0x10      						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x009\controller.c
001c70   f010                                                                                                               
001c72   c0fb     MOVFF     0xfb,0x11                                                                                       
001c74   f011                                                                                                               
001c76   0610     DECF      0x10,0x1,0x0                                                                                    
001c78   0e00     MOVLW     0x0                                                                                             
001c7a   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c7c   5010     MOVF      0x10,0x0,0x0                                                                                    
001c7e   0100     MOVLB     0x0                                                                                             
001c80   19f4     XORWF     0xf4,0x0,0x1                                                                                    
001c82   e102     BNZ       0x1c88                                                                                          
001c84   5011     MOVF      0x11,0x0,0x0                                                                                    
001c86   19f5     XORWF     0xf5,0x0,0x1                                                                                    
001c88   e103     BNZ       0x1c90                                                                                          
001c8a   6bf4     CLRF      0xf4,0x1                                                                                        
001c8c   6bf5     CLRF      0xf5,0x1                                                                                        
001c8e   d003     BRA       0x1c96         						else ++curr_bank;                                                          C:\fw\midicontroller\x009\controller.c
001c90   2bf4     INCF      0xf4,0x1,0x1                                                                                    
001c92   0e00     MOVLW     0x0                                                                                             
001c94   23f5     ADDWFC    0xf5,0x1,0x1                                                                                    
001c96   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x009\controller.c
001c98   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
001c9a   c115     MOVFF     0x115,0xfc     						accel_time = accel_time_fast;                                              C:\fw\midicontroller\x009\controller.c
001c9c   f0fc                                                                                                               
001c9e   c116     MOVFF     0x116,0xfd                                                                                      
001ca0   f0fd                                                                                                               
001ca2   d061     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x009\controller.c
                                           					case ACCEL_DEC_SLOW:                                                        C:\fw\midicontroller\x009\controller.c
001ca4   0100     MOVLB     0x0            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x009\controller.c
001ca6   51f4     MOVF      0xf4,0x0,0x1                                                                                    
001ca8   11f5     IORWF     0xf5,0x0,0x1                                                                                    
001caa   e109     BNZ       0x1cbe                                                                                          
001cac   c0fa     MOVFF     0xfa,0xf4                                                                                       
001cae   f0f4                                                                                                               
001cb0   c0fb     MOVFF     0xfb,0xf5                                                                                       
001cb2   f0f5                                                                                                               
001cb4   0e01     MOVLW     0x1                                                                                             
001cb6   5ff4     SUBWF     0xf4,0x1,0x1                                                                                    
001cb8   0e00     MOVLW     0x0                                                                                             
001cba   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001cbc   d003     BRA       0x1cc4         						else --curr_bank;                                                          C:\fw\midicontroller\x009\controller.c
001cbe   07f4     DECF      0xf4,0x1,0x1                                                                                    
001cc0   0e00     MOVLW     0x0                                                                                             
001cc2   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001cc4   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x009\controller.c
001cc6   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x009\controller.c
001cc8   0100     MOVLB     0x0            						if (accel_count++ == 5) {                                                  C:\fw\midicontroller\x009\controller.c
001cca   51fe     MOVF      0xfe,0x0,0x1                                                                                    
001ccc   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001cce   0805     SUBLW     0x5                                                                                             
001cd0   e109     BNZ       0x1ce4                                                                                          
001cd2   6bfe     CLRF      0xfe,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x009\controller.c
001cd4   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_MEDIUM;                                           C:\fw\midicontroller\x009\controller.c
001cd6   0e05     MOVLW     0x5                                                                                             
001cd8   6f0d     MOVWF     0xd,0x1                                                                                         
001cda   c113     MOVFF     0x113,0xfc     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x009\controller.c
001cdc   f0fc                                                                                                               
001cde   c114     MOVFF     0x114,0xfd                                                                                      
001ce0   f0fd                                                                                                               
001ce2   d004     BRA       0x1cec         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
001ce4   c111     MOVFF     0x111,0xfc     							accel_time = accel_time_slow;                                             C:\fw\midicontroller\x009\controller.c
001ce6   f0fc                                                                                                               
001ce8   c112     MOVFF     0x112,0xfd                                                                                      
001cea   f0fd                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
001cec   d03c     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x009\controller.c
                                           					case ACCEL_DEC_MEDIUM:                                                      C:\fw\midicontroller\x009\controller.c
001cee   0100     MOVLB     0x0            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x009\controller.c
001cf0   51f4     MOVF      0xf4,0x0,0x1                                                                                    
001cf2   11f5     IORWF     0xf5,0x0,0x1                                                                                    
001cf4   e109     BNZ       0x1d08                                                                                          
001cf6   c0fa     MOVFF     0xfa,0xf4                                                                                       
001cf8   f0f4                                                                                                               
001cfa   c0fb     MOVFF     0xfb,0xf5                                                                                       
001cfc   f0f5                                                                                                               
001cfe   0e01     MOVLW     0x1                                                                                             
001d00   5ff4     SUBWF     0xf4,0x1,0x1                                                                                    
001d02   0e00     MOVLW     0x0                                                                                             
001d04   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001d06   d003     BRA       0x1d0e         						else --curr_bank;                                                          C:\fw\midicontroller\x009\controller.c
001d08   07f4     DECF      0xf4,0x1,0x1                                                                                    
001d0a   0e00     MOVLW     0x0                                                                                             
001d0c   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001d0e   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x009\controller.c
001d10   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x009\controller.c
001d12   0100     MOVLB     0x0            						if (accel_count++ == 20) {                                                 C:\fw\midicontroller\x009\controller.c
001d14   51fe     MOVF      0xfe,0x0,0x1                                                                                    
001d16   2bfe     INCF      0xfe,0x1,0x1                                                                                    
001d18   0814     SUBLW     0x14                                                                                            
001d1a   e109     BNZ       0x1d2e                                                                                          
001d1c   6bfe     CLRF      0xfe,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x009\controller.c
001d1e   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_FAST;                                             C:\fw\midicontroller\x009\controller.c
001d20   0e06     MOVLW     0x6                                                                                             
001d22   6f0d     MOVWF     0xd,0x1                                                                                         
001d24   c115     MOVFF     0x115,0xfc     							accel_time = accel_time_fast;                                             C:\fw\midicontroller\x009\controller.c
001d26   f0fc                                                                                                               
001d28   c116     MOVFF     0x116,0xfd                                                                                      
001d2a   f0fd                                                                                                               
001d2c   d004     BRA       0x1d36         						} else {                                                                   C:\fw\midicontroller\x009\controller.c
001d2e   c113     MOVFF     0x113,0xfc     							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x009\controller.c
001d30   f0fc                                                                                                               
001d32   c114     MOVFF     0x114,0xfd                                                                                      
001d34   f0fd                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x009\controller.c
001d36   d017     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x009\controller.c
                                           					case ACCEL_DEC_FAST:                                                        C:\fw\midicontroller\x009\controller.c
001d38   0100     MOVLB     0x0            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x009\controller.c
001d3a   51f4     MOVF      0xf4,0x0,0x1                                                                                    
001d3c   11f5     IORWF     0xf5,0x0,0x1                                                                                    
001d3e   e109     BNZ       0x1d52                                                                                          
001d40   c0fa     MOVFF     0xfa,0xf4                                                                                       
001d42   f0f4                                                                                                               
001d44   c0fb     MOVFF     0xfb,0xf5                                                                                       
001d46   f0f5                                                                                                               
001d48   0e01     MOVLW     0x1                                                                                             
001d4a   5ff4     SUBWF     0xf4,0x1,0x1                                                                                    
001d4c   0e00     MOVLW     0x0                                                                                             
001d4e   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001d50   d003     BRA       0x1d58         						else --curr_bank;                                                          C:\fw\midicontroller\x009\controller.c
001d52   07f4     DECF      0xf4,0x1,0x1                                                                                    
001d54   0e00     MOVLW     0x0                                                                                             
001d56   5bf5     SUBWFB    0xf5,0x1,0x1                                                                                    
001d58   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x009\controller.c
001d5a   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x009\controller.c
001d5c   c115     MOVFF     0x115,0xfc     						accel_time = accel_time_fast;                                              C:\fw\midicontroller\x009\controller.c
001d5e   f0fc                                                                                                               
001d60   c116     MOVFF     0x116,0xfd                                                                                      
001d62   f0fd                                                                                                               
001d64   d000     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x009\controller.c
                                           				}                                                                            C:\fw\midicontroller\x009\controller.c
                                           			}                                                                             C:\fw\midicontroller\x009\controller.c
001d66   d000     BRA       0x1d68         			break;                                                                        C:\fw\midicontroller\x009\controller.c
                                           	}                                                                               C:\fw\midicontroller\x009\controller.c
001d68   c119     MOVFF     0x119,0x11b    	sw_last = sw_curr;                                                              C:\fw\midicontroller\x009\controller.c
001d6a   f11b                                                                                                               
001d6c   c11a     MOVFF     0x11a,0x11c                                                                                     
001d6e   f11c                                                                                                               
001d70   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\controller.c
                                           ;###########################################################################     C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;#			Author: Joe Dunne											  #                                             C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;#			Date 4/06/07					      						  #                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;#			This file handles writing to the FLASH  (ROM).				  #                       C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;#			File Name: writeprogmem.asm   										  #                                 C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;#														 				  #                                                         C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;############################################################################    C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           	INCLUDE "p18F4455.inc"                                                          C:\fw\midicontroller\x009\writeprogmem.asm
                                                   LIST                                                                     C:\fw\midicontroller\x009\p18F4455.inc
                                                                                                                            C:\fw\midicontroller\x009\p18F4455.inc
                                           ;==========================================================================      C:\fw\midicontroller\x009\p18F4455.inc
                                           ;  $Id: P18F4455.INC,v 1.9 2006/10/25 17:47:56 nairnj Exp $                      C:\fw\midicontroller\x009\p18F4455.inc
                                           ;  MPASM PIC18F4455 processor include                                            C:\fw\midicontroller\x009\p18F4455.inc
                                           ;                                                                                C:\fw\midicontroller\x009\p18F4455.inc
                                           ;  (c) Copyright 1999-2006 Microchip Technology, All rights reserved             C:\fw\midicontroller\x009\p18F4455.inc
                                           ;==========================================================================      C:\fw\midicontroller\x009\p18F4455.inc
                                                                                                                            C:\fw\midicontroller\x009\p18F4455.inc
                                                   LIST                                                                     C:\fw\midicontroller\x009\p18F4455.inc
                                           	LIST R=DEC                                                                      C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           	extern	WpmCounter, WpmCounter1                                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           	global	READ_BLOCK_FROM_ROM, WRITE_BLOCK_INTO_ROM                                C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           	code                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;void	Read64BytesFromRom(                                                        C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;;READ_BLOCK_FROM_ROM                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;Before calling, set FSR0 = address of RAM buffer                                C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;Also, set TLPTR = address of ROM to read into RAM.                              C:\fw\midicontroller\x009\writeprogmem.asm
                                           READ_BLOCK_FROM_ROM                                                              C:\fw\midicontroller\x009\writeprogmem.asm
0037c6   0100     MOVLB     0x0            	movlb	high(WpmCounter)	;set appropriate bank.                                   C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
0037c8   0e40     MOVLW     0x40           	MOVLW	64			; number of bytes in erase block                                     C:\fw\midicontroller\x009\writeprogmem.asm
0037ca   6f67     MOVWF     0x67,0x1       	MOVWF	WpmCounter                                                                C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW BUFFER_ADDR_HIGH 		; point to buffer                                     C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF FSR0H                                                                    C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW BUFFER_ADDR_LOW                                                          C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF FSR0L                                                                    C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_UPPER		; Load TBLPTR with the base                             C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF TBLPTRU			; address of the memory block                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_HIGH                                                           C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF TBLPTRH                                                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_LOW                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF TBLPTRL                                                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           READ_BLOCK                                                                       C:\fw\midicontroller\x009\writeprogmem.asm
0037cc   0009     TBLRDPOSTINC             	TBLRD*+				; read into TABLAT, and inc                                          C:\fw\midicontroller\x009\writeprogmem.asm
0037ce   50f5     MOVF      0xf5,0x0,0x0   	MOVF	TABLAT, W		; get data                                                      C:\fw\midicontroller\x009\writeprogmem.asm
0037d0   6eee     MOVWF     0xee,0x0       	MOVWF	POSTINC0		; store data                                                    C:\fw\midicontroller\x009\writeprogmem.asm
0037d2   2f67     DECFSZ    0x67,0x1,0x1   	DECFSZ	WpmCounter			; done?                                                     C:\fw\midicontroller\x009\writeprogmem.asm
0037d4   d7fb     BRA       0x37cc         	BRA	READ_BLOCK		; repeat                                                        C:\fw\midicontroller\x009\writeprogmem.asm
0037d6   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;;WRITE_BLOCK_INTO_ROM                                                           C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;Before calling, set FSR0 = address of RAM buffer                                C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;Also, set TBLPTR = address of ROM to write to  (must be on 64 byte boundary).   C:\fw\midicontroller\x009\writeprogmem.asm
                                           WRITE_BLOCK_INTO_ROM                                                             C:\fw\midicontroller\x009\writeprogmem.asm
0037d8   0100     MOVLB     0x0            	movlb	high(WpmCounter)	;set appropriate bank.                                   C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_UPPER 	                                                        C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF TBLPTRU                                                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_HIGH                                                           C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF TBLPTRH                                                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_LOW                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF TBLPTRL                                                                  C:\fw\midicontroller\x009\writeprogmem.asm
0037da   8ea6     BSF       0xa6,0x7,0x0   	BSF	EECON1, EEPGD		; point to Flash program memory                              C:\fw\midicontroller\x009\writeprogmem.asm
0037dc   9ca6     BCF       0xa6,0x6,0x0   	BCF	EECON1, CFGS		; access Flash program memory                                 C:\fw\midicontroller\x009\writeprogmem.asm
0037de   84a6     BSF       0xa6,0x2,0x0   	BSF	EECON1, WREN		; enable write to memory                                      C:\fw\midicontroller\x009\writeprogmem.asm
0037e0   88a6     BSF       0xa6,0x4,0x0   	BSF	EECON1, FREE		; enable Row Erase operation                                  C:\fw\midicontroller\x009\writeprogmem.asm
0037e2   9ef2     BCF       0xf2,0x7,0x0   	BCF	INTCON, GIE 		; disable interrupts                                          C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;perform erase opration:                                                         C:\fw\midicontroller\x009\writeprogmem.asm
0037e4   0e55     MOVLW     0x55           	MOVLW	55h                                                                       C:\fw\midicontroller\x009\writeprogmem.asm
0037e6   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 55h                                                      C:\fw\midicontroller\x009\writeprogmem.asm
0037e8   0eaa     MOVLW     0xaa           	MOVLW	0AAh                                                                      C:\fw\midicontroller\x009\writeprogmem.asm
0037ea   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 0AAh                                                     C:\fw\midicontroller\x009\writeprogmem.asm
0037ec   82a6     BSF       0xa6,0x1,0x0   	BSF	EECON1, WR		; start erase (CPU stall)                                       C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
0037ee   8ef2     BSF       0xf2,0x7,0x0   	BSF	INTCON, GIE 		; re-enable interrupts                                        C:\fw\midicontroller\x009\writeprogmem.asm
0037f0   000a     TBLRDPOSTDEC             	TBLRD*- 			; dummy read decrement                                               C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW	BUFFER_ADDR_HIGH	; point to buffer                                       C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF	FSR0H                                                                    C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVLW	BUFFER_ADDR_LOW                                                          C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;	MOVWF	FSR0L                                                                    C:\fw\midicontroller\x009\writeprogmem.asm
0037f2   0e02     MOVLW     0x2            	MOVLW	2                                                                         C:\fw\midicontroller\x009\writeprogmem.asm
0037f4   6f68     MOVWF     0x68,0x1       	MOVWF	WpmCounter1                                                               C:\fw\midicontroller\x009\writeprogmem.asm
                                           WRITE_BUFFER_BACK                                                                C:\fw\midicontroller\x009\writeprogmem.asm
0037f6   0e20     MOVLW     0x20           	MOVLW	32	 		; number of bytes in holding register                               C:\fw\midicontroller\x009\writeprogmem.asm
0037f8   6f67     MOVWF     0x67,0x1       	MOVWF	WpmCounter                                                                C:\fw\midicontroller\x009\writeprogmem.asm
                                           WRITE_BYTE_TO_HREGS                                                              C:\fw\midicontroller\x009\writeprogmem.asm
0037fa   50ee     MOVF      0xee,0x0,0x0   	MOVF	POSTINC0, W 		; get low byte of buffer data                                C:\fw\midicontroller\x009\writeprogmem.asm
0037fc   6ef5     MOVWF     0xf5,0x0       	MOVWF	TABLAT 			; present data to table latch                                   C:\fw\midicontroller\x009\writeprogmem.asm
0037fe   000f     TBLWTPREINC              	TBLWT+* 			; write data, perform a short write                                  C:\fw\midicontroller\x009\writeprogmem.asm
                                           					; to internal TBLWT holding register.                                       C:\fw\midicontroller\x009\writeprogmem.asm
003800   2f67     DECFSZ    0x67,0x1,0x1   	DECFSZ	WpmCounter 		; loop until buffers are full                               C:\fw\midicontroller\x009\writeprogmem.asm
003802   d7fb     BRA       0x37fa         	BRA	WRITE_BYTE_TO_HREGS                                                         C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           PROGRAM_MEMORY                                                                   C:\fw\midicontroller\x009\writeprogmem.asm
003804   8ea6     BSF       0xa6,0x7,0x0   	BSF	EECON1, EEPGD		; point to Flash program memory                              C:\fw\midicontroller\x009\writeprogmem.asm
003806   9ca6     BCF       0xa6,0x6,0x0   	BCF	EECON1, CFGS		; access Flash program memory                                 C:\fw\midicontroller\x009\writeprogmem.asm
003808   84a6     BSF       0xa6,0x2,0x0   	BSF	EECON1, WREN		; enable write to memory                                      C:\fw\midicontroller\x009\writeprogmem.asm
00380a   9ef2     BCF       0xf2,0x7,0x0   	BCF	INTCON, GIE		; disable interrupts                                           C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           ;Write to program memmory:                                                       C:\fw\midicontroller\x009\writeprogmem.asm
00380c   0e55     MOVLW     0x55           	MOVLW	55h                                                                       C:\fw\midicontroller\x009\writeprogmem.asm
00380e   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 55h                                                      C:\fw\midicontroller\x009\writeprogmem.asm
003810   0eaa     MOVLW     0xaa           	MOVLW	0AAh                                                                      C:\fw\midicontroller\x009\writeprogmem.asm
003812   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 0AAh                                                     C:\fw\midicontroller\x009\writeprogmem.asm
003814   82a6     BSF       0xa6,0x1,0x0   	BSF	EECON1, WR		; start program (CPU stall)                                     C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
003816   2f68     DECFSZ    0x68,0x1,0x1   	DECFSZ	WpmCounter1                                                              C:\fw\midicontroller\x009\writeprogmem.asm
003818   d7ee     BRA       0x37f6         	BRA	WRITE_BUFFER_BACK                                                           C:\fw\midicontroller\x009\writeprogmem.asm
00381a   8ef2     BSF       0xf2,0x7,0x0   	BSF	INTCON, GIE		; re-enable interrupts                                         C:\fw\midicontroller\x009\writeprogmem.asm
00381c   94a6     BCF       0xa6,0x2,0x0   	BCF	EECON1, WREN		; disable write to memory                                     C:\fw\midicontroller\x009\writeprogmem.asm
00381e   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x009\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x009\writeprogmem.asm
                                           	END                                                                             C:\fw\midicontroller\x009\writeprogmem.asm
                                           //*;###########################################################################  C:\fw\midicontroller\x009\vectors.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\vectors.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x009\vectors.c
                                           //;#			vectors									  			  #                                                  C:\fw\midicontroller\x009\vectors.c
                                           //;#			File Name: vectors.c   										  #                                      C:\fw\midicontroller\x009\vectors.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\vectors.c
                                           //;############################################################################  C:\fw\midicontroller\x009\vectors.c
                                                                                                                            C:\fw\midicontroller\x009\vectors.c
                                                                                                                            C:\fw\midicontroller\x009\vectors.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\vectors.c
                                                                                                                            C:\fw\midicontroller\x009\vectors.c
                                           void main(void);                                                                 C:\fw\midicontroller\x009\vectors.c
                                                                                                                            C:\fw\midicontroller\x009\vectors.c
                                           #pragma code RealInitVector = 0x00                                               C:\fw\midicontroller\x009\vectors.c
                                           void                                                                             C:\fw\midicontroller\x009\vectors.c
                                           RealInitVector (void)                                                            C:\fw\midicontroller\x009\vectors.c
                                           {                                                                                C:\fw\midicontroller\x009\vectors.c
                                             _asm                                                                           C:\fw\midicontroller\x009\vectors.c
000000   ef15     GOTO      0xa2a          	goto main //jump to interrupt routine                                           C:\fw\midicontroller\x009\vectors.c
000002   f005                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x009\vectors.c
000004   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\vectors.c
                                                                                                                            C:\fw\midicontroller\x009\vectors.c
                                           #pragma code RealInterruptVectorHigh = 0x08                                      C:\fw\midicontroller\x009\vectors.c
                                           void                                                                             C:\fw\midicontroller\x009\vectors.c
                                           RealInterruptVectorHigh (void)                                                   C:\fw\midicontroller\x009\vectors.c
                                           {                                                                                C:\fw\midicontroller\x009\vectors.c
                                             _asm                                                                           C:\fw\midicontroller\x009\vectors.c
000008   ef8a     GOTO      0x3914         	goto InterruptHandlerHigh //jump to interrupt routine                           C:\fw\midicontroller\x009\vectors.c
00000a   f01c                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x009\vectors.c
00000c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\vectors.c
                                                                                                                            C:\fw\midicontroller\x009\vectors.c
                                           //*;###########################################################################  C:\fw\midicontroller\x009\eeprom.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\eeprom.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x009\eeprom.c
                                           //;#			EEProm access functions							  			  #                                    C:\fw\midicontroller\x009\eeprom.c
                                           //;#			File Name: eeprom.c   										  #                                       C:\fw\midicontroller\x009\eeprom.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\eeprom.c
                                           //;############################################################################  C:\fw\midicontroller\x009\eeprom.c
                                                                                                                            C:\fw\midicontroller\x009\eeprom.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\eeprom.c
                                                                                                                            C:\fw\midicontroller\x009\eeprom.c
003886   cfd9     MOVFF     0xfd9,0xfe6    unsigned char EERead(unsigned char addr) {                                       C:\fw\midicontroller\x009\eeprom.c
003888   ffe6                                                                                                               
00388a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00388c   ffd9                                                                                                               
00388e   0efe     MOVLW     0xfe           	EEADR=(unsigned char)addr;	// Address to read                                   C:\fw\midicontroller\x009\eeprom.c
003890   50db     MOVF      0xdb,0x0,0x0                                                                                    
003892   6ea9     MOVWF     0xa9,0x0                                                                                        
003894   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   C:\fw\midicontroller\x009\eeprom.c
003896   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           C:\fw\midicontroller\x009\eeprom.c
003898   80a6     BSF       0xa6,0x0,0x0   	EECON1bits.RD=1;			// EE Read                                                   C:\fw\midicontroller\x009\eeprom.c
00389a   50a8     MOVF      0xa8,0x0,0x0   	return EEDATA;				// W = EEDATA                                                 C:\fw\midicontroller\x009\eeprom.c
00389c   d000     BRA       0x389e                                                                                          
00389e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\eeprom.c
0038a0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0038a2   ffd9                                                                                                               
0038a4   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\eeprom.c
                                           //blocking write that takes approximately 4mS ??                                 C:\fw\midicontroller\x009\eeprom.c
0038a6   cfd9     MOVFF     0xfd9,0xfe6    void EEWrite(unsigned char addr,unsigned char data) {                            C:\fw\midicontroller\x009\eeprom.c
0038a8   ffe6                                                                                                               
0038aa   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0038ac   ffd9                                                                                                               
0038ae   0efe     MOVLW     0xfe           	EEADR = (unsigned char)addr;                                                    C:\fw\midicontroller\x009\eeprom.c
0038b0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0038b2   6ea9     MOVWF     0xa9,0x0                                                                                        
0038b4   0efd     MOVLW     0xfd           	EEDATA=data;                                                                    C:\fw\midicontroller\x009\eeprom.c
0038b6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0038b8   6ea8     MOVWF     0xa8,0x0                                                                                        
                                           	                                                                                C:\fw\midicontroller\x009\eeprom.c
0038ba   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   C:\fw\midicontroller\x009\eeprom.c
0038bc   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           C:\fw\midicontroller\x009\eeprom.c
0038be   84a6     BSF       0xa6,0x2,0x0   	EECON1bits.WREN=1;                                                              C:\fw\midicontroller\x009\eeprom.c
                                                                                                                            C:\fw\midicontroller\x009\eeprom.c
0038c0   9ef2     BCF       0xf2,0x7,0x0   	INTCONbits.GIE = 0;			// Disable global interrupts                              C:\fw\midicontroller\x009\eeprom.c
0038c2   0e55     MOVLW     0x55           	EECON2=0x55;				// Required                                                     C:\fw\midicontroller\x009\eeprom.c
0038c4   6ea7     MOVWF     0xa7,0x0                                                                                        
0038c6   0eaa     MOVLW     0xaa           	EECON2=0xAA;				// Required                                                     C:\fw\midicontroller\x009\eeprom.c
0038c8   6ea7     MOVWF     0xa7,0x0                                                                                        
0038ca   82a6     BSF       0xa6,0x1,0x0   	EECON1bits.WR=1;			// Enable writes                                             C:\fw\midicontroller\x009\eeprom.c
                                           	do {                                                                            C:\fw\midicontroller\x009\eeprom.c
0038cc   0004     CLRWDT                   		ClrWdt();                                                                      C:\fw\midicontroller\x009\eeprom.c
0038ce   b2a6     BTFSC     0xa6,0x1,0x0   	} while(EECON1bits.WR);		// block until write complete                          C:\fw\midicontroller\x009\eeprom.c
0038d0   d7fd     BRA       0x38cc                                                                                          
                                                                                                                            C:\fw\midicontroller\x009\eeprom.c
0038d2   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIE = 1;			// Enable global interrupts                               C:\fw\midicontroller\x009\eeprom.c
0038d4   94a6     BCF       0xa6,0x2,0x0   	EECON1bits.WREN=0;			// Disable writes                                          C:\fw\midicontroller\x009\eeprom.c
0038d6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\eeprom.c
0038d8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0038da   ffd9                                                                                                               
0038dc   0012     RETURN    0x0                                                                                             
                                           //*;###########################################################################  C:\fw\midicontroller\x009\leds.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\leds.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x009\leds.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x009\leds.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x009\leds.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\leds.c
                                           //;############################################################################  C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\leds.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\leds.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           void	ProcessLeds(void) {                                                         C:\fw\midicontroller\x009\leds.c
                                           	static unsigned char ComPointer;                                                C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
003068   d834     RCALL     0x30d2         	AllDigitsOff();                                                                 C:\fw\midicontroller\x009\leds.c
00306a   0101     MOVLB     0x1            	switch (ComPointer) {                                                           C:\fw\midicontroller\x009\leds.c
00306c   513b     MOVF      0x3b,0x0,0x1                                                                                    
00306e   0a04     XORLW     0x4                                                                                             
003070   e021     BZ        0x30b4                                                                                          
003072   0a07     XORLW     0x7                                                                                             
003074   e019     BZ        0x30a8                                                                                          
003076   0a01     XORLW     0x1                                                                                             
003078   e011     BZ        0x309c                                                                                          
00307a   0a03     XORLW     0x3                                                                                             
00307c   e009     BZ        0x3090                                                                                          
00307e   0a01     XORLW     0x1                                                                                             
003080   e001     BZ        0x3084                                                                                          
                                           		case 0:                                                                        C:\fw\midicontroller\x009\leds.c
003084   9a8a     BCF       0x8a,0x5,0x0   			DISP_COM0_LAT_BIT = false;                                                    C:\fw\midicontroller\x009\leds.c
003086   c13b     MOVFF     0x13b,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x009\leds.c
003088   ffe6                                                                                                               
00308a   d831     RCALL     0x30ee                                                                                          
00308c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00308e   d018     BRA       0x30c0         			break;                                                                        C:\fw\midicontroller\x009\leds.c
                                           		case 1:                                                                        C:\fw\midicontroller\x009\leds.c
003090   908b     BCF       0x8b,0x0,0x0   			DISP_COM1_LAT_BIT = false;                                                    C:\fw\midicontroller\x009\leds.c
003092   c13b     MOVFF     0x13b,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x009\leds.c
003094   ffe6                                                                                                               
003096   d82b     RCALL     0x30ee                                                                                          
003098   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00309a   d012     BRA       0x30c0         			break;                                                                        C:\fw\midicontroller\x009\leds.c
                                           		case 2:                                                                        C:\fw\midicontroller\x009\leds.c
00309c   968a     BCF       0x8a,0x3,0x0   			DISP_COM2_LAT_BIT = false;                                                    C:\fw\midicontroller\x009\leds.c
00309e   c13b     MOVFF     0x13b,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x009\leds.c
0030a0   ffe6                                                                                                               
0030a2   d825     RCALL     0x30ee                                                                                          
0030a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030a6   d00c     BRA       0x30c0         			break;                                                                        C:\fw\midicontroller\x009\leds.c
                                           		case 3:                                                                        C:\fw\midicontroller\x009\leds.c
0030a8   948a     BCF       0x8a,0x2,0x0   			DISP_COM3_LAT_BIT = false;                                                    C:\fw\midicontroller\x009\leds.c
0030aa   c13b     MOVFF     0x13b,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x009\leds.c
0030ac   ffe6                                                                                                               
0030ae   d81f     RCALL     0x30ee                                                                                          
0030b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030b2   d006     BRA       0x30c0         			break;                                                                        C:\fw\midicontroller\x009\leds.c
                                           		case 4:                                                                        C:\fw\midicontroller\x009\leds.c
0030b4   928a     BCF       0x8a,0x1,0x0   			DISP_COM4_LAT_BIT = false;                                                    C:\fw\midicontroller\x009\leds.c
0030b6   c13b     MOVFF     0x13b,0xfe6    			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x009\leds.c
0030b8   ffe6                                                                                                               
0030ba   d819     RCALL     0x30ee                                                                                          
0030bc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030be   d000     BRA       0x30c0         			break;                                                                        C:\fw\midicontroller\x009\leds.c
                                           		default:                                                                       C:\fw\midicontroller\x009\leds.c
                                           			//do nothing                                                                  C:\fw\midicontroller\x009\leds.c
003082   d01e     BRA       0x30c0         			break;                                                                        C:\fw\midicontroller\x009\leds.c
                                           	}                                                                               C:\fw\midicontroller\x009\leds.c
0030c0   0101     MOVLB     0x1            	if (++ComPointer >= DispNumOfCommons) ComPointer = 0;                           C:\fw\midicontroller\x009\leds.c
0030c2   2b3b     INCF      0x3b,0x1,0x1                                                                                    
0030c4   0100     MOVLB     0x0                                                                                             
0030c6   51b0     MOVF      0xb0,0x0,0x1                                                                                    
0030c8   0101     MOVLB     0x1                                                                                             
0030ca   5d3b     SUBWF     0x3b,0x0,0x1                                                                                    
0030cc   e301     BNC       0x30d0                                                                                          
0030ce   6b3b     CLRF      0x3b,0x1                                                                                        
0030d0   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           void	AllDigitsOff(void) {                                                        C:\fw\midicontroller\x009\leds.c
0030d2   908a     BCF       0x8a,0x0,0x0   	DISP_SEG0_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030d4   9e8c     BCF       0x8c,0x7,0x0   	DISP_SEG1_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030d6   9c8c     BCF       0x8c,0x6,0x0   	DISP_SEG2_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030d8   9a8c     BCF       0x8c,0x5,0x0   	DISP_SEG3_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030da   988c     BCF       0x8c,0x4,0x0   	DISP_SEG4_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030dc   948b     BCF       0x8b,0x2,0x0   	DISP_SEG5_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030de   968c     BCF       0x8c,0x3,0x0   	DISP_SEG6_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
0030e0   948c     BCF       0x8c,0x2,0x0   	DISP_SEG7_LAT_BIT = false;                                                      C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
0030e2   8a8a     BSF       0x8a,0x5,0x0   	DISP_COM0_LAT_BIT = true;                                                       C:\fw\midicontroller\x009\leds.c
0030e4   808b     BSF       0x8b,0x0,0x0   	DISP_COM1_LAT_BIT = true;                                                       C:\fw\midicontroller\x009\leds.c
0030e6   868a     BSF       0x8a,0x3,0x0   	DISP_COM2_LAT_BIT = true;                                                       C:\fw\midicontroller\x009\leds.c
0030e8   848a     BSF       0x8a,0x2,0x0   	DISP_COM3_LAT_BIT = true;                                                       C:\fw\midicontroller\x009\leds.c
0030ea   828a     BSF       0x8a,0x1,0x0   	DISP_COM4_LAT_BIT = true;                                                       C:\fw\midicontroller\x009\leds.c
0030ec   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
0030ee   cfd9     MOVFF     0xfd9,0xfe6    void	HandleDigit(unsigned char ComPointer) {                                     C:\fw\midicontroller\x009\leds.c
0030f0   ffe6                                                                                                               
0030f2   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0030f4   ffd9                                                                                                               
0030f6   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	BitField x;                                                                     C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
0030f8   0efe     MOVLW     0xfe           	x.byte = DispSegData[ComPointer].byte;                                          C:\fw\midicontroller\x009\leds.c
0030fa   50db     MOVF      0xdb,0x0,0x0                                                                                    
0030fc   6aea     CLRF      0xea,0x0                                                                                        
0030fe   0fab     ADDLW     0xab                                                                                            
003100   6ee9     MOVWF     0xe9,0x0                                                                                        
003102   0e00     MOVLW     0x0                                                                                             
003104   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003106   cfef     MOVFF     0xfef,0xfdf                                                                                     
003108   ffdf                                                                                                               
00310a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit0) DISP_SEG0_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00310c   ffe9                                                                                                               
00310e   cfda     MOVFF     0xfda,0xfea                                                                                     
003110   ffea                                                                                                               
003112   50ef     MOVF      0xef,0x0,0x0                                                                                    
003114   0b01     ANDLW     0x1                                                                                             
003116   e001     BZ        0x311a                                                                                          
003118   808a     BSF       0x8a,0x0,0x0                                                                                    
00311a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit1) DISP_SEG1_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00311c   ffe9                                                                                                               
00311e   cfda     MOVFF     0xfda,0xfea                                                                                     
003120   ffea                                                                                                               
003122   50ef     MOVF      0xef,0x0,0x0                                                                                    
003124   0b02     ANDLW     0x2                                                                                             
003126   e001     BZ        0x312a                                                                                          
003128   8e8c     BSF       0x8c,0x7,0x0                                                                                    
00312a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit2) DISP_SEG2_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00312c   ffe9                                                                                                               
00312e   cfda     MOVFF     0xfda,0xfea                                                                                     
003130   ffea                                                                                                               
003132   50ef     MOVF      0xef,0x0,0x0                                                                                    
003134   0b04     ANDLW     0x4                                                                                             
003136   e001     BZ        0x313a                                                                                          
003138   8c8c     BSF       0x8c,0x6,0x0                                                                                    
00313a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit3) DISP_SEG3_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00313c   ffe9                                                                                                               
00313e   cfda     MOVFF     0xfda,0xfea                                                                                     
003140   ffea                                                                                                               
003142   50ef     MOVF      0xef,0x0,0x0                                                                                    
003144   0b08     ANDLW     0x8                                                                                             
003146   e001     BZ        0x314a                                                                                          
003148   8a8c     BSF       0x8c,0x5,0x0                                                                                    
00314a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit4) DISP_SEG4_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00314c   ffe9                                                                                                               
00314e   cfda     MOVFF     0xfda,0xfea                                                                                     
003150   ffea                                                                                                               
003152   50ef     MOVF      0xef,0x0,0x0                                                                                    
003154   0b10     ANDLW     0x10                                                                                            
003156   e001     BZ        0x315a                                                                                          
003158   888c     BSF       0x8c,0x4,0x0                                                                                    
00315a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit5) DISP_SEG5_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00315c   ffe9                                                                                                               
00315e   cfda     MOVFF     0xfda,0xfea                                                                                     
003160   ffea                                                                                                               
003162   50ef     MOVF      0xef,0x0,0x0                                                                                    
003164   0b20     ANDLW     0x20                                                                                            
003166   e001     BZ        0x316a                                                                                          
003168   848b     BSF       0x8b,0x2,0x0                                                                                    
00316a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit6) DISP_SEG6_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00316c   ffe9                                                                                                               
00316e   cfda     MOVFF     0xfda,0xfea                                                                                     
003170   ffea                                                                                                               
003172   50ef     MOVF      0xef,0x0,0x0                                                                                    
003174   0b40     ANDLW     0x40                                                                                            
003176   e001     BZ        0x317a                                                                                          
003178   868c     BSF       0x8c,0x3,0x0                                                                                    
00317a   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit7) DISP_SEG7_LAT_BIT = true;                                           C:\fw\midicontroller\x009\leds.c
00317c   ffe9                                                                                                               
00317e   cfda     MOVFF     0xfda,0xfea                                                                                     
003180   ffea                                                                                                               
003182   50ef     MOVF      0xef,0x0,0x0                                                                                    
003184   0b80     ANDLW     0x80                                                                                            
003186   e001     BZ        0x318a                                                                                          
003188   848c     BSF       0x8c,0x2,0x0                                                                                    
00318a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\leds.c
00318c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00318e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003190   ffd9                                                                                                               
003192   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\leds.c
003194   cfd9     MOVFF     0xfd9,0xfe6    void	SetDispAscii(unsigned char chars[]) {                                       C:\fw\midicontroller\x009\leds.c
003196   ffe6                                                                                                               
003198   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00319a   ffd9                                                                                                               
00319c   0e02     MOVLW     0x2                                                                                             
00319e   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
0031a0   0e01     MOVLW     0x1            	for (i = 0;i<5;i++) {                                                           C:\fw\midicontroller\x009\leds.c
0031a2   6adb     CLRF      0xdb,0x0                                                                                        
0031a4   0e05     MOVLW     0x5                                                                                             
0031a6   6ef3     MOVWF     0xf3,0x0                                                                                        
0031a8   0e01     MOVLW     0x1                                                                                             
0031aa   cfdb     MOVFF     0xfdb,0xff4                                                                                     
0031ac   fff4                                                                                                               
0031ae   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0031b0   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
0031b2   e221     BC        0x31f6                                                                                          
0031f0   0e01     MOVLW     0x1                                                                                             
0031f2   2adb     INCF      0xdb,0x1,0x0                                                                                    
0031f4   d7d7     BRA       0x31a4                                                                                          
0031b4   0e01     MOVLW     0x1            		x = chars[i];                                                                  C:\fw\midicontroller\x009\leds.c
0031b6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0031b8   6ee7     MOVWF     0xe7,0x0                                                                                        
0031ba   0efd     MOVLW     0xfd                                                                                            
0031bc   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0031be   ffe9                                                                                                               
0031c0   0efe     MOVLW     0xfe                                                                                            
0031c2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0031c4   ffea                                                                                                               
0031c6   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0031c8   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0031ca   0e00     MOVLW     0x0                                                                                             
0031cc   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0031ce   cfef     MOVFF     0xfef,0xfdf                                                                                     
0031d0   ffdf                                                                                                               
0031d2   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          C:\fw\midicontroller\x009\leds.c
0031d4   ffe6                                                                                                               
0031d6   d864     RCALL     0x32a0                                                                                          
0031d8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0031da   6ee6     MOVWF     0xe6,0x0                                                                                        
0031dc   0e01     MOVLW     0x1                                                                                             
0031de   50db     MOVF      0xdb,0x0,0x0                                                                                    
0031e0   6aea     CLRF      0xea,0x0                                                                                        
0031e2   0fab     ADDLW     0xab                                                                                            
0031e4   6ee9     MOVWF     0xe9,0x0                                                                                        
0031e6   0e00     MOVLW     0x0                                                                                             
0031e8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0031ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0031ec   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0031ee   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x009\leds.c
0031f6   0e02     MOVLW     0x2            }                                                                                C:\fw\midicontroller\x009\leds.c
0031f8   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0031fa   e202     BC        0x3200                                                                                          
0031fc   6ae1     CLRF      0xe1,0x0                                                                                        
0031fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003200   6ee1     MOVWF     0xe1,0x0                                                                                        
003202   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003204   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003206   ffd9                                                                                                               
003208   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           /* show 4 alphas on the 4-digit display */                                       C:\fw\midicontroller\x009\leds.c
00320a   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_4alphas(char text[LEDS_MAX_ALPHAS]){                              C:\fw\midicontroller\x009\leds.c
00320c   ffe6                                                                                                               
00320e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003210   ffd9                                                                                                               
003212   0e02     MOVLW     0x2                                                                                             
003214   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
003216   0e01     MOVLW     0x1            	for (i = 0;i<4;i++) {                                                           C:\fw\midicontroller\x009\leds.c
003218   6adb     CLRF      0xdb,0x0                                                                                        
00321a   0e04     MOVLW     0x4                                                                                             
00321c   6ef3     MOVWF     0xf3,0x0                                                                                        
00321e   0e01     MOVLW     0x1                                                                                             
003220   cfdb     MOVFF     0xfdb,0xff4                                                                                     
003222   fff4                                                                                                               
003224   50f3     MOVF      0xf3,0x0,0x0                                                                                    
003226   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
003228   e221     BC        0x326c                                                                                          
003266   0e01     MOVLW     0x1                                                                                             
003268   2adb     INCF      0xdb,0x1,0x0                                                                                    
00326a   d7d7     BRA       0x321a                                                                                          
00322a   0e01     MOVLW     0x1            		x = text[i];                                                                   C:\fw\midicontroller\x009\leds.c
00322c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00322e   6ee7     MOVWF     0xe7,0x0                                                                                        
003230   0efd     MOVLW     0xfd                                                                                            
003232   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
003234   ffe9                                                                                                               
003236   0efe     MOVLW     0xfe                                                                                            
003238   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00323a   ffea                                                                                                               
00323c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00323e   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
003240   0e00     MOVLW     0x0                                                                                             
003242   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003244   cfef     MOVFF     0xfef,0xfdf                                                                                     
003246   ffdf                                                                                                               
003248   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          C:\fw\midicontroller\x009\leds.c
00324a   ffe6                                                                                                               
00324c   d829     RCALL     0x32a0                                                                                          
00324e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003250   6ee6     MOVWF     0xe6,0x0                                                                                        
003252   0e01     MOVLW     0x1                                                                                             
003254   50db     MOVF      0xdb,0x0,0x0                                                                                    
003256   6aea     CLRF      0xea,0x0                                                                                        
003258   0fab     ADDLW     0xab                                                                                            
00325a   6ee9     MOVWF     0xe9,0x0                                                                                        
00325c   0e00     MOVLW     0x0                                                                                             
00325e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003260   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003262   50e7     MOVF      0xe7,0x0,0x0                                                                                    
003264   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x009\leds.c
00326c   0e02     MOVLW     0x2            }                                                                                C:\fw\midicontroller\x009\leds.c
00326e   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
003270   e202     BC        0x3276                                                                                          
003272   6ae1     CLRF      0xe1,0x0                                                                                        
003274   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003276   6ee1     MOVWF     0xe1,0x0                                                                                        
003278   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00327a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00327c   ffd9                                                                                                               
00327e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           /* show single digit on the single digit display */                              C:\fw\midicontroller\x009\leds.c
003280   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_1digit(u8 value){                                                 C:\fw\midicontroller\x009\leds.c
003282   ffe6                                                                                                               
003284   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003286   ffd9                                                                                                               
003288   0efe     MOVLW     0xfe           	DispSegData[4].byte = AsciiTo7Seg(value+'0');                                   C:\fw\midicontroller\x009\leds.c
00328a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00328c   0f30     ADDLW     0x30                                                                                            
00328e   6ee6     MOVWF     0xe6,0x0                                                                                        
003290   d807     RCALL     0x32a0                                                                                          
003292   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003294   0100     MOVLB     0x0                                                                                             
003296   6faf     MOVWF     0xaf,0x1                                                                                        
003298   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\leds.c
00329a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00329c   ffd9                                                                                                               
00329e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\leds.c
0032a0   cfd9     MOVFF     0xfd9,0xfe6    unsigned char AsciiTo7Seg(unsigned char chr) {                                   C:\fw\midicontroller\x009\leds.c
0032a2   ffe6                                                                                                               
0032a4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0032a6   ffd9                                                                                                               
                                           	                                                                                C:\fw\midicontroller\x009\leds.c
0032a8   0e41     MOVLW     0x41           	if (chr >= 'A') {                                                               C:\fw\midicontroller\x009\leds.c
0032aa   6ef3     MOVWF     0xf3,0x0                                                                                        
0032ac   0efe     MOVLW     0xfe                                                                                            
0032ae   cfdb     MOVFF     0xfdb,0xff4                                                                                     
0032b0   fff4                                                                                                               
0032b2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0032b4   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
0032b6   e328     BNC       0x3308                                                                                          
0032b8   0e61     MOVLW     0x61           		if (chr >= 'a') chr -= 'a';	//lower case                                       C:\fw\midicontroller\x009\leds.c
0032ba   6ef3     MOVWF     0xf3,0x0                                                                                        
0032bc   0efe     MOVLW     0xfe                                                                                            
0032be   cfdb     MOVFF     0xfdb,0xff4                                                                                     
0032c0   fff4                                                                                                               
0032c2   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0032c4   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
0032c6   e30b     BNC       0x32de                                                                                          
0032c8   0e61     MOVLW     0x61                                                                                            
0032ca   6e10     MOVWF     0x10,0x0                                                                                        
0032cc   0efe     MOVLW     0xfe                                                                                            
0032ce   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
0032d0   ffe7                                                                                                               
0032d2   5010     MOVF      0x10,0x0,0x0                                                                                    
0032d4   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
0032d6   0efe     MOVLW     0xfe                                                                                            
0032d8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0032da   ffdb                                                                                                               
0032dc   d00a     BRA       0x32f2         		else chr-='A';			//capital                                                     C:\fw\midicontroller\x009\leds.c
0032de   0e41     MOVLW     0x41                                                                                            
0032e0   6e10     MOVWF     0x10,0x0                                                                                        
0032e2   0efe     MOVLW     0xfe                                                                                            
0032e4   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
0032e6   ffe7                                                                                                               
0032e8   5010     MOVF      0x10,0x0,0x0                                                                                    
0032ea   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
0032ec   0efe     MOVLW     0xfe                                                                                            
0032ee   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0032f0   ffdb                                                                                                               
0032f2   50db     MOVF      0xdb,0x0,0x0   		chr=LettersSegTable[chr];                                                      C:\fw\midicontroller\x009\leds.c
0032f4   6af7     CLRF      0xf7,0x0                                                                                        
0032f6   0f4e     ADDLW     0x4e                                                                                            
0032f8   6ef6     MOVWF     0xf6,0x0                                                                                        
0032fa   0e39     MOVLW     0x39                                                                                            
0032fc   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0032fe   0008     TBLRD                                                                                                     
003300   0efe     MOVLW     0xfe                                                                                            
003302   cff5     MOVFF     0xff5,0xfdb                                                                                     
003304   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x009\leds.c
003306   d026     BRA       0x3354         	else if (chr >= '0') {                                                          C:\fw\midicontroller\x009\leds.c
003308   0e30     MOVLW     0x30                                                                                            
00330a   6ef3     MOVWF     0xf3,0x0                                                                                        
00330c   0efe     MOVLW     0xfe                                                                                            
00330e   cfdb     MOVFF     0xfdb,0xff4                                                                                     
003310   fff4                                                                                                               
003312   50f3     MOVF      0xf3,0x0,0x0                                                                                    
003314   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
003316   e315     BNC       0x3342                                                                                          
003318   0e30     MOVLW     0x30           		chr -= '0';	//numbers                                                          C:\fw\midicontroller\x009\leds.c
00331a   6e10     MOVWF     0x10,0x0                                                                                        
00331c   0efe     MOVLW     0xfe                                                                                            
00331e   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
003320   ffe7                                                                                                               
003322   5010     MOVF      0x10,0x0,0x0                                                                                    
003324   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
003326   0efe     MOVLW     0xfe                                                                                            
003328   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
00332a   ffdb                                                                                                               
00332c   50db     MOVF      0xdb,0x0,0x0   		chr=NumbersSegTable[chr];                                                      C:\fw\midicontroller\x009\leds.c
00332e   6af7     CLRF      0xf7,0x0                                                                                        
003330   0f44     ADDLW     0x44                                                                                            
003332   6ef6     MOVWF     0xf6,0x0                                                                                        
003334   0e39     MOVLW     0x39                                                                                            
003336   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
003338   0008     TBLRD                                                                                                     
00333a   0efe     MOVLW     0xfe                                                                                            
00333c   cff5     MOVFF     0xff5,0xfdb                                                                                     
00333e   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x009\leds.c
003340   d009     BRA       0x3354         	else if (chr == ' ') chr = 0;		//space characters                               C:\fw\midicontroller\x009\leds.c
003342   0efe     MOVLW     0xfe                                                                                            
003344   50db     MOVF      0xdb,0x0,0x0                                                                                    
003346   0820     SUBLW     0x20                                                                                            
003348   e103     BNZ       0x3350                                                                                          
00334a   0efe     MOVLW     0xfe                                                                                            
00334c   6adb     CLRF      0xdb,0x0                                                                                        
00334e   d002     BRA       0x3354         	else chr = 0;				//all other characters are spaces                              C:\fw\midicontroller\x009\leds.c
003350   0efe     MOVLW     0xfe                                                                                            
003352   6adb     CLRF      0xdb,0x0                                                                                        
003354   50db     MOVF      0xdb,0x0,0x0   	return chr;                                                                     C:\fw\midicontroller\x009\leds.c
003356   d000     BRA       0x3358                                                                                          
003358   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x009\leds.c
00335a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00335c   ffd9                                                                                                               
00335e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           rom unsigned char NumbersSegTable[10] = {                                        C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<4)|(1<<2)|(1<<3),			//0                                C:\fw\midicontroller\x009\leds.c
                                           	(1<<1)|(1<<2),										//1                                                     C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3),					//2                                     C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<2)|(1<<3),					//3                                     C:\fw\midicontroller\x009\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2),						//4                                           C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<2)|(1<<3),					//5                                     C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<2)|(1<<3),			//6                                C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),								//7                                                C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<3)|(1<<4)|(1<<5)|(1<<6),	//8                           C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)					//9                                      C:\fw\midicontroller\x009\leds.c
                                           };                                                                               C:\fw\midicontroller\x009\leds.c
                                                                                                                            C:\fw\midicontroller\x009\leds.c
                                           rom unsigned char LettersSegTable[26] = {                                        C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<4)|(1<<5)|(1<<6),	//A                                  C:\fw\midicontroller\x009\leds.c
                                           	(1<<4)|(1<<6)|(1<<5)|(1<<2)|(1<<3),			//b                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<6)|(1<<4)|(1<<3),						//c                                                  C:\fw\midicontroller\x009\leds.c
                                           	(1<<6)|(1<<4)|(1<<3)|(1<<2)|(1<<1),			//d                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<3),			//E                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4),				//F                                             C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),	//g                                  C:\fw\midicontroller\x009\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4),				//h                                             C:\fw\midicontroller\x009\leds.c
                                           	(1<<1)|(1<<2),								//I                                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<1)|(1<<2)|(1<<3)|(1<<4),				//J                                             C:\fw\midicontroller\x009\leds.c
                                           	0,											//K                                                                C:\fw\midicontroller\x009\leds.c
                                           	(1<<5)|(1<<4)|(1<<3),						//L                                                  C:\fw\midicontroller\x009\leds.c
                                           	0,											//m                                                                C:\fw\midicontroller\x009\leds.c
                                           	(1<<4)|(1<<6)|(1<<2),						//n                                                  C:\fw\midicontroller\x009\leds.c
                                           	(1<<6)|(1<<4)|(1<<2)|(1<<3),				//o                                             C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<4),			//P                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2),			//q                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<4)|(1<<6),								//r                                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<3)|(1<<2)|(1<<6)|(1<<5)|(1<<0),			//S                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),						//T                                                  C:\fw\midicontroller\x009\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//u                                                  C:\fw\midicontroller\x009\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//v                                                  C:\fw\midicontroller\x009\leds.c
                                           	0,											//w                                                                C:\fw\midicontroller\x009\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4)|(1<<1),			//x                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),			//y                                       C:\fw\midicontroller\x009\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3)			//z                                        C:\fw\midicontroller\x009\leds.c
                                           };                                                                               C:\fw\midicontroller\x009\leds.c
                                           //*;###########################################################################  C:\fw\midicontroller\x009\tables.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x009\tables.c
                                           //;#			Date 5/28/07					      						  #                                          C:\fw\midicontroller\x009\tables.c
                                           //;#			Tables in the code								  			  #                                        C:\fw\midicontroller\x009\tables.c
                                           //;#			File Name: tables.c   										  #                                       C:\fw\midicontroller\x009\tables.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x009\tables.c
                                           //;############################################################################  C:\fw\midicontroller\x009\tables.c
                                                                                                                            C:\fw\midicontroller\x009\tables.c
                                                                                                                            C:\fw\midicontroller\x009\tables.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x009\tables.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x009\tables.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x009\tables.c
                                                                                                                            C:\fw\midicontroller\x009\tables.c
                                           #pragma romdata                                                                  C:\fw\midicontroller\x009\tables.c
                                                                                                                            C:\fw\midicontroller\x009\tables.c
                                           rom unsigned char EXPP_PEDAL_LINEAR_CONV_TABLE[256] =                            C:\fw\midicontroller\x009\tables.c
                                           {                                                                                C:\fw\midicontroller\x009\tables.c
                                           	0                                                                               C:\fw\midicontroller\x009\tables.c
                                           };                                                                               C:\fw\midicontroller\x009\tables.c
                                                                                                                            C:\fw\midicontroller\x009\tables.c
                                           #pragma romdata ROMSAVEDATA=0x4000                                               C:\fw\midicontroller\x009\tables.c
                                           rom unsigned char ROM_SAVEDATA[8191] = {                                         C:\fw\midicontroller\x009\tables.c
                                           	0                                                                               C:\fw\midicontroller\x009\tables.c
                                           };                                                                               C:\fw\midicontroller\x009\tables.c
                                                                                                                            C:\fw\midicontroller\x009\tables.c
                                           #pragma code                                                                     C:\fw\midicontroller\x009\tables.c
