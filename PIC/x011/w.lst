MP2COD 4.1, COFF to COD File Converter
Copyright (c) 2006 Microchip Technology Inc.
Listing File Generated: Fri Jun 01 16:50:08 2007


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           //*;###########################################################################  C:\fw\midicontroller\x011\main.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\main.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x011\main.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x011\main.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x011\main.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\main.c
                                           //;############################################################################  C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\main.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                           unsigned char	ADC_CONVERSION(unsigned char Channel);                             C:\fw\midicontroller\x011\main.c
                                           void	ServiceUSB(void);                                                           C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                           //#define	RX_TRIS_BIT		TRISCbits.TRISC7		// Receive direction bit                C:\fw\midicontroller\x011\main.c
                                           //#define	TX_TRIS_BIT		TRISCbits.TRISC6		// Transmit direction bit               C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                           #pragma code	main_code=0xA2A                                                     C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
000a2a   cfd9     MOVFF     0xfd9,0xfe6    void main() {                                                                    C:\fw\midicontroller\x011\main.c
000a2c   ffe6                                                                                                               
000a2e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000a30   ffd9                                                                                                               
000a32   0e05     MOVLW     0x5                                                                                             
000a34   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char chars[5];                                                         C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
000a36   ec90     CALL      0x3520,0x0     	init();                                                                         C:\fw\midicontroller\x011\main.c
000a38   f01a                                                                                                               
                                           //	controllerinit();                                                             C:\fw\midicontroller\x011\main.c
                                           	                                                                                C:\fw\midicontroller\x011\main.c
000a3a   0e20     MOVLW     0x20           	chars[0] = ' ';                                                                 C:\fw\midicontroller\x011\main.c
000a3c   6edf     MOVWF     0xdf,0x0                                                                                        
000a3e   52de     MOVF      0xde,0x1,0x0   	chars[1] = 'p';                                                                 C:\fw\midicontroller\x011\main.c
000a40   0e70     MOVLW     0x70                                                                                            
000a42   6edd     MOVWF     0xdd,0x0                                                                                        
000a44   0e61     MOVLW     0x61           	chars[2] = 'a';                                                                 C:\fw\midicontroller\x011\main.c
000a46   6ef3     MOVWF     0xf3,0x0                                                                                        
000a48   0e02     MOVLW     0x2                                                                                             
000a4a   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a4c   ffdb                                                                                                               
000a4e   0e72     MOVLW     0x72           	chars[3] = 'r';                                                                 C:\fw\midicontroller\x011\main.c
000a50   6ef3     MOVWF     0xf3,0x0                                                                                        
000a52   0e03     MOVLW     0x3                                                                                             
000a54   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a56   ffdb                                                                                                               
000a58   0e63     MOVLW     0x63           	chars[4] = 'c';                                                                 C:\fw\midicontroller\x011\main.c
000a5a   6ef3     MOVWF     0xf3,0x0                                                                                        
000a5c   0e04     MOVLW     0x4                                                                                             
000a5e   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a60   ffdb                                                                                                               
000a62   cfd9     MOVFF     0xfd9,0xfe6    	SetDispAscii(chars);                                                            C:\fw\midicontroller\x011\main.c
000a64   ffe6                                                                                                               
000a66   cfda     MOVFF     0xfda,0xfe6                                                                                     
000a68   ffe6                                                                                                               
000a6a   ec08     CALL      0x2a10,0x0                                                                                      
000a6c   f015                                                                                                               
000a6e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a70   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a72   0eaa     MOVLW     0xaa           	SendDataToShiftReg(0xAA);                                                       C:\fw\midicontroller\x011\main.c
000a74   6ee6     MOVWF     0xe6,0x0                                                                                        
000a76   ec86     CALL      0x250c,0x0                                                                                      
000a78   f012                                                                                                               
000a7a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
000a7c   0e00     MOVLW     0x0            	chars[0] = ROM_SAVEDATA[0];                                                     C:\fw\midicontroller\x011\main.c
000a7e   6ef6     MOVWF     0xf6,0x0                                                                                        
000a80   0e40     MOVLW     0x40                                                                                            
000a82   6ef7     MOVWF     0xf7,0x0                                                                                        
000a84   0008     TBLRD                                                                                                     
000a86   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000a88   6edf     MOVWF     0xdf,0x0                                                                                        
000a8a   0e01     MOVLW     0x1            	chars[1] = ROM_SAVEDATA[1];                                                     C:\fw\midicontroller\x011\main.c
000a8c   6ef6     MOVWF     0xf6,0x0                                                                                        
000a8e   0e40     MOVLW     0x40                                                                                            
000a90   6ef7     MOVWF     0xf7,0x0                                                                                        
000a92   0008     TBLRD                                                                                                     
000a94   0e01     MOVLW     0x1                                                                                             
000a96   cff5     MOVFF     0xff5,0xfdb                                                                                     
000a98   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\main.c
000a9a   0100     MOVLB     0x0            	ProgmemBuffer[0] = 0xAA;                                                        C:\fw\midicontroller\x011\main.c
000a9c   0eaa     MOVLW     0xaa                                                                                            
000a9e   6fbb     MOVWF     0xbb,0x1                                                                                        
000aa0   0e55     MOVLW     0x55           	ProgmemBuffer[1] = 0x55;                                                        C:\fw\midicontroller\x011\main.c
000aa2   6fbc     MOVWF     0xbc,0x1                                                                                        
000aa4   0ebb     MOVLW     0xbb           	Write64BytesProgMem(ROM_SAVEDATA,ProgmemBuffer);                                C:\fw\midicontroller\x011\main.c
000aa6   6ee6     MOVWF     0xe6,0x0                                                                                        
000aa8   0e00     MOVLW     0x0                                                                                             
000aaa   6ee6     MOVWF     0xe6,0x0                                                                                        
000aac   0e00     MOVLW     0x0                                                                                             
000aae   6ee6     MOVWF     0xe6,0x0                                                                                        
000ab0   0e40     MOVLW     0x40                                                                                            
000ab2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ab4   ec7f     CALL      0x26fe,0x0                                                                                      
000ab6   f013                                                                                                               
000ab8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000aba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000abc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000abe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ac0   0e00     MOVLW     0x0            	chars[0] = ROM_SAVEDATA[0];                                                     C:\fw\midicontroller\x011\main.c
000ac2   6ef6     MOVWF     0xf6,0x0                                                                                        
000ac4   0e40     MOVLW     0x40                                                                                            
000ac6   6ef7     MOVWF     0xf7,0x0                                                                                        
000ac8   0008     TBLRD                                                                                                     
000aca   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000acc   6edf     MOVWF     0xdf,0x0                                                                                        
000ace   0e01     MOVLW     0x1            	chars[1] = ROM_SAVEDATA[1];                                                     C:\fw\midicontroller\x011\main.c
000ad0   6ef6     MOVWF     0xf6,0x0                                                                                        
000ad2   0e40     MOVLW     0x40                                                                                            
000ad4   6ef7     MOVWF     0xf7,0x0                                                                                        
000ad6   0008     TBLRD                                                                                                     
000ad8   0e01     MOVLW     0x1                                                                                             
000ada   cff5     MOVFF     0xff5,0xfdb                                                                                     
000adc   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                                                                                                            C:\fw\midicontroller\x011\main.c
000aee   d7f7     BRA       0xade          	for(;;) {                                                                       C:\fw\midicontroller\x011\main.c
000ade   0100     MOVLB     0x0            		if (Systick) {                                                                 C:\fw\midicontroller\x011\main.c
000ae0   a160     BTFSS     0x60,0x0,0x1                                                                                    
000ae2   d004     BRA       0xaec                                                                                           
                                                                                                                            C:\fw\midicontroller\x011\main.c
000ae4   ecae     CALL      0x255c,0x0     			ReadButtons();                                                                C:\fw\midicontroller\x011\main.c
000ae6   f012                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                           //			ProcessControl();                                                           C:\fw\midicontroller\x011\main.c
                                           //			if (LATE == 0x05) LATE = 0x2;                                               C:\fw\midicontroller\x011\main.c
                                           //			else LATE = 0x05;                                                           C:\fw\midicontroller\x011\main.c
000ae8   ec72     CALL      0x28e4,0x0     			ProcessLeds();                                                                C:\fw\midicontroller\x011\main.c
000aea   f014                                                                                                               
                                           			//ServiceRequests();                                                          C:\fw\midicontroller\x011\main.c
                                           			                                                                              C:\fw\midicontroller\x011\main.c
                                           		}                                                                              C:\fw\midicontroller\x011\main.c
000aec   d80b     RCALL     0xb04          		ServiceUSB();                                                                  C:\fw\midicontroller\x011\main.c
                                           	}                                                                               C:\fw\midicontroller\x011\main.c
000af0   0e05     MOVLW     0x5            }                                                                                C:\fw\midicontroller\x011\main.c
000af2   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000af4   e202     BC        0xafa                                                                                           
000af6   6ae1     CLRF      0xe1,0x0                                                                                        
000af8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000afa   6ee1     MOVWF     0xe1,0x0                                                                                        
000afc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000afe   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000b00   ffd9                                                                                                               
000b02   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\main.c
                                           void	ServiceUSB(void) {                                                          C:\fw\midicontroller\x011\main.c
000b04   eca7     CALL      0x234e,0x0     	USBCheckBusStatus();                    // Must use polling method              C:\fw\midicontroller\x011\main.c
000b06   f011                                                                                                               
000b08   be6f     BTFSC     0x6f,0x7,0x0       if(UCFGbits.UTEYE!=1) {                                                      C:\fw\midicontroller\x011\main.c
000b0a   d002     BRA       0xb10                                                                                           
000b0c   ecc6     CALL      0x238c,0x0             USBDriverService();                 // Interrupt or polling method       C:\fw\midicontroller\x011\main.c
000b0e   f011                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x011\main.c
000b10   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\main.c
                                           /* $Id: c018.c,v 1.2.14.1 2006/01/24 14:50:12 rhinec Exp $ */                    C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
                                           /* Copyright (c)1999 Microchip Technology */                                     C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
                                           /* MPLAB-C18 startup code */                                                     C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
                                           /* external reference to the user's main routine */                              C:\fw\midicontroller\x011\startup.c
                                           extern void main (void);                                                         C:\fw\midicontroller\x011\startup.c
                                           /* prototype for the startup function */                                         C:\fw\midicontroller\x011\startup.c
                                           void _entry (void);                                                              C:\fw\midicontroller\x011\startup.c
                                           void _startup (void);                                                            C:\fw\midicontroller\x011\startup.c
                                           extern near char __FPFLAGS;                                                      C:\fw\midicontroller\x011\startup.c
                                           #define RND 6                                                                    C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
                                           #pragma code _entry_scn=0x000A00                                                 C:\fw\midicontroller\x011\startup.c
                                           void                                                                             C:\fw\midicontroller\x011\startup.c
                                           _entry (void)                                                                    C:\fw\midicontroller\x011\startup.c
                                           {                                                                                C:\fw\midicontroller\x011\startup.c
000a00   ef27     GOTO      0x364e         _asm goto _startup _endasm                                                       C:\fw\midicontroller\x011\startup.c
000a02   f01b                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\startup.c
000a04   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
                                           #pragma code _startup_scn                                                        C:\fw\midicontroller\x011\startup.c
                                           void                                                                             C:\fw\midicontroller\x011\startup.c
                                           _startup (void)                                                                  C:\fw\midicontroller\x011\startup.c
                                           {                                                                                C:\fw\midicontroller\x011\startup.c
                                             _asm                                                                           C:\fw\midicontroller\x011\startup.c
                                               // Initialize the stack pointer                                              C:\fw\midicontroller\x011\startup.c
00364e   ee17     LFSR      0x1,0x700          lfsr 1, _stack                                                               C:\fw\midicontroller\x011\startup.c
003650   f000                                                                                                               
003652   ee27     LFSR      0x2,0x700          lfsr 2, _stack                                                               C:\fw\midicontroller\x011\startup.c
003654   f000                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\startup.c
003656   6af8     CLRF      0xf8,0x0           clrf TBLPTRU, 0 // 1st silicon doesn't do this on POR                        C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
003658   9c0f     BCF       0xf,0x6,0x0        bcf __FPFLAGS,RND,0 // Initalize rounding flag for floating point libs       C:\fw\midicontroller\x011\startup.c
                                           _endasm loop:                                                                    C:\fw\midicontroller\x011\startup.c
                                                                                                                            C:\fw\midicontroller\x011\startup.c
                                             // Call the user's main routine                                                C:\fw\midicontroller\x011\startup.c
00365a   ec15     CALL      0xa2a,0x0        main ();                                                                       C:\fw\midicontroller\x011\startup.c
00365c   f005                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\startup.c
00365e   d7fd     BRA       0x365a           goto loop;                                                                     C:\fw\midicontroller\x011\startup.c
003660   0012     RETURN    0x0            }                               /* end _startup() */                             C:\fw\midicontroller\x011\startup.c
                                           /*********************************************************************           C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *********************************************************************           C:\fw\midicontroller\x011\usb.c
                                            * FileName:        usb9.c                                                       C:\fw\midicontroller\x011\usb.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x011\usb.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x011\usb.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x011\usb.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x011\usb.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x011\usb.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x011\usb.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x011\usb.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x011\usb.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x011\usb.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x011\usb.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x011\usb.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x011\usb.c
                                            * license.                                                                      C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x011\usb.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x011\usb.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x011\usb.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x011\usb.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x011\usb.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Author               Date        Comment                                      C:\fw\midicontroller\x011\usb.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\fw\midicontroller\x011\usb.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\fw\midicontroller\x011\usb.c
                                            ********************************************************************/           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\usb.c
                                           //#include "io_cfg.h"                     // Required for self_power status      C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBStdGetDscHandler(void);                                                  C:\fw\midicontroller\x011\usb.c
                                           void USBStdSetCfgHandler(void);                                                  C:\fw\midicontroller\x011\usb.c
                                           void USBStdGetStatusHandler(void);                                               C:\fw\midicontroller\x011\usb.c
                                           void USBStdFeatureReqHandler(void);                                              C:\fw\midicontroller\x011\usb.c
                                           void HIDSetReportHandler(void);                                                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCheckStdRequest(void)                                C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\fw\midicontroller\x011\usb.c
                                            *                  knows how to handle it                                       C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCheckStdRequest(void)                                                    C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
001d72   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 C:\fw\midicontroller\x011\usb.c
001d74   5110     MOVF      0x10,0x0,0x1                                                                                    
001d76   0b60     ANDLW     0x60                                                                                            
001d78   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d7a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d7c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d7e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d80   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d82   0900     IORLW     0x0                                                                                             
001d84   e001     BZ        0x1d88                                                                                          
001d86   d04f     BRA       0x1e26                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001d88   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\fw\midicontroller\x011\usb.c
001d8a   0a07     XORLW     0x7                                                                                             
001d8c   e04b     BZ        0x1e24                                                                                          
001d8e   0a0b     XORLW     0xb                                                                                             
001d90   e049     BZ        0x1e24                                                                                          
001d92   0a07     XORLW     0x7                                                                                             
001d94   e03a     BZ        0x1e0a                                                                                          
001d96   0a01     XORLW     0x1                                                                                             
001d98   e028     BZ        0x1dea                                                                                          
001d9a   0a0b     XORLW     0xb                                                                                             
001d9c   e024     BZ        0x1de6                                                                                          
001d9e   0a02     XORLW     0x2                                                                                             
001da0   e022     BZ        0x1de6                                                                                          
001da2   0a03     XORLW     0x3                                                                                             
001da4   e01e     BZ        0x1de2                                                                                          
001da6   0a08     XORLW     0x8                                                                                             
001da8   e011     BZ        0x1dcc                                                                                          
001daa   0a01     XORLW     0x1                                                                                             
001dac   e00d     BZ        0x1dc8                                                                                          
001dae   0a0f     XORLW     0xf                                                                                             
001db0   e009     BZ        0x1dc4                                                                                          
001db2   0a03     XORLW     0x3                                                                                             
001db4   e001     BZ        0x1db8                                                                                          
001db6   d036     BRA       0x1e24                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
                                                   case SET_ADR:                                                            C:\fw\midicontroller\x011\usb.c
001db8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x011\usb.c
001dba   0e01     MOVLW     0x1                                                                                             
001dbc   6f4b     MOVWF     0x4b,0x1                                                                                        
001dbe   0e04     MOVLW     0x4                        usb_device_state = ADR_PENDING_STATE;       // Update state only     C:\fw\midicontroller\x011\usb.c
001dc0   6f46     MOVWF     0x46,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    C:\fw\midicontroller\x011\usb.c
001dc2   d031     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case GET_DSC:                                                            C:\fw\midicontroller\x011\usb.c
001dc4   d831     RCALL     0x1e28                     USBStdGetDscHandler();                                               C:\fw\midicontroller\x011\usb.c
001dc6   d02f     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case SET_CFG:                                                            C:\fw\midicontroller\x011\usb.c
001dc8   d890     RCALL     0x1eea                     USBStdSetCfgHandler();                                               C:\fw\midicontroller\x011\usb.c
001dca   d02d     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case GET_CFG:                                                            C:\fw\midicontroller\x011\usb.c
001dcc   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x011\usb.c
001dce   0e01     MOVLW     0x1                                                                                             
001dd0   6f4b     MOVWF     0x4b,0x1                                                                                        
001dd2   0e48     MOVLW     0x48                       pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            C:\fw\midicontroller\x011\usb.c
001dd4   6f4c     MOVWF     0x4c,0x1                                                                                        
001dd6   0e01     MOVLW     0x1                                                                                             
001dd8   6f4d     MOVWF     0x4d,0x1                                                                                        
001dda   9347     BCF       0x47,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\fw\midicontroller\x011\usb.c
001ddc   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        C:\fw\midicontroller\x011\usb.c
001dde   6f50     MOVWF     0x50,0x1                                                                                        
001de0   d022     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case GET_STATUS:                                                         C:\fw\midicontroller\x011\usb.c
001de2   d8a9     RCALL     0x1f36                     USBStdGetStatusHandler();                                            C:\fw\midicontroller\x011\usb.c
001de4   d020     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case CLR_FEATURE:                                                        C:\fw\midicontroller\x011\usb.c
                                                   case SET_FEATURE:                                                        C:\fw\midicontroller\x011\usb.c
001de6   d8f1     RCALL     0x1fca                     USBStdFeatureReqHandler();                                           C:\fw\midicontroller\x011\usb.c
001de8   d01e     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case GET_INTF:                                                           C:\fw\midicontroller\x011\usb.c
001dea   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x011\usb.c
001dec   0e01     MOVLW     0x1                                                                                             
001dee   6f4b     MOVWF     0x4b,0x1                                                                                        
001df0   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    C:\fw\midicontroller\x011\usb.c
001df2   5114     MOVF      0x14,0x0,0x1                                                                                    
001df4   0101     MOVLB     0x1                                                                                             
001df6   6f4c     MOVWF     0x4c,0x1                                                                                        
001df8   6b4d     CLRF      0x4d,0x1                                                                                        
001dfa   0e49     MOVLW     0x49                                                                                            
001dfc   274c     ADDWF     0x4c,0x1,0x1                                                                                    
001dfe   0e01     MOVLW     0x1                                                                                             
001e00   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
001e02   9347     BCF       0x47,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       C:\fw\midicontroller\x011\usb.c
001e04   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        C:\fw\midicontroller\x011\usb.c
001e06   6f50     MOVWF     0x50,0x1                                                                                        
001e08   d00e     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case SET_INTF:                                                           C:\fw\midicontroller\x011\usb.c
001e0a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x011\usb.c
001e0c   0e01     MOVLW     0x1                                                                                             
001e0e   6f4b     MOVWF     0x4b,0x1                                                                                        
001e10   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    C:\fw\midicontroller\x011\usb.c
001e12   5114     MOVF      0x14,0x0,0x1                                                                                    
001e14   6aea     CLRF      0xea,0x0                                                                                        
001e16   0f49     ADDLW     0x49                                                                                            
001e18   6ee9     MOVWF     0xe9,0x0                                                                                        
001e1a   0e01     MOVLW     0x1                                                                                             
001e1c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001e1e   c412     MOVFF     0x412,0xfef                                                                                     
001e20   ffef                                                                                                               
001e22   d001     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case SET_DSC:                                                            C:\fw\midicontroller\x011\usb.c
                                                   case SYNCH_FRAME:                                                        C:\fw\midicontroller\x011\usb.c
                                                   default:                                                                 C:\fw\midicontroller\x011\usb.c
001e24   d000     BRA       0x1e26                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                               }//end switch                                                                C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001e26   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBStdGetDscHandler(void)                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    C:\fw\midicontroller\x011\usb.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     C:\fw\midicontroller\x011\usb.c
                                            *                  This routine should never have to be modified if the tables  C:\fw\midicontroller\x011\usb.c
                                            *                  in usbdsc.c are declared correctly.                          C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBStdGetDscHandler(void)                                                   C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
001e28   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           C:\fw\midicontroller\x011\usb.c
001e2a   0104     MOVLB     0x4                                                                                             
001e2c   5d10     SUBWF     0x10,0x0,0x1                                                                                    
001e2e   e15c     BNZ       0x1ee8                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
001e30   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\fw\midicontroller\x011\usb.c
001e32   0a03     XORLW     0x3                                                                                             
001e34   e032     BZ        0x1e9a                                                                                          
001e36   0a01     XORLW     0x1                                                                                             
001e38   e00e     BZ        0x1e56                                                                                          
001e3a   0a03     XORLW     0x3                                                                                             
001e3c   e001     BZ        0x1e40                                                                                          
001e3e   d04b     BRA       0x1ed6                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
                                                       case DSC_DEV:                                                        C:\fw\midicontroller\x011\usb.c
001e40   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x011\usb.c
001e42   0e01     MOVLW     0x1                                                                                             
001e44   6f4b     MOVWF     0x4b,0x1                                                                                        
001e46   0e90     MOVLW     0x90                           pSrc.bRom = (rom byte*)&device_dsc;                              C:\fw\midicontroller\x011\usb.c
001e48   6f4c     MOVWF     0x4c,0x1                                                                                        
001e4a   0e32     MOVLW     0x32                                                                                            
001e4c   6f4d     MOVWF     0x4d,0x1                                                                                        
001e4e   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    C:\fw\midicontroller\x011\usb.c
001e50   6f50     MOVWF     0x50,0x1                                                                                        
001e52   6b51     CLRF      0x51,0x1                                                                                        
001e54   d040     BRA       0x1ed6                         break;                                                           C:\fw\midicontroller\x011\usb.c
                                                       case DSC_CFG:                                                        C:\fw\midicontroller\x011\usb.c
001e56   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x011\usb.c
001e58   0e01     MOVLW     0x1                                                                                             
001e5a   6f4b     MOVWF     0x4b,0x1                                                                                        
001e5c   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    C:\fw\midicontroller\x011\usb.c
001e5e   5112     MOVF      0x12,0x0,0x1                                                                                    
001e60   6ef6     MOVWF     0xf6,0x0                                                                                        
001e62   6af7     CLRF      0xf7,0x0                                                                                        
001e64   90d8     BCF       0xd8,0x0,0x0                                                                                    
001e66   36f6     RLCF      0xf6,0x1,0x0                                                                                    
001e68   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001e6a   0eaa     MOVLW     0xaa                                                                                            
001e6c   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001e6e   0e33     MOVLW     0x33                                                                                            
001e70   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e72   0009     TBLRDPOSTINC                                                                                              
001e74   cff5     MOVFF     0xff5,0x14c                                                                                     
001e76   f14c                                                                                                               
001e78   000a     TBLRDPOSTDEC                                                                                              
001e7a   cff5     MOVFF     0xff5,0x14d                                                                                     
001e7c   f14d                                                                                                               
001e7e   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    C:\fw\midicontroller\x011\usb.c
001e80   0101     MOVLB     0x1                                                                                             
001e82   6af7     CLRF      0xf7,0x0                                                                                        
001e84   254c     ADDWF     0x4c,0x0,0x1                                                                                    
001e86   6ef6     MOVWF     0xf6,0x0                                                                                        
001e88   514d     MOVF      0x4d,0x0,0x1                                                                                    
001e8a   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e8c   0009     TBLRDPOSTINC                                                                                              
001e8e   cff5     MOVFF     0xff5,0x150                                                                                     
001e90   f150                                                                                                               
001e92   000a     TBLRDPOSTDEC                                                                                              
001e94   cff5     MOVFF     0xff5,0x151                                                                                     
001e96   f151                                                                                                               
001e98   d01e     BRA       0x1ed6                         break;                                                           C:\fw\midicontroller\x011\usb.c
                                                       case DSC_STR:                                                        C:\fw\midicontroller\x011\usb.c
001e9a   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              C:\fw\midicontroller\x011\usb.c
001e9c   0e01     MOVLW     0x1                                                                                             
001e9e   6f4b     MOVWF     0x4b,0x1                                                                                        
001ea0   0104     MOVLB     0x4            				pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                                C:\fw\midicontroller\x011\usb.c
001ea2   5112     MOVF      0x12,0x0,0x1                                                                                    
001ea4   6ef6     MOVWF     0xf6,0x0                                                                                        
001ea6   6af7     CLRF      0xf7,0x0                                                                                        
001ea8   90d8     BCF       0xd8,0x0,0x0                                                                                    
001eaa   36f6     RLCF      0xf6,0x1,0x0                                                                                    
001eac   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001eae   0eae     MOVLW     0xae                                                                                            
001eb0   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001eb2   0e33     MOVLW     0x33                                                                                            
001eb4   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001eb6   0009     TBLRDPOSTINC                                                                                              
001eb8   cff5     MOVFF     0xff5,0x14c                                                                                     
001eba   f14c                                                                                                               
001ebc   000a     TBLRDPOSTDEC                                                                                              
001ebe   cff5     MOVFF     0xff5,0x14d                                                                                     
001ec0   f14d                                                                                                               
001ec2   c14c     MOVFF     0x14c,0xff6    				wCount._word = *pSrc.bRom;                  // Set data count                C:\fw\midicontroller\x011\usb.c
001ec4   fff6                                                                                                               
001ec6   c14d     MOVFF     0x14d,0xff7                                                                                     
001ec8   fff7                                                                                                               
001eca   0008     TBLRD                                                                                                     
001ecc   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001ece   0101     MOVLB     0x1                                                                                             
001ed0   6f50     MOVWF     0x50,0x1                                                                                        
001ed2   6b51     CLRF      0x51,0x1                                                                                        
001ed4   d000     BRA       0x1ed6                         break;                                                           C:\fw\midicontroller\x011\usb.c
                                                   }//end switch                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001ed6   0e02     MOVLW     0x2            		if (SetupPkt.bDscIndex != INDEX_NAME && SetupPkt.bDscIndex != INDEX_SERIALNUM) { //handle as NVR (or ram) read C:\fw\midicontroller\x011\usb.c
001ed8   0104     MOVLB     0x4                                                                                             
001eda   5d12     SUBWF     0x12,0x0,0x1                                                                                    
001edc   e005     BZ        0x1ee8                                                                                          
001ede   0e03     MOVLW     0x3                                                                                             
001ee0   5d12     SUBWF     0x12,0x0,0x1                                                                                    
001ee2   e002     BZ        0x1ee8                                                                                          
001ee4   0101     MOVLB     0x1                    	usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type  C:\fw\midicontroller\x011\usb.c
001ee6   8347     BSF       0x47,0x1,0x1                                                                                    
                                                   }                                                                        C:\fw\midicontroller\x011\usb.c
                                               }//end if                                                                    C:\fw\midicontroller\x011\usb.c
001ee8   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBStdSetCfgHandler(void)                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine first disables all endpoints by clearing        C:\fw\midicontroller\x011\usb.c
                                            *                  UEP registers. It then configures (initializes) endpoints    C:\fw\midicontroller\x011\usb.c
                                            *                  specified in the modifiable section.                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBStdSetCfgHandler(void)                                                   C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
001eea   0101     MOVLB     0x1                ctrl_trf_session_owner = MUID_USB9;                                          C:\fw\midicontroller\x011\usb.c
001eec   0e01     MOVLW     0x1                                                                                             
001eee   6f4b     MOVWF     0x4b,0x1                                                                                        
001ef0   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  C:\fw\midicontroller\x011\usb.c
001ef2   6ee6     MOVWF     0xe6,0x0                                                                                        
001ef4   0e71     MOVLW     0x71                                                                                            
001ef6   6ee6     MOVWF     0xe6,0x0                                                                                        
001ef8   0e0f     MOVLW     0xf                                                                                             
001efa   6ee6     MOVWF     0xe6,0x0                                                                                        
001efc   dac9     RCALL     0x2490                                                                                          
001efe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f04   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                C:\fw\midicontroller\x011\usb.c
001f06   6ee6     MOVWF     0xe6,0x0                                                                                        
001f08   0e49     MOVLW     0x49                                                                                            
001f0a   6ee6     MOVWF     0xe6,0x0                                                                                        
001f0c   0e01     MOVLW     0x1                                                                                             
001f0e   6ee6     MOVWF     0xe6,0x0                                                                                        
001f10   dabf     RCALL     0x2490                                                                                          
001f12   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f14   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f18   c412     MOVFF     0x412,0x148        usb_active_cfg = SetupPkt.bCfgValue;                                         C:\fw\midicontroller\x011\usb.c
001f1a   f148                                                                                                               
001f1c   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  C:\fw\midicontroller\x011\usb.c
001f1e   5112     MOVF      0x12,0x0,0x1                                                                                    
001f20   e104     BNZ       0x1f2a                                                                                          
001f22   0101     MOVLB     0x1                    usb_device_state = ADDRESS_STATE;                                        C:\fw\midicontroller\x011\usb.c
001f24   0e05     MOVLW     0x5                                                                                             
001f26   6f46     MOVWF     0x46,0x1                                                                                        
001f28   d005     BRA       0x1f34             else                                                                         C:\fw\midicontroller\x011\usb.c
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
001f2a   0101     MOVLB     0x1                    usb_device_state = CONFIGURED_STATE;                                     C:\fw\midicontroller\x011\usb.c
001f2c   0e06     MOVLW     0x6                                                                                             
001f2e   6f46     MOVWF     0x46,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /* Modifiable Section */                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   #if defined(USB_USE_HID)                // See autofiles\usbcfg.h        C:\fw\midicontroller\x011\usb.c
001f30   ecf4     CALL      0x2fe8,0x0             HIDInitEP();                                                             C:\fw\midicontroller\x011\usb.c
001f32   f017                                                                                                               
                                                   #endif                                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /* End modifiable section */                                             C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           C:\fw\midicontroller\x011\usb.c
001f34   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBStdGetStatusHandler(void)                            C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine handles the standard GET_STATUS request         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBStdGetStatusHandler(void)                                                C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
001f36   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        C:\fw\midicontroller\x011\usb.c
001f38   6b18     CLRF      0x18,0x1                                                                                        
001f3a   6b19     CLRF      0x19,0x1           CtrlTrfData._byte1 = 0;                                                      C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001f3c   5110     MOVF      0x10,0x0,0x1       switch(SetupPkt.Recipient)                                                   C:\fw\midicontroller\x011\usb.c
001f3e   0b1f     ANDLW     0x1f                                                                                            
001f40   0a02     XORLW     0x2                                                                                             
001f42   e014     BZ        0x1f6c                                                                                          
001f44   0a03     XORLW     0x3                                                                                             
001f46   e00e     BZ        0x1f64                                                                                          
001f48   0a01     XORLW     0x1                                                                                             
001f4a   e001     BZ        0x1f4e                                                                                          
001f4c   d033     BRA       0x1fb4                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
                                                   case RCPT_DEV:                                                           C:\fw\midicontroller\x011\usb.c
001f4e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x011\usb.c
001f50   0e01     MOVLW     0x1                                                                                             
001f52   6f4b     MOVWF     0x4b,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered C:\fw\midicontroller\x011\usb.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     C:\fw\midicontroller\x011\usb.c
                                                        */                                                                  C:\fw\midicontroller\x011\usb.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h C:\fw\midicontroller\x011\usb.c
001f54   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  C:\fw\midicontroller\x011\usb.c
001f56   8118     BSF       0x18,0x0,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001f58   0101     MOVLB     0x1                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c C:\fw\midicontroller\x011\usb.c
001f5a   a147     BTFSS     0x47,0x0,0x1                                                                                    
001f5c   d002     BRA       0x1f62                                                                                          
001f5e   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  C:\fw\midicontroller\x011\usb.c
001f60   8318     BSF       0x18,0x1,0x1                                                                                    
001f62   d028     BRA       0x1fb4                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case RCPT_INTF:                                                          C:\fw\midicontroller\x011\usb.c
001f64   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         C:\fw\midicontroller\x011\usb.c
001f66   0e01     MOVLW     0x1                                                                                             
001f68   6f4b     MOVWF     0x4b,0x1                                                                                        
001f6a   d024     BRA       0x1fb4                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                                   case RCPT_EP:                                                            C:\fw\midicontroller\x011\usb.c
001f6c   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  C:\fw\midicontroller\x011\usb.c
001f6e   0e01     MOVLW     0x1                                                                                             
001f70   6f4b     MOVWF     0x4b,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               C:\fw\midicontroller\x011\usb.c
                                                        */                                                                  C:\fw\midicontroller\x011\usb.c
001f72   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     C:\fw\midicontroller\x011\usb.c
001f74   5114     MOVF      0x14,0x0,0x1                                                                                    
001f76   0b0f     ANDLW     0xf                                                                                             
001f78   0d08     MULLW     0x8                                                                                             
001f7a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001f7c   6a11     CLRF      0x11,0x0                                                                                        
001f7e   0f00     ADDLW     0x0                                                                                             
001f80   6e10     MOVWF     0x10,0x0                                                                                        
001f82   0e04     MOVLW     0x4                                                                                             
001f84   2211     ADDWFC    0x11,0x1,0x0                                                                                    
001f86   5114     MOVF      0x14,0x0,0x1                                                                                    
001f88   0b80     ANDLW     0x80                                                                                            
001f8a   e001     BZ        0x1f8e                                                                                          
001f8c   0e01     MOVLW     0x1                                                                                             
001f8e   0d04     MULLW     0x4                                                                                             
001f90   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001f92   0101     MOVLB     0x1                                                                                             
001f94   2410     ADDWF     0x10,0x0,0x0                                                                                    
001f96   6f4e     MOVWF     0x4e,0x1                                                                                        
001f98   0e00     MOVLW     0x0                                                                                             
001f9a   2011     ADDWFC    0x11,0x0,0x0                                                                                    
001f9c   6f4f     MOVWF     0x4f,0x1                                                                                        
001f9e   c14e     MOVFF     0x14e,0xfe9                if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             C:\fw\midicontroller\x011\usb.c
001fa0   ffe9                                                                                                               
001fa2   c14f     MOVFF     0x14f,0xfea                                                                                     
001fa4   ffea                                                                                                               
001fa6   50ef     MOVF      0xef,0x0,0x0                                                                                    
001fa8   0b04     ANDLW     0x4                                                                                             
001faa   e003     BZ        0x1fb2                                                                                          
001fac   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              C:\fw\midicontroller\x011\usb.c
001fae   0e01     MOVLW     0x1                                                                                             
001fb0   6f18     MOVWF     0x18,0x1                                                                                        
001fb2   d000     BRA       0x1fb4                     break;                                                               C:\fw\midicontroller\x011\usb.c
                                               }//end switch                                                                C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001fb4   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_USB9)                                      C:\fw\midicontroller\x011\usb.c
001fb6   054b     DECF      0x4b,0x0,0x1                                                                                    
001fb8   e107     BNZ       0x1fc8                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
001fba   0e18     MOVLW     0x18                   pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                C:\fw\midicontroller\x011\usb.c
001fbc   6f4c     MOVWF     0x4c,0x1                                                                                        
001fbe   0e04     MOVLW     0x4                                                                                             
001fc0   6f4d     MOVWF     0x4d,0x1                                                                                        
001fc2   9347     BCF       0x47,0x1,0x1           usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           C:\fw\midicontroller\x011\usb.c
001fc4   0e02     MOVLW     0x2                    LSB(wCount) = 2;                            // Set data count            C:\fw\midicontroller\x011\usb.c
001fc6   6f50     MOVWF     0x50,0x1                                                                                        
                                               }//end if(...)                                                               C:\fw\midicontroller\x011\usb.c
001fc8   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       C:\fw\midicontroller\x011\usb.c
                                            *                  requests                                                     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBStdFeatureReqHandler(void)                                               C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
001fca   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             C:\fw\midicontroller\x011\usb.c
001fcc   0512     DECF      0x12,0x0,0x1                                                                                    
001fce   e110     BNZ       0x1ff0                (SetupPkt.Recipient == RCPT_DEV))                                         C:\fw\midicontroller\x011\usb.c
001fd0   5110     MOVF      0x10,0x0,0x1                                                                                    
001fd2   0b1f     ANDLW     0x1f                                                                                            
001fd4   0900     IORLW     0x0                                                                                             
001fd6   e10c     BNZ       0x1ff0                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
001fd8   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      C:\fw\midicontroller\x011\usb.c
001fda   0e01     MOVLW     0x1                                                                                             
001fdc   6f4b     MOVWF     0x4b,0x1                                                                                        
001fde   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\fw\midicontroller\x011\usb.c
001fe0   0104     MOVLB     0x4                                                                                             
001fe2   5d11     SUBWF     0x11,0x0,0x1                                                                                    
001fe4   e103     BNZ       0x1fec                                                                                          
001fe6   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 1;                                           C:\fw\midicontroller\x011\usb.c
001fe8   8147     BSF       0x47,0x0,0x1                                                                                    
001fea   d002     BRA       0x1ff0                 else                                                                     C:\fw\midicontroller\x011\usb.c
001fec   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 0;                                           C:\fw\midicontroller\x011\usb.c
001fee   9147     BCF       0x47,0x0,0x1                                                                                    
                                               }//end if                                                                    C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
001ff0   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    C:\fw\midicontroller\x011\usb.c
001ff2   5112     MOVF      0x12,0x0,0x1                                                                                    
001ff4   e13a     BNZ       0x206a                (SetupPkt.Recipient == RCPT_EP)&&                                         C:\fw\midicontroller\x011\usb.c
001ff6   5110     MOVF      0x10,0x0,0x1                                                                                    
001ff8   0b1f     ANDLW     0x1f                                                                                            
001ffa   0802     SUBLW     0x2                                                                                             
001ffc   e136     BNZ       0x206a                                                                                          
001ffe   5114     MOVF      0x14,0x0,0x1          (SetupPkt.EPNum != 0))                                                    C:\fw\midicontroller\x011\usb.c
002000   0b0f     ANDLW     0xf                                                                                             
002002   0900     IORLW     0x0                                                                                             
002004   e032     BZ        0x206a                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
002006   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      C:\fw\midicontroller\x011\usb.c
002008   0e01     MOVLW     0x1                                                                                             
00200a   6f4b     MOVWF     0x4b,0x1                                                                                        
                                                   /* Must do address calculation here */                                   C:\fw\midicontroller\x011\usb.c
00200c   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         C:\fw\midicontroller\x011\usb.c
00200e   5114     MOVF      0x14,0x0,0x1                                                                                    
002010   0b0f     ANDLW     0xf                                                                                             
002012   0d08     MULLW     0x8                                                                                             
002014   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002016   6a11     CLRF      0x11,0x0                                                                                        
002018   0f00     ADDLW     0x0                                                                                             
00201a   6e10     MOVWF     0x10,0x0                                                                                        
00201c   0e04     MOVLW     0x4                                                                                             
00201e   2211     ADDWFC    0x11,0x1,0x0                                                                                    
002020   5114     MOVF      0x14,0x0,0x1                                                                                    
002022   0b80     ANDLW     0x80                                                                                            
002024   e001     BZ        0x2028                                                                                          
002026   0e01     MOVLW     0x1                                                                                             
002028   0d04     MULLW     0x4                                                                                             
00202a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00202c   0101     MOVLB     0x1                                                                                             
00202e   2410     ADDWF     0x10,0x0,0x0                                                                                    
002030   6f4e     MOVWF     0x4e,0x1                                                                                        
002032   0e00     MOVLW     0x0                                                                                             
002034   2011     ADDWFC    0x11,0x0,0x0                                                                                    
002036   6f4f     MOVWF     0x4f,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002038   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     C:\fw\midicontroller\x011\usb.c
00203a   0104     MOVLB     0x4                                                                                             
00203c   5d11     SUBWF     0x11,0x0,0x1                                                                                    
00203e   e107     BNZ       0x204e                                                                                          
002040   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          C:\fw\midicontroller\x011\usb.c
002042   c14e     MOVFF     0x14e,0xfe9                                                                                     
002044   ffe9                                                                                                               
002046   c14f     MOVFF     0x14f,0xfea                                                                                     
002048   ffea                                                                                                               
00204a   6eef     MOVWF     0xef,0x0                                                                                        
00204c   d00e     BRA       0x206a                 else                                                                     C:\fw\midicontroller\x011\usb.c
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
00204e   af14     BTFSS     0x14,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        C:\fw\midicontroller\x011\usb.c
002050   d006     BRA       0x205e                                                                                          
002052   c14e     MOVFF     0x14e,0xfe9                    *pDst.bRam = _UCPU;                                              C:\fw\midicontroller\x011\usb.c
002054   ffe9                                                                                                               
002056   c14f     MOVFF     0x14f,0xfea                                                                                     
002058   ffea                                                                                                               
00205a   6aef     CLRF      0xef,0x0                                                                                        
00205c   d006     BRA       0x206a                     else                                                                 C:\fw\midicontroller\x011\usb.c
00205e   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 C:\fw\midicontroller\x011\usb.c
002060   c14e     MOVFF     0x14e,0xfe9                                                                                     
002062   ffe9                                                                                                               
002064   c14f     MOVFF     0x14f,0xfea                                                                                     
002066   ffea                                                                                                               
002068   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                C:\fw\midicontroller\x011\usb.c
                                               }//end if                                                                    C:\fw\midicontroller\x011\usb.c
00206a   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** EOF usb9.c ***************************************************************/  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           //usbmmap.c                                                                      C:\fw\midicontroller\x011\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x011\usb.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        C:\fw\midicontroller\x011\usb.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              C:\fw\midicontroller\x011\usb.c
                                           byte usb_active_cfg;            // Value of current configuration                C:\fw\midicontroller\x011\usb.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  C:\fw\midicontroller\x011\usb.c
                                                                           // setting for each interface ID                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  C:\fw\midicontroller\x011\usb.c
                                           //#pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) C:\fw\midicontroller\x011\usb.c
                                           #pragma udata overlay usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Section A: Buffer Descriptor Table                                            C:\fw\midicontroller\x011\usb.c
                                            * - 0x400 - 0x4FF(max)                                                          C:\fw\midicontroller\x011\usb.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              C:\fw\midicontroller\x011\usb.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            C:\fw\midicontroller\x011\usb.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Section B: EP0 Buffer Space                                                   C:\fw\midicontroller\x011\usb.c
                                            ******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * - Two buffer areas are defined:                                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *   A. CTRL_TRF_SETUP                                                           C:\fw\midicontroller\x011\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\fw\midicontroller\x011\usb.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *   B. CTRL_TRF_DATA                                                            C:\fw\midicontroller\x011\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  C:\fw\midicontroller\x011\usb.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            C:\fw\midicontroller\x011\usb.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Section C: HID Buffer                                                         C:\fw\midicontroller\x011\usb.c
                                            ******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #if defined(USB_USE_HID)                                                         C:\fw\midicontroller\x011\usb.c
                                           volatile far unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];                  C:\fw\midicontroller\x011\usb.c
                                           volatile far unsigned char hid_report_in[HID_INT_IN_EP_SIZE];                    C:\fw\midicontroller\x011\usb.c
                                           #endif                                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x011\usb.c
                                           /** EOF usbmmap.c ************************************************************/  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           //usbctrltrf.c                                                                   C:\fw\midicontroller\x011\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x011\usb.c
                                           byte ctrl_trf_state;                // Control Transfer State                    C:\fw\midicontroller\x011\usb.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           POINTER pSrc;                       // Data source pointer                       C:\fw\midicontroller\x011\usb.c
                                           POINTER pDst;                       // Data destination pointer                  C:\fw\midicontroller\x011\usb.c
                                           WORD wCount;                        // Data counter                              C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlTrfSetupHandler(void);                                               C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlTrfOutHandler(void);                                                 C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlTrfInHandler(void);                                                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlEPService(void)                                  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     C:\fw\midicontroller\x011\usb.c
                                            *                  it knows how to service and services them:                   C:\fw\midicontroller\x011\usb.c
                                            *                  1. EP0 SETUP                                                 C:\fw\midicontroller\x011\usb.c
                                            *                  2. EP0 OUT                                                   C:\fw\midicontroller\x011\usb.c
                                            *                  3. EP0 IN                                                    C:\fw\midicontroller\x011\usb.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlEPService(void)                                                      C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
00206c   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        C:\fw\midicontroller\x011\usb.c
00206e   e10b     BNZ       0x2086                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
002070   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 C:\fw\midicontroller\x011\usb.c
002072   5100     MOVF      0x0,0x0,0x1                                                                                     
002074   0b3c     ANDLW     0x3c                                                                                            
002076   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002078   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00207a   080d     SUBLW     0xd                                                                                             
00207c   e102     BNZ       0x2082                                                                                          
00207e   d808     RCALL     0x2090                     USBCtrlTrfSetupHandler();                                            C:\fw\midicontroller\x011\usb.c
002080   d001     BRA       0x2084                 else                                        // EP0 OUT                   C:\fw\midicontroller\x011\usb.c
002082   d83b     RCALL     0x20fa                     USBCtrlTrfOutHandler();                                              C:\fw\midicontroller\x011\usb.c
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
002084   d004     BRA       0x208e             else if(USTAT == EP00_IN)                       // EP0 IN                    C:\fw\midicontroller\x011\usb.c
002086   0e04     MOVLW     0x4                                                                                             
002088   5c6c     SUBWF     0x6c,0x0,0x0                                                                                    
00208a   e101     BNZ       0x208e                                                                                          
00208c   d846     RCALL     0x211a                 USBCtrlTrfInHandler();                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00208e   0012     RETURN    0x0            }//end USBCtrlEPService                                                          C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          C:\fw\midicontroller\x011\usb.c
                                            *                  1. It initializes the control transfer state machine.        C:\fw\midicontroller\x011\usb.c
                                            *                  2. It calls on each of the module that may know how to       C:\fw\midicontroller\x011\usb.c
                                            *                     service the Setup Request from the host.                  C:\fw\midicontroller\x011\usb.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  C:\fw\midicontroller\x011\usb.c
                                            *                     As new classes are added, ClassReqHandler table in        C:\fw\midicontroller\x011\usb.c
                                            *                     usbdsc.c should be updated to call all available          C:\fw\midicontroller\x011\usb.c
                                            *                     class handlers.                                           C:\fw\midicontroller\x011\usb.c
                                            *                  3. Once each of the modules has had a chance to check if     C:\fw\midicontroller\x011\usb.c
                                            *                     it is responsible for servicing the request, stage 3      C:\fw\midicontroller\x011\usb.c
                                            *                     then checks direction of the transfer to determine how    C:\fw\midicontroller\x011\usb.c
                                            *                     to prepare EP0 for the control transfer.                  C:\fw\midicontroller\x011\usb.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            Microchip USB Firmware has three different states for        C:\fw\midicontroller\x011\usb.c
                                            *                  the control transfer state machine:                          C:\fw\midicontroller\x011\usb.c
                                            *                  1. WAIT_SETUP                                                C:\fw\midicontroller\x011\usb.c
                                            *                  2. CTRL_TRF_TX                                               C:\fw\midicontroller\x011\usb.c
                                            *                  3. CTRL_TRF_RX                                               C:\fw\midicontroller\x011\usb.c
                                            *                  Refer to firmware manual to find out how one state           C:\fw\midicontroller\x011\usb.c
                                            *                  is transitioned to another.                                  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                  A Control Transfer is composed of many USB transactions.     C:\fw\midicontroller\x011\usb.c
                                            *                  When transferring data over multiple transactions,           C:\fw\midicontroller\x011\usb.c
                                            *                  it is important to keep track of data source, data           C:\fw\midicontroller\x011\usb.c
                                            *                  destination, and data count. These three parameters are      C:\fw\midicontroller\x011\usb.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           C:\fw\midicontroller\x011\usb.c
                                            *                  note if the data source is from ROM or RAM.                  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
002090   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                C:\fw\midicontroller\x011\usb.c
002092   ffe6                                                                                                               
002094   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002096   ffd9                                                                                                               
002098   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               byte i;                                                                      C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /* Stage 1 */                                                                C:\fw\midicontroller\x011\usb.c
00209a   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;                                                 C:\fw\midicontroller\x011\usb.c
00209c   6b4a     CLRF      0x4a,0x1                                                                                        
00209e   6b4b     CLRF      0x4b,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 C:\fw\midicontroller\x011\usb.c
0020a0   6b50     CLRF      0x50,0x1           wCount._word = 0;                                                            C:\fw\midicontroller\x011\usb.c
0020a2   6b51     CLRF      0x51,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /* Stage 2 */                                                                C:\fw\midicontroller\x011\usb.c
0020a4   de66     RCALL     0x1d72             USBCheckStdRequest();                   // See system\usb9\usb9.c            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /* Modifiable Section */                                                     C:\fw\midicontroller\x011\usb.c
0020a6   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     C:\fw\midicontroller\x011\usb.c
0020a8   50df     MOVF      0xdf,0x0,0x0                                                                                    
0020aa   6e10     MOVWF     0x10,0x0                                                                                        
0020ac   6a11     CLRF      0x11,0x0                                                                                        
0020ae   0e01     MOVLW     0x1                                                                                             
0020b0   5c10     SUBWF     0x10,0x0,0x0                                                                                    
0020b2   0e00     MOVLW     0x0                                                                                             
0020b4   5811     SUBWFB    0x11,0x0,0x0                                                                                    
0020b6   e21b     BC        0x20ee                                                                                          
0020ea   2adf     INCF      0xdf,0x1,0x0                                                                                    
0020ec   d7dd     BRA       0x20a8                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
0020b8   0101     MOVLB     0x1                    if(ctrl_trf_session_owner != MUID_NULL)break;                            C:\fw\midicontroller\x011\usb.c
0020ba   514b     MOVF      0x4b,0x0,0x1                                                                                    
0020bc   e001     BZ        0x20c0                                                                                          
0020be   d017     BRA       0x20ee                                                                                          
0020c0   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            C:\fw\midicontroller\x011\usb.c
0020c2   34df     RLCF      0xdf,0x0,0x0                                                                                    
0020c4   0bfe     ANDLW     0xfe                                                                                            
0020c6   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0020c8   6ef6     MOVWF     0xf6,0x0                                                                                        
0020ca   0eb6     MOVLW     0xb6                                                                                            
0020cc   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0020ce   0e33     MOVLW     0x33                                                                                            
0020d0   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0020d2   0009     TBLRDPOSTINC                                                                                              
0020d4   cff5     MOVFF     0xff5,0x10                                                                                      
0020d6   f010                                                                                                               
0020d8   0008     TBLRD                                                                                                     
0020da   cff5     MOVFF     0xff5,0x11                                                                                      
0020dc   f011                                                                                                               
0020de   d004     BRA       0x20e8                                                                                          
0020e0   c011     MOVFF     0x11,0xffa                                                                                      
0020e2   fffa                                                                                                               
0020e4   5010     MOVF      0x10,0x0,0x0                                                                                    
0020e6   6ef9     MOVWF     0xf9,0x0                                                                                        
0020e8   dffb     RCALL     0x20e0                                                                                          
                                               }//end while                                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /* End Modifiable Section */                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /* Stage 3 */                                                                C:\fw\midicontroller\x011\usb.c
0020ee   d8df     RCALL     0x22ae             USBCtrlEPServiceComplete();                                                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
0020f0   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    C:\fw\midicontroller\x011\usb.c
0020f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020f4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0020f6   ffd9                                                                                                               
0020f8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine handles an OUT transaction according to         C:\fw\midicontroller\x011\usb.c
                                            *                  which control transfer state is currently active.            C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            Note that if the the control transfer was from               C:\fw\midicontroller\x011\usb.c
                                            *                  host to device, the session owner should be notified         C:\fw\midicontroller\x011\usb.c
                                            *                  at the end of each OUT transaction to service the            C:\fw\midicontroller\x011\usb.c
                                            *                  received data.                                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlTrfOutHandler(void)                                                  C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
0020fa   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            C:\fw\midicontroller\x011\usb.c
0020fc   0101     MOVLB     0x1                                                                                             
0020fe   5d4a     SUBWF     0x4a,0x0,0x1                                                                                    
002100   e10a     BNZ       0x2116                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
002102   d898     RCALL     0x2234                 USBCtrlTrfRxService();                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x011\usb.c
                                                    * Don't have to worry about overwriting _KEEP bit                       C:\fw\midicontroller\x011\usb.c
                                                    * because if _KEEP was set, TRNIF would not have been                   C:\fw\midicontroller\x011\usb.c
                                                    * generated in the first place.                                         C:\fw\midicontroller\x011\usb.c
                                                    */                                                                      C:\fw\midicontroller\x011\usb.c
002104   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  C:\fw\midicontroller\x011\usb.c
002106   bd00     BTFSC     0x0,0x6,0x1                                                                                     
002108   d003     BRA       0x2110                                                                                          
00210a   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
00210c   6f00     MOVWF     0x0,0x1                                                                                         
00210e   d002     BRA       0x2114                 else                                                                     C:\fw\midicontroller\x011\usb.c
002110   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
002112   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
002114   d001     BRA       0x2118             else    // CTRL_TRF_TX                                                       C:\fw\midicontroller\x011\usb.c
002116   d90e     RCALL     0x2334                 USBPrepareForNextSetupTrf();                                             C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002118   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine handles an IN transaction according to          C:\fw\midicontroller\x011\usb.c
                                            *                  which control transfer state is currently active.            C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            A Set Address Request must not change the acutal address     C:\fw\midicontroller\x011\usb.c
                                            *                  of the device until the completion of the control            C:\fw\midicontroller\x011\usb.c
                                            *                  transfer. The end of the control transfer for Set Address    C:\fw\midicontroller\x011\usb.c
                                            *                  Request is an IN transaction. Therefore it is necessary      C:\fw\midicontroller\x011\usb.c
                                            *                  to service this unique situation when the condition is       C:\fw\midicontroller\x011\usb.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          C:\fw\midicontroller\x011\usb.c
                                            *                  usb9.h and its function is to specifically service this      C:\fw\midicontroller\x011\usb.c
                                            *                  event.                                                       C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlTrfInHandler(void)                                                   C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
00211a   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    C:\fw\midicontroller\x011\usb.c
00211c   0101     MOVLB     0x1                                                                                             
00211e   5d46     SUBWF     0x46,0x0,0x1                                                                                    
002120   e10a     BNZ       0x2136                                                                                          
002122   c412     MOVFF     0x412,0xf6e                                                                                     
002124   ff6e                                                                                                               
002126   506e     MOVF      0x6e,0x0,0x0                                                                                    
002128   0800     SUBLW     0x0                                                                                             
00212a   e203     BC        0x2132                                                                                          
00212c   0e05     MOVLW     0x5                                                                                             
00212e   6f46     MOVWF     0x46,0x1                                                                                        
002130   d002     BRA       0x2136                                                                                          
002132   0e03     MOVLW     0x3                                                                                             
002134   6f46     MOVWF     0x46,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002136   054a     DECF      0x4a,0x0,0x1       if(ctrl_trf_state == CTRL_TRF_TX)                                            C:\fw\midicontroller\x011\usb.c
002138   e10a     BNZ       0x214e                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
00213a   d811     RCALL     0x215e                 USBCtrlTrfTxService();                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00213c   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  C:\fw\midicontroller\x011\usb.c
00213e   bd04     BTFSC     0x4,0x6,0x1                                                                                     
002140   d003     BRA       0x2148                                                                                          
002142   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
002144   6f04     MOVWF     0x4,0x1                                                                                         
002146   d002     BRA       0x214c                 else                                                                     C:\fw\midicontroller\x011\usb.c
002148   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
00214a   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
00214c   d007     BRA       0x215c             else { // CTRL_TRF_RX                                                        C:\fw\midicontroller\x011\usb.c
                                           //Rawin's code change to handle setreport data:                                  C:\fw\midicontroller\x011\usb.c
00214e   0e09     MOVLW     0x9            		if (SetupPkt.bRequest == SET_REPORT) {                                         C:\fw\midicontroller\x011\usb.c
002150   0104     MOVLB     0x4                                                                                             
002152   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002154   e102     BNZ       0x215a                                                                                          
002156   ec84     CALL      0x3108,0x0     			HIDSetReportHandler();                                                        C:\fw\midicontroller\x011\usb.c
002158   f018                                                                                                               
                                           		}                                                                              C:\fw\midicontroller\x011\usb.c
00215a   d8ec     RCALL     0x2334         		USBPrepareForNextSetupTrf();                                                   C:\fw\midicontroller\x011\usb.c
                                           	}                                                                               C:\fw\midicontroller\x011\usb.c
00215c   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlTrfTxService(void)                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine should be called from only two places.          C:\fw\midicontroller\x011\usb.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             C:\fw\midicontroller\x011\usb.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           C:\fw\midicontroller\x011\usb.c
                                            *                  transfer over multiple USB transactions.                     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            This routine works with isochronous endpoint larger than     C:\fw\midicontroller\x011\usb.c
                                            *                  256 bytes and is shown here as an example of how to deal     C:\fw\midicontroller\x011\usb.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   C:\fw\midicontroller\x011\usb.c
                                            *                  be larger than 64 bytes.                                     C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
00215e   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   C:\fw\midicontroller\x011\usb.c
002160   ffe6                                                                                                               
002162   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002164   ffd9                                                                                                               
002166   0e02     MOVLW     0x2                                                                                             
002168   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               WORD byte_to_send;                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * First, have to figure out how many byte of data to send.                  C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
00216a   0101     MOVLB     0x1                if(wCount._word < EP0_BUFF_SIZE)                                             C:\fw\midicontroller\x011\usb.c
00216c   0e08     MOVLW     0x8                                                                                             
00216e   5d50     SUBWF     0x50,0x0,0x1                                                                                    
002170   0e00     MOVLW     0x0                                                                                             
002172   5951     SUBWFB    0x51,0x0,0x1                                                                                    
002174   e205     BC        0x2180                                                                                          
002176   c150     MOVFF     0x150,0xfde            byte_to_send._word = wCount._word;                                       C:\fw\midicontroller\x011\usb.c
002178   ffde                                                                                                               
00217a   c151     MOVFF     0x151,0xfdd                                                                                     
00217c   ffdd                                                                                                               
00217e   d003     BRA       0x2186             else                                                                         C:\fw\midicontroller\x011\usb.c
002180   0e08     MOVLW     0x8                    byte_to_send._word = EP0_BUFF_SIZE;                                      C:\fw\midicontroller\x011\usb.c
002182   6ede     MOVWF     0xde,0x0                                                                                        
002184   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002186   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          C:\fw\midicontroller\x011\usb.c
002188   9304     BCF       0x4,0x1,0x1                                                                                     
00218a   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          C:\fw\midicontroller\x011\usb.c
00218c   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       C:\fw\midicontroller\x011\usb.c
00218e   50db     MOVF      0xdb,0x0,0x0                                                                                    
002190   1304     IORWF     0x4,0x1,0x1                                                                                     
002192   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               C:\fw\midicontroller\x011\usb.c
002194   f405                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Subtract the number of bytes just about to be sent from the total.        C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002196   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            C:\fw\midicontroller\x011\usb.c
002198   50db     MOVF      0xdb,0x0,0x0                                                                                    
00219a   0101     MOVLB     0x1                                                                                             
00219c   5f50     SUBWF     0x50,0x1,0x1                                                                                    
00219e   0e01     MOVLW     0x1                                                                                             
0021a0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0021a2   5b51     SUBWFB    0x51,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\usb.c
0021a4   0e18     MOVLW     0x18               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           C:\fw\midicontroller\x011\usb.c
0021a6   6f4e     MOVWF     0x4e,0x1                                                                                        
0021a8   0e04     MOVLW     0x4                                                                                             
0021aa   6f4f     MOVWF     0x4f,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
0021ac   a347     BTFSS     0x47,0x1,0x1       if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   C:\fw\midicontroller\x011\usb.c
0021ae   d01d     BRA       0x21ea                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
0021b0   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\fw\midicontroller\x011\usb.c
0021b2   ffe9                                                                                                               
0021b4   cfda     MOVFF     0xfda,0xfea                                                                                     
0021b6   ffea                                                                                                               
0021b8   50ee     MOVF      0xee,0x0,0x0                                                                                    
0021ba   10ed     IORWF     0xed,0x0,0x0                                                                                    
0021bc   e015     BZ        0x21e8                                                                                          
0021e6   d7e4     BRA       0x21b0                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
0021be   c14c     MOVFF     0x14c,0xff6                *pDst.bRam = *pSrc.bRom;                                             C:\fw\midicontroller\x011\usb.c
0021c0   fff6                                                                                                               
0021c2   c14d     MOVFF     0x14d,0xff7                                                                                     
0021c4   fff7                                                                                                               
0021c6   0008     TBLRD                                                                                                     
0021c8   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0021ca   c14e     MOVFF     0x14e,0xfe9                                                                                     
0021cc   ffe9                                                                                                               
0021ce   c14f     MOVFF     0x14f,0xfea                                                                                     
0021d0   ffea                                                                                                               
0021d2   6eef     MOVWF     0xef,0x0                                                                                        
0021d4   2b4e     INCF      0x4e,0x1,0x1               pDst.bRam++;                                                         C:\fw\midicontroller\x011\usb.c
0021d6   0e00     MOVLW     0x0                                                                                             
0021d8   234f     ADDWFC    0x4f,0x1,0x1                                                                                    
0021da   2b4c     INCF      0x4c,0x1,0x1               pSrc.bRom++;                                                         C:\fw\midicontroller\x011\usb.c
0021dc   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
0021de   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\fw\midicontroller\x011\usb.c
0021e0   0e01     MOVLW     0x1                                                                                             
0021e2   e201     BC        0x21e6                                                                                          
0021e4   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\fw\midicontroller\x011\usb.c
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
0021e8   d01b     BRA       0x2220             else // RAM                                                                  C:\fw\midicontroller\x011\usb.c
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
0021ea   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                C:\fw\midicontroller\x011\usb.c
0021ec   ffe9                                                                                                               
0021ee   cfda     MOVFF     0xfda,0xfea                                                                                     
0021f0   ffea                                                                                                               
0021f2   50ee     MOVF      0xee,0x0,0x0                                                                                    
0021f4   10ed     IORWF     0xed,0x0,0x0                                                                                    
0021f6   e014     BZ        0x2220                                                                                          
00221e   d7e5     BRA       0x21ea                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
0021f8   c14c     MOVFF     0x14c,0xfe9                *pDst.bRam = *pSrc.bRam;                                             C:\fw\midicontroller\x011\usb.c
0021fa   ffe9                                                                                                               
0021fc   c14d     MOVFF     0x14d,0xfea                                                                                     
0021fe   ffea                                                                                                               
002200   50ef     MOVF      0xef,0x0,0x0                                                                                    
002202   c14e     MOVFF     0x14e,0xfe9                                                                                     
002204   ffe9                                                                                                               
002206   c14f     MOVFF     0x14f,0xfea                                                                                     
002208   ffea                                                                                                               
00220a   6eef     MOVWF     0xef,0x0                                                                                        
00220c   2b4e     INCF      0x4e,0x1,0x1               pDst.bRam++;                                                         C:\fw\midicontroller\x011\usb.c
00220e   0e00     MOVLW     0x0                                                                                             
002210   234f     ADDWFC    0x4f,0x1,0x1                                                                                    
002212   2b4c     INCF      0x4c,0x1,0x1               pSrc.bRam++;                                                         C:\fw\midicontroller\x011\usb.c
002214   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
002216   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                C:\fw\midicontroller\x011\usb.c
002218   0e01     MOVLW     0x1                                                                                             
00221a   e201     BC        0x221e                                                                                          
00221c   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         C:\fw\midicontroller\x011\usb.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002220   0e02     MOVLW     0x2            }//end USBCtrlTrfTxService                                                       C:\fw\midicontroller\x011\usb.c
002222   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002224   e202     BC        0x222a                                                                                          
002226   6ae1     CLRF      0xe1,0x0                                                                                        
002228   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00222a   6ee1     MOVWF     0xe1,0x0                                                                                        
00222c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00222e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002230   ffd9                                                                                                               
002232   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlTrfRxService(void)                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    pDst and wCount are setup properly.                          C:\fw\midicontroller\x011\usb.c
                                            *                  pSrc is always &CtrlTrfData                                  C:\fw\midicontroller\x011\usb.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        C:\fw\midicontroller\x011\usb.c
                                            *                  wCount should be set to 0 at the start of each control       C:\fw\midicontroller\x011\usb.c
                                            *                  transfer.                                                    C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        *** This routine is only partially complete. Check for       C:\fw\midicontroller\x011\usb.c
                                            *                  new version of the firmware.                                 C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
002234   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   C:\fw\midicontroller\x011\usb.c
002236   ffe6                                                                                                               
002238   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00223a   ffd9                                                                                                               
00223c   0e02     MOVLW     0x2                                                                                             
00223e   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               WORD byte_to_read;                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002240   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    C:\fw\midicontroller\x011\usb.c
002242   0104     MOVLB     0x4                                                                                             
002244   1500     ANDWF     0x0,0x0,0x1                                                                                     
002246   6ee7     MOVWF     0xe7,0x0                                                                                        
002248   0e01     MOVLW     0x1                                                                                             
00224a   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
00224c   ffdb                                                                                                               
00224e   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               C:\fw\midicontroller\x011\usb.c
002250   ffdf                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Accumulate total number of bytes read                                     C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002252   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            C:\fw\midicontroller\x011\usb.c
002254   0101     MOVLB     0x1                                                                                             
002256   2750     ADDWF     0x50,0x1,0x1                                                                                    
002258   50dd     MOVF      0xdd,0x0,0x0                                                                                    
00225a   2351     ADDWFC    0x51,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00225c   0e18     MOVLW     0x18               pSrc.bRam = (byte*)&CtrlTrfData;                                             C:\fw\midicontroller\x011\usb.c
00225e   6f4c     MOVWF     0x4c,0x1                                                                                        
002260   0e04     MOVLW     0x4                                                                                             
002262   6f4d     MOVWF     0x4d,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002264   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    C:\fw\midicontroller\x011\usb.c
002266   ffe9                                                                                                               
002268   cfda     MOVFF     0xfda,0xfea                                                                                     
00226a   ffea                                                                                                               
00226c   50ee     MOVF      0xee,0x0,0x0                                                                                    
00226e   10ed     IORWF     0xed,0x0,0x0                                                                                    
002270   e014     BZ        0x229a                                                                                          
002298   d7e5     BRA       0x2264                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
002272   c14c     MOVFF     0x14c,0xfe9            *pDst.bRam = *pSrc.bRam;                                                 C:\fw\midicontroller\x011\usb.c
002274   ffe9                                                                                                               
002276   c14d     MOVFF     0x14d,0xfea                                                                                     
002278   ffea                                                                                                               
00227a   50ef     MOVF      0xef,0x0,0x0                                                                                    
00227c   c14e     MOVFF     0x14e,0xfe9                                                                                     
00227e   ffe9                                                                                                               
002280   c14f     MOVFF     0x14f,0xfea                                                                                     
002282   ffea                                                                                                               
002284   6eef     MOVWF     0xef,0x0                                                                                        
002286   2b4e     INCF      0x4e,0x1,0x1           pDst.bRam++;                                                             C:\fw\midicontroller\x011\usb.c
002288   0e00     MOVLW     0x0                                                                                             
00228a   234f     ADDWFC    0x4f,0x1,0x1                                                                                    
00228c   2b4c     INCF      0x4c,0x1,0x1           pSrc.bRam++;                                                             C:\fw\midicontroller\x011\usb.c
00228e   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
002290   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    C:\fw\midicontroller\x011\usb.c
002292   0e01     MOVLW     0x1                                                                                             
002294   e201     BC        0x2298                                                                                          
002296   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00229a   0e02     MOVLW     0x2            }//end USBCtrlTrfRxService                                                       C:\fw\midicontroller\x011\usb.c
00229c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00229e   e202     BC        0x22a4                                                                                          
0022a0   6ae1     CLRF      0xe1,0x0                                                                                        
0022a2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022a4   6ee1     MOVWF     0xe1,0x0                                                                                        
0022a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022a8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0022aa   ffd9                                                                                                               
0022ac   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        C:\fw\midicontroller\x011\usb.c
                                            *                  a Setup Request. Its main task is to set the endpoint        C:\fw\midicontroller\x011\usb.c
                                            *                  controls appropriately for a given situation. See code       C:\fw\midicontroller\x011\usb.c
                                            *                  below.                                                       C:\fw\midicontroller\x011\usb.c
                                            *                  There are three main scenarios:                              C:\fw\midicontroller\x011\usb.c
                                            *                  a) There was no handler for the Request, in this case        C:\fw\midicontroller\x011\usb.c
                                            *                     a STALL should be sent out.                               C:\fw\midicontroller\x011\usb.c
                                            *                  b) The host has requested a read control transfer,           C:\fw\midicontroller\x011\usb.c
                                            *                     endpoints are required to be setup in a specific way.     C:\fw\midicontroller\x011\usb.c
                                            *                  c) The host has requested a write control transfer, or       C:\fw\midicontroller\x011\usb.c
                                            *                     a control data stage is not required, endpoints are       C:\fw\midicontroller\x011\usb.c
                                            *                     required to be setup in a specific way.                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCtrlEPServiceComplete(void)                                              C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
0022ae   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_NULL)                                      C:\fw\midicontroller\x011\usb.c
0022b0   514b     MOVF      0x4b,0x0,0x1                                                                                    
0022b2   e10b     BNZ       0x22ca                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x011\usb.c
                                                    * If no one knows how to service this request then stall.               C:\fw\midicontroller\x011\usb.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          C:\fw\midicontroller\x011\usb.c
                                                    */                                                                      C:\fw\midicontroller\x011\usb.c
0022b4   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               C:\fw\midicontroller\x011\usb.c
0022b6   0e08     MOVLW     0x8                                                                                             
0022b8   6f01     MOVWF     0x1,0x1                                                                                         
0022ba   0e10     MOVLW     0x10                   ep0Bo.ADR = (byte*)&SetupPkt;                                            C:\fw\midicontroller\x011\usb.c
0022bc   6f02     MOVWF     0x2,0x1                                                                                         
0022be   0e04     MOVLW     0x4                                                                                             
0022c0   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x011\usb.c
0022c2   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        C:\fw\midicontroller\x011\usb.c
0022c4   6f00     MOVWF     0x0,0x1                                                                                         
0022c6   6f04     MOVWF     0x4,0x1                ep0Bi.Stat._byte = _USIE|_BSTALL;                                        C:\fw\midicontroller\x011\usb.c
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
0022c8   d033     BRA       0x2330             else    // A module has claimed ownership of the control transfer session.   C:\fw\midicontroller\x011\usb.c
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
0022ca   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      C:\fw\midicontroller\x011\usb.c
0022cc   af10     BTFSS     0x10,0x7,0x1                                                                                    
0022ce   d021     BRA       0x2312                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
0022d0   0101     MOVLB     0x1                        if(SetupPkt.wLength < wCount._word)                                  C:\fw\midicontroller\x011\usb.c
0022d2   5150     MOVF      0x50,0x0,0x1                                                                                    
0022d4   0104     MOVLB     0x4                                                                                             
0022d6   5d16     SUBWF     0x16,0x0,0x1                                                                                    
0022d8   0101     MOVLB     0x1                                                                                             
0022da   5151     MOVF      0x51,0x0,0x1                                                                                    
0022dc   0104     MOVLB     0x4                                                                                             
0022de   5917     SUBWFB    0x17,0x0,0x1                                                                                    
0022e0   e204     BC        0x22ea                                                                                          
0022e2   c416     MOVFF     0x416,0x150                    wCount._word = SetupPkt.wLength;                                 C:\fw\midicontroller\x011\usb.c
0022e4   f150                                                                                                               
0022e6   c417     MOVFF     0x417,0x151                                                                                     
0022e8   f151                                                                                                               
0022ea   df39     RCALL     0x215e                     USBCtrlTrfTxService();                                               C:\fw\midicontroller\x011\usb.c
0022ec   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_TX;                                        C:\fw\midicontroller\x011\usb.c
0022ee   0e01     MOVLW     0x1                                                                                             
0022f0   6f4a     MOVWF     0x4a,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * Control Read:                                                     C:\fw\midicontroller\x011\usb.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  C:\fw\midicontroller\x011\usb.c
                                                        * 1. Prepare OUT EP to respond to early termination                 C:\fw\midicontroller\x011\usb.c
                                                        *                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * NOTE:                                                             C:\fw\midicontroller\x011\usb.c
                                                        * If something went wrong during the control transfer,              C:\fw\midicontroller\x011\usb.c
                                                        * the last status stage may not be sent by the host.                C:\fw\midicontroller\x011\usb.c
                                                        * When this happens, two different things could happen              C:\fw\midicontroller\x011\usb.c
                                                        * depending on the host.                                            C:\fw\midicontroller\x011\usb.c
                                                        * a) The host could send out a RESET.                               C:\fw\midicontroller\x011\usb.c
                                                        * b) The host could send out a new SETUP transaction                C:\fw\midicontroller\x011\usb.c
                                                        *    without sending a RESET first.                                 C:\fw\midicontroller\x011\usb.c
                                                        * To properly handle case (b), the OUT EP must be setup             C:\fw\midicontroller\x011\usb.c
                                                        * to receive either a zero length OUT transaction, or a             C:\fw\midicontroller\x011\usb.c
                                                        * new SETUP transaction.                                            C:\fw\midicontroller\x011\usb.c
                                                        *                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * Since the SETUP transaction requires the DTS bit to be            C:\fw\midicontroller\x011\usb.c
                                                        * DAT0 while the zero length OUT status requires the DTS            C:\fw\midicontroller\x011\usb.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          C:\fw\midicontroller\x011\usb.c
                                                        * be disabled. This way the SIE could accept either of              C:\fw\midicontroller\x011\usb.c
                                                        * the two transactions.                                             C:\fw\midicontroller\x011\usb.c
                                                        *                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            C:\fw\midicontroller\x011\usb.c
                                                        * the SETUP data (8-byte or more), and the buffer address           C:\fw\midicontroller\x011\usb.c
                                                        * should be pointed to SetupPkt.                                    C:\fw\midicontroller\x011\usb.c
                                                        */                                                                  C:\fw\midicontroller\x011\usb.c
0022f2   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\fw\midicontroller\x011\usb.c
0022f4   0e08     MOVLW     0x8                                                                                             
0022f6   6f01     MOVWF     0x1,0x1                                                                                         
0022f8   0e10     MOVLW     0x10                       ep0Bo.ADR = (byte*)&SetupPkt;                                        C:\fw\midicontroller\x011\usb.c
0022fa   6f02     MOVWF     0x2,0x1                                                                                         
0022fc   0e04     MOVLW     0x4                                                                                             
0022fe   6f03     MOVWF     0x3,0x1                                                                                         
002300   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             C:\fw\midicontroller\x011\usb.c
002302   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                       /*                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                C:\fw\midicontroller\x011\usb.c
                                                        *    been initialized by responsible request owner.                 C:\fw\midicontroller\x011\usb.c
                                                        */                                                                  C:\fw\midicontroller\x011\usb.c
002304   0e18     MOVLW     0x18                       ep0Bi.ADR = (byte*)&CtrlTrfData;                                     C:\fw\midicontroller\x011\usb.c
002306   6f06     MOVWF     0x6,0x1                                                                                         
002308   0e04     MOVLW     0x4                                                                                             
00230a   6f07     MOVWF     0x7,0x1                                                                                         
00230c   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
00230e   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        C:\fw\midicontroller\x011\usb.c
002310   d00f     BRA       0x2330                 else    // (SetupPkt.DataDir == HOST_TO_DEV)                             C:\fw\midicontroller\x011\usb.c
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
002312   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_RX;                                        C:\fw\midicontroller\x011\usb.c
002314   0e02     MOVLW     0x2                                                                                             
002316   6f4a     MOVWF     0x4a,0x1                                                                                        
                                                       /*                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * Control Write:                                                    C:\fw\midicontroller\x011\usb.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 C:\fw\midicontroller\x011\usb.c
                                                        *                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * 1. Prepare IN EP to respond to early termination                  C:\fw\midicontroller\x011\usb.c
                                                        *                                                                   C:\fw\midicontroller\x011\usb.c
                                                        *    This is the same as a Zero Length Packet Response              C:\fw\midicontroller\x011\usb.c
                                                        *    for control transfer without a data stage                      C:\fw\midicontroller\x011\usb.c
                                                        */                                                                  C:\fw\midicontroller\x011\usb.c
002318   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       C:\fw\midicontroller\x011\usb.c
00231a   6b05     CLRF      0x5,0x1                                                                                         
00231c   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
00231e   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                       /*                                                                   C:\fw\midicontroller\x011\usb.c
                                                        * 2. Prepare OUT EP to receive data.                                C:\fw\midicontroller\x011\usb.c
                                                        */                                                                  C:\fw\midicontroller\x011\usb.c
002320   0e08     MOVLW     0x8                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           C:\fw\midicontroller\x011\usb.c
002322   6f01     MOVWF     0x1,0x1                                                                                         
002324   0e18     MOVLW     0x18                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     C:\fw\midicontroller\x011\usb.c
002326   6f02     MOVWF     0x2,0x1                                                                                         
002328   0e04     MOVLW     0x4                                                                                             
00232a   6f03     MOVWF     0x3,0x1                                                                                         
00232c   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               C:\fw\midicontroller\x011\usb.c
00232e   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               C:\fw\midicontroller\x011\usb.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   C:\fw\midicontroller\x011\usb.c
                                                * Clear to resume packet processing.                                        C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002330   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002332   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       C:\fw\midicontroller\x011\usb.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBPrepareForNextSetupTrf(void)                                             C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
002334   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  C:\fw\midicontroller\x011\usb.c
002336   6b4a     CLRF      0x4a,0x1                                                                                        
002338   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               C:\fw\midicontroller\x011\usb.c
00233a   0e08     MOVLW     0x8                                                                                             
00233c   6f01     MOVWF     0x1,0x1                                                                                         
00233e   0e10     MOVLW     0x10               ep0Bo.ADR = (byte*)&SetupPkt;                                                C:\fw\midicontroller\x011\usb.c
002340   6f02     MOVWF     0x2,0x1                                                                                         
002342   0e04     MOVLW     0x4                                                                                             
002344   6f03     MOVWF     0x3,0x1                                                                                         
002346   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  C:\fw\midicontroller\x011\usb.c
002348   6f00     MOVWF     0x0,0x1                                                                                         
00234a   6b04     CLRF      0x4,0x1            ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      C:\fw\midicontroller\x011\usb.c
00234c   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** EOF usbctrltrf.c *********************************************************/  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           //usbdrv.c                                                                       C:\fw\midicontroller\x011\usb.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\usb.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\usb.c
                                           //#include "io_cfg.h"             // Required for USBCheckBusStatus()            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBModuleEnable(void);                                                      C:\fw\midicontroller\x011\usb.c
                                           void USBModuleDisable(void);                                                     C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           void USBSuspend(void);                                                           C:\fw\midicontroller\x011\usb.c
                                           void USBWakeFromSuspend(void);                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           void USBProtocolResetHandler(void);                                              C:\fw\midicontroller\x011\usb.c
                                           void USB_SOF_Handler(void);                                                      C:\fw\midicontroller\x011\usb.c
                                           void USBStallHandler(void);                                                      C:\fw\midicontroller\x011\usb.c
                                           void USBErrorHandler(void);                                                      C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x011\usb.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBCheckBusStatus(void)                                 C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   C:\fw\midicontroller\x011\usb.c
                                            *                  the USB power signal.                                        C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBCheckBusStatus(void)                                                     C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               /**************************************************************************  C:\fw\midicontroller\x011\usb.c
                                                * Bus Attachment & Detachment Detection                                     C:\fw\midicontroller\x011\usb.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           C:\fw\midicontroller\x011\usb.c
                                                *************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                               #define USB_BUS_ATTACHED    1                                                C:\fw\midicontroller\x011\usb.c
                                               #define USB_BUS_DETACHED    0                                                C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          C:\fw\midicontroller\x011\usb.c
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
00234e   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            C:\fw\midicontroller\x011\usb.c
002350   d80f     RCALL     0x2370                     USBModuleEnable();                  // Is off, enable it             C:\fw\midicontroller\x011\usb.c
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
002352   d002     BRA       0x2358             else                                                                         C:\fw\midicontroller\x011\usb.c
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
002354   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             C:\fw\midicontroller\x011\usb.c
002356   d813     RCALL     0x237e                     USBModuleDisable();                 // Is on, disable it             C:\fw\midicontroller\x011\usb.c
                                               }//end if(usb_bus_sense...)                                                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * After enabling the USB module, it takes some time for the voltage         C:\fw\midicontroller\x011\usb.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. C:\fw\midicontroller\x011\usb.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is C:\fw\midicontroller\x011\usb.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     C:\fw\midicontroller\x011\usb.c
                                                * unique event as a USB bus reset from the USB host.                        C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002358   0101     MOVLB     0x1                if(usb_device_state == ATTACHED_STATE)                                       C:\fw\midicontroller\x011\usb.c
00235a   0546     DECF      0x46,0x0,0x1                                                                                    
00235c   e108     BNZ       0x236e                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
00235e   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        C:\fw\midicontroller\x011\usb.c
002360   d006     BRA       0x236e                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
002362   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          C:\fw\midicontroller\x011\usb.c
002364   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           C:\fw\midicontroller\x011\usb.c
002366   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            C:\fw\midicontroller\x011\usb.c
002368   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             C:\fw\midicontroller\x011\usb.c
00236a   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    C:\fw\midicontroller\x011\usb.c
00236c   6f46     MOVWF     0x46,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00236e   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBModuleEnable(void)                                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine enables the USB module.                         C:\fw\midicontroller\x011\usb.c
                                            *                  An end designer should never have to call this routine       C:\fw\midicontroller\x011\usb.c
                                            *                  manually. This routine should only be called from            C:\fw\midicontroller\x011\usb.c
                                            *                  USBCheckBusStatus().                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBModuleEnable(void)                                                       C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
002370   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    C:\fw\midicontroller\x011\usb.c
002372   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\fw\midicontroller\x011\usb.c
002374   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     C:\fw\midicontroller\x011\usb.c
002376   0101     MOVLB     0x1                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         C:\fw\midicontroller\x011\usb.c
002378   0e01     MOVLW     0x1                                                                                             
00237a   6f46     MOVWF     0x46,0x1                                                                                        
00237c   0012     RETURN    0x0            }//end USBModuleEnable                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBModuleDisable(void)                                  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine disables the USB module.                        C:\fw\midicontroller\x011\usb.c
                                            *                  An end designer should never have to call this routine       C:\fw\midicontroller\x011\usb.c
                                            *                  manually. This routine should only be called from            C:\fw\midicontroller\x011\usb.c
                                            *                  USBCheckBusStatus().                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBModuleDisable(void)                                                      C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
00237e   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  C:\fw\midicontroller\x011\usb.c
002380   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           C:\fw\midicontroller\x011\usb.c
002382   0101     MOVLB     0x1                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         C:\fw\midicontroller\x011\usb.c
002384   6b46     CLRF      0x46,0x1                                                                                        
002386   0012     RETURN    0x0            }//end USBModuleDisable                                                          C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBSoftDetach(void)                                     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       C:\fw\midicontroller\x011\usb.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      C:\fw\midicontroller\x011\usb.c
                                            *                  pull-up resistor. The pull-down resistors on the host        C:\fw\midicontroller\x011\usb.c
                                            *                  side will pull both differential signal lines low and        C:\fw\midicontroller\x011\usb.c
                                            *                  the host registers the event as a disconnect.                C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                  Since the USB cable is not physically disconnected, the      C:\fw\midicontroller\x011\usb.c
                                            *                  power supply through the cable can still be sensed by        C:\fw\midicontroller\x011\usb.c
                                            *                  the device. The next time USBCheckBusStatus() function       C:\fw\midicontroller\x011\usb.c
                                            *                  is called, it will reconnect the device back to the bus.     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBSoftDetach(void)                                                         C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
002388   efbf     GOTO      0x237e             USBModuleDisable();                                                          C:\fw\midicontroller\x011\usb.c
00238a   f011                                                                                                               
                                           }//end USBSoftDetach                                                             C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBDriverService(void)                                  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This routine is the heart of this firmware. It manages       C:\fw\midicontroller\x011\usb.c
                                            *                  all USB interrupts.                                          C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            Device state transitions through the following stages:       C:\fw\midicontroller\x011\usb.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                C:\fw\midicontroller\x011\usb.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBDriverService(void)                                                      C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Pointless to continue servicing if USB cable is not even attached.        C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
00238c   0101     MOVLB     0x1                if(usb_device_state == DETACHED_STATE) return;                               C:\fw\midicontroller\x011\usb.c
00238e   5146     MOVF      0x46,0x0,0x1                                                                                    
002390   e101     BNZ       0x2394                                                                                          
002392   d039     BRA       0x2406                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Task A: Service USB Activity Interrupt                                    C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002394   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                C:\fw\midicontroller\x011\usb.c
002396   0b04     ANDLW     0x4                                                                                             
002398   e004     BZ        0x23a2                                                                                          
00239a   5069     MOVF      0x69,0x0,0x0                                                                                    
00239c   0b04     ANDLW     0x4                                                                                             
00239e   e001     BZ        0x23a2                                                                                          
0023a0   d838     RCALL     0x2412                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Pointless to continue servicing if the device is in suspend mode.         C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
0023a2   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               C:\fw\midicontroller\x011\usb.c
0023a4   d030     BRA       0x2406                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  C:\fw\midicontroller\x011\usb.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      C:\fw\midicontroller\x011\usb.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  C:\fw\midicontroller\x011\usb.c
                                                * This is why URSTIF is checked after ACTVIF.                               C:\fw\midicontroller\x011\usb.c
                                                *                                                                           C:\fw\midicontroller\x011\usb.c
                                                * The USB reset flag is masked when the USB state is in                     C:\fw\midicontroller\x011\usb.c
                                                * DETACHED_STATE or ATTACHED_STATE, and therefore cannot                    C:\fw\midicontroller\x011\usb.c
                                                * cause a USB reset event during these two states.                          C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
0023a6   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           C:\fw\midicontroller\x011\usb.c
0023a8   0b01     ANDLW     0x1                                                                                             
0023aa   e004     BZ        0x23b4                                                                                          
0023ac   5069     MOVF      0x69,0x0,0x0                                                                                    
0023ae   0b01     ANDLW     0x1                                                                                             
0023b0   e001     BZ        0x23b4                                                                                          
0023b2   d84f     RCALL     0x2452                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Task C: Service other USB interrupts                                      C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
0023b4   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        C:\fw\midicontroller\x011\usb.c
0023b6   0b10     ANDLW     0x10                                                                                            
0023b8   e004     BZ        0x23c2                                                                                          
0023ba   5069     MOVF      0x69,0x0,0x0                                                                                    
0023bc   0b10     ANDLW     0x10                                                                                            
0023be   e001     BZ        0x23c2                                                                                          
0023c0   d823     RCALL     0x2408                                                                                          
0023c2   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   C:\fw\midicontroller\x011\usb.c
0023c4   0b40     ANDLW     0x40                                                                                            
0023c6   e004     BZ        0x23d0                                                                                          
0023c8   5069     MOVF      0x69,0x0,0x0                                                                                    
0023ca   0b40     ANDLW     0x40                                                                                            
0023cc   e001     BZ        0x23d0                                                                                          
0023ce   d837     RCALL     0x243e                                                                                          
0023d0   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   C:\fw\midicontroller\x011\usb.c
0023d2   0b20     ANDLW     0x20                                                                                            
0023d4   e004     BZ        0x23de                                                                                          
0023d6   5069     MOVF      0x69,0x0,0x0                                                                                    
0023d8   0b20     ANDLW     0x20                                                                                            
0023da   e001     BZ        0x23de                                                                                          
0023dc   d832     RCALL     0x2442                                                                                          
0023de   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   C:\fw\midicontroller\x011\usb.c
0023e0   0b02     ANDLW     0x2                                                                                             
0023e2   e004     BZ        0x23ec                                                                                          
0023e4   5069     MOVF      0x69,0x0,0x0                                                                                    
0023e6   0b02     ANDLW     0x2                                                                                             
0023e8   e001     BZ        0x23ec                                                                                          
0023ea   d831     RCALL     0x244e                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     C:\fw\midicontroller\x011\usb.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       C:\fw\midicontroller\x011\usb.c
                                                * state and is ready for communication.                                     C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
0023ec   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 C:\fw\midicontroller\x011\usb.c
0023ee   0101     MOVLB     0x1                                                                                             
0023f0   5d46     SUBWF     0x46,0x0,0x1                                                                                    
0023f2   e201     BC        0x23f6                                                                                          
0023f4   d008     BRA       0x2406                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
0023f6   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           C:\fw\midicontroller\x011\usb.c
0023f8   0b08     ANDLW     0x8                                                                                             
0023fa   e005     BZ        0x2406                                                                                          
0023fc   5069     MOVF      0x69,0x0,0x0                                                                                    
0023fe   0b08     ANDLW     0x8                                                                                             
002400   e002     BZ        0x2406                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x011\usb.c
                                                    * USBCtrlEPService only services transactions over EP0.                 C:\fw\midicontroller\x011\usb.c
                                                    * It ignores all other EP transactions.                                 C:\fw\midicontroller\x011\usb.c
                                                    */                                                                      C:\fw\midicontroller\x011\usb.c
002402   de34     RCALL     0x206c                 USBCtrlEPService();                                                      C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /*                                                                       C:\fw\midicontroller\x011\usb.c
                                                    * Other EP can be serviced later by responsible device class firmware.  C:\fw\midicontroller\x011\usb.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    C:\fw\midicontroller\x011\usb.c
                                                    * checking the buffer ownership bit.                                    C:\fw\midicontroller\x011\usb.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      C:\fw\midicontroller\x011\usb.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       C:\fw\midicontroller\x011\usb.c
                                                    *                                                                       C:\fw\midicontroller\x011\usb.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    C:\fw\midicontroller\x011\usb.c
                                                    * of non-EP0 transactions.                                              C:\fw\midicontroller\x011\usb.c
                                                    */                                                                      C:\fw\midicontroller\x011\usb.c
002404   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\fw\midicontroller\x011\usb.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002406   0012     RETURN    0x0            }//end USBDriverService                                                          C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBSuspend(void)                                        C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:                                                                     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBSuspend(void)                                                            C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   C:\fw\midicontroller\x011\usb.c
                                                * Reason:                                                                   C:\fw\midicontroller\x011\usb.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               C:\fw\midicontroller\x011\usb.c
                                                * This is a 1:1 ratio interrupt generation.                                 C:\fw\midicontroller\x011\usb.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             C:\fw\midicontroller\x011\usb.c
                                                * the number of subsequent bus transitions.                                 C:\fw\midicontroller\x011\usb.c
                                                *                                                                           C:\fw\midicontroller\x011\usb.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 C:\fw\midicontroller\x011\usb.c
                                                * [       IDLE       ][bus activity ->                                      C:\fw\midicontroller\x011\usb.c
                                                * <--- 3 ms ----->     ^                                                    C:\fw\midicontroller\x011\usb.c
                                                *                ^     ACTVIF=1                                             C:\fw\midicontroller\x011\usb.c
                                                *                IDLEIF=1                                                   C:\fw\midicontroller\x011\usb.c
                                                *  #           #           #           #   (#=Program polling flags)        C:\fw\midicontroller\x011\usb.c
                                                *                          ^                                                C:\fw\midicontroller\x011\usb.c
                                                *                          This polling loop will see both                  C:\fw\midicontroller\x011\usb.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           C:\fw\midicontroller\x011\usb.c
                                                *                          However, the program services IDLEIF first       C:\fw\midicontroller\x011\usb.c
                                                *                          because ACTIVIE=0.                               C:\fw\midicontroller\x011\usb.c
                                                *                          If this routine clears the only ACTIVIF,         C:\fw\midicontroller\x011\usb.c
                                                *                          then it can never get out of the suspend         C:\fw\midicontroller\x011\usb.c
                                                *                          mode.                                            C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002408   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     C:\fw\midicontroller\x011\usb.c
00240a   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          C:\fw\midicontroller\x011\usb.c
00240c   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  C:\fw\midicontroller\x011\usb.c
                                                                                       // mode, SIE clock inactive          C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * At this point the PIC can go into sleep,idle, or                          C:\fw\midicontroller\x011\usb.c
                                                * switch to a slower clock, etc.                                            C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               /* Modifiable Section */                                                     C:\fw\midicontroller\x011\usb.c
00240e   9aa1     BCF       0xa1,0x5,0x0       PIR2bits.USBIF = 0;                                                          C:\fw\midicontroller\x011\usb.c
                                           /*                                                                               C:\fw\midicontroller\x011\usb.c
                                           //2/15/05 JD This was causing problems with USBIE being enabled..                C:\fw\midicontroller\x011\usb.c
                                               INTCONbits.RBIF = 0;                                                         C:\fw\midicontroller\x011\usb.c
                                               PIE2bits.USBIE = 1;                     // Set USB wakeup source             C:\fw\midicontroller\x011\usb.c
                                               INTCONbits.RBIE = 1;                    // Set sw2,3 wakeup source           C:\fw\midicontroller\x011\usb.c
                                               Sleep();                                // Goto sleep                        C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                               if(INTCONbits.RBIF == 1)                // Check if external stimulus        C:\fw\midicontroller\x011\usb.c
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
                                                   USBRemoteWakeup();                  // If yes, attempt RWU               C:\fw\midicontroller\x011\usb.c
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
                                               PIE2bits.USBIE = 0;                                                          C:\fw\midicontroller\x011\usb.c
                                               INTCONbits.RBIE = 0;                                                         C:\fw\midicontroller\x011\usb.c
                                           */                                                                               C:\fw\midicontroller\x011\usb.c
                                               /* End Modifiable Section */                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002410   0012     RETURN    0x0            }//end USBSuspend                                                                C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBWakeFromSuspend(void)                                C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:                                                                     C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBWakeFromSuspend(void)                                                    C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * If using clock switching, this is the place to restore the                C:\fw\midicontroller\x011\usb.c
                                                * original clock frequency.                                                 C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002412   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         C:\fw\midicontroller\x011\usb.c
002414   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          C:\fw\midicontroller\x011\usb.c
002416   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          C:\fw\midicontroller\x011\usb.c
002418   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBRemoteWakeup(void)                                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        This function should be called by user when the device       C:\fw\midicontroller\x011\usb.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      C:\fw\midicontroller\x011\usb.c
                                            *                  Please read the note below to understand the limitations.    C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            The modifiable section in this routine should be changed     C:\fw\midicontroller\x011\usb.c
                                            *                  to meet the application needs. Current implementation        C:\fw\midicontroller\x011\usb.c
                                            *                  temporary blocks other functions from executing for a        C:\fw\midicontroller\x011\usb.c
                                            *                  period of 1-13 ms depending on the core frequency.           C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          C:\fw\midicontroller\x011\usb.c
                                            *                  "The remote wakeup device must hold the resume signaling     C:\fw\midicontroller\x011\usb.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                C:\fw\midicontroller\x011\usb.c
                                            *                  The idea here is to use a delay counter loop, using a        C:\fw\midicontroller\x011\usb.c
                                            *                  common value that would work over a wide range of core       C:\fw\midicontroller\x011\usb.c
                                            *                  frequencies.                                                 C:\fw\midicontroller\x011\usb.c
                                            *                  That value selected is 1800. See table below:                C:\fw\midicontroller\x011\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x011\usb.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    C:\fw\midicontroller\x011\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x011\usb.c
                                            *                      48              12          1.05                         C:\fw\midicontroller\x011\usb.c
                                            *                       4              1           12.6                         C:\fw\midicontroller\x011\usb.c
                                            *                  ==========================================================   C:\fw\midicontroller\x011\usb.c
                                            *                  * These timing could be incorrect when using code            C:\fw\midicontroller\x011\usb.c
                                            *                    optimization or extended instruction mode,                 C:\fw\midicontroller\x011\usb.c
                                            *                    or when having other interrupts enabled.                   C:\fw\midicontroller\x011\usb.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBRemoteWakeup(void)                                                       C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               static word delay_count;                                                     C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00241a   0101     MOVLB     0x1                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    C:\fw\midicontroller\x011\usb.c
00241c   a147     BTFSS     0x47,0x0,0x1                                                                                    
00241e   d00e     BRA       0x243c                                                                                          
                                               {                                       // has been enabled by the host.     C:\fw\midicontroller\x011\usb.c
002420   dff8     RCALL     0x2412                 USBWakeFromSuspend();               // Unsuspend USB modue               C:\fw\midicontroller\x011\usb.c
002422   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /* Modifiable Section */                                                 C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002424   0101     MOVLB     0x1                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       C:\fw\midicontroller\x011\usb.c
002426   0e08     MOVLW     0x8                                                                                             
002428   6f52     MOVWF     0x52,0x1                                                                                        
00242a   0e07     MOVLW     0x7                                                                                             
00242c   6f53     MOVWF     0x53,0x1                                                                                        
                                                   do                                                                       C:\fw\midicontroller\x011\usb.c
                                                   {                                                                        C:\fw\midicontroller\x011\usb.c
00242e   0752     DECF      0x52,0x1,0x1               delay_count--;                                                       C:\fw\midicontroller\x011\usb.c
002430   0e00     MOVLW     0x0                                                                                             
002432   5b53     SUBWFB    0x53,0x1,0x1                                                                                    
002434   5152     MOVF      0x52,0x0,0x1           }while(delay_count);                                                     C:\fw\midicontroller\x011\usb.c
002436   1153     IORWF     0x53,0x0,0x1                                                                                    
002438   e1fa     BNZ       0x242e                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                   /* End Modifiable Section */                                             C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00243a   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     C:\fw\midicontroller\x011\usb.c
                                               }//endif                                                                     C:\fw\midicontroller\x011\usb.c
00243c   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USB_SOF_Handler(void)                                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    C:\fw\midicontroller\x011\usb.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     C:\fw\midicontroller\x011\usb.c
                                            *                  pipes. End designers should implement callback routine       C:\fw\midicontroller\x011\usb.c
                                            *                  as necessary.                                                C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USB_SOF_Handler(void)                                                       C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               /* Callback routine here */                                                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00243e   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           C:\fw\midicontroller\x011\usb.c
002440   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBStallHandler(void)                                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         C:\fw\midicontroller\x011\usb.c
                                            *                  packet regardless of which endpoint causes it.               C:\fw\midicontroller\x011\usb.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  C:\fw\midicontroller\x011\usb.c
                                            *                  endpoint stops stalling once it receives a setup packet.     C:\fw\midicontroller\x011\usb.c
                                            *                  In this case, the SIE will accepts the Setup packet and      C:\fw\midicontroller\x011\usb.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    C:\fw\midicontroller\x011\usb.c
                                            *                  for that particular endpoint pipe will be automatically      C:\fw\midicontroller\x011\usb.c
                                            *                  disabled (direction specific).                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            *                  There are a few reasons for an endpoint to be stalled.       C:\fw\midicontroller\x011\usb.c
                                            *                  1. When a non-supported USB request is received.             C:\fw\midicontroller\x011\usb.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 C:\fw\midicontroller\x011\usb.c
                                            *                  2. When an endpoint is currently halted.                     C:\fw\midicontroller\x011\usb.c
                                            *                  3. When the device class specifies that an endpoint must     C:\fw\midicontroller\x011\usb.c
                                            *                     stall in response to a specific event.                    C:\fw\midicontroller\x011\usb.c
                                            *                     Example: Mass Storage Device Class                        C:\fw\midicontroller\x011\usb.c
                                            *                              If the CBW is not valid, the device shall        C:\fw\midicontroller\x011\usb.c
                                            *                              STALL the Bulk-In pipe.                          C:\fw\midicontroller\x011\usb.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   C:\fw\midicontroller\x011\usb.c
                                            *                              Specification for more details.                  C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     C:\fw\midicontroller\x011\usb.c
                                            *                  the stall event.                                             C:\fw\midicontroller\x011\usb.c
                                            *                  If                                                           C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBStallHandler(void)                                                       C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
                                               /*                                                                           C:\fw\midicontroller\x011\usb.c
                                                * Does not really have to do anything here,                                 C:\fw\midicontroller\x011\usb.c
                                                * even for the control endpoint.                                            C:\fw\midicontroller\x011\usb.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         C:\fw\midicontroller\x011\usb.c
                                                * but once a Setup Transaction is received, the ownership                   C:\fw\midicontroller\x011\usb.c
                                                * for EP0_OUT will be returned to CPU.                                      C:\fw\midicontroller\x011\usb.c
                                                * When the Setup Transaction is serviced, the ownership                     C:\fw\midicontroller\x011\usb.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   C:\fw\midicontroller\x011\usb.c
                                                */                                                                          C:\fw\midicontroller\x011\usb.c
002442   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    C:\fw\midicontroller\x011\usb.c
002444   d002     BRA       0x244a                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
002446   df76     RCALL     0x2334                 USBPrepareForNextSetupTrf();        // Firmware work-around              C:\fw\midicontroller\x011\usb.c
002448   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    C:\fw\midicontroller\x011\usb.c
                                               }                                                                            C:\fw\midicontroller\x011\usb.c
00244a   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         C:\fw\midicontroller\x011\usb.c
00244c   0012     RETURN    0x0            }//end USBStallHandler                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBErrorHandler(void)                                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        C:\fw\midicontroller\x011\usb.c
                                            *                  during development. Check UEIR to see which error causes     C:\fw\midicontroller\x011\usb.c
                                            *                  the interrupt.                                               C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBErrorHandler(void)                                                       C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
00244e   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          C:\fw\midicontroller\x011\usb.c
002450   0012     RETURN    0x0            }//end USBErrorHandler                                                           C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\usb.c
                                            * Function:        void USBProtocolResetHandler(void)                           C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * PreCondition:    A USB bus reset is received from the host.                   C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              C:\fw\midicontroller\x011\usb.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     C:\fw\midicontroller\x011\usb.c
                                            *                  might not be desirable in some applications.                 C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Overview:        Once a USB bus reset is received from the host, this         C:\fw\midicontroller\x011\usb.c
                                            *                  routine should be called. It resets the device address to    C:\fw\midicontroller\x011\usb.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     C:\fw\midicontroller\x011\usb.c
                                            *                  be ready for default communication, clears all USB           C:\fw\midicontroller\x011\usb.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      C:\fw\midicontroller\x011\usb.c
                                            *                  reinitializes internal state-machine variables.              C:\fw\midicontroller\x011\usb.c
                                            *                                                                               C:\fw\midicontroller\x011\usb.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\usb.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\usb.c
                                           void USBProtocolResetHandler(void)                                               C:\fw\midicontroller\x011\usb.c
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
002452   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 C:\fw\midicontroller\x011\usb.c
002454   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 C:\fw\midicontroller\x011\usb.c
002456   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           C:\fw\midicontroller\x011\usb.c
002458   6e6b     MOVWF     0x6b,0x0                                                                                        
00245a   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       C:\fw\midicontroller\x011\usb.c
00245c   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
00245e   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  C:\fw\midicontroller\x011\usb.c
002460   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          C:\fw\midicontroller\x011\usb.c
002462   6ee6     MOVWF     0xe6,0x0                                                                                        
002464   0e71     MOVLW     0x71                                                                                            
002466   6ee6     MOVWF     0xe6,0x0                                                                                        
002468   0e0f     MOVLW     0xf                                                                                             
00246a   6ee6     MOVWF     0xe6,0x0                                                                                        
00246c   d811     RCALL     0x2490                                                                                          
00246e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002470   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002472   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002474   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       C:\fw\midicontroller\x011\usb.c
002476   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002478   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            C:\fw\midicontroller\x011\usb.c
00247a   d002     BRA       0x2480                                                                                          
00247e   d7fc     BRA       0x2478                                                                                          
00247c   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002480   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    C:\fw\midicontroller\x011\usb.c
002482   df58     RCALL     0x2334             USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
002484   0101     MOVLB     0x1                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            C:\fw\midicontroller\x011\usb.c
002486   9147     BCF       0x47,0x0,0x1                                                                                    
002488   6b48     CLRF      0x48,0x1           usb_active_cfg = 0;             // Clear active configuration                C:\fw\midicontroller\x011\usb.c
00248a   0e03     MOVLW     0x3                usb_device_state = DEFAULT_STATE;                                            C:\fw\midicontroller\x011\usb.c
00248c   6f46     MOVWF     0x46,0x1                                                                                        
00248e   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /* Auxiliary Function */                                                         C:\fw\midicontroller\x011\usb.c
002490   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       C:\fw\midicontroller\x011\usb.c
002492   ffe6                                                                                                               
002494   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002496   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x011\usb.c
002498   0efd     MOVLW     0xfd               *startAdr;                                                                   C:\fw\midicontroller\x011\usb.c
00249a   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00249c   ffe9                                                                                                               
00249e   0efe     MOVLW     0xfe                                                                                            
0024a0   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0024a2   ffea                                                                                                               
0024a4   0efc     MOVLW     0xfc               while(count)                                                                 C:\fw\midicontroller\x011\usb.c
0024a6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0024a8   e004     BZ        0x24b2                                                                                          
0024b0   d7f9     BRA       0x24a4                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usb.c
                                                   _asm                                                                     C:\fw\midicontroller\x011\usb.c
0024aa   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          C:\fw\midicontroller\x011\usb.c
                                                   _endasm                                                                  C:\fw\midicontroller\x011\usb.c
0024ac   0efc     MOVLW     0xfc                   count--;                                                                 C:\fw\midicontroller\x011\usb.c
0024ae   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 C:\fw\midicontroller\x011\usb.c
0024b2   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                C:\fw\midicontroller\x011\usb.c
0024b4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024b6   ffd9                                                                                                               
0024b8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                           /** EOF usbdrv.c *************************************************************/  C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usb.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x011\usbapplet.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           void PROCESS_COMM_REQUEST(void);                                                 C:\fw\midicontroller\x011\usbapplet.c
                                           //void RemCapCalculation(void);                                                  C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           void HIDSetReportHandler(void) {                                                 C:\fw\midicontroller\x011\usbapplet.c
003108   0100     MOVLB     0x0            	USBQuery = true;                                                                C:\fw\midicontroller\x011\usbapplet.c
00310a   89b8     BSF       0xb8,0x4,0x1                                                                                    
00310c   ecee     CALL      0x2bdc,0x0     	PROCESS_COMM_REQUEST();                                                         C:\fw\midicontroller\x011\usbapplet.c
00310e   f015                                                                                                               
003110   0100     MOVLB     0x0            	USBQuery = false;	                                                              C:\fw\midicontroller\x011\usbapplet.c
003112   99b8     BCF       0xb8,0x4,0x1                                                                                    
003114   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\usbapplet.c
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x011\usbapplet.c
                                           void HIDGetReportHandler(void) {                                                 C:\fw\midicontroller\x011\usbapplet.c
                                           //load up CtrlTrfData with data.                                                 C:\fw\midicontroller\x011\usbapplet.c
003116   0100     MOVLB     0x0            	USBQuery = true;                                                                C:\fw\midicontroller\x011\usbapplet.c
003118   89b8     BSF       0xb8,0x4,0x1                                                                                    
00311a   ecee     CALL      0x2bdc,0x0     	PROCESS_COMM_REQUEST();                                                         C:\fw\midicontroller\x011\usbapplet.c
00311c   f015                                                                                                               
00311e   0101     MOVLB     0x1            	ctrl_trf_session_owner = MUID_HID;                                              C:\fw\midicontroller\x011\usbapplet.c
003120   0e02     MOVLW     0x2                                                                                             
003122   6f4b     MOVWF     0x4b,0x1                                                                                        
003124   0101     MOVLB     0x1            	pSrc.bRam = (byte*)&CtrlTrfData;                                                C:\fw\midicontroller\x011\usbapplet.c
003126   0e18     MOVLW     0x18                                                                                            
003128   6f4c     MOVWF     0x4c,0x1                                                                                        
00312a   0e04     MOVLW     0x4                                                                                             
00312c   6f4d     MOVWF     0x4d,0x1                                                                                        
00312e   0101     MOVLB     0x1            	usb_stat.ctrl_trf_mem = _RAM;       // Set memory type                          C:\fw\midicontroller\x011\usbapplet.c
003130   9347     BCF       0x47,0x1,0x1                                                                                    
003132   0100     MOVLB     0x0            	USBQuery = false;                                                               C:\fw\midicontroller\x011\usbapplet.c
003134   99b8     BCF       0xb8,0x4,0x1                                                                                    
003136   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           typedef union DATA_PACKET                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           {                                                                                C:\fw\midicontroller\x011\usbapplet.c
                                               byte _byte[HID_INT_OUT_EP_SIZE];  //For byte access                          C:\fw\midicontroller\x011\usbapplet.c
                                               word _word[HID_INT_OUT_EP_SIZE/2];//For word access(USBGEN_EP_SIZE msut be even) C:\fw\midicontroller\x011\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x011\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                   enum                                                                     C:\fw\midicontroller\x011\usbapplet.c
                                                   {                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                                       READ_VERSION    = 0x00,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       /*                                                                   C:\fw\midicontroller\x011\usbapplet.c
                                                       READ_FLASH      = 0x01,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       WRITE_FLASH     = 0x02,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       ERASE_FLASH     = 0x03,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       READ_EEDATA     = 0x04,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       WRITE_EEDATA    = 0x05,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       READ_CONFIG     = 0x06,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       WRITE_CONFIG    = 0x07,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       */                                                                   C:\fw\midicontroller\x011\usbapplet.c
                                                       ID_BOARD        = 0x31,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       UPDATE_LED      = 0x32,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       SET_TEMP_REAL   = 0x33,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       RD_TEMP         = 0x34,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       SET_TEMP_LOGGING= 0x35,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       RD_TEMP_LOGGING = 0x36,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       RD_POT          = 0x37,                                              C:\fw\midicontroller\x011\usbapplet.c
                                                       RESET           = 0xFF                                               C:\fw\midicontroller\x011\usbapplet.c
                                                   }CMD;                                                                    C:\fw\midicontroller\x011\usbapplet.c
                                                   byte len;                                                                C:\fw\midicontroller\x011\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x011\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x011\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                   unsigned :8;                                                             C:\fw\midicontroller\x011\usbapplet.c
                                                   byte ID;                                                                 C:\fw\midicontroller\x011\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x011\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x011\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                   unsigned :8;                                                             C:\fw\midicontroller\x011\usbapplet.c
                                                   byte led_num;                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                   byte led_status;                                                         C:\fw\midicontroller\x011\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x011\usbapplet.c
                                               struct                                                                       C:\fw\midicontroller\x011\usbapplet.c
                                               {                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                   unsigned :8;                                                             C:\fw\midicontroller\x011\usbapplet.c
                                                   word word_data;                                                          C:\fw\midicontroller\x011\usbapplet.c
                                               };                                                                           C:\fw\midicontroller\x011\usbapplet.c
                                           } DATA_PACKET;                                                                   C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           DATA_PACKET dataPacket;                                                          C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
003138   cfd9     MOVFF     0xfd9,0xfe6    void ServiceRequests(void)                                                       C:\fw\midicontroller\x011\usbapplet.c
00313a   ffe6                                                                                                               
00313c   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00313e   ffd9                                                                                                               
003140   0e02     MOVLW     0x2                                                                                             
003142   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {    byte index, counter;                                                        C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
003144   0e08     MOVLW     0x8                if(HIDRxReport((byte*)&dataPacket,sizeof(dataPacket)))                       C:\fw\midicontroller\x011\usbapplet.c
003146   6ee6     MOVWF     0xe6,0x0                                                                                        
003148   0e57     MOVLW     0x57                                                                                            
00314a   6ee6     MOVWF     0xe6,0x0                                                                                        
00314c   0e01     MOVLW     0x1                                                                                             
00314e   6ee6     MOVWF     0xe6,0x0                                                                                        
003150   ec43     CALL      0x3086,0x0                                                                                      
003152   f018                                                                                                               
003154   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003156   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003158   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00315a   0900     IORLW     0x0                                                                                             
00315c   e028     BZ        0x31ae                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\usbapplet.c
00315e   0e01     MOVLW     0x1                    counter = 0;                                                             C:\fw\midicontroller\x011\usbapplet.c
003160   6adb     CLRF      0xdb,0x0                                                                                        
003162   0101     MOVLB     0x1                    switch(dataPacket.CMD)                                                   C:\fw\midicontroller\x011\usbapplet.c
003164   5157     MOVF      0x57,0x0,0x1                                                                                    
003166   e008     BZ        0x3178                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                                       case READ_VERSION:                                                   C:\fw\midicontroller\x011\usbapplet.c
                                                           //dataPacket._byte[1] is len                                     C:\fw\midicontroller\x011\usbapplet.c
003178   0e01     MOVLW     0x1                            dataPacket._byte[2] = 0x01;                                      C:\fw\midicontroller\x011\usbapplet.c
00317a   6f59     MOVWF     0x59,0x1                                                                                        
00317c   0e02     MOVLW     0x2                            dataPacket._byte[3] = 0x02;                                      C:\fw\midicontroller\x011\usbapplet.c
00317e   6f5a     MOVWF     0x5a,0x1                                                                                        
003180   52de     MOVF      0xde,0x1,0x0                   counter=0x04;                                                    C:\fw\midicontroller\x011\usbapplet.c
003182   0e04     MOVLW     0x4                                                                                             
003184   6edd     MOVWF     0xdd,0x0                                                                                        
003186   d001     BRA       0x318a                         break;                                                           C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                       default:                                                             C:\fw\midicontroller\x011\usbapplet.c
                                                           //dataPacket._byte[1] is len                                     C:\fw\midicontroller\x011\usbapplet.c
003168   0e01     MOVLW     0x1                            dataPacket._byte[2] = 0x01;                                      C:\fw\midicontroller\x011\usbapplet.c
00316a   6f59     MOVWF     0x59,0x1                                                                                        
00316c   0e02     MOVLW     0x2                            dataPacket._byte[3] = 0x02;                                      C:\fw\midicontroller\x011\usbapplet.c
00316e   6f5a     MOVWF     0x5a,0x1                                                                                        
003170   52de     MOVF      0xde,0x1,0x0                   counter=64;                                                      C:\fw\midicontroller\x011\usbapplet.c
003172   0e40     MOVLW     0x40                                                                                            
003174   6edd     MOVWF     0xdd,0x0                                                                                        
003176   d009     BRA       0x318a                         break;                                                           C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
003188   d000     BRA       0x318a                         break;                                                           C:\fw\midicontroller\x011\usbapplet.c
                                                   }//end switch()                                                          C:\fw\midicontroller\x011\usbapplet.c
00318a   0e01     MOVLW     0x1                    if(counter != 0)                                                         C:\fw\midicontroller\x011\usbapplet.c
00318c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00318e   e00f     BZ        0x31ae                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\usbapplet.c
003190   0104     MOVLB     0x4                        if(!mHIDTxIsBusy())                                                  C:\fw\midicontroller\x011\usbapplet.c
003192   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
003194   d00c     BRA       0x31ae                                                                                          
003196   0e01     MOVLW     0x1                            HIDTxReport((byte*)&dataPacket,counter);                         C:\fw\midicontroller\x011\usbapplet.c
003198   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00319a   ffe6                                                                                                               
00319c   0e57     MOVLW     0x57                                                                                            
00319e   6ee6     MOVWF     0xe6,0x0                                                                                        
0031a0   0e01     MOVLW     0x1                                                                                             
0031a2   6ee6     MOVWF     0xe6,0x0                                                                                        
0031a4   ec09     CALL      0x3012,0x0                                                                                      
0031a6   f018                                                                                                               
0031a8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0031aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0031ac   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                   }//end if                                                                C:\fw\midicontroller\x011\usbapplet.c
                                               }//end if                                                                    C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
0031ae   0e02     MOVLW     0x2            }//end ServiceRequests                                                           C:\fw\midicontroller\x011\usbapplet.c
0031b0   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0031b2   e202     BC        0x31b8                                                                                          
0031b4   6ae1     CLRF      0xe1,0x0                                                                                        
0031b6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0031b8   6ee1     MOVWF     0xe1,0x0                                                                                        
0031ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0031bc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0031be   ffd9                                                                                                               
0031c0   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           #define	WRITE_NVR		3                                                             C:\fw\midicontroller\x011\usbapplet.c
                                           #define	READ_NVR		4                                                              C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           unsigned char PresentCmd;                                                        C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           //This handles data over report ID 44                                            C:\fw\midicontroller\x011\usbapplet.c
                                           //Device to host must always follow a host to device                             C:\fw\midicontroller\x011\usbapplet.c
0031c2   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ProcessGenericTransferd2h(void) {                                  C:\fw\midicontroller\x011\usbapplet.c
0031c4   ffe6                                                                                                               
0031c6   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0031c8   ffd9                                                                                                               
0031ca   0e02     MOVLW     0x2                                                                                             
0031cc   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char index, cmdrecognized;                                             C:\fw\midicontroller\x011\usbapplet.c
                                           	                                                                                C:\fw\midicontroller\x011\usbapplet.c
0031ce   52de     MOVF      0xde,0x1,0x0   	cmdrecognized = true;                                                           C:\fw\midicontroller\x011\usbapplet.c
0031d0   0e01     MOVLW     0x1                                                                                             
0031d2   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	                                                                                C:\fw\midicontroller\x011\usbapplet.c
0031d4   0101     MOVLB     0x1            	switch (PresentCmd) {                                                           C:\fw\midicontroller\x011\usbapplet.c
0031d6   515f     MOVF      0x5f,0x0,0x1                                                                                    
0031d8   0a04     XORLW     0x4                                                                                             
0031da   e011     BZ        0x31fe                                                                                          
0031dc   0a07     XORLW     0x7                                                                                             
0031de   e003     BZ        0x31e6                                                                                          
                                           		case	WRITE_NVR:		//the response to a write nvr request is simply a readback of that data C:\fw\midicontroller\x011\usbapplet.c
0031e6   6adf     CLRF      0xdf,0x0       			for (index=0;index<64;index++) {                                              C:\fw\midicontroller\x011\usbapplet.c
0031e8   0e40     MOVLW     0x40                                                                                            
0031ea   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
0031ec   e207     BC        0x31fc                                                                                          
0031f8   2adf     INCF      0xdf,0x1,0x0                                                                                    
0031fa   d7f6     BRA       0x31e8                                                                                          
0031ee   0e02     MOVLW     0x2            				TXENQ(2);                                                                    C:\fw\midicontroller\x011\usbapplet.c
0031f0   6ee6     MOVWF     0xe6,0x0                                                                                        
0031f2   ec50     CALL      0x2ea0,0x0                                                                                      
0031f4   f017                                                                                                               
0031f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\usbapplet.c
0031fc   d015     BRA       0x3228         			break;                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           		case	READ_NVR:		//use address set previously to send out new data              C:\fw\midicontroller\x011\usbapplet.c
0031fe   0e05     MOVLW     0x5            			TXENQ(5);                                                                     C:\fw\midicontroller\x011\usbapplet.c
003200   6ee6     MOVWF     0xe6,0x0                                                                                        
003202   ec50     CALL      0x2ea0,0x0                                                                                      
003204   f017                                                                                                               
003206   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003208   0e06     MOVLW     0x6            			TXENQ(6);                                                                     C:\fw\midicontroller\x011\usbapplet.c
00320a   6ee6     MOVWF     0xe6,0x0                                                                                        
00320c   ec50     CALL      0x2ea0,0x0                                                                                      
00320e   f017                                                                                                               
003210   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003212   6adf     CLRF      0xdf,0x0       			for (index=0;index<62;index++) {                                              C:\fw\midicontroller\x011\usbapplet.c
003214   0e3e     MOVLW     0x3e                                                                                            
003216   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
003218   e206     BC        0x3226                                                                                          
003222   2adf     INCF      0xdf,0x1,0x0                                                                                    
003224   d7f7     BRA       0x3214                                                                                          
00321a   6ae6     CLRF      0xe6,0x0       				TXENQ(0);                                                                    C:\fw\midicontroller\x011\usbapplet.c
00321c   ec50     CALL      0x2ea0,0x0                                                                                      
00321e   f017                                                                                                               
003220   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\usbapplet.c
003226   d000     BRA       0x3228         			break;                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           		default:                                                                       C:\fw\midicontroller\x011\usbapplet.c
0031e0   0e01     MOVLW     0x1            			cmdrecognized = false;                                                        C:\fw\midicontroller\x011\usbapplet.c
0031e2   6adb     CLRF      0xdb,0x0                                                                                        
0031e4   d021     BRA       0x3228         			break;                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           	}                                                                               C:\fw\midicontroller\x011\usbapplet.c
003228   0e01     MOVLW     0x1            	return cmdrecognized;                                                           C:\fw\midicontroller\x011\usbapplet.c
00322a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00322c   6e10     MOVWF     0x10,0x0       }                                                                                C:\fw\midicontroller\x011\usbapplet.c
00322e   0e02     MOVLW     0x2                                                                                             
003230   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
003232   e203     BC        0x323a                                                                                          
003234   d000     BRA       0x3236                                                                                          
003236   6ae1     CLRF      0xe1,0x0                                                                                        
003238   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00323a   6ee1     MOVWF     0xe1,0x0                                                                                        
00323c   5010     MOVF      0x10,0x0,0x0                                                                                    
00323e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003240   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003242   ffd9                                                                                                               
003244   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                                                                                                            C:\fw\midicontroller\x011\usbapplet.c
                                           //This handles data over report ID 44.	                                          C:\fw\midicontroller\x011\usbapplet.c
003246   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ProcessGenericTransferh2d(void) {                                  C:\fw\midicontroller\x011\usbapplet.c
003248   ffe6                                                                                                               
00324a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00324c   ffd9                                                                                                               
00324e   0e02     MOVLW     0x2                                                                                             
003250   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char index, cmdrecognized;                                             C:\fw\midicontroller\x011\usbapplet.c
                                           	                                                                                C:\fw\midicontroller\x011\usbapplet.c
003252   52de     MOVF      0xde,0x1,0x0   	cmdrecognized = true;                                                           C:\fw\midicontroller\x011\usbapplet.c
003254   0e01     MOVLW     0x1                                                                                             
003256   6edd     MOVWF     0xdd,0x0                                                                                        
003258   c072     MOVFF     0x72,0x15f     	PresentCmd = USBEP0DataInBuffer[1];                                             C:\fw\midicontroller\x011\usbapplet.c
00325a   f15f                                                                                                               
00325c   0100     MOVLB     0x0            	switch (USBEP0DataInBuffer[1]) {                                                C:\fw\midicontroller\x011\usbapplet.c
00325e   5172     MOVF      0x72,0x0,0x1                                                                                    
003260   0a04     XORLW     0x4                                                                                             
003262   e006     BZ        0x3270                                                                                          
003264   0a07     XORLW     0x7                                                                                             
003266   e003     BZ        0x326e                                                                                          
                                           		case	WRITE_NVR:                                                                C:\fw\midicontroller\x011\usbapplet.c
                                           			                                                                              C:\fw\midicontroller\x011\usbapplet.c
00326e   d001     BRA       0x3272         			break;                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           		case	READ_NVR:                                                                 C:\fw\midicontroller\x011\usbapplet.c
                                           			//address = whatever..                                                        C:\fw\midicontroller\x011\usbapplet.c
003270   d000     BRA       0x3272         			break;                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           		default:                                                                       C:\fw\midicontroller\x011\usbapplet.c
003268   0e01     MOVLW     0x1            			cmdrecognized = false;                                                        C:\fw\midicontroller\x011\usbapplet.c
00326a   6adb     CLRF      0xdb,0x0                                                                                        
00326c   d002     BRA       0x3272         			break;                                                                        C:\fw\midicontroller\x011\usbapplet.c
                                           	}                                                                               C:\fw\midicontroller\x011\usbapplet.c
003272   0e01     MOVLW     0x1            	return cmdrecognized;                                                           C:\fw\midicontroller\x011\usbapplet.c
003274   50db     MOVF      0xdb,0x0,0x0                                                                                    
003276   6e10     MOVWF     0x10,0x0       }                                                                                C:\fw\midicontroller\x011\usbapplet.c
003278   0e02     MOVLW     0x2                                                                                             
00327a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00327c   e203     BC        0x3284                                                                                          
00327e   d000     BRA       0x3280                                                                                          
003280   6ae1     CLRF      0xe1,0x0                                                                                        
003282   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003284   6ee1     MOVWF     0xe1,0x0                                                                                        
003286   5010     MOVF      0x10,0x0,0x0                                                                                    
003288   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00328a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00328c   ffd9                                                                                                               
00328e   0012     RETURN    0x0                                                                                             
                                           /*********************************************************************           C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            *                Microchip USB C18 Firmware Version 1.0                         C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            *********************************************************************           C:\fw\midicontroller\x011\usbdescript.c
                                            * FileName:        usbdsc.c                                                     C:\fw\midicontroller\x011\usbdescript.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x011\usbdescript.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x011\usbdescript.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x011\usbdescript.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x011\usbdescript.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x011\usbdescript.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x011\usbdescript.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x011\usbdescript.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x011\usbdescript.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x011\usbdescript.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x011\usbdescript.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x011\usbdescript.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x011\usbdescript.c
                                            * license.                                                                      C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x011\usbdescript.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x011\usbdescript.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x011\usbdescript.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x011\usbdescript.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x011\usbdescript.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /*********************************************************************           C:\fw\midicontroller\x011\usbdescript.c
                                            * -usbdsc.c-                                                                    C:\fw\midicontroller\x011\usbdescript.c
                                            * This file contains the USB descriptor information. It is used                 C:\fw\midicontroller\x011\usbdescript.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             C:\fw\midicontroller\x011\usbdescript.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                C:\fw\midicontroller\x011\usbdescript.c
                                            * the user must also change the descriptor structure defined in                 C:\fw\midicontroller\x011\usbdescript.c
                                            * the usbdsc.h file. The structure is used to calculate the                     C:\fw\midicontroller\x011\usbdescript.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * A typical configuration descriptor consists of:                               C:\fw\midicontroller\x011\usbdescript.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           C:\fw\midicontroller\x011\usbdescript.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              C:\fw\midicontroller\x011\usbdescript.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * Naming Convention:                                                            C:\fw\midicontroller\x011\usbdescript.c
                                            * To resolve ambiguity, the naming convention are as followed:                  C:\fw\midicontroller\x011\usbdescript.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      C:\fw\midicontroller\x011\usbdescript.c
                                            *   configuration number. This number should match the actual                   C:\fw\midicontroller\x011\usbdescript.c
                                            *   index value of this configuration.                                          C:\fw\midicontroller\x011\usbdescript.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               C:\fw\midicontroller\x011\usbdescript.c
                                            *   interface number and zz is the alternate interface number.                  C:\fw\midicontroller\x011\usbdescript.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 C:\fw\midicontroller\x011\usbdescript.c
                                            *   ## is the endpoint number and d is the direction of transfer.               C:\fw\midicontroller\x011\usbdescript.c
                                            *   The interface name should also be listed as a suffix to identify            C:\fw\midicontroller\x011\usbdescript.c
                                            *   which interface does the endpoint belong to.                                C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * Example:                                                                      C:\fw\midicontroller\x011\usbdescript.c
                                            * If a device has one configuration, two interfaces; interface 0                C:\fw\midicontroller\x011\usbdescript.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         C:\fw\midicontroller\x011\usbdescript.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * #define CFG01 rom struct                            \                         C:\fw\midicontroller\x011\usbdescript.c
                                            * {   USB_CFG_DSC             cd01;                   \                         C:\fw\midicontroller\x011\usbdescript.c
                                            *     USB_INTF_DSC            i00a00;                 \                         C:\fw\midicontroller\x011\usbdescript.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         C:\fw\midicontroller\x011\usbdescript.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         C:\fw\midicontroller\x011\usbdescript.c
                                            *     USB_INTF_DSC            i01a00;                 \                         C:\fw\midicontroller\x011\usbdescript.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         C:\fw\midicontroller\x011\usbdescript.c
                                            * } cfg01                                                                       C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               C:\fw\midicontroller\x011\usbdescript.c
                                            * specification requirement. All endpoints belonging to an interface            C:\fw\midicontroller\x011\usbdescript.c
                                            * should be listed immediately after that interface.                            C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x011\usbdescript.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        C:\fw\midicontroller\x011\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x011\usbdescript.c
                                            * Most items should be self-explanatory, however, a few will be                 C:\fw\midicontroller\x011\usbdescript.c
                                            * explained for clarification.                                                  C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       C:\fw\midicontroller\x011\usbdescript.c
                                            * The configuration attribute must always have the _DEFAULT                     C:\fw\midicontroller\x011\usbdescript.c
                                            * definition at the minimum. Additional options can be ORed                     C:\fw\midicontroller\x011\usbdescript.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              C:\fw\midicontroller\x011\usbdescript.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              C:\fw\midicontroller\x011\usbdescript.c
                                            * _SELF tells the USB host that this device is self-powered. The                C:\fw\midicontroller\x011\usbdescript.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             C:\fw\midicontroller\x011\usbdescript.c
                                            * Assume the following example:                                                 C:\fw\midicontroller\x011\usbdescript.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * The first two parameters are self-explanatory. They specify the               C:\fw\midicontroller\x011\usbdescript.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               C:\fw\midicontroller\x011\usbdescript.c
                                            * The next parameter identifies the endpoint, the definitions are               C:\fw\midicontroller\x011\usbdescript.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     C:\fw\midicontroller\x011\usbdescript.c
                                            * convention:                                                                   C:\fw\midicontroller\x011\usbdescript.c
                                            * _EP<##>_<dir>                                                                 C:\fw\midicontroller\x011\usbdescript.c
                                            * where ## is the endpoint number and dir is the direction of                   C:\fw\midicontroller\x011\usbdescript.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      C:\fw\midicontroller\x011\usbdescript.c
                                            * The next parameter identifies the type of the endpoint. Available             C:\fw\midicontroller\x011\usbdescript.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    C:\fw\midicontroller\x011\usbdescript.c
                                            * typically used because the default control transfer endpoint is               C:\fw\midicontroller\x011\usbdescript.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 C:\fw\midicontroller\x011\usbdescript.c
                                            * addition options can be ORed to _ISO. Example:                                C:\fw\midicontroller\x011\usbdescript.c
                                            * _ISO|_AD|_FE                                                                  C:\fw\midicontroller\x011\usbdescript.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              C:\fw\midicontroller\x011\usbdescript.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    C:\fw\midicontroller\x011\usbdescript.c
                                            * specification for details. The next parameter defines the size of             C:\fw\midicontroller\x011\usbdescript.c
                                            * the endpoint. The last parameter in the polling interval.                     C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x011\usbdescript.c
                                            * Adding a USB String                                                           C:\fw\midicontroller\x011\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x011\usbdescript.c
                                            * A string descriptor array should have the following format:                   C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              C:\fw\midicontroller\x011\usbdescript.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * The above structure provides a means for the C compiler to                    C:\fw\midicontroller\x011\usbdescript.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             C:\fw\midicontroller\x011\usbdescript.c
                                            * index number. The first two bytes of the descriptor are descriptor            C:\fw\midicontroller\x011\usbdescript.c
                                            * length and type. The rest <text> are string texts which must be               C:\fw\midicontroller\x011\usbdescript.c
                                            * in the unicode format. The unicode format is achieved by declaring            C:\fw\midicontroller\x011\usbdescript.c
                                            * each character as a word type. The whole text string is declared              C:\fw\midicontroller\x011\usbdescript.c
                                            * as a word array with the number of characters equals to <size>.               C:\fw\midicontroller\x011\usbdescript.c
                                            * <size> has to be manually counted and entered into the array                  C:\fw\midicontroller\x011\usbdescript.c
                                            * declaration. Let's study this through an example:                             C:\fw\midicontroller\x011\usbdescript.c
                                            * if the string is "USB" , then the string descriptor should be:                C:\fw\midicontroller\x011\usbdescript.c
                                            * (Using index 02)                                                              C:\fw\midicontroller\x011\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 C:\fw\midicontroller\x011\usbdescript.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * A USB project may have multiple strings and the firmware supports             C:\fw\midicontroller\x011\usbdescript.c
                                            * the management of multiple strings through a look-up table.                   C:\fw\midicontroller\x011\usbdescript.c
                                            * The look-up table is defined as:                                              C:\fw\midicontroller\x011\usbdescript.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 C:\fw\midicontroller\x011\usbdescript.c
                                            * Strings can be removed or added. sd000 is a specialized string                C:\fw\midicontroller\x011\usbdescript.c
                                            * descriptor. It defines the language code, usually this is                     C:\fw\midicontroller\x011\usbdescript.c
                                            * US English (0x0409). The index of the string must match the index             C:\fw\midicontroller\x011\usbdescript.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  C:\fw\midicontroller\x011\usbdescript.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            C:\fw\midicontroller\x011\usbdescript.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                C:\fw\midicontroller\x011\usbdescript.c
                                            * function in usb9.c.                                                           C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * -------------------------------------------------------------------           C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * The look-up table scheme also applies to the configuration                    C:\fw\midicontroller\x011\usbdescript.c
                                            * descriptor. A USB device may have multiple configuration                      C:\fw\midicontroller\x011\usbdescript.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   C:\fw\midicontroller\x011\usbdescript.c
                                            * descriptor, user must implement a structure similar to CFG01.                 C:\fw\midicontroller\x011\usbdescript.c
                                            * The next step is to add the configuration descriptor name, i.e.               C:\fw\midicontroller\x011\usbdescript.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               C:\fw\midicontroller\x011\usbdescript.c
                                            * is a dummy place holder since configuration 0 is the un-configured            C:\fw\midicontroller\x011\usbdescript.c
                                            * state according to the definition in the USB specification.                   C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /*********************************************************************           C:\fw\midicontroller\x011\usbdescript.c
                                            * Descriptor specific type definitions are defined in:                          C:\fw\midicontroller\x011\usbdescript.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          C:\fw\midicontroller\x011\usbdescript.c
                                            *                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                            * Configuration information is defined in:                                      C:\fw\midicontroller\x011\usbdescript.c
                                            * autofiles\usbcfg.h                                                            C:\fw\midicontroller\x011\usbdescript.c
                                            ********************************************************************/           C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           #define POLLING_INTERVAL	40                                                      C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /** I N C L U D E S *************************************************/           C:\fw\midicontroller\x011\usbdescript.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /** C O N S T A N T S ************************************************/          C:\fw\midicontroller\x011\usbdescript.c
                                           #pragma romdata                                                                  C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /* Device Descriptor */                                                          C:\fw\midicontroller\x011\usbdescript.c
                                           rom USB_DEV_DSC device_dsc=                                                      C:\fw\midicontroller\x011\usbdescript.c
                                           {                                                                                C:\fw\midicontroller\x011\usbdescript.c
                                               0x12,     	// bLength                                                        C:\fw\midicontroller\x011\usbdescript.c
                                               0x01,     	// bDescriptorType                                                C:\fw\midicontroller\x011\usbdescript.c
                                               0x0110,    	// bcdUSB (spec release #)                                       C:\fw\midicontroller\x011\usbdescript.c
                                               0x00,     	// bDeviceClass                                                   C:\fw\midicontroller\x011\usbdescript.c
                                               0x00,     	// bDeviceSubClass                                                C:\fw\midicontroller\x011\usbdescript.c
                                               0x00,     	// bDeviceProtocol                                                C:\fw\midicontroller\x011\usbdescript.c
                                               0x08,     	// bMaxPacketSize0                                                C:\fw\midicontroller\x011\usbdescript.c
                                               0x09AE,     // idVendor                                                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x4430,		// idProduct                                                        C:\fw\midicontroller\x011\usbdescript.c
                                               0x0010,    	// bcdDevice : Project version = 0.10                            C:\fw\midicontroller\x011\usbdescript.c
                                               INDEX_MANUFACTURER,	// Index of string Descriptor describing manufacturer      C:\fw\midicontroller\x011\usbdescript.c
                                               INDEX_NAME,			// Index of string Descriptor describing product               C:\fw\midicontroller\x011\usbdescript.c
                                               INDEX_SERIALNUM,	// Index of string Descriptor describing the device's serial number C:\fw\midicontroller\x011\usbdescript.c
                                               0x01				// bNumConfigurations : renaud 1 configuration                       C:\fw\midicontroller\x011\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /* Configuration 1 Descriptor */                                                 C:\fw\midicontroller\x011\usbdescript.c
                                           CFG01={                                                                          C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09,		// bLength: Configuration Descriptor size                                C:\fw\midicontroller\x011\usbdescript.c
                                           	0x02,		// bDescriptorType: Configuration                                        C:\fw\midicontroller\x011\usbdescript.c
                                           	P1_CONFDESC_LEN,	//(word) Length of configuration descriptor. **Renaud : To update C:\fw\midicontroller\x011\usbdescript.c
                                           	0x01,		// bNumInterfaces: 1 interface.                                          C:\fw\midicontroller\x011\usbdescript.c
                                           	0x01,		// bConfigurationValue: Configuration value = 1                          C:\fw\midicontroller\x011\usbdescript.c
                                           	0,			// iConfiguration: Index of string descriptor describing the configuration (None) C:\fw\midicontroller\x011\usbdescript.c
                                           //	0x80,		// bmAttributes: Bus powered and NO Remote wakeup                      C:\fw\midicontroller\x011\usbdescript.c
                                           	0xA0,		// bmAttributes: Bus powered and Remote wakeup ** Renaud : changed from 0xE0 C:\fw\midicontroller\x011\usbdescript.c
                                           //	0xC0,		// bmAttributes: Self powered and NO Remote wakeup                     C:\fw\midicontroller\x011\usbdescript.c
                                           //	0xE0,		// bmAttributes: Self powered and Remote wakeup                        C:\fw\midicontroller\x011\usbdescript.c
                                           	0x32,		// MaxPower 50 mA : ** Renaud : MaxPowerself-powered draws 0 mA from the bus.  C:\fw\midicontroller\x011\usbdescript.c
                                           //	0x00,		// 0 mA power consumption.                                             C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           // Interface descriptor (Interface 0 = DemoKit)                                  C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09,		// bLength: Interface Descriptor size                                    C:\fw\midicontroller\x011\usbdescript.c
                                           	0x04,		// bDescriptorType: Interface descriptor type  ** Renaud : to check      C:\fw\midicontroller\x011\usbdescript.c
                                           	0x00,		// bInterfaceNumber: Interface Number = 0                                C:\fw\midicontroller\x011\usbdescript.c
                                           	0x00,		// bAlternateSetting: No Alternate setting                               C:\fw\midicontroller\x011\usbdescript.c
                                           	0x01,		// bNumEndpoints:                                                        C:\fw\midicontroller\x011\usbdescript.c
                                           	0x03,		// bInterfaceClass: HID                                                  C:\fw\midicontroller\x011\usbdescript.c
                                           	0x00,		// bInterfaceSubClass:                                                   C:\fw\midicontroller\x011\usbdescript.c
                                           	0x00,		// bInterfaceProtocol: ** Renaud : changed from 2 (protocol - mouse in tripplite descriptor) to 0 : no protocol  C:\fw\midicontroller\x011\usbdescript.c
                                           	0x00,		// iInterface: Index of string descriptor (No string value)              C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           // HID descriptor (Demokit)                                                      C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09,		// bLength: HID Descriptor size                                          C:\fw\midicontroller\x011\usbdescript.c
                                           	0x21,		// bDescriptorType: HID                                                  C:\fw\midicontroller\x011\usbdescript.c
                                           	0x0110,		// (word) bcdHID: HID Class Spec release number (1.10) ** Renaud : I let rev 1.10, but Tripplite has HID class release number (1.00) C:\fw\midicontroller\x011\usbdescript.c
                                           	0x00,		// bCountryCode: Hardware target country US ** Renaud changed from 0x21 (US) to 0x00 (none specified) C:\fw\midicontroller\x011\usbdescript.c
                                           	0x01,		// bNumDescriptors: Number of HID class descriptors to follow            C:\fw\midicontroller\x011\usbdescript.c
                                           	0x22,		// bDescriptorType: Report                                               C:\fw\midicontroller\x011\usbdescript.c
                                           	HID_RPT_UPS_SIZE,	// (word) Length of report descriptor interface 0 (2 bytes) ** Renaud : To update C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           // Endpoint 1 descriptor (Demokit)                                               C:\fw\midicontroller\x011\usbdescript.c
                                           	0x07,		// bLength: Endpoint Descriptor size                                     C:\fw\midicontroller\x011\usbdescript.c
                                           	0x05,		// bDescriptorType: Endpoint descriptor type   ** Renaud : To check      C:\fw\midicontroller\x011\usbdescript.c
                                           	0x81,		// bEndpointAddress: Endpoint  1 IN                                      C:\fw\midicontroller\x011\usbdescript.c
                                           	0x03,		// bmAttributes: Interrupt endpoint                                      C:\fw\midicontroller\x011\usbdescript.c
                                           	0x0008,		// wMaxPacketSize(LSB):                                                C:\fw\midicontroller\x011\usbdescript.c
                                           	POLLING_INTERVAL       // bInterval: Polling Interval (40 ms = 0x28)            C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //    sizeof(USB_EP_DSC),DSC_EP,_EP01_IN,_INT,HID_INT_IN_EP_SIZE,POLLING_INTERVAL C:\fw\midicontroller\x011\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //    sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_INT,HID_INT_OUT_EP_SIZE,POLLING_INTERVAL, C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //2/8/05 JD language selection I think..                                         C:\fw\midicontroller\x011\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    C:\fw\midicontroller\x011\usbdescript.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //Manufacturer string                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[11];}MfrString={               C:\fw\midicontroller\x011\usbdescript.c
                                           sizeof(MfrString),DSC_STR,                                                       C:\fw\midicontroller\x011\usbdescript.c
                                           'J','o','e'};                                                                    C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //Product String                                                                 C:\fw\midicontroller\x011\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[21];}PrdString={               C:\fw\midicontroller\x011\usbdescript.c
                                           sizeof(PrdString),DSC_STR,                                                       C:\fw\midicontroller\x011\usbdescript.c
                                           'M','I','D','I',' ','D','e','v','i','c','e',' '};                                C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //Serial Number                                                                  C:\fw\midicontroller\x011\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[16];}SerialNum={               C:\fw\midicontroller\x011\usbdescript.c
                                           sizeof(SerialNum),DSC_STR,                                                       C:\fw\midicontroller\x011\usbdescript.c
                                           '6','9','1','2','0','6','0','B',' '};                                            C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //the reason for this structure is so that sizeof() returns a value.             C:\fw\midicontroller\x011\usbdescript.c
                                           rom struct{byte report[HID_RPT_UPS_SIZE];}hid_rpt_UPS={                          C:\fw\midicontroller\x011\usbdescript.c
                                           //Production test information                                                    C:\fw\midicontroller\x011\usbdescript.c
                                               0x06, 0xff, 0xff,              //     USAGE_PAGE (Vendor Defined Page 0xffff) C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09,  0x01,               		// USAGE (Vendor Usage 1)                          C:\fw\midicontroller\x011\usbdescript.c
                                           	0xa1,  0x01,              	  // COLLECTION (Application)                        C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x95, 0x01,                    //       REPORT_COUNT (1)                     C:\fw\midicontroller\x011\usbdescript.c
                                               0x26, 0xff, 0x00,              //       LOGICAL_MAXIMUM (255)                C:\fw\midicontroller\x011\usbdescript.c
                                               0x15, 0x00,                    //       LOGICAL_MINIMUM (0)                  C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //NVR Operations                                                                 C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x96,                    //       REPORT_ID (150)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xC0,                    //       USAGE (***NVR Read/Write Data)       C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0xB4,                    //       REPORT_ID (180)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xD2,                    //       USAGE (***NVR Page Read/Write Data)  C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x97,                    //       REPORT_ID (151)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xC1,                    //       USAGE (***NVR Address 16bit)         C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //RAM Operations                                                                 C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x98,                    //       REPORT_ID (152)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xC2,                    //       USAGE (***RAM Read/Write Data)       C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x99,                    //       REPORT_ID (153)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xC3,                    //       USAGE (***RAM Address 16bit)         C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //ROM Operations                                                                 C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x9C,                    //       REPORT_ID (156)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xD4,                    //       USAGE (***ROM Read/Write Data)       C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x9D,                    //       REPORT_ID (157)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xD5,                    //       USAGE (***ROM Address 16bit)         C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //Production test protocol #                                                     C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x9B,                    //       REPORT_ID (155)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xC5,                    //       USAGE (***Production Test Protocol #) C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              C:\fw\midicontroller\x011\usbdescript.c
                                           	0x81, 0xa2,					   //	 	INPUT (Data,Var,Abs, Vol, NPrf)                         C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x76, 0x00, 0x02,              //       REPORT_SIZE (512)                    C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0xB0,                    //       REPORT_ID (176)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xEA,                    //       USAGE (***Voltage Data Bulk)         C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //Firmware Partnumber                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           	0x75, 0x20,						//	   REPORT_SIZE (32)                                         C:\fw\midicontroller\x011\usbdescript.c
                                           	0x85, 0xC2,						//	   REPORT_ID (194)                                          C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09, 0xD6,						//	   USAGE (***Firmware Partnumber 32bit)                     C:\fw\midicontroller\x011\usbdescript.c
                                           	0xb1, 0x02,						//	   FEATURE (Data,Var,Abs)                                   C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //Production test password = 866E1942                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0x85, 0x9A,                    //       REPORT_ID (154)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x09, 0xC4,                    //       USAGE (***Production test Password - 32bit) C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //The input report		                                                             C:\fw\midicontroller\x011\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      C:\fw\midicontroller\x011\usbdescript.c
                                               0x95, 63,                    //       REPORT_COUNT (63)                      C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           	0x85, 44,					// REPORT_ID 44                                                   C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09, 0x04,					// usage - vendor defined                                       C:\fw\midicontroller\x011\usbdescript.c
                                           //	0x81, 0x02,					// Input (Data, Variable, Absolute)                           C:\fw\midicontroller\x011\usbdescript.c
                                           	0x09, 0x04,					// usage - vendor defined                                       C:\fw\midicontroller\x011\usbdescript.c
                                               0xb1, 0x02,                 //       FEATURE (Data,Var,Abs)                  C:\fw\midicontroller\x011\usbdescript.c
                                           		                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                           //The output report		                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           //	0x09, 0x06,					// usage - vendor defined                                     C:\fw\midicontroller\x011\usbdescript.c
                                           //	0x91, 0x02,					// Output (Data, Variable, Absolute)                          C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                               0xc0                          //     END_COLLECTION                          C:\fw\midicontroller\x011\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                           //** Renaud : end_ReportDescriptor                                               C:\fw\midicontroller\x011\usbdescript.c
                                           	                                                                                C:\fw\midicontroller\x011\usbdescript.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       C:\fw\midicontroller\x011\usbdescript.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&MfrString,&PrdString,&SerialNum}; C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           rom pFunc ClassReqHandler[1]=                                                    C:\fw\midicontroller\x011\usbdescript.c
                                           {                                                                                C:\fw\midicontroller\x011\usbdescript.c
                                               &USBCheckHIDRequest                                                          C:\fw\midicontroller\x011\usbdescript.c
                                           };                                                                               C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\usbdescript.c
                                                                                                                            C:\fw\midicontroller\x011\usbdescript.c
                                           /** EOF usbdsc.c ****************************************************/           C:\fw\midicontroller\x011\usbdescript.c
                                           //############################################################################### C:\fw\midicontroller\x011\rs232.c
                                           //#										       						       		#                                             C:\fw\midicontroller\x011\rs232.c
                                           //#			Author: Joe Dunne											 		#                                           C:\fw\midicontroller\x011\rs232.c
                                           //#			RS232 Communication ROUTINE											#                                    C:\fw\midicontroller\x011\rs232.c
                                           //#			File Name: RXCOMM.ASM												#                                         C:\fw\midicontroller\x011\rs232.c
                                           //#																				#                                                         C:\fw\midicontroller\x011\rs232.c
                                           //#			Updated 2/02/05 by JD												#                                         C:\fw\midicontroller\x011\rs232.c
                                           //#									      	       	       	       	       		#                            C:\fw\midicontroller\x011\rs232.c
                                           //############################################################################### C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           #include	"c_system.h"                                                            C:\fw\midicontroller\x011\rs232.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\rs232.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           #define	FW_REV						0x10                                                         C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           #define	UPS_TYPE					(2|FW_REV)                                                  C:\fw\midicontroller\x011\rs232.c
                                           #define	INVALID_REQUEST				0xff                                                  C:\fw\midicontroller\x011\rs232.c
                                           #define	PRODUCTION_TEST_PROTOCOL	0x0003                                          C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[];}SerialNum;           C:\fw\midicontroller\x011\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[24];}MfrString;         C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           void	RemCapCalculation(void);                                                    C:\fw\midicontroller\x011\rs232.c
                                           void	EE_READ(void);                                                              C:\fw\midicontroller\x011\rs232.c
                                           void	D_DIV(void);                                                                C:\fw\midicontroller\x011\rs232.c
                                           void	SQRT_16BIT(void);		//result is stored in RES0.                              C:\fw\midicontroller\x011\rs232.c
                                           void	HIDGetReportHandler(void);                                                  C:\fw\midicontroller\x011\rs232.c
                                           unsigned char	READ_SYSTEM_NVR(void);                                             C:\fw\midicontroller\x011\rs232.c
                                           void	EE_PAGE_WRITE(void);                                                        C:\fw\midicontroller\x011\rs232.c
                                           void	BOOT_LOAD_MODE(void);                                                       C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           //--------------------------------------------------------------                 C:\fw\midicontroller\x011\rs232.c
                                           //						Handle received query                                                    C:\fw\midicontroller\x011\rs232.c
                                           //--------------------------------------------------------------                 C:\fw\midicontroller\x011\rs232.c
002bdc   cfd9     MOVFF     0xfd9,0xfe6    void	PROCESS_COMM_REQUEST(void) {                                                C:\fw\midicontroller\x011\rs232.c
002bde   ffe6                                                                                                               
002be0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002be2   ffd9                                                                                                               
002be4   0e11     MOVLW     0x11                                                                                            
002be6   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char *RcvPtr;                                                          C:\fw\midicontroller\x011\rs232.c
                                           	unsigned char tempvar1, tempvar0;                                               C:\fw\midicontroller\x011\rs232.c
                                           	far unsigned char *Data;                                                        C:\fw\midicontroller\x011\rs232.c
                                           	BitField ByteToSend;                                                            C:\fw\midicontroller\x011\rs232.c
                                           	TwoBytes tempreg, tempnum0, value;                                              C:\fw\midicontroller\x011\rs232.c
                                           	FourBytes longreg;                                                              C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
002be8   0100     MOVLB     0x0            	ResponseType = 0xFF;		//no response                                             C:\fw\midicontroller\x011\rs232.c
002bea   69b1     SETF      0xb1,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           	//USB query                                                                     C:\fw\midicontroller\x011\rs232.c
002bec   0100     MOVLB     0x0            	USBDataPointer = 1;		//the 0th byte is the reportid                             C:\fw\midicontroller\x011\rs232.c
002bee   0e01     MOVLW     0x1                                                                                             
002bf0   6f70     MOVWF     0x70,0x1                                                                                        
002bf2   0e72     MOVLW     0x72           	RcvPtr = (unsigned char *)&USBEP0DataInBuffer[1];                               C:\fw\midicontroller\x011\rs232.c
002bf4   6ede     MOVWF     0xde,0x0                                                                                        
002bf6   0e00     MOVLW     0x0                                                                                             
002bf8   6edd     MOVWF     0xdd,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           //Polling command:                                                               C:\fw\midicontroller\x011\rs232.c
002bfa   0104     MOVLB     0x4            	if (SetupPkt.bRequest == GET_REPORT) {                                          C:\fw\midicontroller\x011\rs232.c
002bfc   0511     DECF      0x11,0x0,0x1                                                                                    
002bfe   e001     BZ        0x2c02                                                                                          
002c00   d0a2     BRA       0x2d46                                                                                          
002c02   5112     MOVF      0x12,0x0,0x1   		switch (SetupPkt._byte[2]) {                                                   C:\fw\midicontroller\x011\rs232.c
002c04   0ab4     XORLW     0xb4                                                                                            
002c06   e101     BNZ       0x2c0a                                                                                          
002c08   d085     BRA       0x2d14                                                                                          
002c0a   0a2f     XORLW     0x2f                                                                                            
002c0c   e101     BNZ       0x2c10                                                                                          
002c0e   d077     BRA       0x2cfe                                                                                          
002c10   0a06     XORLW     0x6                                                                                             
002c12   e069     BZ        0x2ce6                                                                                          
002c14   0a01     XORLW     0x1                                                                                             
002c16   e05a     BZ        0x2ccc                                                                                          
002c18   0a05     XORLW     0x5                                                                                             
002c1a   e04c     BZ        0x2cb4                                                                                          
002c1c   0a01     XORLW     0x1                                                                                             
002c1e   e036     BZ        0x2c8c                                                                                          
002c20   0a0f     XORLW     0xf                                                                                             
002c22   e028     BZ        0x2c74                                                                                          
002c24   0a01     XORLW     0x1                                                                                             
002c26   e01b     BZ        0x2c5e                                                                                          
002c28   0aba     XORLW     0xba                                                                                            
002c2a   e013     BZ        0x2c52                                                                                          
002c2c   0a83     XORLW     0x83                                                                                            
002c2e   e001     BZ        0x2c32                                                                                          
002c30   d089     BRA       0x2d44                                                                                          
                                           			                                                                              C:\fw\midicontroller\x011\rs232.c
                                           		case 175:		//voltage data                                                      C:\fw\midicontroller\x011\rs232.c
002c32   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002c34   0e05     MOVLW     0x5                                                                                             
002c36   6fb1     MOVWF     0xb1,0x1                                                                                        
002c38   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x011\rs232.c
002c3a   d932     RCALL     0x2ea0                                                                                          
002c3c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c3e   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x011\rs232.c
002c40   d92f     RCALL     0x2ea0                                                                                          
002c42   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c44   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x011\rs232.c
002c46   d92c     RCALL     0x2ea0                                                                                          
002c48   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c4a   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     C:\fw\midicontroller\x011\rs232.c
002c4c   d929     RCALL     0x2ea0                                                                                          
002c4e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c50   d07a     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           		case 44:		//generic data transfer device to host                               C:\fw\midicontroller\x011\rs232.c
002c52   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002c54   0e05     MOVLW     0x5                                                                                             
002c56   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           			                                                                              C:\fw\midicontroller\x011\rs232.c
002c58   ece1     CALL      0x31c2,0x0     			ProcessGenericTransferd2h();                                                  C:\fw\midicontroller\x011\rs232.c
002c5a   f018                                                                                                               
002c5c   d074     BRA       0x2d46         			break;	                                                                       C:\fw\midicontroller\x011\rs232.c
                                           			                                                                              C:\fw\midicontroller\x011\rs232.c
                                           //production test commands:			                                                   C:\fw\midicontroller\x011\rs232.c
                                           		case 150:		//NVR Read                                                          C:\fw\midicontroller\x011\rs232.c
002c5e   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002c60   0e05     MOVLW     0x5                                                                                             
002c62   6fb1     MOVWF     0xb1,0x1                                                                                        
002c64   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x011\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        C:\fw\midicontroller\x011\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x011\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();		//returns data through wreg                    C:\fw\midicontroller\x011\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x011\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x011\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x011\rs232.c
002c66   d005     BRA       0x2c72         			else {                                                                        C:\fw\midicontroller\x011\rs232.c
002c68   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x011\rs232.c
002c6a   6fb1     MOVWF     0xb1,0x1                                                                                        
002c6c   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x011\rs232.c
002c6e   d918     RCALL     0x2ea0                                                                                          
002c70   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\rs232.c
002c72   d069     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           			                                                                              C:\fw\midicontroller\x011\rs232.c
                                           		case 151:		//NVR Address                                                       C:\fw\midicontroller\x011\rs232.c
002c74   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002c76   0e05     MOVLW     0x5                                                                                             
002c78   6fb1     MOVWF     0xb1,0x1                                                                                        
002c7a   c0b2     MOVFF     0xb2,0xfe6     			TXENQ(NVRCommAddr.b_form.low);		//low byte                                    C:\fw\midicontroller\x011\rs232.c
002c7c   ffe6                                                                                                               
002c7e   d910     RCALL     0x2ea0                                                                                          
002c80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c82   c0b3     MOVFF     0xb3,0xfe6     			TXENQ(NVRCommAddr.b_form.high);		//high byte                                  C:\fw\midicontroller\x011\rs232.c
002c84   ffe6                                                                                                               
002c86   d90c     RCALL     0x2ea0                                                                                          
002c88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c8a   d05d     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		case 152:		//RAM Read                                                          C:\fw\midicontroller\x011\rs232.c
002c8c   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002c8e   0e05     MOVLW     0x5                                                                                             
002c90   6fb1     MOVWF     0xb1,0x1                                                                                        
002c92   0e04     MOVLW     0x4            			Data = (far unsigned char *)RAMCommAddr.s_form;                               C:\fw\midicontroller\x011\rs232.c
002c94   c0b4     MOVFF     0xb4,0xfdb                                                                                      
002c96   ffdb                                                                                                               
002c98   0e05     MOVLW     0x5                                                                                             
002c9a   c0b5     MOVFF     0xb5,0xfdb                                                                                      
002c9c   ffdb                                                                                                               
002c9e   0e04     MOVLW     0x4            			TXENQ(*Data);                                                                 C:\fw\midicontroller\x011\rs232.c
002ca0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002ca2   ffe9                                                                                                               
002ca4   0e05     MOVLW     0x5                                                                                             
002ca6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002ca8   ffea                                                                                                               
002caa   50ef     MOVF      0xef,0x0,0x0                                                                                    
002cac   6ee6     MOVWF     0xe6,0x0                                                                                        
002cae   d8f8     RCALL     0x2ea0                                                                                          
002cb0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002cb2   d049     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           		case 153:		//RAM Address                                                       C:\fw\midicontroller\x011\rs232.c
002cb4   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002cb6   0e05     MOVLW     0x5                                                                                             
002cb8   6fb1     MOVWF     0xb1,0x1                                                                                        
002cba   c0b4     MOVFF     0xb4,0xfe6     			TXENQ(RAMCommAddr.b_form.low);		//low byte                                    C:\fw\midicontroller\x011\rs232.c
002cbc   ffe6                                                                                                               
002cbe   d8f0     RCALL     0x2ea0                                                                                          
002cc0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002cc2   c0b5     MOVFF     0xb5,0xfe6     			TXENQ(RAMCommAddr.b_form.high);		//high byte                                  C:\fw\midicontroller\x011\rs232.c
002cc4   ffe6                                                                                                               
002cc6   d8ec     RCALL     0x2ea0                                                                                          
002cc8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
002cca   d03d     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           		case 156:		//ROM Read                                                          C:\fw\midicontroller\x011\rs232.c
002ccc   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002cce   0e05     MOVLW     0x5                                                                                             
002cd0   6fb1     MOVWF     0xb1,0x1                                                                                        
002cd2   c0b6     MOVFF     0xb6,0xff6     			TXENQ(*(near unsigned char rom *)ROMCommAddr.s_form);                         C:\fw\midicontroller\x011\rs232.c
002cd4   fff6                                                                                                               
002cd6   c0b7     MOVFF     0xb7,0xff7                                                                                      
002cd8   fff7                                                                                                               
002cda   0008     TBLRD                                                                                                     
002cdc   50f5     MOVF      0xf5,0x0,0x0                                                                                    
002cde   6ee6     MOVWF     0xe6,0x0                                                                                        
002ce0   d8df     RCALL     0x2ea0                                                                                          
002ce2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ce4   d030     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           		case 157:		//ROM Address                                                       C:\fw\midicontroller\x011\rs232.c
002ce6   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002ce8   0e05     MOVLW     0x5                                                                                             
002cea   6fb1     MOVWF     0xb1,0x1                                                                                        
002cec   c0b6     MOVFF     0xb6,0xfe6     			TXENQ(ROMCommAddr.b_form.low);		//low byte                                    C:\fw\midicontroller\x011\rs232.c
002cee   ffe6                                                                                                               
002cf0   d8d7     RCALL     0x2ea0                                                                                          
002cf2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002cf4   c0b7     MOVFF     0xb7,0xfe6     			TXENQ(ROMCommAddr.b_form.high);		//high byte                                  C:\fw\midicontroller\x011\rs232.c
002cf6   ffe6                                                                                                               
002cf8   d8d3     RCALL     0x2ea0                                                                                          
002cfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002cfc   d024     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           		case 155:		//production test protocol                                          C:\fw\midicontroller\x011\rs232.c
002cfe   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002d00   0e05     MOVLW     0x5                                                                                             
002d02   6fb1     MOVWF     0xb1,0x1                                                                                        
002d04   0e03     MOVLW     0x3            			TXENQ(PRODUCTION_TEST_PROTOCOL&255);                                          C:\fw\midicontroller\x011\rs232.c
002d06   6ee6     MOVWF     0xe6,0x0                                                                                        
002d08   d8cb     RCALL     0x2ea0                                                                                          
002d0a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d0c   6ae6     CLRF      0xe6,0x0       			TXENQ(PRODUCTION_TEST_PROTOCOL>>8);                                           C:\fw\midicontroller\x011\rs232.c
002d0e   d8c8     RCALL     0x2ea0                                                                                          
002d10   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d12   d019     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           		case 180:		//NVR Page Read                                                     C:\fw\midicontroller\x011\rs232.c
002d14   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 C:\fw\midicontroller\x011\rs232.c
002d16   0e05     MOVLW     0x5                                                                                             
002d18   6fb1     MOVWF     0xb1,0x1                                                                                        
002d1a   b8a0     BTFSC     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x011\rs232.c
002d1c   d004     BRA       0x2d26                                                                                          
002d1e   9ef2     BCF       0xf2,0x7,0x0   				DISABLE_ALL_INTERRUPTS();                                                    C:\fw\midicontroller\x011\rs232.c
002d20   9cf2     BCF       0xf2,0x6,0x0                                                                                    
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        C:\fw\midicontroller\x011\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x011\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x011\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x011\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x011\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x011\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x011\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x011\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x011\rs232.c
                                           //				EEAddress++;                                                               C:\fw\midicontroller\x011\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 C:\fw\midicontroller\x011\rs232.c
                                           //				TXENQ(Temp6);                                                              C:\fw\midicontroller\x011\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x011\rs232.c
002d22   d011     BRA       0x2d46         				break;                                                                       C:\fw\midicontroller\x011\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x011\rs232.c
002d24   d00f     BRA       0x2d44         			else {                                                                        C:\fw\midicontroller\x011\rs232.c
002d26   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             C:\fw\midicontroller\x011\rs232.c
002d28   6fb1     MOVWF     0xb1,0x1                                                                                        
002d2a   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x011\rs232.c
002d2c   d8b9     RCALL     0x2ea0                                                                                          
002d2e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d30   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x011\rs232.c
002d32   d8b6     RCALL     0x2ea0                                                                                          
002d34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d36   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x011\rs232.c
002d38   d8b3     RCALL     0x2ea0                                                                                          
002d3a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d3c   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      C:\fw\midicontroller\x011\rs232.c
002d3e   d8b0     RCALL     0x2ea0                                                                                          
002d40   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d42   d001     BRA       0x2d46         				break;                                                                       C:\fw\midicontroller\x011\rs232.c
                                           			}				                                                                         C:\fw\midicontroller\x011\rs232.c
                                           		default:                                                                       C:\fw\midicontroller\x011\rs232.c
002d44   d000     BRA       0x2d46         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		}                                                                              C:\fw\midicontroller\x011\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           //Set command:                                                                   C:\fw\midicontroller\x011\rs232.c
002d46   0e09     MOVLW     0x9            	if (SetupPkt.bRequest == SET_REPORT) {                                          C:\fw\midicontroller\x011\rs232.c
002d48   0104     MOVLB     0x4                                                                                             
002d4a   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002d4c   e001     BZ        0x2d50                                                                                          
002d4e   d08c     BRA       0x2e68                                                                                          
002d50   5112     MOVF      0x12,0x0,0x1   		switch (SetupPkt._byte[2]) {                                                   C:\fw\midicontroller\x011\rs232.c
002d52   0ab4     XORLW     0xb4                                                                                            
002d54   e101     BNZ       0x2d58                                                                                          
002d56   d084     BRA       0x2e60                                                                                          
002d58   0a29     XORLW     0x29                                                                                            
002d5a   e06a     BZ        0x2e30                                                                                          
002d5c   0a01     XORLW     0x1                                                                                             
002d5e   e064     BZ        0x2e28                                                                                          
002d60   0a06     XORLW     0x6                                                                                             
002d62   e05e     BZ        0x2e20                                                                                          
002d64   0a03     XORLW     0x3                                                                                             
002d66   e048     BZ        0x2df8                                                                                          
002d68   0a01     XORLW     0x1                                                                                             
002d6a   e038     BZ        0x2ddc                                                                                          
002d6c   0a0f     XORLW     0xf                                                                                             
002d6e   e01e     BZ        0x2dac                                                                                          
002d70   0a01     XORLW     0x1                                                                                             
002d72   e014     BZ        0x2d9c                                                                                          
002d74   0aba     XORLW     0xba                                                                                            
002d76   e001     BZ        0x2d7a                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           		case 44:		//generic data transfer host to device                               C:\fw\midicontroller\x011\rs232.c
002d7a   ec23     CALL      0x3246,0x0     			if (ProcessGenericTransferh2d()) ResponseType = COMMAND_ACCEPTED;             C:\fw\midicontroller\x011\rs232.c
002d7c   f019                                                                                                               
002d7e   cff3     MOVFF     0xff3,0x10                                                                                      
002d80   f010                                                                                                               
002d82   cff4     MOVFF     0xff4,0x11                                                                                      
002d84   f011                                                                                                               
002d86   5010     MOVF      0x10,0x0,0x0                                                                                    
002d88   1011     IORWF     0x11,0x0,0x0                                                                                    
002d8a   e004     BZ        0x2d94                                                                                          
002d8c   0100     MOVLB     0x0                                                                                             
002d8e   0e02     MOVLW     0x2                                                                                             
002d90   6fb1     MOVWF     0xb1,0x1                                                                                        
002d92   d003     BRA       0x2d9a         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x011\rs232.c
002d94   0100     MOVLB     0x0                                                                                             
002d96   0e01     MOVLW     0x1                                                                                             
002d98   6fb1     MOVWF     0xb1,0x1                                                                                        
002d9a   d066     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           //Production test commands                                                       C:\fw\midicontroller\x011\rs232.c
                                           		case 150:		//NVR Write                                                         C:\fw\midicontroller\x011\rs232.c
002d9c   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002d9e   0e02     MOVLW     0x2                                                                                             
002da0   6fb1     MOVWF     0xb1,0x1                                                                                        
002da2   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    C:\fw\midicontroller\x011\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  C:\fw\midicontroller\x011\rs232.c
                                           //				EECounterB = 1;						//Number of bytes to write.                           C:\fw\midicontroller\x011\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;	//EEPROM register starting address byte. C:\fw\midicontroller\x011\rs232.c
                                           //				EEData = RcvPtr[0];					//First byte of data to write.                     C:\fw\midicontroller\x011\rs232.c
                                           //diag disable ee_page_write                                                     C:\fw\midicontroller\x011\rs232.c
                                           //				EE_PAGE_WRITE();                                                           C:\fw\midicontroller\x011\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   C:\fw\midicontroller\x011\rs232.c
                                           			}                                                                             C:\fw\midicontroller\x011\rs232.c
002da4   d002     BRA       0x2daa         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x011\rs232.c
002da6   0e01     MOVLW     0x1                                                                                             
002da8   6fb1     MOVWF     0xb1,0x1                                                                                        
002daa   d05e     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           			                                                                              C:\fw\midicontroller\x011\rs232.c
                                           		case 151:		//NVR Address                                                       C:\fw\midicontroller\x011\rs232.c
002dac   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002dae   0e02     MOVLW     0x2                                                                                             
002db0   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x011\rs232.c
002db2   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.low = RcvPtr[0];		//low byte                              C:\fw\midicontroller\x011\rs232.c
002db4   ffe9                                                                                                               
002db6   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002db8   ffea                                                                                                               
002dba   cfef     MOVFF     0xfef,0xb2                                                                                      
002dbc   f0b2                                                                                                               
002dbe   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.high = RcvPtr[1];	//high byte                             C:\fw\midicontroller\x011\rs232.c
002dc0   ffe9                                                                                                               
002dc2   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002dc4   ffea                                                                                                               
002dc6   0e01     MOVLW     0x1                                                                                             
002dc8   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002dca   0e00     MOVLW     0x0                                                                                             
002dcc   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002dce   cfef     MOVFF     0xfef,0xb3                                                                                      
002dd0   f0b3                                                                                                               
                                           			}                                                                             C:\fw\midicontroller\x011\rs232.c
002dd2   d003     BRA       0x2dda         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x011\rs232.c
002dd4   0100     MOVLB     0x0                                                                                             
002dd6   0e01     MOVLW     0x1                                                                                             
002dd8   6fb1     MOVWF     0xb1,0x1                                                                                        
002dda   d046     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		case 152:		//RAM Write                                                         C:\fw\midicontroller\x011\rs232.c
002ddc   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002dde   0e02     MOVLW     0x2                                                                                             
002de0   6fb1     MOVWF     0xb1,0x1                                                                                        
002de2   cfde     MOVFF     0xfde,0xfe9    			*(far unsigned char *)RAMCommAddr.s_form = RcvPtr[0];                         C:\fw\midicontroller\x011\rs232.c
002de4   ffe9                                                                                                               
002de6   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002de8   ffea                                                                                                               
002dea   50ef     MOVF      0xef,0x0,0x0                                                                                    
002dec   c0b4     MOVFF     0xb4,0xfe9                                                                                      
002dee   ffe9                                                                                                               
002df0   c0b5     MOVFF     0xb5,0xfea                                                                                      
002df2   ffea                                                                                                               
002df4   6eef     MOVWF     0xef,0x0                                                                                        
002df6   d038     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           		case 153:		//RAM Address                                                       C:\fw\midicontroller\x011\rs232.c
002df8   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002dfa   0e02     MOVLW     0x2                                                                                             
002dfc   6fb1     MOVWF     0xb1,0x1                                                                                        
002dfe   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.low = RcvPtr[0];		//low byte                               C:\fw\midicontroller\x011\rs232.c
002e00   ffe9                                                                                                               
002e02   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002e04   ffea                                                                                                               
002e06   cfef     MOVFF     0xfef,0xb4                                                                                      
002e08   f0b4                                                                                                               
002e0a   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.high = RcvPtr[1];	//high byte                              C:\fw\midicontroller\x011\rs232.c
002e0c   ffe9                                                                                                               
002e0e   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002e10   ffea                                                                                                               
002e12   0e01     MOVLW     0x1                                                                                             
002e14   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002e16   0e00     MOVLW     0x0                                                                                             
002e18   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002e1a   cfef     MOVFF     0xfef,0xb5                                                                                      
002e1c   f0b5                                                                                                               
002e1e   d024     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		case 154:		//Password write (starting with low byte)                           C:\fw\midicontroller\x011\rs232.c
002e20   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002e22   0e02     MOVLW     0x2                                                                                             
002e24   6fb1     MOVWF     0xb1,0x1                                                                                        
002e26   d020     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		case 156:		//ROM Write (not supported)                                         C:\fw\midicontroller\x011\rs232.c
                                           //Writing a single byte is not supported by the chip.                            C:\fw\midicontroller\x011\rs232.c
002e28   0100     MOVLB     0x0            			ResponseType = COMMAND_REJECTED;                                              C:\fw\midicontroller\x011\rs232.c
002e2a   0e01     MOVLW     0x1                                                                                             
002e2c   6fb1     MOVWF     0xb1,0x1                                                                                        
002e2e   d01c     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           		case 157:		//ROM Address                                                       C:\fw\midicontroller\x011\rs232.c
002e30   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002e32   0e02     MOVLW     0x2                                                                                             
002e34   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           			if (1) {                                                                      C:\fw\midicontroller\x011\rs232.c
002e36   cfde     MOVFF     0xfde,0xfe9    				ROMCommAddr.b_form.low = RcvPtr[0];		//low byte                              C:\fw\midicontroller\x011\rs232.c
002e38   ffe9                                                                                                               
002e3a   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002e3c   ffea                                                                                                               
002e3e   cfef     MOVFF     0xfef,0xb6                                                                                      
002e40   f0b6                                                                                                               
002e42   cfde     MOVFF     0xfde,0xfe9    				ROMCommAddr.b_form.high = RcvPtr[1];	//high byte                             C:\fw\midicontroller\x011\rs232.c
002e44   ffe9                                                                                                               
002e46   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002e48   ffea                                                                                                               
002e4a   0e01     MOVLW     0x1                                                                                             
002e4c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002e4e   0e00     MOVLW     0x0                                                                                             
002e50   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002e52   cfef     MOVFF     0xfef,0xb7                                                                                      
002e54   f0b7                                                                                                               
                                           			}                                                                             C:\fw\midicontroller\x011\rs232.c
002e56   d003     BRA       0x2e5e         			else ResponseType = COMMAND_REJECTED;                                         C:\fw\midicontroller\x011\rs232.c
002e58   0100     MOVLB     0x0                                                                                             
002e5a   0e01     MOVLW     0x1                                                                                             
002e5c   6fb1     MOVWF     0xb1,0x1                                                                                        
002e5e   d004     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           		case 180:		//NVR Page Write                                                    C:\fw\midicontroller\x011\rs232.c
002e60   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              C:\fw\midicontroller\x011\rs232.c
002e62   0e02     MOVLW     0x2                                                                                             
002e64   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           //diag.. disable ee_page_write                                                   C:\fw\midicontroller\x011\rs232.c
002e66   d000     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		default:                                                                       C:\fw\midicontroller\x011\rs232.c
002d78   d077     BRA       0x2e68         			break;                                                                        C:\fw\midicontroller\x011\rs232.c
                                           		}                                                                              C:\fw\midicontroller\x011\rs232.c
                                           	}                                                                               C:\fw\midicontroller\x011\rs232.c
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
002e68   0eff     MOVLW     0xff           	if (ResponseType == 0xff) return;                                               C:\fw\midicontroller\x011\rs232.c
002e6a   0100     MOVLB     0x0                                                                                             
002e6c   5db1     SUBWF     0xb1,0x0,0x1                                                                                    
002e6e   e101     BNZ       0x2e72                                                                                          
002e70   d00d     BRA       0x2e8c                                                                                          
                                           //no response or ack?                                                            C:\fw\midicontroller\x011\rs232.c
002e72   0e09     MOVLW     0x9            	if (SetupPkt.bRequest == SET_REPORT) return;		//no response to set_report       C:\fw\midicontroller\x011\rs232.c
002e74   0104     MOVLB     0x4                                                                                             
002e76   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002e78   e101     BNZ       0x2e7c                                                                                          
002e7a   d008     BRA       0x2e8c                                                                                          
                                           	                                                                                C:\fw\midicontroller\x011\rs232.c
                                           //USB query setup data:                                                          C:\fw\midicontroller\x011\rs232.c
002e7c   c412     MOVFF     0x412,0x418    	CtrlTrfData._byte[0] = SetupPkt._byte[2];                                       C:\fw\midicontroller\x011\rs232.c
002e7e   f418                                                                                                               
002e80   0100     MOVLB     0x0            	wCount._word = USBDataPointer;		//Calculate number of bytes to send             C:\fw\midicontroller\x011\rs232.c
002e82   5170     MOVF      0x70,0x0,0x1                                                                                    
002e84   0101     MOVLB     0x1                                                                                             
002e86   6f50     MOVWF     0x50,0x1                                                                                        
002e88   6b51     CLRF      0x51,0x1                                                                                        
002e8a   d000     BRA       0x2e8c         	return;                                                                         C:\fw\midicontroller\x011\rs232.c
002e8c   0e11     MOVLW     0x11           }                                                                                C:\fw\midicontroller\x011\rs232.c
002e8e   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002e90   e202     BC        0x2e96                                                                                          
002e92   6ae1     CLRF      0xe1,0x0                                                                                        
002e94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e96   6ee1     MOVWF     0xe1,0x0                                                                                        
002e98   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e9a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002e9c   ffd9                                                                                                               
002e9e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\rs232.c
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x011\rs232.c
                                           //This routine will store a character into the TxBuffer.                         C:\fw\midicontroller\x011\rs232.c
002ea0   cfd9     MOVFF     0xfd9,0xfe6    void	TXENQ(unsigned char Input) {                                                C:\fw\midicontroller\x011\rs232.c
002ea2   ffe6                                                                                                               
002ea4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002ea6   ffd9                                                                                                               
                                           	//USB Query                                                                     C:\fw\midicontroller\x011\rs232.c
002ea8   0e40     MOVLW     0x40           	if (USBDataPointer >= 64) return;		//Exit if buffer full.                       C:\fw\midicontroller\x011\rs232.c
002eaa   0100     MOVLB     0x0                                                                                             
002eac   5d70     SUBWF     0x70,0x0,0x1                                                                                    
002eae   e301     BNC       0x2eb2                                                                                          
002eb0   d00a     BRA       0x2ec6                                                                                          
002eb2   5170     MOVF      0x70,0x0,0x1   	CtrlTrfData._byte[USBDataPointer] = Input;                                      C:\fw\midicontroller\x011\rs232.c
002eb4   6aea     CLRF      0xea,0x0                                                                                        
002eb6   0f18     ADDLW     0x18                                                                                            
002eb8   6ee9     MOVWF     0xe9,0x0                                                                                        
002eba   0e04     MOVLW     0x4                                                                                             
002ebc   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002ebe   0efe     MOVLW     0xfe                                                                                            
002ec0   cfdb     MOVFF     0xfdb,0xfef                                                                                     
002ec2   ffef                                                                                                               
002ec4   2b70     INCF      0x70,0x1,0x1   	USBDataPointer++;                                                               C:\fw\midicontroller\x011\rs232.c
002ec6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\rs232.c
002ec8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002eca   ffd9                                                                                                               
002ecc   0012     RETURN    0x0                                                                                             
                                           //-----------------------------------------------------------------------        C:\fw\midicontroller\x011\rs232.c
                                           /*********************************************************************           C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            *             Microchip USB C18 Firmware -  HID Version 1.0                     C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            *********************************************************************           C:\fw\midicontroller\x011\hid.c
                                            * FileName:        hid.c                                                        C:\fw\midicontroller\x011\hid.c
                                            * Dependencies:    See INCLUDES section below                                   C:\fw\midicontroller\x011\hid.c
                                            * Processor:       PIC18                                                        C:\fw\midicontroller\x011\hid.c
                                            * Compiler:        C18 2.30.01+                                                 C:\fw\midicontroller\x011\hid.c
                                            * Company:         Microchip Technology, Inc.                                   C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Software License Agreement                                                    C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * The software supplied herewith by Microchip Technology Incorporated           C:\fw\midicontroller\x011\hid.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             C:\fw\midicontroller\x011\hid.c
                                            * supplied to you, the Company’s customer, for use solely and                   C:\fw\midicontroller\x011\hid.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               C:\fw\midicontroller\x011\hid.c
                                            * software is owned by the Company and/or its supplier, and is                  C:\fw\midicontroller\x011\hid.c
                                            * protected under applicable copyright laws. All rights are reserved.           C:\fw\midicontroller\x011\hid.c
                                            * Any use in violation of the foregoing restrictions may subject the            C:\fw\midicontroller\x011\hid.c
                                            * user to criminal sanctions under applicable laws, as well as to               C:\fw\midicontroller\x011\hid.c
                                            * civil liability for the breach of the terms and conditions of this            C:\fw\midicontroller\x011\hid.c
                                            * license.                                                                      C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             C:\fw\midicontroller\x011\hid.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             C:\fw\midicontroller\x011\hid.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   C:\fw\midicontroller\x011\hid.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             C:\fw\midicontroller\x011\hid.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    C:\fw\midicontroller\x011\hid.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Author               Date        Comment                                      C:\fw\midicontroller\x011\hid.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           C:\fw\midicontroller\x011\hid.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    C:\fw\midicontroller\x011\hid.c
                                            ********************************************************************/           C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** I N C L U D E S **********************************************************/  C:\fw\midicontroller\x011\hid.c
                                           #include "p18f4455.h"                                                            C:\fw\midicontroller\x011\hid.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\hid.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\hid.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           #ifdef USB_USE_HID                                                               C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  C:\fw\midicontroller\x011\hid.c
                                           void HIDGetReportHandler(void);                                                  C:\fw\midicontroller\x011\hid.c
                                           void HIDSetReportHandler(void);                                                  C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** V A R I A B L E S ********************************************************/  C:\fw\midicontroller\x011\hid.c
                                           #pragma udata usb5                                                               C:\fw\midicontroller\x011\hid.c
                                           byte idle_rate;                                                                  C:\fw\midicontroller\x011\hid.c
                                           byte active_protocol;               // [0] Boot Protocol [1] Report Protocol     C:\fw\midicontroller\x011\hid.c
                                           byte hid_rpt_rx_len;                                                             C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** D E C L A R A T I O N S **************************************************/  C:\fw\midicontroller\x011\hid.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  C:\fw\midicontroller\x011\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\hid.c
                                            * Function:        void USBCheckHIDRequest(void)                                C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Overview:        This routine checks the setup data packet to see if it       C:\fw\midicontroller\x011\hid.c
                                            *                  knows how to handle it                                       C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\hid.c
                                           void USBCheckHIDRequest(void)                                                    C:\fw\midicontroller\x011\hid.c
                                           {                                                                                C:\fw\midicontroller\x011\hid.c
002ece   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  C:\fw\midicontroller\x011\hid.c
002ed0   5110     MOVF      0x10,0x0,0x1                                                                                    
002ed2   0b1f     ANDLW     0x1f                                                                                            
002ed4   0801     SUBLW     0x1                                                                                             
002ed6   e001     BZ        0x2eda                                                                                          
002ed8   d086     BRA       0x2fe6                                                                                          
002eda   5114     MOVF      0x14,0x0,0x1       if(SetupPkt.bIntfID != HID_INTF_ID) return;                                  C:\fw\midicontroller\x011\hid.c
002edc   e001     BZ        0x2ee0                                                                                          
002ede   d083     BRA       0x2fe6                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                               /*                                                                           C:\fw\midicontroller\x011\hid.c
                                                * There are two standard requests that hid.c may support.                   C:\fw\midicontroller\x011\hid.c
                                                * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\fw\midicontroller\x011\hid.c
                                                * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      C:\fw\midicontroller\x011\hid.c
                                                */                                                                          C:\fw\midicontroller\x011\hid.c
002ee0   0e06     MOVLW     0x6                if(SetupPkt.bRequest == GET_DSC)                                             C:\fw\midicontroller\x011\hid.c
002ee2   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002ee4   e12e     BNZ       0x2f42                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\hid.c
002ee6   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                C:\fw\midicontroller\x011\hid.c
002ee8   0a23     XORLW     0x23                                                                                            
002eea   e028     BZ        0x2f3c                                                                                          
002eec   0a01     XORLW     0x1                                                                                             
002eee   e013     BZ        0x2f16                                                                                          
002ef0   0a03     XORLW     0x3                                                                                             
002ef2   e001     BZ        0x2ef6                                                                                          
002ef4   d024     BRA       0x2f3e                                                                                          
                                                   {                                                                        C:\fw\midicontroller\x011\hid.c
                                                       case DSC_HID:                                                        C:\fw\midicontroller\x011\hid.c
002ef6   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               C:\fw\midicontroller\x011\hid.c
002ef8   0e02     MOVLW     0x2                                                                                             
002efa   6f4b     MOVWF     0x4b,0x1                                                                                        
002efc   0101     MOVLB     0x1                            mUSBGetHIDDscAdr(pSrc.bRom);        // See usbcfg.h              C:\fw\midicontroller\x011\hid.c
002efe   0548     DECF      0x48,0x0,0x1                                                                                    
002f00   e105     BNZ       0x2f0c                                                                                          
002f02   0101     MOVLB     0x1                                                                                             
002f04   0eb4     MOVLW     0xb4                                                                                            
002f06   6f4c     MOVWF     0x4c,0x1                                                                                        
002f08   0e32     MOVLW     0x32                                                                                            
002f0a   6f4d     MOVWF     0x4d,0x1                                                                                        
002f0c   0e09     MOVLW     0x9                            wCount._word = sizeof(USB_HID_DSC);                              C:\fw\midicontroller\x011\hid.c
002f0e   0101     MOVLB     0x1                                                                                             
002f10   6f50     MOVWF     0x50,0x1                                                                                        
002f12   6b51     CLRF      0x51,0x1                                                                                        
002f14   d014     BRA       0x2f3e                         break;                                                           C:\fw\midicontroller\x011\hid.c
                                                       case DSC_RPT:                                                        C:\fw\midicontroller\x011\hid.c
002f16   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               C:\fw\midicontroller\x011\hid.c
002f18   0e02     MOVLW     0x2                                                                                             
002f1a   6f4b     MOVWF     0x4b,0x1                                                                                        
002f1c   0101     MOVLB     0x1                            mUSBGetHIDRptDscAdr(pSrc.bRom);     // See usbcfg.h              C:\fw\midicontroller\x011\hid.c
002f1e   0548     DECF      0x48,0x0,0x1                                                                                    
002f20   e105     BNZ       0x2f2c                                                                                          
002f22   0101     MOVLB     0x1                                                                                             
002f24   0e2e     MOVLW     0x2e                                                                                            
002f26   6f4c     MOVWF     0x4c,0x1                                                                                        
002f28   0e33     MOVLW     0x33                                                                                            
002f2a   6f4d     MOVWF     0x4d,0x1                                                                                        
002f2c   0101     MOVLB     0x1                            mUSBGetHIDRptDscSize(wCount._word); // See usbcfg.h              C:\fw\midicontroller\x011\hid.c
002f2e   0548     DECF      0x48,0x0,0x1                                                                                    
002f30   e104     BNZ       0x2f3a                                                                                          
002f32   0e7c     MOVLW     0x7c                                                                                            
002f34   0101     MOVLB     0x1                                                                                             
002f36   6f50     MOVWF     0x50,0x1                                                                                        
002f38   6b51     CLRF      0x51,0x1                                                                                        
002f3a   d001     BRA       0x2f3e                         break;                                                           C:\fw\midicontroller\x011\hid.c
                                                       case DSC_PHY:                                                        C:\fw\midicontroller\x011\hid.c
                                                           // ctrl_trf_session_owner = MUID_HID;                            C:\fw\midicontroller\x011\hid.c
002f3c   d000     BRA       0x2f3e                         break;                                                           C:\fw\midicontroller\x011\hid.c
                                                   }//end switch(SetupPkt.bDscType)                                         C:\fw\midicontroller\x011\hid.c
002f3e   0101     MOVLB     0x1                    usb_stat.ctrl_trf_mem = _ROM;                                            C:\fw\midicontroller\x011\hid.c
002f40   8347     BSF       0x47,0x1,0x1                                                                                    
                                               }//end if(SetupPkt.bRequest == GET_DSC)                                      C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
002f42   0104     MOVLB     0x4                if(SetupPkt.RequestType != CLASS) return;                                    C:\fw\midicontroller\x011\hid.c
002f44   5110     MOVF      0x10,0x0,0x1                                                                                    
002f46   0b60     ANDLW     0x60                                                                                            
002f48   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002f4a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002f4c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002f4e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002f50   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002f52   0801     SUBLW     0x1                                                                                             
002f54   e001     BZ        0x2f58                                                                                          
002f56   d047     BRA       0x2fe6                                                                                          
002f58   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    C:\fw\midicontroller\x011\hid.c
002f5a   0a0b     XORLW     0xb                                                                                             
002f5c   e03e     BZ        0x2fda                                                                                          
002f5e   0a08     XORLW     0x8                                                                                             
002f60   e02e     BZ        0x2fbe                                                                                          
002f62   0a09     XORLW     0x9                                                                                             
002f64   e026     BZ        0x2fb2                                                                                          
002f66   0a08     XORLW     0x8                                                                                             
002f68   e016     BZ        0x2f96                                                                                          
002f6a   0a0b     XORLW     0xb                                                                                             
002f6c   e006     BZ        0x2f7a                                                                                          
002f6e   0a08     XORLW     0x8                                                                                             
002f70   e001     BZ        0x2f74                                                                                          
002f72   d039     BRA       0x2fe6                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\hid.c
                                                   case GET_REPORT:                                                         C:\fw\midicontroller\x011\hid.c
002f74   ec8b     CALL      0x3116,0x0                 HIDGetReportHandler();                                               C:\fw\midicontroller\x011\hid.c
002f76   f018                                                                                                               
002f78   d036     BRA       0x2fe6                     break;                                                               C:\fw\midicontroller\x011\hid.c
                                                   case SET_REPORT:                                                         C:\fw\midicontroller\x011\hid.c
                                           //            HIDSetReportHandler();      //2/8/05 JD this was not at the right location. C:\fw\midicontroller\x011\hid.c
002f7a   0101     MOVLB     0x1            			pDst.bRam = (byte*)&USBEP0DataInBuffer;	//Set destination for report data.    C:\fw\midicontroller\x011\hid.c
002f7c   0e71     MOVLW     0x71                                                                                            
002f7e   6f4e     MOVWF     0x4e,0x1                                                                                        
002f80   0e00     MOVLW     0x0                                                                                             
002f82   6f4f     MOVWF     0x4f,0x1                                                                                        
002f84   0101     MOVLB     0x1            			usb_stat.ctrl_trf_mem = _RAM;		//Set memory type                              C:\fw\midicontroller\x011\hid.c
002f86   9347     BCF       0x47,0x1,0x1                                                                                    
002f88   0101     MOVLB     0x1            			wCount._word = 0;					//reset counter                                         C:\fw\midicontroller\x011\hid.c
002f8a   6b50     CLRF      0x50,0x1                                                                                        
002f8c   6b51     CLRF      0x51,0x1                                                                                        
002f8e   0101     MOVLB     0x1            			ctrl_trf_session_owner = MUID_HID;  //set owner to HID, service this when we have some data..	 C:\fw\midicontroller\x011\hid.c
002f90   0e02     MOVLW     0x2                                                                                             
002f92   6f4b     MOVWF     0x4b,0x1                                                                                        
002f94   d028     BRA       0x2fe6                     break;                                                               C:\fw\midicontroller\x011\hid.c
                                                   case GET_IDLE:                                                           C:\fw\midicontroller\x011\hid.c
002f96   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x011\hid.c
002f98   0e02     MOVLW     0x2                                                                                             
002f9a   6f4b     MOVWF     0x4b,0x1                                                                                        
002f9c   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&idle_rate;      // Set source                    C:\fw\midicontroller\x011\hid.c
002f9e   0e54     MOVLW     0x54                                                                                            
002fa0   6f4c     MOVWF     0x4c,0x1                                                                                        
002fa2   0e01     MOVLW     0x1                                                                                             
002fa4   6f4d     MOVWF     0x4d,0x1                                                                                        
002fa6   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\fw\midicontroller\x011\hid.c
002fa8   9347     BCF       0x47,0x1,0x1                                                                                    
002faa   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                C:\fw\midicontroller\x011\hid.c
002fac   0e01     MOVLW     0x1                                                                                             
002fae   6f50     MOVWF     0x50,0x1                                                                                        
002fb0   d01a     BRA       0x2fe6                     break;                                                               C:\fw\midicontroller\x011\hid.c
                                                   case SET_IDLE:                                                           C:\fw\midicontroller\x011\hid.c
002fb2   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x011\hid.c
002fb4   0e02     MOVLW     0x2                                                                                             
002fb6   6f4b     MOVWF     0x4b,0x1                                                                                        
002fb8   c413     MOVFF     0x413,0x154                idle_rate = MSB(SetupPkt.W_Value);                                   C:\fw\midicontroller\x011\hid.c
002fba   f154                                                                                                               
002fbc   d014     BRA       0x2fe6                     break;                                                               C:\fw\midicontroller\x011\hid.c
                                                   case GET_PROTOCOL:                                                       C:\fw\midicontroller\x011\hid.c
002fbe   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x011\hid.c
002fc0   0e02     MOVLW     0x2                                                                                             
002fc2   6f4b     MOVWF     0x4b,0x1                                                                                        
002fc4   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&active_protocol;// Set source                    C:\fw\midicontroller\x011\hid.c
002fc6   0e55     MOVLW     0x55                                                                                            
002fc8   6f4c     MOVWF     0x4c,0x1                                                                                        
002fca   0e01     MOVLW     0x1                                                                                             
002fcc   6f4d     MOVWF     0x4d,0x1                                                                                        
002fce   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               C:\fw\midicontroller\x011\hid.c
002fd0   9347     BCF       0x47,0x1,0x1                                                                                    
002fd2   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                C:\fw\midicontroller\x011\hid.c
002fd4   0e01     MOVLW     0x1                                                                                             
002fd6   6f50     MOVWF     0x50,0x1                                                                                        
002fd8   d006     BRA       0x2fe6                     break;                                                               C:\fw\midicontroller\x011\hid.c
                                                   case SET_PROTOCOL:                                                       C:\fw\midicontroller\x011\hid.c
002fda   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   C:\fw\midicontroller\x011\hid.c
002fdc   0e02     MOVLW     0x2                                                                                             
002fde   6f4b     MOVWF     0x4b,0x1                                                                                        
002fe0   c412     MOVFF     0x412,0x155                active_protocol = LSB(SetupPkt.W_Value);                             C:\fw\midicontroller\x011\hid.c
002fe2   f155                                                                                                               
002fe4   d000     BRA       0x2fe6                     break;                                                               C:\fw\midicontroller\x011\hid.c
                                               }//end switch(SetupPkt.bRequest)                                             C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
002fe6   0012     RETURN    0x0            }//end USBCheckHIDRequest                                                        C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** U S E R  A P I ***********************************************************/  C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\hid.c
                                            * Function:        void HIDInitEP(void)                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * PreCondition:    None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Input:           None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Overview:        HIDInitEP initializes HID endpoints, buffer descriptors,     C:\fw\midicontroller\x011\hid.c
                                            *                  internal state-machine, and variables.                       C:\fw\midicontroller\x011\hid.c
                                            *                  It should be called after the USB host has sent out a        C:\fw\midicontroller\x011\hid.c
                                            *                  SET_CONFIGURATION request.                                   C:\fw\midicontroller\x011\hid.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\hid.c
                                           void HIDInitEP(void)                                                             C:\fw\midicontroller\x011\hid.c
                                           {                                                                                C:\fw\midicontroller\x011\hid.c
002fe8   0101     MOVLB     0x1                hid_rpt_rx_len =0;                                                           C:\fw\midicontroller\x011\hid.c
002fea   6b56     CLRF      0x56,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hid.c
002fec   0e1e     MOVLW     0x1e               HID_UEP = EP_OUT_IN|HSHK_EN;                // Enable 2 data pipes           C:\fw\midicontroller\x011\hid.c
002fee   6e71     MOVWF     0x71,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hid.c
002ff0   0104     MOVLB     0x4                HID_BD_OUT.Cnt = sizeof(hid_report_out);    // Set buffer size               C:\fw\midicontroller\x011\hid.c
002ff2   0e08     MOVLW     0x8                                                                                             
002ff4   6f09     MOVWF     0x9,0x1                                                                                         
002ff6   0e58     MOVLW     0x58               HID_BD_OUT.ADR = (byte*)&hid_report_out;    // Set buffer address            C:\fw\midicontroller\x011\hid.c
002ff8   6f0a     MOVWF     0xa,0x1                                                                                         
002ffa   0e04     MOVLW     0x4                                                                                             
002ffc   6f0b     MOVWF     0xb,0x1                                                                                         
002ffe   0e88     MOVLW     0x88               HID_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN; // Set status                    C:\fw\midicontroller\x011\hid.c
003000   6f08     MOVWF     0x8,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                               /*                                                                           C:\fw\midicontroller\x011\hid.c
                                                * Do not have to init Cnt of IN pipes here.                                 C:\fw\midicontroller\x011\hid.c
                                                * Reason:  Number of bytes to send to the host                              C:\fw\midicontroller\x011\hid.c
                                                *          varies from one transaction to                                   C:\fw\midicontroller\x011\hid.c
                                                *          another. Cnt should equal the exact                              C:\fw\midicontroller\x011\hid.c
                                                *          number of bytes to transmit for                                  C:\fw\midicontroller\x011\hid.c
                                                *          a given IN transaction.                                          C:\fw\midicontroller\x011\hid.c
                                                *          This number of bytes will only                                   C:\fw\midicontroller\x011\hid.c
                                                *          be known right before the data is                                C:\fw\midicontroller\x011\hid.c
                                                *          sent.                                                            C:\fw\midicontroller\x011\hid.c
                                                */                                                                          C:\fw\midicontroller\x011\hid.c
003002   0104     MOVLB     0x4                HID_BD_IN.ADR = (byte*)&hid_report_in;      // Set buffer address            C:\fw\midicontroller\x011\hid.c
003004   0e60     MOVLW     0x60                                                                                            
003006   6f0e     MOVWF     0xe,0x1                                                                                         
003008   0e04     MOVLW     0x4                                                                                             
00300a   6f0f     MOVWF     0xf,0x1                                                                                         
00300c   0e40     MOVLW     0x40               HID_BD_IN.Stat._byte = _UCPU|_DAT1;         // Set status                    C:\fw\midicontroller\x011\hid.c
00300e   6f0c     MOVWF     0xc,0x1                                                                                         
                                                                                                                            C:\fw\midicontroller\x011\hid.c
003010   0012     RETURN    0x0            }//end HIDInitEP                                                                 C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\hid.c
                                            * Function:        void HIDTxReport(char *buffer, byte len)                     C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * PreCondition:    mHIDTxIsBusy() must return false.                            C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            *                  Value of 'len' must be equal to or smaller than              C:\fw\midicontroller\x011\hid.c
                                            *                  HID_INT_IN_EP_SIZE                                           C:\fw\midicontroller\x011\hid.c
                                            *                  For an interrupt endpoint, the largest buffer size is        C:\fw\midicontroller\x011\hid.c
                                            *                  64 bytes.                                                    C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Input:           buffer  : Pointer to the starting location of data bytes     C:\fw\midicontroller\x011\hid.c
                                            *                  len     : Number of bytes to be transferred                  C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Output:          None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Side Effects:    None                                                         C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Overview:        Use this macro to transfer data located in data memory.      C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            *                  Remember: mHIDTxIsBusy() must return false before user       C:\fw\midicontroller\x011\hid.c
                                            *                  can call this function.                                      C:\fw\midicontroller\x011\hid.c
                                            *                  Unexpected behavior will occur if this function is called    C:\fw\midicontroller\x011\hid.c
                                            *                  when mHIDTxIsBusy() == 0                                     C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            *                  Typical Usage:                                               C:\fw\midicontroller\x011\hid.c
                                            *                  if(!mHIDTxIsBusy())                                          C:\fw\midicontroller\x011\hid.c
                                            *                      HIDTxReport(buffer, 3);                                  C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Note:            None                                                         C:\fw\midicontroller\x011\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\hid.c
003012   cfd9     MOVFF     0xfd9,0xfe6    void HIDTxReport(char *buffer, byte len)                                         C:\fw\midicontroller\x011\hid.c
003014   ffe6                                                                                                               
003016   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003018   ffd9                                                                                                               
00301a   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x011\hid.c
                                           	byte i;                                                                         C:\fw\midicontroller\x011\hid.c
                                           	                                                                                C:\fw\midicontroller\x011\hid.c
                                               /*                                                                           C:\fw\midicontroller\x011\hid.c
                                                * Value of len should be equal to or smaller than HID_INT_IN_EP_SIZE.       C:\fw\midicontroller\x011\hid.c
                                                * This check forces the value of len to meet the precondition.              C:\fw\midicontroller\x011\hid.c
                                                */                                                                          C:\fw\midicontroller\x011\hid.c
00301c   0efc     MOVLW     0xfc           	if(len > HID_INT_IN_EP_SIZE)                                                    C:\fw\midicontroller\x011\hid.c
00301e   50db     MOVF      0xdb,0x0,0x0                                                                                    
003020   0808     SUBLW     0x8                                                                                             
003022   e205     BC        0x302e                                                                                          
003024   0e08     MOVLW     0x8            	    len = HID_INT_IN_EP_SIZE;                                                   C:\fw\midicontroller\x011\hid.c
003026   6ef3     MOVWF     0xf3,0x0                                                                                        
003028   0efc     MOVLW     0xfc                                                                                            
00302a   cff3     MOVFF     0xff3,0xfdb                                                                                     
00302c   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                              /*                                                                            C:\fw\midicontroller\x011\hid.c
                                               * Copy data from user's buffer to dual-ram buffer                            C:\fw\midicontroller\x011\hid.c
                                               */                                                                           C:\fw\midicontroller\x011\hid.c
00302e   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    C:\fw\midicontroller\x011\hid.c
003030   0efc     MOVLW     0xfc                                                                                            
003032   50db     MOVF      0xdb,0x0,0x0                                                                                    
003034   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
003036   e219     BC        0x306a                                                                                          
003066   2adf     INCF      0xdf,0x1,0x0                                                                                    
003068   d7e3     BRA       0x3030                                                                                          
003038   50df     MOVF      0xdf,0x0,0x0       	hid_report_in[i] = buffer[i];                                               C:\fw\midicontroller\x011\hid.c
00303a   6ee7     MOVWF     0xe7,0x0                                                                                        
00303c   0efd     MOVLW     0xfd                                                                                            
00303e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
003040   ffe9                                                                                                               
003042   0efe     MOVLW     0xfe                                                                                            
003044   cfdb     MOVFF     0xfdb,0xfea                                                                                     
003046   ffea                                                                                                               
003048   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00304a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
00304c   0e00     MOVLW     0x0                                                                                             
00304e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003050   50ef     MOVF      0xef,0x0,0x0                                                                                    
003052   6ee6     MOVWF     0xe6,0x0                                                                                        
003054   50df     MOVF      0xdf,0x0,0x0                                                                                    
003056   6aea     CLRF      0xea,0x0                                                                                        
003058   0f60     ADDLW     0x60                                                                                            
00305a   6ee9     MOVWF     0xe9,0x0                                                                                        
00305c   0e04     MOVLW     0x4                                                                                             
00305e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003060   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003062   50e7     MOVF      0xe7,0x0,0x0                                                                                    
003064   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hid.c
00306a   0efc     MOVLW     0xfc               HID_BD_IN.Cnt = len;                                                         C:\fw\midicontroller\x011\hid.c
00306c   cfdb     MOVFF     0xfdb,0x40d                                                                                     
00306e   f40d                                                                                                               
003070   0e40     MOVLW     0x40               mUSBBufferReady(HID_BD_IN);                                                  C:\fw\midicontroller\x011\hid.c
003072   0104     MOVLB     0x4                                                                                             
003074   170c     ANDWF     0xc,0x1,0x1                                                                                     
003076   7d0c     BTG       0xc,0x6,0x1                                                                                     
003078   0e88     MOVLW     0x88                                                                                            
00307a   130c     IORWF     0xc,0x1,0x1                                                                                     
                                                                                                                            C:\fw\midicontroller\x011\hid.c
00307c   52e5     MOVF      0xe5,0x1,0x0   }//end HIDTxReport                                                               C:\fw\midicontroller\x011\hid.c
00307e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003080   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003082   ffd9                                                                                                               
003084   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /******************************************************************************  C:\fw\midicontroller\x011\hid.c
                                            * Function:        byte HIDRxReport(char *buffer, byte len)                     C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     C:\fw\midicontroller\x011\hid.c
                                            *                  maximum endpoint size responsible for receiving report       C:\fw\midicontroller\x011\hid.c
                                            *                  data from USB host for HID class.                            C:\fw\midicontroller\x011\hid.c
                                            *                  Input argument 'buffer' should point to a buffer area that   C:\fw\midicontroller\x011\hid.c
                                            *                  is bigger or equal to the size specified by 'len'.           C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   C:\fw\midicontroller\x011\hid.c
                                            *                  len     : The number of bytes expected.                      C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Output:          The number of bytes copied to buffer.                        C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Side Effects:    Publicly accessible variable hid_rpt_rx_len is updated       C:\fw\midicontroller\x011\hid.c
                                            *                  with the number of bytes copied to buffer.                   C:\fw\midicontroller\x011\hid.c
                                            *                  Once HIDRxReport is called, subsequent retrieval of          C:\fw\midicontroller\x011\hid.c
                                            *                  hid_rpt_rx_len can be done by calling macro                  C:\fw\midicontroller\x011\hid.c
                                            *                  mHIDGetRptRxLength().                                        C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Overview:        HIDRxReport copies a string of bytes received through        C:\fw\midicontroller\x011\hid.c
                                            *                  USB HID OUT endpoint to a user's specified location.         C:\fw\midicontroller\x011\hid.c
                                            *                  It is a non-blocking function. It does not wait              C:\fw\midicontroller\x011\hid.c
                                            *                  for data if there is no data available. Instead it returns   C:\fw\midicontroller\x011\hid.c
                                            *                  '0' to notify the caller that there is no data available.    C:\fw\midicontroller\x011\hid.c
                                            *                                                                               C:\fw\midicontroller\x011\hid.c
                                            * Note:            If the actual number of bytes received is larger than the    C:\fw\midicontroller\x011\hid.c
                                            *                  number of bytes expected (len), only the expected number     C:\fw\midicontroller\x011\hid.c
                                            *                  of bytes specified will be copied to buffer.                 C:\fw\midicontroller\x011\hid.c
                                            *                  If the actual number of bytes received is smaller than the   C:\fw\midicontroller\x011\hid.c
                                            *                  number of bytes expected (len), only the actual number       C:\fw\midicontroller\x011\hid.c
                                            *                  of bytes received will be copied to buffer.                  C:\fw\midicontroller\x011\hid.c
                                            *****************************************************************************/  C:\fw\midicontroller\x011\hid.c
003086   cfd9     MOVFF     0xfd9,0xfe6    byte HIDRxReport(char *buffer, byte len)                                         C:\fw\midicontroller\x011\hid.c
003088   ffe6                                                                                                               
00308a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00308c   ffd9                                                                                                               
                                           {                                                                                C:\fw\midicontroller\x011\hid.c
00308e   0101     MOVLB     0x1                hid_rpt_rx_len = 0;                                                          C:\fw\midicontroller\x011\hid.c
003090   6b56     CLRF      0x56,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hid.c
003092   0104     MOVLB     0x4                if(!mHIDRxIsBusy())                                                          C:\fw\midicontroller\x011\hid.c
003094   bf08     BTFSC     0x8,0x7,0x1                                                                                     
003096   d031     BRA       0x30fa                                                                                          
                                               {                                                                            C:\fw\midicontroller\x011\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x011\hid.c
                                                    * Adjust the expected number of bytes to equal                          C:\fw\midicontroller\x011\hid.c
                                                    * the actual number of bytes received.                                  C:\fw\midicontroller\x011\hid.c
                                                    */                                                                      C:\fw\midicontroller\x011\hid.c
003098   0efc     MOVLW     0xfc                   if(len > HID_BD_OUT.Cnt)                                                 C:\fw\midicontroller\x011\hid.c
00309a   cfdb     MOVFF     0xfdb,0x10                                                                                      
00309c   f010                                                                                                               
00309e   5109     MOVF      0x9,0x0,0x1                                                                                     
0030a0   80d8     BSF       0xd8,0x0,0x0                                                                                    
0030a2   5410     SUBFWB    0x10,0x0,0x0                                                                                    
0030a4   e203     BC        0x30ac                                                                                          
0030a6   0efc     MOVLW     0xfc                       len = HID_BD_OUT.Cnt;                                                C:\fw\midicontroller\x011\hid.c
0030a8   c409     MOVFF     0x409,0xfdb                                                                                     
0030aa   ffdb                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x011\hid.c
                                                    * Copy data from dual-ram buffer to user's buffer                       C:\fw\midicontroller\x011\hid.c
                                                    */                                                                      C:\fw\midicontroller\x011\hid.c
0030ac   0101     MOVLB     0x1                    for(hid_rpt_rx_len = 0; hid_rpt_rx_len < len; hid_rpt_rx_len++)          C:\fw\midicontroller\x011\hid.c
0030ae   6b56     CLRF      0x56,0x1                                                                                        
0030b0   0efc     MOVLW     0xfc                                                                                            
0030b2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0030b4   5d56     SUBWF     0x56,0x0,0x1                                                                                    
0030b6   e219     BC        0x30ea                                                                                          
0030e6   2b56     INCF      0x56,0x1,0x1                                                                                    
0030e8   d7e3     BRA       0x30b0                                                                                          
0030b8   5156     MOVF      0x56,0x0,0x1               buffer[hid_rpt_rx_len] = hid_report_out[hid_rpt_rx_len];             C:\fw\midicontroller\x011\hid.c
0030ba   6aea     CLRF      0xea,0x0                                                                                        
0030bc   0f58     ADDLW     0x58                                                                                            
0030be   6ee9     MOVWF     0xe9,0x0                                                                                        
0030c0   0e04     MOVLW     0x4                                                                                             
0030c2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0030c4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0030c6   6ee6     MOVWF     0xe6,0x0                                                                                        
0030c8   5156     MOVF      0x56,0x0,0x1                                                                                    
0030ca   6ee7     MOVWF     0xe7,0x0                                                                                        
0030cc   0efd     MOVLW     0xfd                                                                                            
0030ce   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0030d0   ffe9                                                                                                               
0030d2   0efe     MOVLW     0xfe                                                                                            
0030d4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0030d6   ffea                                                                                                               
0030d8   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0030da   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0030dc   0e00     MOVLW     0x0                                                                                             
0030de   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0030e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030e2   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0030e4   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                                   /*                                                                       C:\fw\midicontroller\x011\hid.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      C:\fw\midicontroller\x011\hid.c
                                                    */                                                                      C:\fw\midicontroller\x011\hid.c
0030ea   0104     MOVLB     0x4                    HID_BD_OUT.Cnt = sizeof(hid_report_out);                                 C:\fw\midicontroller\x011\hid.c
0030ec   0e08     MOVLW     0x8                                                                                             
0030ee   6f09     MOVWF     0x9,0x1                                                                                         
0030f0   0e40     MOVLW     0x40                   mUSBBufferReady(HID_BD_OUT);                                             C:\fw\midicontroller\x011\hid.c
0030f2   1708     ANDWF     0x8,0x1,0x1                                                                                     
0030f4   7d08     BTG       0x8,0x6,0x1                                                                                     
0030f6   0e88     MOVLW     0x88                                                                                            
0030f8   1308     IORWF     0x8,0x1,0x1                                                                                     
                                               }//end if                                                                    C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
0030fa   0101     MOVLB     0x1                return hid_rpt_rx_len;                                                       C:\fw\midicontroller\x011\hid.c
0030fc   5156     MOVF      0x56,0x0,0x1                                                                                    
0030fe   d000     BRA       0x3100                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hid.c
003100   52e5     MOVF      0xe5,0x1,0x0   }//end HIDRxReport                                                               C:\fw\midicontroller\x011\hid.c
003102   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003104   ffd9                                                                                                               
003106   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           #endif //def USB_USE_HID                                                         C:\fw\midicontroller\x011\hid.c
                                                                                                                            C:\fw\midicontroller\x011\hid.c
                                           /** EOF hid.c ***************************************************************/   C:\fw\midicontroller\x011\hid.c
                                           //This file contains the global ram definitions for the project                  C:\fw\midicontroller\x011\ram_def.c
                                           #include	"c_system.h"                                                            C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           //----------------------------Main variables---------------------------------------- C:\fw\midicontroller\x011\ram_def.c
                                           TwoBytes NVRCommAddr;                                                            C:\fw\midicontroller\x011\ram_def.c
                                           TwoBytes RAMCommAddr;                                                            C:\fw\midicontroller\x011\ram_def.c
                                           TwoBytes ROMCommAddr;                                                            C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           BitField	CommFlags1;                                                             C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char WpmCounter;                                                        C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char WpmCounter1;                                                       C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char ProgmemBuffer[64];                                                 C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           #pragma udata RamData                                                            C:\fw\midicontroller\x011\ram_def.c
                                           BitField ArbFlags1;                                                              C:\fw\midicontroller\x011\ram_def.c
                                           BitField MiscFlags1;                                                             C:\fw\midicontroller\x011\ram_def.c
                                           BitField DispSegData[5];                                                         C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char DispNumOfCommons;                                                  C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char LedStates;			//footswitch leds                                     C:\fw\midicontroller\x011\ram_def.c
                                           unsigned long	ButtonState;                                                       C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char ExpPedalInst;                                                      C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           TwoBytes ExpPedalAvg;                                                            C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           //----------------------------USB stuff----------------------------------        C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char USBDataPointer;                                                    C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char USBEP0DataInBuffer[64];                                            C:\fw\midicontroller\x011\ram_def.c
                                           unsigned char ResponseType;                                                      C:\fw\midicontroller\x011\ram_def.c
                                                                                                                            C:\fw\midicontroller\x011\ram_def.c
                                           ;###########################################################################     C:\fw\midicontroller\x011\config.asm
                                           ;#			Author: Joe Dunne				  #                                                    C:\fw\midicontroller\x011\config.asm
                                           ;#			Date 4/06/07					  #                                                        C:\fw\midicontroller\x011\config.asm
                                           ;#			Main arbitrator					  #                                                     C:\fw\midicontroller\x011\config.asm
                                           ;#			File Name: config.asm  				  #                                              C:\fw\midicontroller\x011\config.asm
                                           ;#									  #                                                                   C:\fw\midicontroller\x011\config.asm
                                           ;############################################################################    C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           	ERRORLEVEL -208, -216                                                           C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           	LIST R=DEC                                                                      C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           	INCLUDE "a_MICRDEF.INC"                                                         C:\fw\midicontroller\x011\config.asm
                                                   LIST                                                                     C:\fw\midicontroller\x011\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x011\a_MICRDEF.INC
                                           ;==========================================================================      C:\fw\midicontroller\x011\a_MICRDEF.INC
                                           ;  $Id: P18F4550.INC,v 1.7 2004/10/06 13:56:45 curtiss Exp $                     C:\fw\midicontroller\x011\a_MICRDEF.INC
                                           ;  MPASM PIC18F4550 processor include                                            C:\fw\midicontroller\x011\a_MICRDEF.INC
                                           ;                                                                                C:\fw\midicontroller\x011\a_MICRDEF.INC
                                           ;  (c) Copyright 1999-2004 Microchip Technology, All rights reserved             C:\fw\midicontroller\x011\a_MICRDEF.INC
                                           ;==========================================================================      C:\fw\midicontroller\x011\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x011\a_MICRDEF.INC
                                                   LIST                                                                     C:\fw\midicontroller\x011\a_MICRDEF.INC
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           ;This section contains configuration bits for the processor                      C:\fw\midicontroller\x011\config.asm
                                           ;Don't change this unless you know what you're doing.                            C:\fw\midicontroller\x011\config.asm
                                           ;300000                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG USBDIV=2, CPUDIV=OSC2_PLL3, PLLDIV=2                                     C:\fw\midicontroller\x011\config.asm
                                           ;300001                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG FOSC=HSPLL_HS, FCMEN=OFF, IESO=OFF                                       C:\fw\midicontroller\x011\config.asm
                                           ;300002                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG VREGEN=ON, PWRT=ON, BOR=ON, BORV=2		;2 = 2.7V..                          C:\fw\midicontroller\x011\config.asm
                                           ;300003                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG WDT=OFF, WDTPS=128                                                       C:\fw\midicontroller\x011\config.asm
                                           ;300005                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG CCP2MX=ON, PBADEN=OFF, LPT1OSC=OFF, MCLRE=ON                             C:\fw\midicontroller\x011\config.asm
                                           ;300006                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG STVREN=ON, LVP=OFF, ICPRT=OFF, XINST=OFF, DEBUG=OFF                      C:\fw\midicontroller\x011\config.asm
                                           ;300008                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG CP0=OFF, CP1=OFF, CP2=OFF                                                C:\fw\midicontroller\x011\config.asm
                                           ;300009                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG CPB=OFF, CPD=OFF                                                         C:\fw\midicontroller\x011\config.asm
                                           ;30000A                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG WRT0=OFF, WRT1=OFF, WRT2=OFF                                             C:\fw\midicontroller\x011\config.asm
                                           ;30000B                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG WRTC=OFF, WRTB=OFF, WRTD=OFF                                             C:\fw\midicontroller\x011\config.asm
                                           ;30000C                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG EBTR0=OFF, EBTR1=OFF, EBTR2=OFF                                          C:\fw\midicontroller\x011\config.asm
                                           ;30000D                                                                          C:\fw\midicontroller\x011\config.asm
                                           	CONFIG EBTRB=OFF                                                                C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           	global	CLEAR_RAM                                                                C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           	code                                                                            C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           ;clear general purpose registers 0x000 through 0x7FF.                            C:\fw\midicontroller\x011\config.asm
                                           CLEAR_RAM                                                                        C:\fw\midicontroller\x011\config.asm
0034b8   6aea     CLRF      0xea,0x0       	clrf	FSR0H                                                                      C:\fw\midicontroller\x011\config.asm
0034ba   6ae9     CLRF      0xe9,0x0       	clrf	FSR0L                                                                      C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           RAMCLEAR                                                                         C:\fw\midicontroller\x011\config.asm
0034bc   0004     CLRWDT                   	CLRWDT                                                                          C:\fw\midicontroller\x011\config.asm
0034be   6aee     CLRF      0xee,0x0       	clrf	POSTINC0                                                                   C:\fw\midicontroller\x011\config.asm
0034c0   a6ea     BTFSS     0xea,0x3,0x0   	btfss	FSR0H, 3                                                                  C:\fw\midicontroller\x011\config.asm
0034c2   d7fc     BRA       0x34bc         	bra	RAMCLEAR                                                                    C:\fw\midicontroller\x011\config.asm
0034c4   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x011\config.asm
                                                                                                                            C:\fw\midicontroller\x011\config.asm
                                           	END                                                                             C:\fw\midicontroller\x011\config.asm
                                           //#######################################################################        C:\fw\midicontroller\x011\intslct.c
                                           /**                                                                              C:\fw\midicontroller\x011\intslct.c
                                           * @file intslct.c                                                                C:\fw\midicontroller\x011\intslct.c
                                           * interrupt handler                                                              C:\fw\midicontroller\x011\intslct.c
                                           *                                                                                C:\fw\midicontroller\x011\intslct.c
                                           * @author Joe Dunne                                                              C:\fw\midicontroller\x011\intslct.c
                                           * @date 2/02/05                                                                  C:\fw\midicontroller\x011\intslct.c
                                           * @brief RS232/USB communication routine                                         C:\fw\midicontroller\x011\intslct.c
                                           */                                                                               C:\fw\midicontroller\x011\intslct.c
                                           //			*See Updates section at bottom of file*                                     C:\fw\midicontroller\x011\intslct.c
                                           //#######################################################################        C:\fw\midicontroller\x011\intslct.c
                                                                                                                            C:\fw\midicontroller\x011\intslct.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\intslct.c
                                                                                                                            C:\fw\midicontroller\x011\intslct.c
                                           #pragma code InterruptVectorHigh = 0xA08                                         C:\fw\midicontroller\x011\intslct.c
                                           void                                                                             C:\fw\midicontroller\x011\intslct.c
                                           InterruptVectorHigh (void)                                                       C:\fw\midicontroller\x011\intslct.c
                                           {                                                                                C:\fw\midicontroller\x011\intslct.c
                                             _asm                                                                           C:\fw\midicontroller\x011\intslct.c
000a08   efef     GOTO      0x35de         	goto InterruptHandlerHigh //jump to interrupt routine                           C:\fw\midicontroller\x011\intslct.c
000a0a   f01a                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x011\intslct.c
000a0c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\intslct.c
                                                                                                                            C:\fw\midicontroller\x011\intslct.c
                                                                                                                            C:\fw\midicontroller\x011\intslct.c
                                           //----------------------------------------------------------------------------   C:\fw\midicontroller\x011\intslct.c
                                           // High priority interrupt routine                                               C:\fw\midicontroller\x011\intslct.c
                                                                                                                            C:\fw\midicontroller\x011\intslct.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\intslct.c
                                                                                                                            C:\fw\midicontroller\x011\intslct.c
                                           #pragma interruptlow InterruptHandlerHigh                                        C:\fw\midicontroller\x011\intslct.c
0035de   cfd8     MOVFF     0xfd8,0xfe4    void	InterruptHandlerHigh ()                                                     C:\fw\midicontroller\x011\intslct.c
0035e0   ffe4                                                                                                               
0035e2   cfe0     MOVFF     0xfe0,0xfe4                                                                                     
0035e4   ffe4                                                                                                               
0035e6   6ee4     MOVWF     0xe4,0x0                                                                                        
0035e8   cfda     MOVFF     0xfda,0xfe4                                                                                     
0035ea   ffe4                                                                                                               
0035ec   cfe2     MOVFF     0xfe2,0xfda                                                                                     
0035ee   ffda                                                                                                               
0035f0   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                C:\fw\midicontroller\x011\intslct.c
0035f2   a4f2     BTFSS     0xf2,0x2,0x0     if (INTCONbits.TMR0IF)                                                         C:\fw\midicontroller\x011\intslct.c
0035f4   d003     BRA       0x35fc                                                                                          
                                               {                                   //check for TMR0 overflow                C:\fw\midicontroller\x011\intslct.c
0035f6   94f2     BCF       0xf2,0x2,0x0         INTCONbits.TMR0IF = 0;            //clear interrupt flag                   C:\fw\midicontroller\x011\intslct.c
0035f8   0100     MOVLB     0x0                  Systick = true;                                                            C:\fw\midicontroller\x011\intslct.c
0035fa   8160     BSF       0x60,0x0,0x1                                                                                    
                                               }                                                                            C:\fw\midicontroller\x011\intslct.c
0035fc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\intslct.c
0035fe   cfe5     MOVFF     0xfe5,0xfda                                                                                     
003600   ffda                                                                                                               
003602   50e5     MOVF      0xe5,0x0,0x0                                                                                    
003604   cfe5     MOVFF     0xfe5,0xfe0                                                                                     
003606   ffe0                                                                                                               
003608   cfe5     MOVFF     0xfe5,0xfd8                                                                                     
00360a   ffd8                                                                                                               
00360c   0010     RETFIE    0x0                                                                                             
                                           #pragma code                                                                     C:\fw\midicontroller\x011\intslct.c
                                           //----------------------------------------------------------------------------   C:\fw\midicontroller\x011\intslct.c
                                           //*;###########################################################################  C:\fw\midicontroller\x011\init.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\init.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x011\init.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x011\init.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x011\init.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\init.c
                                           //;############################################################################  C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\init.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           void init(void) {                                                                C:\fw\midicontroller\x011\init.c
003520   ec5c     CALL      0x34b8,0x0     	CLEAR_RAM();                                                                    C:\fw\midicontroller\x011\init.c
003522   f01a                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\init.c
003524   6a89     CLRF      0x89,0x0       	LATA = 0;                                                                       C:\fw\midicontroller\x011\init.c
003526   6a8a     CLRF      0x8a,0x0       	LATB = 0;                                                                       C:\fw\midicontroller\x011\init.c
003528   6a8b     CLRF      0x8b,0x0       	LATC = 0;                                                                       C:\fw\midicontroller\x011\init.c
00352a   6a8c     CLRF      0x8c,0x0       	LATD = 0;                                                                       C:\fw\midicontroller\x011\init.c
00352c   6a8d     CLRF      0x8d,0x0       	LATE = 0;                                                                       C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
00352e   0e01     MOVLW     0x1            	TRISA = INIT_TRISA;                                                             C:\fw\midicontroller\x011\init.c
003530   6e92     MOVWF     0x92,0x0                                                                                        
003532   0e10     MOVLW     0x10           	TRISB = INIT_TRISB;                                                             C:\fw\midicontroller\x011\init.c
003534   6e93     MOVWF     0x93,0x0                                                                                        
003536   0ef8     MOVLW     0xf8           	TRISC = INIT_TRISC;                                                             C:\fw\midicontroller\x011\init.c
003538   6e94     MOVWF     0x94,0x0                                                                                        
00353a   6a95     CLRF      0x95,0x0       	TRISD = INIT_TRISD;                                                             C:\fw\midicontroller\x011\init.c
00353c   0e02     MOVLW     0x2            	TRISE = INIT_TRISE;                                                             C:\fw\midicontroller\x011\init.c
00353e   6e96     MOVWF     0x96,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\init.c
003540   0100     MOVLB     0x0            	DispNumOfCommons = DISP_NUMBER_OF_COMMONS;                                      C:\fw\midicontroller\x011\init.c
003542   0e05     MOVLW     0x5                                                                                             
003544   6f67     MOVWF     0x67,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           //	TRISCbits.TRISC6 = false;                                                     C:\fw\midicontroller\x011\init.c
                                           //	RCSTA = 0x90;                                                                 C:\fw\midicontroller\x011\init.c
                                           //	TXSTA = 0xA2;		//0x46;                                                        C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           //	SPBRG = 204;                                                                  C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           #ifdef UARTISRS232                                                               C:\fw\midicontroller\x011\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          C:\fw\midicontroller\x011\init.c
                                           //Initialize the USART control registers                                         C:\fw\midicontroller\x011\init.c
                                           	TXSTA = 0xA6;			//master,8bit,async,high speed                                  C:\fw\midicontroller\x011\init.c
                                           	RCSTA = 0x90;			//enabled,8bit, continuous                                      C:\fw\midicontroller\x011\init.c
                                           //	BAUDCONbits.BRG16 = true;                                                     C:\fw\midicontroller\x011\init.c
                                           	SPBRG = 16;			//115200 baud                                                     C:\fw\midicontroller\x011\init.c
                                           	SPBRGH = 0x01;                                                                  C:\fw\midicontroller\x011\init.c
                                           #else                                                                            C:\fw\midicontroller\x011\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          C:\fw\midicontroller\x011\init.c
                                           //Initialize the USART control registers                                         C:\fw\midicontroller\x011\init.c
003546   0ee6     MOVLW     0xe6           	TXSTA = 0xE6;			//master,8bit,async, BRGH=1                                     C:\fw\midicontroller\x011\init.c
003548   6eac     MOVWF     0xac,0x0                                                                                        
00354a   0e90     MOVLW     0x90           	RCSTA = 0x90;			//enabled,8bit, continuous                                      C:\fw\midicontroller\x011\init.c
00354c   6eab     MOVWF     0xab,0x0                                                                                        
                                           //	BAUDCONbits.BRG16 = true;                                                     C:\fw\midicontroller\x011\init.c
00354e   0e3f     MOVLW     0x3f           	SPBRG = 63;			//31250 baud                                                      C:\fw\midicontroller\x011\init.c
003550   6eaf     MOVWF     0xaf,0x0                                                                                        
003552   6ab0     CLRF      0xb0,0x0       	SPBRGH = 0x00;                                                                  C:\fw\midicontroller\x011\init.c
                                           #endif                                                                           C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           //These constants setup the application's MCU Analog-to-Digital Converter module. C:\fw\midicontroller\x011\init.c
003554   0e40     MOVLW     0x40           	ADCON0	= 0b01000000;		//AN0, off                                                C:\fw\midicontroller\x011\init.c
003556   6ec2     MOVWF     0xc2,0x0                                                                                        
003558   0e0e     MOVLW     0xe            	ADCON1	= 0b00001110;		//1 analog channels                                       C:\fw\midicontroller\x011\init.c
00355a   6ec1     MOVWF     0xc1,0x0                                                                                        
00355c   0e86     MOVLW     0x86           	ADCON2	= 0b10000110;		//Right justified, 0 TAD(manual), FOSC/32                 C:\fw\midicontroller\x011\init.c
00355e   6ec0     MOVWF     0xc0,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                           //set up timer0 to interrupt at some interval..                                  C:\fw\midicontroller\x011\init.c
003560   0e20     MOVLW     0x20           	INTCON = 0x20;                //disable global and enable TMR0 interrupt        C:\fw\midicontroller\x011\init.c
003562   6ef2     MOVWF     0xf2,0x0                                                                                        
003564   0e84     MOVLW     0x84           	INTCON2 = 0x84;               //TMR0 high priority                              C:\fw\midicontroller\x011\init.c
003566   6ef1     MOVWF     0xf1,0x0                                                                                        
003568   8ed0     BSF       0xd0,0x7,0x0   	RCONbits.IPEN = 1;            //enable priority levels                          C:\fw\midicontroller\x011\init.c
00356a   6ad7     CLRF      0xd7,0x0       	TMR0H = 0;                    //clear timer                                     C:\fw\midicontroller\x011\init.c
00356c   6ad6     CLRF      0xd6,0x0       	TMR0L = 0;                    //clear timer                                     C:\fw\midicontroller\x011\init.c
00356e   0e80     MOVLW     0x80           	T0CON = 0x80;                 //set up timer0 - prescaler 1:8                   C:\fw\midicontroller\x011\init.c
003570   6ed5     MOVWF     0xd5,0x0                                                                                        
003572   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIEH = 1;          //enable interrupts                               C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
                                                                                                                            C:\fw\midicontroller\x011\init.c
003574   0e14     MOVLW     0x14           	mInitializeUSBDriver();                                                         C:\fw\midicontroller\x011\init.c
003576   6e6f     MOVWF     0x6f,0x0                                                                                        
003578   0101     MOVLB     0x1                                                                                             
00357a   6b46     CLRF      0x46,0x1                                                                                        
00357c   0101     MOVLB     0x1                                                                                             
00357e   6b47     CLRF      0x47,0x1                                                                                        
003580   0101     MOVLB     0x1                                                                                             
003582   6b48     CLRF      0x48,0x1                                                                                        
003584   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\init.c
                                           //*;###########################################################################  C:\fw\midicontroller\x011\hwcalls.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\hwcalls.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x011\hwcalls.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x011\hwcalls.c
                                           //;#			File Name: hwcalls.c   										  #                                      C:\fw\midicontroller\x011\hwcalls.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\hwcalls.c
                                           //;############################################################################  C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           #include "typedefs.h"                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
0024ba   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ADC_CONVERSION(unsigned char Channel) {                            C:\fw\midicontroller\x011\hwcalls.c
0024bc   ffe6                                                                                                               
0024be   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0024c0   ffd9                                                                                                               
0024c2   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char tempcntr;                                                         C:\fw\midicontroller\x011\hwcalls.c
0024c4   0efe     MOVLW     0xfe           	ADCON0 = Channel;                                                               C:\fw\midicontroller\x011\hwcalls.c
0024c6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0024c8   6ec2     MOVWF     0xc2,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //Wait for the converter's holding capacitor to charge up.                       C:\fw\midicontroller\x011\hwcalls.c
                                           ADC_CHARGING_DELAY_LOOP:                                                         C:\fw\midicontroller\x011\hwcalls.c
0024ca   0e0a     MOVLW     0xa            	for(tempcntr = 10;tempcntr!=0;tempcntr--);                                      C:\fw\midicontroller\x011\hwcalls.c
0024cc   6edf     MOVWF     0xdf,0x0                                                                                        
0024ce   50df     MOVF      0xdf,0x0,0x0                                                                                    
0024d0   e002     BZ        0x24d6                                                                                          
0024d2   06df     DECF      0xdf,0x1,0x0                                                                                    
0024d4   d7fc     BRA       0x24ce                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //Start the conversion                                                           C:\fw\midicontroller\x011\hwcalls.c
0024d6   82c2     BSF       0xc2,0x1,0x0   	ADCON0bits.GO = true;                                                           C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //Wait for the conversion to complete, then exit                                 C:\fw\midicontroller\x011\hwcalls.c
                                           ADC_CONVERSION_DELAY:                                                            C:\fw\midicontroller\x011\hwcalls.c
0024d8   b2c2     BTFSC     0xc2,0x1,0x0   	for(;ADCON0bits.GO;);                                                           C:\fw\midicontroller\x011\hwcalls.c
0024da   d7fe     BRA       0x24d8                                                                                          
                                           	                                                                                C:\fw\midicontroller\x011\hwcalls.c
0024dc   50c4     MOVF      0xc4,0x0,0x0   	return ADRESH;                                                                  C:\fw\midicontroller\x011\hwcalls.c
0024de   d000     BRA       0x24e0                                                                                          
0024e0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0024e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0024e4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024e6   ffd9                                                                                                               
0024e8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Send a single MIDI byte. */                                                   C:\fw\midicontroller\x011\hwcalls.c
0024ea   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_byte(u8 data) {                                                   C:\fw\midicontroller\x011\hwcalls.c
0024ec   ffe6                                                                                                               
0024ee   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0024f0   ffd9                                                                                                               
0024f2   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char temp;                                                             C:\fw\midicontroller\x011\hwcalls.c
                                           	//send out first byte.                                                          C:\fw\midicontroller\x011\hwcalls.c
0024f4   0efe     MOVLW     0xfe           	TXREG = data;                                                                   C:\fw\midicontroller\x011\hwcalls.c
0024f6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0024f8   6ead     MOVWF     0xad,0x0                                                                                        
0024fa   509e     MOVF      0x9e,0x0,0x0   	temp = PIR1;			//clear TXIF..                                                   C:\fw\midicontroller\x011\hwcalls.c
0024fc   6edf     MOVWF     0xdf,0x0                                                                                        
0024fe   a89e     BTFSS     0x9e,0x4,0x0   	while(!PIR1bits.TXIF);                                                          C:\fw\midicontroller\x011\hwcalls.c
002500   d7fe     BRA       0x24fe                                                                                          
002502   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
002504   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002506   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002508   ffd9                                                                                                               
00250a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //****************************************************************************** C:\fw\midicontroller\x011\hwcalls.c
                                           //JDunne 5/27/07 - Converted routine from assembly to C.  (used to be called SEND_TO_LATCHES) C:\fw\midicontroller\x011\hwcalls.c
                                           //------------------------------------------------------------------------------ C:\fw\midicontroller\x011\hwcalls.c
00250c   cfd9     MOVFF     0xfd9,0xfe6    void	SendDataToShiftReg(unsigned char dataToSend) {                              C:\fw\midicontroller\x011\hwcalls.c
00250e   ffe6                                                                                                               
002510   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002512   ffd9                                                                                                               
002514   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char DataCounter;                                                      C:\fw\midicontroller\x011\hwcalls.c
                                           //SEND_SPEC_TO_LATCHES                                                           C:\fw\midicontroller\x011\hwcalls.c
002516   0e08     MOVLW     0x8            	DataCounter = 8;								//Load number of bits to be transfered                  C:\fw\midicontroller\x011\hwcalls.c
002518   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //	bcf	SRCK_LAT_BIT						//Control clock signal, also prevent IIC start          C:\fw\midicontroller\x011\hwcalls.c
00251a   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Flush out garbage                              C:\fw\midicontroller\x011\hwcalls.c
00251c   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //STL_TRANSMIT_BIT                                                               C:\fw\midicontroller\x011\hwcalls.c
                                           	do {                                                                            C:\fw\midicontroller\x011\hwcalls.c
00251e   9289     BCF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = false;				//Clear strobe pin                           C:\fw\midicontroller\x011\hwcalls.c
002520   0efe     MOVLW     0xfe           		if (!chkbit(dataToSend, 7)) {		//MSB high?                                     C:\fw\midicontroller\x011\hwcalls.c
002522   bedb     BTFSC     0xdb,0x7,0x0                                                                                    
002524   d002     BRA       0x252a                                                                                          
002526   9689     BCF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = false;		//No, set data signal low                   C:\fw\midicontroller\x011\hwcalls.c
                                           		}                                                                              C:\fw\midicontroller\x011\hwcalls.c
002528   d001     BRA       0x252c         		else {								//MSB low?                                                       C:\fw\midicontroller\x011\hwcalls.c
00252a   8689     BSF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = true;		//No, release data signal                    C:\fw\midicontroller\x011\hwcalls.c
                                           		}                                                                              C:\fw\midicontroller\x011\hwcalls.c
00252c   cfdb     MOVFF     0xfdb,0xff3    		dataToSend <<=1;					//Shift next bit to MSB position                          C:\fw\midicontroller\x011\hwcalls.c
00252e   fff3                                                                                                               
002530   9ef3     BCF       0xf3,0x7,0x0                                                                                    
002532   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
002534   cff3     MOVFF     0xff3,0xfdb                                                                                     
002536   ffdb                                                                                                               
002538   8289     BSF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = true;                                                  C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //STL_RESET_CLOCK_LEVEL                                                          C:\fw\midicontroller\x011\hwcalls.c
00253a   06df     DECF      0xdf,0x1,0x0   	} while (--DataCounter!=0);				//All 8 bits transfered? No, go transfer next bit C:\fw\midicontroller\x011\hwcalls.c
00253c   e1f0     BNZ       0x251e                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //STL_STROBE                                                                     C:\fw\midicontroller\x011\hwcalls.c
00253e   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Strobe the data                                C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //STL_STROBE_DELAY                                                               C:\fw\midicontroller\x011\hwcalls.c
002540   0e10     MOVLW     0x10           	for (DataCounter = LATCH_STROBE_DELAY; DataCounter !=0;DataCounter--);		//Pause for data transfer from external latch_1's input to its output C:\fw\midicontroller\x011\hwcalls.c
002542   6edf     MOVWF     0xdf,0x0                                                                                        
002544   50df     MOVF      0xdf,0x0,0x0                                                                                    
002546   e002     BZ        0x254c                                                                                          
002548   06df     DECF      0xdf,0x1,0x0                                                                                    
00254a   d7fc     BRA       0x2544                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
00254c   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   C:\fw\midicontroller\x011\hwcalls.c
00254e   8689     BSF       0x89,0x3,0x0   	SHIFTREG_SER_IN_LAT_BIT = true;				//Release data signal                        C:\fw\midicontroller\x011\hwcalls.c
002550   8289     BSF       0x89,0x1,0x0   	SHIFTREG_SRCK_LAT_BIT = true;			//Release serial clk                            C:\fw\midicontroller\x011\hwcalls.c
002552   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
002554   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002556   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002558   ffd9                                                                                                               
00255a   0012     RETURN    0x0                                                                                             
                                           //------------------------------------------------------------------------------ C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //returns data into ButtonState.                                                 C:\fw\midicontroller\x011\hwcalls.c
00255c   cfd9     MOVFF     0xfd9,0xfe6    void	ReadButtons(void) {                                                         C:\fw\midicontroller\x011\hwcalls.c
00255e   ffe6                                                                                                               
002560   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002562   ffd9                                                                                                               
002564   0e04     MOVLW     0x4                                                                                             
002566   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char BtnAddress, bitloc, i;                                            C:\fw\midicontroller\x011\hwcalls.c
                                           	BitField TempButtons;                                                           C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           //the following only reads 7 buttons from the multiplexor, and the 8th from the pin directly. C:\fw\midicontroller\x011\hwcalls.c
                                           //the 7th bit of the multiplexor is the modeswitch which is read below.          C:\fw\midicontroller\x011\hwcalls.c
002568   52de     MOVF      0xde,0x1,0x0   	bitloc = 1;                                                                     C:\fw\midicontroller\x011\hwcalls.c
00256a   0e01     MOVLW     0x1                                                                                             
00256c   6edd     MOVWF     0xdd,0x0                                                                                        
00256e   0e03     MOVLW     0x3            	TempButtons.byte = 0;                                                           C:\fw\midicontroller\x011\hwcalls.c
002570   6adb     CLRF      0xdb,0x0                                                                                        
002572   6adf     CLRF      0xdf,0x0       	for (BtnAddress = 0;BtnAddress<=6;BtnAddress++) {                               C:\fw\midicontroller\x011\hwcalls.c
002574   50df     MOVF      0xdf,0x0,0x0                                                                                    
002576   0806     SUBLW     0x6                                                                                             
002578   e322     BNC       0x25be                                                                                          
0025ba   2adf     INCF      0xdf,0x1,0x0                                                                                    
0025bc   d7db     BRA       0x2574                                                                                          
00257a   cfdf     MOVFF     0xfdf,0xfe6    		SetDipAddress(BtnAddress);                                                     C:\fw\midicontroller\x011\hwcalls.c
00257c   ffe6                                                                                                               
00257e   d8dd     RCALL     0x273a                                                                                          
002580   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
002582   0e05     MOVLW     0x5            		for (i = BTN_SAMPLE_DELAY;i!=0;i--);		//delay for a sampling delay             C:\fw\midicontroller\x011\hwcalls.c
002584   6ef3     MOVWF     0xf3,0x0                                                                                        
002586   0e02     MOVLW     0x2                                                                                             
002588   cff3     MOVFF     0xff3,0xfdb                                                                                     
00258a   ffdb                                                                                                               
00258c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00258e   e003     BZ        0x2596                                                                                          
002590   0e02     MOVLW     0x2                                                                                             
002592   06db     DECF      0xdb,0x1,0x0                                                                                    
002594   d7fb     BRA       0x258c                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
002596   a284     BTFSS     0x84,0x1,0x0   		if (BTN_IN_PIN) TempButtons.byte |= bitloc;		//Or in the current bit if it is set. C:\fw\midicontroller\x011\hwcalls.c
002598   d009     BRA       0x25ac                                                                                          
00259a   0e03     MOVLW     0x3                                                                                             
00259c   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
00259e   ffe7                                                                                                               
0025a0   0e01     MOVLW     0x1                                                                                             
0025a2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0025a4   12e7     IORWF     0xe7,0x1,0x0                                                                                    
0025a6   0e03     MOVLW     0x3                                                                                             
0025a8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0025aa   ffdb                                                                                                               
0025ac   0e01     MOVLW     0x1            		bitloc <<= 1;										//shift the bit over to the next                        C:\fw\midicontroller\x011\hwcalls.c
0025ae   cfdb     MOVFF     0xfdb,0xff3                                                                                     
0025b0   fff3                                                                                                               
0025b2   9ef3     BCF       0xf3,0x7,0x0                                                                                    
0025b4   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
0025b6   cff3     MOVFF     0xff3,0xfdb                                                                                     
0025b8   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
0025be   0e03     MOVLW     0x3            	ButtonState = TempButtons.byte;                                                 C:\fw\midicontroller\x011\hwcalls.c
0025c0   cfdb     MOVFF     0xfdb,0x69                                                                                      
0025c2   f069                                                                                                               
0025c4   0100     MOVLB     0x0                                                                                             
0025c6   6b6a     CLRF      0x6a,0x1                                                                                        
0025c8   6b6b     CLRF      0x6b,0x1                                                                                        
0025ca   6b6c     CLRF      0x6c,0x1                                                                                        
0025cc   90d8     BCF       0xd8,0x0,0x0   	ButtonState <<=1;			//shift everything over one because the 0th bit is supposed C:\fw\midicontroller\x011\hwcalls.c
0025ce   3769     RLCF      0x69,0x1,0x1                                                                                    
0025d0   376a     RLCF      0x6a,0x1,0x1                                                                                    
0025d2   376b     RLCF      0x6b,0x1,0x1                                                                                    
0025d4   376c     RLCF      0x6c,0x1,0x1                                                                                    
                                           								//to be PRESET_1, which is on another pin.                               C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
0025d6   696a     SETF      0x6a,0x1       	ButtonState |= 0xFFFFFF00;                                                      C:\fw\midicontroller\x011\hwcalls.c
0025d8   696b     SETF      0x6b,0x1                                                                                        
0025da   696c     SETF      0x6c,0x1                                                                                        
0025dc   b881     BTFSC     0x81,0x4,0x0   	if (BTN_PRESET_1_PIN) setbit(ButtonState,0);                                    C:\fw\midicontroller\x011\hwcalls.c
0025de   8169     BSF       0x69,0x0,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           	//all buttons are backwards logic, so simply invert the state of ButtonState.   C:\fw\midicontroller\x011\hwcalls.c
0025e0   1f69     COMF      0x69,0x1,0x1   	ButtonState = ~ButtonState;                                                     C:\fw\midicontroller\x011\hwcalls.c
0025e2   1f6a     COMF      0x6a,0x1,0x1                                                                                    
0025e4   1f6b     COMF      0x6b,0x1,0x1                                                                                    
0025e6   1f6c     COMF      0x6c,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           	//read the 7th bit of the shift register.  (Which is the slider mode switch)    C:\fw\midicontroller\x011\hwcalls.c
0025e8   0e07     MOVLW     0x7            	BtnAddress = 0x07;                                                              C:\fw\midicontroller\x011\hwcalls.c
0025ea   6edf     MOVWF     0xdf,0x0                                                                                        
0025ec   cfdf     MOVFF     0xfdf,0xfe6    	SetDipAddress(BtnAddress);                                                      C:\fw\midicontroller\x011\hwcalls.c
0025ee   ffe6                                                                                                               
0025f0   d8a4     RCALL     0x273a                                                                                          
0025f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0025f4   0100     MOVLB     0x0            	ModeSwitchState = true;                                                         C:\fw\midicontroller\x011\hwcalls.c
0025f6   8161     BSF       0x61,0x0,0x1                                                                                    
0025f8   b284     BTFSC     0x84,0x1,0x0   	if (BTN_IN_PIN) ModeSwitchState = false;                                        C:\fw\midicontroller\x011\hwcalls.c
0025fa   9161     BCF       0x61,0x0,0x1                                                                                    
0025fc   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0025fe   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002600   e202     BC        0x2606                                                                                          
002602   6ae1     CLRF      0xe1,0x0                                                                                        
002604   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002606   6ee1     MOVWF     0xe1,0x0                                                                                        
002608   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00260a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00260c   ffd9                                                                                                               
00260e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           ///Average = ((Inst-Avg)/(2^Tau))+Avg                                            C:\fw\midicontroller\x011\hwcalls.c
002610   cfd9     MOVFF     0xfd9,0xfe6    TwoBytes Filtered2SampleAvg(TwoBytes Avg, unsigned char Inst, unsigned char Tau) { C:\fw\midicontroller\x011\hwcalls.c
002612   ffe6                                                                                                               
002614   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002616   ffd9                                                                                                               
002618   0e03     MOVLW     0x3                                                                                             
00261a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char positive;                                                         C:\fw\midicontroller\x011\hwcalls.c
                                           	TwoBytes diff;                                                                  C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
00261c   0e01     MOVLW     0x1            	diff.s_form = 0;                                                                C:\fw\midicontroller\x011\hwcalls.c
00261e   6adb     CLRF      0xdb,0x0                                                                                        
002620   0e02     MOVLW     0x2                                                                                             
002622   6adb     CLRF      0xdb,0x0                                                                                        
002624   0efe     MOVLW     0xfe           	if (Inst >= Avg.b_form.high) {                                                  C:\fw\midicontroller\x011\hwcalls.c
002626   50db     MOVF      0xdb,0x0,0x0                                                                                    
002628   6ef3     MOVWF     0xf3,0x0                                                                                        
00262a   0efc     MOVLW     0xfc                                                                                            
00262c   cfdb     MOVFF     0xfdb,0xff4                                                                                     
00262e   fff4                                                                                                               
002630   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002632   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002634   e30e     BNC       0x2652                                                                                          
002636   0efc     MOVLW     0xfc           		diff.b_form.high = Inst - Avg.b_form.high;                                     C:\fw\midicontroller\x011\hwcalls.c
002638   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00263a   ffe6                                                                                                               
00263c   0efe     MOVLW     0xfe                                                                                            
00263e   50db     MOVF      0xdb,0x0,0x0                                                                                    
002640   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002642   5ce7     SUBWF     0xe7,0x0,0x0                                                                                    
002644   6ee7     MOVWF     0xe7,0x0                                                                                        
002646   0e02     MOVLW     0x2                                                                                             
002648   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
00264a   ffdb                                                                                                               
00264c   0e00     MOVLW     0x0            		setbit(positive,0);                                                            C:\fw\midicontroller\x011\hwcalls.c
00264e   80df     BSF       0xdf,0x0,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\hwcalls.c
002650   d00d     BRA       0x266c         	else {                                                                          C:\fw\midicontroller\x011\hwcalls.c
002652   0efe     MOVLW     0xfe           		diff.b_form.high = Avg.b_form.high - Inst;                                     C:\fw\midicontroller\x011\hwcalls.c
002654   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
002656   ffe6                                                                                                               
002658   0efc     MOVLW     0xfc                                                                                            
00265a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00265c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00265e   5ce7     SUBWF     0xe7,0x0,0x0                                                                                    
002660   6ee7     MOVWF     0xe7,0x0                                                                                        
002662   0e02     MOVLW     0x2                                                                                             
002664   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002666   ffdb                                                                                                               
002668   0e00     MOVLW     0x0            		clrbit(positive,0);                                                            C:\fw\midicontroller\x011\hwcalls.c
00266a   90df     BCF       0xdf,0x0,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
00266c   0efb     MOVLW     0xfb           	diff.s_form >>= Tau;                                                            C:\fw\midicontroller\x011\hwcalls.c
00266e   cfdb     MOVFF     0xfdb,0x10                                                                                      
002670   f010                                                                                                               
002672   50d9     MOVF      0xd9,0x0,0x0                                                                                    
002674   0f01     ADDLW     0x1                                                                                             
002676   6ee9     MOVWF     0xe9,0x0                                                                                        
002678   cfda     MOVFF     0xfda,0xfea                                                                                     
00267a   ffea                                                                                                               
00267c   5010     MOVF      0x10,0x0,0x0                                                                                    
00267e   0b0f     ANDLW     0xf                                                                                             
002680   e006     BZ        0x268e                                                                                          
002682   52ec     MOVF      0xec,0x1,0x0                                                                                    
002684   90d8     BCF       0xd8,0x0,0x0                                                                                    
002686   32ed     RRCF      0xed,0x1,0x0                                                                                    
002688   32ef     RRCF      0xef,0x1,0x0                                                                                    
00268a   06e8     DECF      0xe8,0x1,0x0                                                                                    
00268c   e1fa     BNZ       0x2682                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
00268e   a0df     BTFSS     0xdf,0x0,0x0   	if (chkbit(positive,0)) {                                                       C:\fw\midicontroller\x011\hwcalls.c
002690   d011     BRA       0x26b4                                                                                          
002692   0e01     MOVLW     0x1            		Avg.s_form += diff.s_form;                                                     C:\fw\midicontroller\x011\hwcalls.c
002694   cfdb     MOVFF     0xfdb,0x10                                                                                      
002696   f010                                                                                                               
002698   0e02     MOVLW     0x2                                                                                             
00269a   cfdb     MOVFF     0xfdb,0x11                                                                                      
00269c   f011                                                                                                               
00269e   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0026a0   0ffd     ADDLW     0xfd                                                                                            
0026a2   6ee9     MOVWF     0xe9,0x0                                                                                        
0026a4   0eff     MOVLW     0xff                                                                                            
0026a6   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0026a8   6eea     MOVWF     0xea,0x0                                                                                        
0026aa   5010     MOVF      0x10,0x0,0x0                                                                                    
0026ac   26ee     ADDWF     0xee,0x1,0x0                                                                                    
0026ae   5011     MOVF      0x11,0x0,0x0                                                                                    
0026b0   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\hwcalls.c
0026b2   d010     BRA       0x26d4         	else {                                                                          C:\fw\midicontroller\x011\hwcalls.c
0026b4   0e01     MOVLW     0x1            		Avg.s_form -= diff.s_form;                                                     C:\fw\midicontroller\x011\hwcalls.c
0026b6   cfdb     MOVFF     0xfdb,0x10                                                                                      
0026b8   f010                                                                                                               
0026ba   0e02     MOVLW     0x2                                                                                             
0026bc   cfdb     MOVFF     0xfdb,0x11                                                                                      
0026be   f011                                                                                                               
0026c0   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0026c2   0ffd     ADDLW     0xfd                                                                                            
0026c4   6ee9     MOVWF     0xe9,0x0                                                                                        
0026c6   0eff     MOVLW     0xff                                                                                            
0026c8   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0026ca   6eea     MOVWF     0xea,0x0                                                                                        
0026cc   5010     MOVF      0x10,0x0,0x0                                                                                    
0026ce   5eee     SUBWF     0xee,0x1,0x0                                                                                    
0026d0   5011     MOVF      0x11,0x0,0x0                                                                                    
0026d2   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\hwcalls.c
0026d4   0efd     MOVLW     0xfd           	return Avg;                                                                     C:\fw\midicontroller\x011\hwcalls.c
0026d6   cfdb     MOVFF     0xfdb,0x10                                                                                      
0026d8   f010                                                                                                               
0026da   0efe     MOVLW     0xfe                                                                                            
0026dc   cfdb     MOVFF     0xfdb,0x11                                                                                      
0026de   f011                                                                                                               
0026e0   c010     MOVFF     0x10,0xff3                                                                                      
0026e2   fff3                                                                                                               
0026e4   c011     MOVFF     0x11,0xff4                                                                                      
0026e6   fff4                                                                                                               
0026e8   0e03     MOVLW     0x3            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0026ea   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0026ec   e203     BC        0x26f4                                                                                          
0026ee   d000     BRA       0x26f0                                                                                          
0026f0   6ae1     CLRF      0xe1,0x0                                                                                        
0026f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0026f4   6ee1     MOVWF     0xe1,0x0                                                                                        
0026f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0026f8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0026fa   ffd9                                                                                                               
0026fc   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
0026fe   cfd9     MOVFF     0xfd9,0xfe6    void	Write64BytesProgMem(rom unsigned char *RomPtr, unsigned char *RamPtr) {     C:\fw\midicontroller\x011\hwcalls.c
002700   ffe6                                                                                                               
002702   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002704   ffd9                                                                                                               
002706   0efd     MOVLW     0xfd           	TBLPTR = (unsigned long)RomPtr;                                                 C:\fw\midicontroller\x011\hwcalls.c
002708   cfdb     MOVFF     0xfdb,0x10                                                                                      
00270a   f010                                                                                                               
00270c   0efe     MOVLW     0xfe                                                                                            
00270e   cfdb     MOVFF     0xfdb,0x11                                                                                      
002710   f011                                                                                                               
002712   6a12     CLRF      0x12,0x0                                                                                        
002714   6a13     CLRF      0x13,0x0                                                                                        
002716   c010     MOVFF     0x10,0xff6                                                                                      
002718   fff6                                                                                                               
00271a   c011     MOVFF     0x11,0xff7                                                                                      
00271c   fff7                                                                                                               
00271e   c012     MOVFF     0x12,0xff8                                                                                      
002720   fff8                                                                                                               
002722   0efb     MOVLW     0xfb           	FSR0 = (unsigned short)RamPtr;                                                  C:\fw\midicontroller\x011\hwcalls.c
002724   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002726   ffe9                                                                                                               
002728   0efc     MOVLW     0xfc                                                                                            
00272a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00272c   ffea                                                                                                               
00272e   ec6c     CALL      0x34d8,0x0     	WRITE_BLOCK_INTO_ROM();                                                         C:\fw\midicontroller\x011\hwcalls.c
002730   f01a                                                                                                               
002732   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
002734   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002736   ffd9                                                                                                               
002738   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
00273a   cfd9     MOVFF     0xfd9,0xfe6    void	SetDipAddress(unsigned char Address) {                                      C:\fw\midicontroller\x011\hwcalls.c
00273c   ffe6                                                                                                               
00273e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002740   ffd9                                                                                                               
002742   9889     BCF       0x89,0x4,0x0   	BTN_S0_LAT_BIT = false;                                                         C:\fw\midicontroller\x011\hwcalls.c
002744   9a89     BCF       0x89,0x5,0x0   	BTN_S1_LAT_BIT = false;                                                         C:\fw\midicontroller\x011\hwcalls.c
002746   908d     BCF       0x8d,0x0,0x0   	BTN_S2_LAT_BIT = false;                                                         C:\fw\midicontroller\x011\hwcalls.c
002748   0efe     MOVLW     0xfe           	if (chkbit(Address,0)) BTN_S0_LAT_BIT = true;                                   C:\fw\midicontroller\x011\hwcalls.c
00274a   b0db     BTFSC     0xdb,0x0,0x0                                                                                    
00274c   8889     BSF       0x89,0x4,0x0                                                                                    
00274e   b2db     BTFSC     0xdb,0x1,0x0   	if (chkbit(Address,1)) BTN_S1_LAT_BIT = true;                                   C:\fw\midicontroller\x011\hwcalls.c
002750   8a89     BSF       0x89,0x5,0x0                                                                                    
002752   b4db     BTFSC     0xdb,0x2,0x0   	if (chkbit(Address,2)) BTN_S2_LAT_BIT = true;                                   C:\fw\midicontroller\x011\hwcalls.c
002754   808d     BSF       0x8d,0x0,0x0                                                                                    
002756   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
002758   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00275a   ffd9                                                                                                               
00275c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* --------------- LED read-out display functions: */                            C:\fw\midicontroller\x011\hwcalls.c
00275e   cfd9     MOVFF     0xfd9,0xfe6    u32 fsw_poll(){                                                                  C:\fw\midicontroller\x011\hwcalls.c
002760   ffe6                                                                                                               
002762   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002764   ffd9                                                                                                               
002766   0e04     MOVLW     0x4                                                                                             
002768   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	FourBytes TempButtons;                                                          C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
00276a   6ade     CLRF      0xde,0x0       	TempButtons.l_form = 0;                                                         C:\fw\midicontroller\x011\hwcalls.c
00276c   6ade     CLRF      0xde,0x0                                                                                        
00276e   6ade     CLRF      0xde,0x0                                                                                        
002770   6add     CLRF      0xdd,0x0                                                                                        
002772   52dd     MOVF      0xdd,0x1,0x0                                                                                    
002774   52dd     MOVF      0xdd,0x1,0x0                                                                                    
002776   c069     MOVFF     0x69,0x10      	TempButtons.b_form.byte3 = ButtonState&0xF0;                                    C:\fw\midicontroller\x011\hwcalls.c
002778   f010                                                                                                               
00277a   c06a     MOVFF     0x6a,0x11                                                                                       
00277c   f011                                                                                                               
00277e   c06b     MOVFF     0x6b,0x12                                                                                       
002780   f012                                                                                                               
002782   c06c     MOVFF     0x6c,0x13                                                                                       
002784   f013                                                                                                               
002786   0ef0     MOVLW     0xf0                                                                                            
002788   1610     ANDWF     0x10,0x1,0x0                                                                                    
00278a   6a11     CLRF      0x11,0x0                                                                                        
00278c   6a12     CLRF      0x12,0x0                                                                                        
00278e   6a13     CLRF      0x13,0x0                                                                                        
002790   0e03     MOVLW     0x3                                                                                             
002792   c010     MOVFF     0x10,0xfdb                                                                                      
002794   ffdb                                                                                                               
002796   c069     MOVFF     0x69,0x10      	TempButtons.b_form.byte0 = ButtonState&0x0F;                                    C:\fw\midicontroller\x011\hwcalls.c
002798   f010                                                                                                               
00279a   c06a     MOVFF     0x6a,0x11                                                                                       
00279c   f011                                                                                                               
00279e   c06b     MOVFF     0x6b,0x12                                                                                       
0027a0   f012                                                                                                               
0027a2   c06c     MOVFF     0x6c,0x13                                                                                       
0027a4   f013                                                                                                               
0027a6   0e0f     MOVLW     0xf                                                                                             
0027a8   1610     ANDWF     0x10,0x1,0x0                                                                                    
0027aa   6a11     CLRF      0x11,0x0                                                                                        
0027ac   6a12     CLRF      0x12,0x0                                                                                        
0027ae   6a13     CLRF      0x13,0x0                                                                                        
0027b0   5010     MOVF      0x10,0x0,0x0                                                                                    
0027b2   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
0027b4   cfdf     MOVFF     0xfdf,0x10     	return TempButtons.l_form;                                                      C:\fw\midicontroller\x011\hwcalls.c
0027b6   f010                                                                                                               
0027b8   0e01     MOVLW     0x1                                                                                             
0027ba   cfdb     MOVFF     0xfdb,0x11                                                                                      
0027bc   f011                                                                                                               
0027be   c010     MOVFF     0x10,0xff3                                                                                      
0027c0   fff3                                                                                                               
0027c2   c011     MOVFF     0x11,0xff4                                                                                      
0027c4   fff4                                                                                                               
0027c6   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0027c8   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0027ca   e203     BC        0x27d2                                                                                          
0027cc   d000     BRA       0x27ce                                                                                          
0027ce   6ae1     CLRF      0xe1,0x0                                                                                        
0027d0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027d2   6ee1     MOVWF     0xe1,0x0                                                                                        
0027d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027d6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0027d8   ffd9                                                                                                               
0027da   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           void	UpdateLeds(void) {                                                          C:\fw\midicontroller\x011\hwcalls.c
0027dc   c068     MOVFF     0x68,0xfe6     	SendDataToShiftReg(LedStates);                                                  C:\fw\midicontroller\x011\hwcalls.c
0027de   ffe6                                                                                                               
0027e0   de95     RCALL     0x250c                                                                                          
0027e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027e4   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
                                           /* Set currently active program foot-switch's LED indicator and disable all others */ C:\fw\midicontroller\x011\hwcalls.c
0027e6   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_set_active(int idx){                                                C:\fw\midicontroller\x011\hwcalls.c
0027e8   ffe6                                                                                                               
0027ea   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0027ec   ffd9                                                                                                               
0027ee   0100     MOVLB     0x0            	LedStates = 0;                                                                  C:\fw\midicontroller\x011\hwcalls.c
0027f0   6b68     CLRF      0x68,0x1                                                                                        
0027f2   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          C:\fw\midicontroller\x011\hwcalls.c
0027f4   6ef3     MOVWF     0xf3,0x0                                                                                        
0027f6   0efd     MOVLW     0xfd                                                                                            
0027f8   50db     MOVF      0xdb,0x0,0x0                                                                                    
0027fa   e004     BZ        0x2804                                                                                          
0027fc   90d8     BCF       0xd8,0x0,0x0                                                                                    
0027fe   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002800   06e8     DECF      0xe8,0x1,0x0                                                                                    
002802   e1fc     BNZ       0x27fc                                                                                          
002804   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002806   0100     MOVLB     0x0                                                                                             
002808   1368     IORWF     0x68,0x1,0x1                                                                                    
00280a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
00280c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00280e   ffd9                                                                                                               
002810   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Explicitly enable a single LED without affecting the others */                C:\fw\midicontroller\x011\hwcalls.c
002812   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_enable(int idx){                                                    C:\fw\midicontroller\x011\hwcalls.c
002814   ffe6                                                                                                               
002816   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002818   ffd9                                                                                                               
00281a   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          C:\fw\midicontroller\x011\hwcalls.c
00281c   6ef3     MOVWF     0xf3,0x0                                                                                        
00281e   0efd     MOVLW     0xfd                                                                                            
002820   50db     MOVF      0xdb,0x0,0x0                                                                                    
002822   e004     BZ        0x282c                                                                                          
002824   90d8     BCF       0xd8,0x0,0x0                                                                                    
002826   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002828   06e8     DECF      0xe8,0x1,0x0                                                                                    
00282a   e1fc     BNZ       0x2824                                                                                          
00282c   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00282e   0100     MOVLB     0x0                                                                                             
002830   1368     IORWF     0x68,0x1,0x1                                                                                    
002832   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
002834   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002836   ffd9                                                                                                               
002838   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Explicitly disable a single LED without affecting the others */               C:\fw\midicontroller\x011\hwcalls.c
00283a   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_disable(int idx){                                                   C:\fw\midicontroller\x011\hwcalls.c
00283c   ffe6                                                                                                               
00283e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002840   ffd9                                                                                                               
002842   0e01     MOVLW     0x1            	clrbit(LedStates,idx);                                                          C:\fw\midicontroller\x011\hwcalls.c
002844   6ef3     MOVWF     0xf3,0x0                                                                                        
002846   0efd     MOVLW     0xfd                                                                                            
002848   50db     MOVF      0xdb,0x0,0x0                                                                                    
00284a   e004     BZ        0x2854                                                                                          
00284c   90d8     BCF       0xd8,0x0,0x0                                                                                    
00284e   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002850   06e8     DECF      0xe8,0x1,0x0                                                                                    
002852   e1fc     BNZ       0x284c                                                                                          
002854   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002856   6e10     MOVWF     0x10,0x0                                                                                        
002858   6a11     CLRF      0x11,0x0                                                                                        
00285a   be10     BTFSC     0x10,0x7,0x0                                                                                    
00285c   6811     SETF      0x11,0x0                                                                                        
00285e   0eff     MOVLW     0xff                                                                                            
002860   1810     XORWF     0x10,0x0,0x0                                                                                    
002862   0100     MOVLB     0x0                                                                                             
002864   1768     ANDWF     0x68,0x1,0x1                                                                                    
002866   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
002868   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00286a   ffd9                                                                                                               
00286c   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Poll the slider switch to see which mode we're in: */                         C:\fw\midicontroller\x011\hwcalls.c
                                           u8 slider_poll(){                                                                C:\fw\midicontroller\x011\hwcalls.c
00286e   0100     MOVLB     0x0            	return	ModeSwitchState;                                                         C:\fw\midicontroller\x011\hwcalls.c
002870   5161     MOVF      0x61,0x0,0x1                                                                                    
002872   0b01     ANDLW     0x1                                                                                             
002874   d000     BRA       0x2876                                                                                          
002876   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Poll the expression pedal's data (0-127): */                                  C:\fw\midicontroller\x011\hwcalls.c
                                           u8 expr_poll(){                                                                  C:\fw\midicontroller\x011\hwcalls.c
                                           	                                                                                C:\fw\midicontroller\x011\hwcalls.c
002878   0e01     MOVLW     0x1            	ADC_CONVERSION(EXP_PEDAL_CHANNEL);                                              C:\fw\midicontroller\x011\hwcalls.c
00287a   6ee6     MOVWF     0xe6,0x0                                                                                        
00287c   de1e     RCALL     0x24ba                                                                                          
00287e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002880   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* --------------- Data persistence functions: */                                C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Gets number of stored banks */                                                C:\fw\midicontroller\x011\hwcalls.c
                                           u16 banks_count(){                                                               C:\fw\midicontroller\x011\hwcalls.c
002882   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Loads a bank into the specified arrays: */                                    C:\fw\midicontroller\x011\hwcalls.c
002884   cfd9     MOVFF     0xfd9,0xfe6    void bank_load(u16 bank_index, char name[BANK_NAME_MAXLENGTH], u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 *bankmap_count){ C:\fw\midicontroller\x011\hwcalls.c
002886   ffe6                                                                                                               
002888   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00288a   ffd9                                                                                                               
00288c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
00288e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002890   ffd9                                                                                                               
002892   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Stores the programs back to the bank: */                                      C:\fw\midicontroller\x011\hwcalls.c
002894   cfd9     MOVFF     0xfd9,0xfe6    void bank_store(u16 bank_index, u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 bankmap_count){ C:\fw\midicontroller\x011\hwcalls.c
002896   ffe6                                                                                                               
002898   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00289a   ffd9                                                                                                               
00289c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
00289e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028a0   ffd9                                                                                                               
0028a2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Load bank name for browsing through banks: */                                 C:\fw\midicontroller\x011\hwcalls.c
0028a4   cfd9     MOVFF     0xfd9,0xfe6    void bank_loadname(u16 bank_index, char name[BANK_NAME_MAXLENGTH]){              C:\fw\midicontroller\x011\hwcalls.c
0028a6   ffe6                                                                                                               
0028a8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028aa   ffd9                                                                                                               
0028ac   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0028ae   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028b0   ffd9                                                                                                               
0028b2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Get the alphabetically sorted bank index */                                   C:\fw\midicontroller\x011\hwcalls.c
0028b4   cfd9     MOVFF     0xfd9,0xfe6    u16 bank_getsortedindex(u16 sort_index){                                         C:\fw\midicontroller\x011\hwcalls.c
0028b6   ffe6                                                                                                               
0028b8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028ba   ffd9                                                                                                               
0028bc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0028be   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028c0   ffd9                                                                                                               
0028c2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* --------------- MIDI I/O functions: */                                        C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /* Send formatted MIDI commands.                                                 C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                               0 <= cmd <= F       - MIDI command                                           C:\fw\midicontroller\x011\hwcalls.c
                                               0 <= channel <= F   - MIDI channel to send command to                        C:\fw\midicontroller\x011\hwcalls.c
                                               00 <= data1 <= FF   - first data byte of MIDI command                        C:\fw\midicontroller\x011\hwcalls.c
                                               00 <= data2 <= FF   - second (optional) data byte of MIDI command            C:\fw\midicontroller\x011\hwcalls.c
                                           */                                                                               C:\fw\midicontroller\x011\hwcalls.c
0028c4   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd1(u8 cmd, u8 channel, u8 data1){                               C:\fw\midicontroller\x011\hwcalls.c
0028c6   ffe6                                                                                                               
0028c8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028ca   ffd9                                                                                                               
0028cc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0028ce   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028d0   ffd9                                                                                                               
0028d2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
0028d4   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd2(u8 cmd, u8 channel, u8 data1, u8 data2){                     C:\fw\midicontroller\x011\hwcalls.c
0028d6   ffe6                                                                                                               
0028d8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028da   ffd9                                                                                                               
0028dc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\hwcalls.c
0028de   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028e0   ffd9                                                                                                               
0028e2   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                                                                                                            C:\fw\midicontroller\x011\hwcalls.c
                                           /*                                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	A programmable MIDI foot controller.                                            C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	Written by James S. Dunne                                                       C:\fw\midicontroller\x011\controller.c
                                           	04/05/2007                                                                      C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	Possible hardware layout diagram:                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	(o)     = SPST rugged foot-switch                                               C:\fw\midicontroller\x011\controller.c
                                           	(*)     = Single on/off LED                                                     C:\fw\midicontroller\x011\controller.c
                                           	[ ... ] = LED 7-segment (or more) display                                       C:\fw\midicontroller\x011\controller.c
                                           	{\}		= slider switch                                                            C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                            PWR  MIDI OUT EXPR IN (opt)                                                     C:\fw\midicontroller\x011\controller.c
                                             |      ||      ||                                                              C:\fw\midicontroller\x011\controller.c
                                           /--------------------\                                                           C:\fw\midicontroller\x011\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x011\controller.c
                                           | [8 8 8 8] {\}  [8] |                                                           C:\fw\midicontroller\x011\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x011\controller.c
                                           | (*)  (*)  (*)  (*) |                                                           C:\fw\midicontroller\x011\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           C:\fw\midicontroller\x011\controller.c
                                           |  1    2    3    4  |                                                           C:\fw\midicontroller\x011\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x011\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           C:\fw\midicontroller\x011\controller.c
                                           | DEC  INC  ENTR NEXT|                                                           C:\fw\midicontroller\x011\controller.c
                                           |                    |                                                           C:\fw\midicontroller\x011\controller.c
                                           \--------------------/                                                           C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           NOTE:   CONCERT mode: Implement hold-down of preset button to                    C:\fw\midicontroller\x011\controller.c
                                           quick-switch to said preset, but on release switch back to last                  C:\fw\midicontroller\x011\controller.c
                                           preset.                                                                          C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           */                                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           #include "types.h"                                                               C:\fw\midicontroller\x011\controller.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           const u8 midi_channel = 0;                                                       C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           u8      bank[BANK_PRESET_COUNT];                                                 C:\fw\midicontroller\x011\controller.c
                                           u8		bankcontroller[BANK_PRESET_COUNT];                                           C:\fw\midicontroller\x011\controller.c
                                           u8		bankmap[BANK_MAP_COUNT];                                                     C:\fw\midicontroller\x011\controller.c
                                           u8		bankmap_count;                                                               C:\fw\midicontroller\x011\controller.c
                                           char	bankname[BANK_NAME_MAXLENGTH];                                              C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* current settings */                                                           C:\fw\midicontroller\x011\controller.c
                                           u8      curr_program;                                                            C:\fw\midicontroller\x011\controller.c
                                           u8      curr_preset;                                                             C:\fw\midicontroller\x011\controller.c
                                           u8      curr_mapindex;                                                           C:\fw\midicontroller\x011\controller.c
                                           u16     curr_bank, loaded_bank;                                                  C:\fw\midicontroller\x011\controller.c
                                           u16		curr_sortedbank;                                                            C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           u16		bank_count;                                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           u32		preset_held = 0;                                                            C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* decrement timer in ms: */                                                     C:\fw\midicontroller\x011\controller.c
                                           u16		accel_time;                                                                 C:\fw\midicontroller\x011\controller.c
                                           u8		accel_count;                                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           u16		cdtimer_value = 0;                                                          C:\fw\midicontroller\x011\controller.c
                                           u16		cdtimer_flash = 0;                                                          C:\fw\midicontroller\x011\controller.c
                                           u16		cdtimer_store = 0;                                                          C:\fw\midicontroller\x011\controller.c
                                           u16		cdtimer_incdec_held = 0;                                                    C:\fw\midicontroller\x011\controller.c
                                           u16		cdtimer_holdenter = 0;                                                      C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           enum acceleration_state {                                                        C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_NONE,                                                                     C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_INC_SLOW,                                                                 C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_INC_MEDIUM,                                                               C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_INC_FAST,                                                                 C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_DEC_SLOW,                                                                 C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_DEC_MEDIUM,                                                               C:\fw\midicontroller\x011\controller.c
                                           	ACCEL_DEC_FAST                                                                  C:\fw\midicontroller\x011\controller.c
                                           } accel_state = ACCEL_NONE;                                                      C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           enum flashing_led_state {                                                        C:\fw\midicontroller\x011\controller.c
                                           	FLASH_NONE,                                                                     C:\fw\midicontroller\x011\controller.c
                                           	FLASH_STORE,                                                                    C:\fw\midicontroller\x011\controller.c
                                           	FLASH_BANK_SELECT_MODE,                                                         C:\fw\midicontroller\x011\controller.c
                                           	FLASH_PRGM_SELECT_MODE                                                          C:\fw\midicontroller\x011\controller.c
                                           } flash_state = FLASH_NONE;                                                      C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           enum program_modes {                                                             C:\fw\midicontroller\x011\controller.c
                                           	PROGRAM_NONE,                                                                   C:\fw\midicontroller\x011\controller.c
                                           	PROGRAM_SEQUENCE,                                                               C:\fw\midicontroller\x011\controller.c
                                           	PROGRAM_COMPLETE                                                                C:\fw\midicontroller\x011\controller.c
                                           } program_mode = PROGRAM_NONE;                                                   C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           u8		flash_led = 0;                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* time period in ms before value is changed */                                  C:\fw\midicontroller\x011\controller.c
                                           const u16 accel_time_slow	= 15;                                                  C:\fw\midicontroller\x011\controller.c
                                           const u16 accel_time_medium	=  5;                                                C:\fw\midicontroller\x011\controller.c
                                           const u16 accel_time_fast	=  2;                                                  C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           const u16 value_flashtime	= 75;                                                  C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* concert/practice main mode switch */                                          C:\fw\midicontroller\x011\controller.c
                                           enum mainmode {                                                                  C:\fw\midicontroller\x011\controller.c
                                           	MODE_PRACTICE = 0,                                                              C:\fw\midicontroller\x011\controller.c
                                           	MODE_CONCERT = 1                                                                C:\fw\midicontroller\x011\controller.c
                                           } mode;                                                                          C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* convert integer to ASCII in fixed number of chars, right-aligned */           C:\fw\midicontroller\x011\controller.c
000b20   cfd9     MOVFF     0xfd9,0xfe6    void itoa_fixed(u8 n, char s[LEDS_MAX_ALPHAS]) {                                 C:\fw\midicontroller\x011\controller.c
000b22   ffe6                                                                                                               
000b24   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000b26   ffd9                                                                                                               
000b28   52e6     MOVF      0xe6,0x1,0x0                                                                                    
000b2a   0e03     MOVLW     0x3            	u8 i = LEDS_MAX_ALPHAS - 1;                                                     C:\fw\midicontroller\x011\controller.c
000b2c   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	do {                                                                            C:\fw\midicontroller\x011\controller.c
000b2e   0e0a     MOVLW     0xa            		s[i--] = (n%10) + '0';                                                         C:\fw\midicontroller\x011\controller.c
000b30   6e10     MOVWF     0x10,0x0                                                                                        
000b32   c010     MOVFF     0x10,0xc                                                                                        
000b34   f00c                                                                                                               
000b36   0efe     MOVLW     0xfe                                                                                            
000b38   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b3a   f007                                                                                                               
000b3c   ec19     CALL      0x3632,0x0                                                                                      
000b3e   f01b                                                                                                               
000b40   5003     MOVF      0x3,0x0,0x0                                                                                     
000b42   0f30     ADDLW     0x30                                                                                            
000b44   6ee6     MOVWF     0xe6,0x0                                                                                        
000b46   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b48   06df     DECF      0xdf,0x1,0x0                                                                                    
000b4a   6ee7     MOVWF     0xe7,0x0                                                                                        
000b4c   0efc     MOVLW     0xfc                                                                                            
000b4e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b50   ffe9                                                                                                               
000b52   0efd     MOVLW     0xfd                                                                                            
000b54   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b56   ffea                                                                                                               
000b58   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b5a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b5c   0e00     MOVLW     0x0                                                                                             
000b5e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000b60   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b62   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b64   6eef     MOVWF     0xef,0x0                                                                                        
000b66   0e0a     MOVLW     0xa            	} while ((n /= 10) > 0);                                                        C:\fw\midicontroller\x011\controller.c
000b68   6e10     MOVWF     0x10,0x0                                                                                        
000b6a   c010     MOVFF     0x10,0xc                                                                                        
000b6c   f00c                                                                                                               
000b6e   0efe     MOVLW     0xfe                                                                                            
000b70   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b72   f007                                                                                                               
000b74   ec19     CALL      0x3632,0x0                                                                                      
000b76   f01b                                                                                                               
000b78   0efe     MOVLW     0xfe                                                                                            
000b7a   c007     MOVFF     0x7,0xfdb                                                                                       
000b7c   ffdb                                                                                                               
000b7e   5007     MOVF      0x7,0x0,0x0                                                                                     
000b80   0800     SUBLW     0x0                                                                                             
000b82   e3d5     BNC       0xb2e                                                                                           
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* pad the left chars with spaces: */                                           C:\fw\midicontroller\x011\controller.c
000b84   50df     MOVF      0xdf,0x0,0x0   	for (;i > 0;--i) s[i] = ' ';                                                    C:\fw\midicontroller\x011\controller.c
000b86   0800     SUBLW     0x0                                                                                             
000b88   e210     BC        0xbaa                                                                                           
000b8a   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b8c   6ee7     MOVWF     0xe7,0x0                                                                                        
000b8e   0efc     MOVLW     0xfc                                                                                            
000b90   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b92   ffe9                                                                                                               
000b94   0efd     MOVLW     0xfd                                                                                            
000b96   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b98   ffea                                                                                                               
000b9a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b9c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b9e   0e00     MOVLW     0x0                                                                                             
000ba0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000ba2   0e20     MOVLW     0x20                                                                                            
000ba4   6eef     MOVWF     0xef,0x0                                                                                        
000ba6   06df     DECF      0xdf,0x1,0x0                                                                                    
000ba8   d7ed     BRA       0xb84                                                                                           
000baa   50df     MOVF      0xdf,0x0,0x0   	s[i] = ' ';                                                                     C:\fw\midicontroller\x011\controller.c
000bac   6ee7     MOVWF     0xe7,0x0                                                                                        
000bae   0efc     MOVLW     0xfc                                                                                            
000bb0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000bb2   ffe9                                                                                                               
000bb4   0efd     MOVLW     0xfd                                                                                            
000bb6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000bb8   ffea                                                                                                               
000bba   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000bbc   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000bbe   0e00     MOVLW     0x0                                                                                             
000bc0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000bc2   0e20     MOVLW     0x20                                                                                            
000bc4   6eef     MOVWF     0xef,0x0                                                                                        
000bc6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000bc8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bca   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000bcc   ffd9                                                                                                               
000bce   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* display a program value in decimal with a leading 'P': */                     C:\fw\midicontroller\x011\controller.c
000bd0   cfd9     MOVFF     0xfd9,0xfe6    void show_program() {                                                            C:\fw\midicontroller\x011\controller.c
000bd2   ffe6                                                                                                               
000bd4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bd6   ffd9                                                                                                               
000bd8   0e04     MOVLW     0x4                                                                                             
000bda   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	char	a[LEDS_MAX_ALPHAS];                                                        C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* convert curr_program to ASCII: */                                            C:\fw\midicontroller\x011\controller.c
000bdc   cfd9     MOVFF     0xfd9,0xfe6    	itoa_fixed(curr_program + 1, a);                                                C:\fw\midicontroller\x011\controller.c
000bde   ffe6                                                                                                               
000be0   cfda     MOVFF     0xfda,0xfe6                                                                                     
000be2   ffe6                                                                                                               
000be4   0101     MOVLB     0x1                                                                                             
000be6   2915     INCF      0x15,0x0,0x1                                                                                    
000be8   6ee6     MOVWF     0xe6,0x0                                                                                        
000bea   df9a     RCALL     0xb20                                                                                           
000bec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bf0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* leading 'P' char: */                                                         C:\fw\midicontroller\x011\controller.c
000bf2   0e50     MOVLW     0x50           	a[0] = 'P';                                                                     C:\fw\midicontroller\x011\controller.c
000bf4   6edf     MOVWF     0xdf,0x0                                                                                        
000bf6   cfd9     MOVFF     0xfd9,0xfe6    	leds_show_4alphas(a);                                                           C:\fw\midicontroller\x011\controller.c
000bf8   ffe6                                                                                                               
000bfa   cfda     MOVFF     0xfda,0xfe6                                                                                     
000bfc   ffe6                                                                                                               
000bfe   ec43     CALL      0x2a86,0x0                                                                                      
000c00   f015                                                                                                               
000c02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c04   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* start timer to revert the display: */                                        C:\fw\midicontroller\x011\controller.c
000c06   c13b     MOVFF     0x13b,0x127    	cdtimer_value = value_flashtime;                                                C:\fw\midicontroller\x011\controller.c
000c08   f127                                                                                                               
000c0a   c13c     MOVFF     0x13c,0x128                                                                                     
000c0c   f128                                                                                                               
000c0e   0e04     MOVLW     0x4            }                                                                                C:\fw\midicontroller\x011\controller.c
000c10   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000c12   e202     BC        0xc18                                                                                           
000c14   6ae1     CLRF      0xe1,0x0                                                                                        
000c16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c18   6ee1     MOVWF     0xe1,0x0                                                                                        
000c1a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c1c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c1e   ffd9                                                                                                               
000c20   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* send the MIDI program change message */                                       C:\fw\midicontroller\x011\controller.c
000c22   cfd9     MOVFF     0xfd9,0xfe6    void program_activate(u8 notify) {                                               C:\fw\midicontroller\x011\controller.c
000c24   ffe6                                                                                                               
000c26   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c28   ffd9                                                                                                               
000c2a   c115     MOVFF     0x115,0xfe6    	midi_send_cmd1(0xC, midi_channel, curr_program);                                C:\fw\midicontroller\x011\controller.c
000c2c   ffe6                                                                                                               
000c2e   c124     MOVFF     0x124,0xfe6                                                                                     
000c30   ffe6                                                                                                               
000c32   0e0c     MOVLW     0xc                                                                                             
000c34   6ee6     MOVWF     0xe6,0x0                                                                                        
000c36   ec62     CALL      0x28c4,0x0                                                                                      
000c38   f014                                                                                                               
000c3a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c3c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c40   0efe     MOVLW     0xfe           	if (notify) {                                                                   C:\fw\midicontroller\x011\controller.c
000c42   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c44   e001     BZ        0xc48                                                                                           
                                           		/* show the program value: */                                                  C:\fw\midicontroller\x011\controller.c
000c46   dfc4     RCALL     0xbd0          		show_program();                                                                C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
000c48   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000c4a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c4c   ffd9                                                                                                               
000c4e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* activate current preset */                                                    C:\fw\midicontroller\x011\controller.c
000c50   cfd9     MOVFF     0xfd9,0xfe6    void preset_activate(u8 notify) {                                                C:\fw\midicontroller\x011\controller.c
000c52   ffe6                                                                                                               
000c54   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c56   ffd9                                                                                                               
                                           	/* grab the program # from the bank */                                          C:\fw\midicontroller\x011\controller.c
000c58   0101     MOVLB     0x1            	curr_program = bank[curr_preset];                                               C:\fw\midicontroller\x011\controller.c
000c5a   5116     MOVF      0x16,0x0,0x1                                                                                    
000c5c   6aea     CLRF      0xea,0x0                                                                                        
000c5e   0f00     ADDLW     0x0                                                                                             
000c60   6ee9     MOVWF     0xe9,0x0                                                                                        
000c62   0e01     MOVLW     0x1                                                                                             
000c64   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c66   cfef     MOVFF     0xfef,0x115                                                                                     
000c68   f115                                                                                                               
000c6a   0efe     MOVLW     0xfe           	program_activate(notify);                                                       C:\fw\midicontroller\x011\controller.c
000c6c   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000c6e   ffe6                                                                                                               
000c70   dfd8     RCALL     0xc22                                                                                           
000c72   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* activate the footswitch LED: */                                              C:\fw\midicontroller\x011\controller.c
000c74   0101     MOVLB     0x1            	fsw_led_set_active(curr_preset);                                                C:\fw\midicontroller\x011\controller.c
000c76   5116     MOVF      0x16,0x0,0x1                                                                                    
000c78   6ee6     MOVWF     0xe6,0x0                                                                                        
000c7a   6ae6     CLRF      0xe6,0x0                                                                                        
000c7c   ecf3     CALL      0x27e6,0x0                                                                                      
000c7e   f013                                                                                                               
000c80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c82   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c84   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000c86   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c88   ffd9                                                                                                               
000c8a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* display the sequence index on the 1-digit LED display: */                     C:\fw\midicontroller\x011\controller.c
                                           void bankmap_show() {                                                            C:\fw\midicontroller\x011\controller.c
000c8c   0101     MOVLB     0x1            	leds_show_1digit(curr_mapindex + 1);                                            C:\fw\midicontroller\x011\controller.c
000c8e   2917     INCF      0x17,0x0,0x1                                                                                    
000c90   6ee6     MOVWF     0xe6,0x0                                                                                        
000c92   ec7e     CALL      0x2afc,0x0                                                                                      
000c94   f015                                                                                                               
000c96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c98   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* activate the preset for the current bank map index */                         C:\fw\midicontroller\x011\controller.c
000c9a   cfd9     MOVFF     0xfd9,0xfe6    void bankmap_activate(u8 notify) {                                               C:\fw\midicontroller\x011\controller.c
000c9c   ffe6                                                                                                               
000c9e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ca0   ffd9                                                                                                               
                                           	/* switch preset */                                                             C:\fw\midicontroller\x011\controller.c
000ca2   c118     MOVFF     0x118,0x11a    	loaded_bank = curr_bank;                                                        C:\fw\midicontroller\x011\controller.c
000ca4   f11a                                                                                                               
000ca6   c119     MOVFF     0x119,0x11b                                                                                     
000ca8   f11b                                                                                                               
000caa   0101     MOVLB     0x1            	curr_preset = bankmap[curr_mapindex];                                           C:\fw\midicontroller\x011\controller.c
000cac   5117     MOVF      0x17,0x0,0x1                                                                                    
000cae   6aea     CLRF      0xea,0x0                                                                                        
000cb0   0f08     ADDLW     0x8                                                                                             
000cb2   6ee9     MOVWF     0xe9,0x0                                                                                        
000cb4   0e01     MOVLW     0x1                                                                                             
000cb6   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000cb8   cfef     MOVFF     0xfef,0x116                                                                                     
000cba   f116                                                                                                               
000cbc   0efe     MOVLW     0xfe           	preset_activate(notify);                                                        C:\fw\midicontroller\x011\controller.c
000cbe   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000cc0   ffe6                                                                                                               
000cc2   dfc6     RCALL     0xc50                                                                                           
000cc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* always show the bank map index */                                            C:\fw\midicontroller\x011\controller.c
000cc6   dfe2     RCALL     0xc8c          	bankmap_show();                                                                 C:\fw\midicontroller\x011\controller.c
000cc8   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000cca   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ccc   ffd9                                                                                                               
000cce   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* load current bank but do not switch to a preset */                            C:\fw\midicontroller\x011\controller.c
000cd0   cfd9     MOVFF     0xfd9,0xfe6    void bank_activate(u8 notify) {                                                  C:\fw\midicontroller\x011\controller.c
000cd2   ffe6                                                                                                               
000cd4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000cd6   ffd9                                                                                                               
                                           	/* load up the selected bank: */                                                C:\fw\midicontroller\x011\controller.c
000cd8   0e10     MOVLW     0x10           	bank_load(curr_bank, bankname, bank, bankcontroller, bankmap, &bankmap_count);  C:\fw\midicontroller\x011\controller.c
000cda   6ee6     MOVWF     0xe6,0x0                                                                                        
000cdc   0e01     MOVLW     0x1                                                                                             
000cde   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce0   0e08     MOVLW     0x8                                                                                             
000ce2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce4   0e01     MOVLW     0x1                                                                                             
000ce6   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce8   0e04     MOVLW     0x4                                                                                             
000cea   6ee6     MOVWF     0xe6,0x0                                                                                        
000cec   0e01     MOVLW     0x1                                                                                             
000cee   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf0   0e00     MOVLW     0x0                                                                                             
000cf2   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf4   0e01     MOVLW     0x1                                                                                             
000cf6   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf8   0e11     MOVLW     0x11                                                                                            
000cfa   6ee6     MOVWF     0xe6,0x0                                                                                        
000cfc   0e01     MOVLW     0x1                                                                                             
000cfe   6ee6     MOVWF     0xe6,0x0                                                                                        
000d00   c118     MOVFF     0x118,0xfe6                                                                                     
000d02   ffe6                                                                                                               
000d04   c119     MOVFF     0x119,0xfe6                                                                                     
000d06   ffe6                                                                                                               
000d08   ec42     CALL      0x2884,0x0                                                                                      
000d0a   f014                                                                                                               
000d0c   6e10     MOVWF     0x10,0x0                                                                                        
000d0e   0e0c     MOVLW     0xc                                                                                             
000d10   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000d12   5010     MOVF      0x10,0x0,0x0                                                                                    
000d14   0101     MOVLB     0x1            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x011\controller.c
000d16   6b17     CLRF      0x17,0x1                                                                                        
                                           	/* always show the bank map index */                                            C:\fw\midicontroller\x011\controller.c
000d18   2917     INCF      0x17,0x0,0x1   	leds_show_1digit(curr_mapindex + 1);                                            C:\fw\midicontroller\x011\controller.c
000d1a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d1c   ec7e     CALL      0x2afc,0x0                                                                                      
000d1e   f015                                                                                                               
000d20   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d22   0efe     MOVLW     0xfe           	if (notify) {                                                                   C:\fw\midicontroller\x011\controller.c
000d24   50db     MOVF      0xdb,0x0,0x0                                                                                    
000d26   e008     BZ        0xd38                                                                                           
                                           		/* display bank name: */                                                       C:\fw\midicontroller\x011\controller.c
000d28   0e11     MOVLW     0x11           		leds_show_4alphas(bankname);                                                   C:\fw\midicontroller\x011\controller.c
000d2a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d2c   0e01     MOVLW     0x1                                                                                             
000d2e   6ee6     MOVWF     0xe6,0x0                                                                                        
000d30   ec43     CALL      0x2a86,0x0                                                                                      
000d32   f015                                                                                                               
000d34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d36   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
000d38   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000d3a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d3c   ffd9                                                                                                               
000d3e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* load the real bank # from the sorted index */                                 C:\fw\midicontroller\x011\controller.c
000d40   cfd9     MOVFF     0xfd9,0xfe6    void sortedbank_activate(u8 notify) {                                            C:\fw\midicontroller\x011\controller.c
000d42   ffe6                                                                                                               
000d44   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d46   ffd9                                                                                                               
000d48   c11c     MOVFF     0x11c,0xfe6    	curr_bank = bank_getsortedindex(curr_sortedbank);                               C:\fw\midicontroller\x011\controller.c
000d4a   ffe6                                                                                                               
000d4c   c11d     MOVFF     0x11d,0xfe6                                                                                     
000d4e   ffe6                                                                                                               
000d50   ec5a     CALL      0x28b4,0x0                                                                                      
000d52   f014                                                                                                               
000d54   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d56   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d58   cff3     MOVFF     0xff3,0x118                                                                                     
000d5a   f118                                                                                                               
000d5c   cff4     MOVFF     0xff4,0x119                                                                                     
000d5e   f119                                                                                                               
000d60   0efe     MOVLW     0xfe           	bank_activate(notify);                                                          C:\fw\midicontroller\x011\controller.c
000d62   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000d64   ffe6                                                                                                               
000d66   dfb4     RCALL     0xcd0                                                                                           
000d68   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d6a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000d6c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d6e   ffd9                                                                                                               
000d70   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* load only current bank name and display it on 4-digit display */              C:\fw\midicontroller\x011\controller.c
                                           void bank_showname() {                                                           C:\fw\midicontroller\x011\controller.c
000d72   0e11     MOVLW     0x11           	bank_loadname(curr_bank, bankname);                                             C:\fw\midicontroller\x011\controller.c
000d74   6ee6     MOVWF     0xe6,0x0                                                                                        
000d76   0e01     MOVLW     0x1                                                                                             
000d78   6ee6     MOVWF     0xe6,0x0                                                                                        
000d7a   c118     MOVFF     0x118,0xfe6                                                                                     
000d7c   ffe6                                                                                                               
000d7e   c119     MOVFF     0x119,0xfe6                                                                                     
000d80   ffe6                                                                                                               
000d82   ec52     CALL      0x28a4,0x0                                                                                      
000d84   f014                                                                                                               
000d86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8e   0e11     MOVLW     0x11           	leds_show_4alphas(bankname);                                                    C:\fw\midicontroller\x011\controller.c
000d90   6ee6     MOVWF     0xe6,0x0                                                                                        
000d92   0e01     MOVLW     0x1                                                                                             
000d94   6ee6     MOVWF     0xe6,0x0                                                                                        
000d96   ec43     CALL      0x2a86,0x0                                                                                      
000d98   f015                                                                                                               
000d9a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9e   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* load only current bank name from the sorted index and display it on 4-digit display */ C:\fw\midicontroller\x011\controller.c
                                           void sortedbank_showname() {                                                     C:\fw\midicontroller\x011\controller.c
000da0   0101     MOVLB     0x1            	if (program_mode != PROGRAM_NONE) {                                             C:\fw\midicontroller\x011\controller.c
000da2   5133     MOVF      0x33,0x0,0x1                                                                                    
000da4   e009     BZ        0xdb8                                                                                           
000da6   0e62     MOVLW     0x62           		leds_show_4alphas("SEQ-");                                                     C:\fw\midicontroller\x011\controller.c
000da8   6ee6     MOVWF     0xe6,0x0                                                                                        
000daa   0e36     MOVLW     0x36                                                                                            
000dac   6ee6     MOVWF     0xe6,0x0                                                                                        
000dae   ec43     CALL      0x2a86,0x0                                                                                      
000db0   f015                                                                                                               
000db2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db6   d022     BRA       0xdfc          	} else {                                                                        C:\fw\midicontroller\x011\controller.c
000db8   c11c     MOVFF     0x11c,0xfe6    		curr_bank = bank_getsortedindex(curr_sortedbank);                              C:\fw\midicontroller\x011\controller.c
000dba   ffe6                                                                                                               
000dbc   c11d     MOVFF     0x11d,0xfe6                                                                                     
000dbe   ffe6                                                                                                               
000dc0   ec5a     CALL      0x28b4,0x0                                                                                      
000dc2   f014                                                                                                               
000dc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dc6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dc8   cff3     MOVFF     0xff3,0x118                                                                                     
000dca   f118                                                                                                               
000dcc   cff4     MOVFF     0xff4,0x119                                                                                     
000dce   f119                                                                                                               
000dd0   0e11     MOVLW     0x11           		bank_loadname(curr_bank, bankname);                                            C:\fw\midicontroller\x011\controller.c
000dd2   6ee6     MOVWF     0xe6,0x0                                                                                        
000dd4   0e01     MOVLW     0x1                                                                                             
000dd6   6ee6     MOVWF     0xe6,0x0                                                                                        
000dd8   c118     MOVFF     0x118,0xfe6                                                                                     
000dda   ffe6                                                                                                               
000ddc   c119     MOVFF     0x119,0xfe6                                                                                     
000dde   ffe6                                                                                                               
000de0   ec52     CALL      0x28a4,0x0                                                                                      
000de2   f014                                                                                                               
000de4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000de6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000de8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dec   0e11     MOVLW     0x11           		leds_show_4alphas(bankname);                                                   C:\fw\midicontroller\x011\controller.c
000dee   6ee6     MOVWF     0xe6,0x0                                                                                        
000df0   0e01     MOVLW     0x1                                                                                             
000df2   6ee6     MOVWF     0xe6,0x0                                                                                        
000df4   ec43     CALL      0x2a86,0x0                                                                                      
000df6   f015                                                                                                               
000df8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
000dfc   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* current and previous foot-switch states: */                                   C:\fw\midicontroller\x011\controller.c
                                           u32		sw_curr = 0, sw_last = 0;                                                   C:\fw\midicontroller\x011\controller.c
                                           u8		cc_curr = 0, cc_last = 0;                                                    C:\fw\midicontroller\x011\controller.c
                                           u8		switch_state = 0, store_state = 0;                                           C:\fw\midicontroller\x011\controller.c
                                           u8		incdec_mode = 0;                                                             C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* determine if a footswitch was pressed: */                                     C:\fw\midicontroller\x011\controller.c
000dfe   cfd9     MOVFF     0xfd9,0xfe6    u8 button_pressed(u32 mask) {                                                    C:\fw\midicontroller\x011\controller.c
000e00   ffe6                                                                                                               
000e02   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e04   ffd9                                                                                                               
000e06   0efd     MOVLW     0xfd           	return ((sw_curr & mask) == mask) && ((sw_last & mask) == 0);                   C:\fw\midicontroller\x011\controller.c
000e08   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e0a   0101     MOVLB     0x1                                                                                             
000e0c   153d     ANDWF     0x3d,0x0,0x1                                                                                    
000e0e   0100     MOVLB     0x0                                                                                             
000e10   6e10     MOVWF     0x10,0x0                                                                                        
000e12   0efe     MOVLW     0xfe                                                                                            
000e14   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e16   0101     MOVLB     0x1                                                                                             
000e18   153e     ANDWF     0x3e,0x0,0x1                                                                                    
000e1a   0100     MOVLB     0x0                                                                                             
000e1c   6e11     MOVWF     0x11,0x0                                                                                        
000e1e   0efd     MOVLW     0xfd                                                                                            
000e20   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e22   1810     XORWF     0x10,0x0,0x0                                                                                    
000e24   e103     BNZ       0xe2c                                                                                           
000e26   0efe     MOVLW     0xfe                                                                                            
000e28   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e2a   1811     XORWF     0x11,0x0,0x0                                                                                    
000e2c   e10f     BNZ       0xe4c                                                                                           
000e2e   0efd     MOVLW     0xfd                                                                                            
000e30   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e32   0101     MOVLB     0x1                                                                                             
000e34   153f     ANDWF     0x3f,0x0,0x1                                                                                    
000e36   0100     MOVLB     0x0                                                                                             
000e38   6e12     MOVWF     0x12,0x0                                                                                        
000e3a   0efe     MOVLW     0xfe                                                                                            
000e3c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e3e   0101     MOVLB     0x1                                                                                             
000e40   1540     ANDWF     0x40,0x0,0x1                                                                                    
000e42   0100     MOVLB     0x0                                                                                             
000e44   6e13     MOVWF     0x13,0x0                                                                                        
000e46   5012     MOVF      0x12,0x0,0x0                                                                                    
000e48   1013     IORWF     0x13,0x0,0x0                                                                                    
000e4a   e002     BZ        0xe50                                                                                           
000e4c   0e00     MOVLW     0x0                                                                                             
000e4e   d001     BRA       0xe52                                                                                           
000e50   0e01     MOVLW     0x1                                                                                             
000e52   d000     BRA       0xe54                                                                                           
000e54   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000e56   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e58   ffd9                                                                                                               
000e5a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* determine if still holding footswitch: */                                     C:\fw\midicontroller\x011\controller.c
000e5c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_held(u32 mask) {                                                       C:\fw\midicontroller\x011\controller.c
000e5e   ffe6                                                                                                               
000e60   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e62   ffd9                                                                                                               
000e64   0efd     MOVLW     0xfd           	return (sw_curr & mask) == mask;                                                C:\fw\midicontroller\x011\controller.c
000e66   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e68   0101     MOVLB     0x1                                                                                             
000e6a   153d     ANDWF     0x3d,0x0,0x1                                                                                    
000e6c   0100     MOVLB     0x0                                                                                             
000e6e   6e10     MOVWF     0x10,0x0                                                                                        
000e70   0efe     MOVLW     0xfe                                                                                            
000e72   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e74   0101     MOVLB     0x1                                                                                             
000e76   153e     ANDWF     0x3e,0x0,0x1                                                                                    
000e78   0100     MOVLB     0x0                                                                                             
000e7a   6e11     MOVWF     0x11,0x0                                                                                        
000e7c   0efd     MOVLW     0xfd                                                                                            
000e7e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e80   1810     XORWF     0x10,0x0,0x0                                                                                    
000e82   e103     BNZ       0xe8a                                                                                           
000e84   0efe     MOVLW     0xfe                                                                                            
000e86   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e88   1811     XORWF     0x11,0x0,0x0                                                                                    
000e8a   e002     BZ        0xe90                                                                                           
000e8c   0e00     MOVLW     0x0                                                                                             
000e8e   d001     BRA       0xe92                                                                                           
000e90   0e01     MOVLW     0x1                                                                                             
000e92   d000     BRA       0xe94                                                                                           
000e94   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000e96   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e98   ffd9                                                                                                               
000e9a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* determine if a footswitch was released: */                                    C:\fw\midicontroller\x011\controller.c
000e9c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_released(u32 mask) {                                                   C:\fw\midicontroller\x011\controller.c
000e9e   ffe6                                                                                                               
000ea0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ea2   ffd9                                                                                                               
000ea4   0efd     MOVLW     0xfd           	return ((sw_last & mask) == mask) && ((sw_curr & mask) == 0);                   C:\fw\midicontroller\x011\controller.c
000ea6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ea8   0101     MOVLB     0x1                                                                                             
000eaa   153f     ANDWF     0x3f,0x0,0x1                                                                                    
000eac   0100     MOVLB     0x0                                                                                             
000eae   6e10     MOVWF     0x10,0x0                                                                                        
000eb0   0efe     MOVLW     0xfe                                                                                            
000eb2   50db     MOVF      0xdb,0x0,0x0                                                                                    
000eb4   0101     MOVLB     0x1                                                                                             
000eb6   1540     ANDWF     0x40,0x0,0x1                                                                                    
000eb8   0100     MOVLB     0x0                                                                                             
000eba   6e11     MOVWF     0x11,0x0                                                                                        
000ebc   0efd     MOVLW     0xfd                                                                                            
000ebe   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ec0   1810     XORWF     0x10,0x0,0x0                                                                                    
000ec2   e103     BNZ       0xeca                                                                                           
000ec4   0efe     MOVLW     0xfe                                                                                            
000ec6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ec8   1811     XORWF     0x11,0x0,0x0                                                                                    
000eca   e10f     BNZ       0xeea                                                                                           
000ecc   0efd     MOVLW     0xfd                                                                                            
000ece   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ed0   0101     MOVLB     0x1                                                                                             
000ed2   153d     ANDWF     0x3d,0x0,0x1                                                                                    
000ed4   0100     MOVLB     0x0                                                                                             
000ed6   6e12     MOVWF     0x12,0x0                                                                                        
000ed8   0efe     MOVLW     0xfe                                                                                            
000eda   50db     MOVF      0xdb,0x0,0x0                                                                                    
000edc   0101     MOVLB     0x1                                                                                             
000ede   153e     ANDWF     0x3e,0x0,0x1                                                                                    
000ee0   0100     MOVLB     0x0                                                                                             
000ee2   6e13     MOVWF     0x13,0x0                                                                                        
000ee4   5012     MOVF      0x12,0x0,0x0                                                                                    
000ee6   1013     IORWF     0x13,0x0,0x0                                                                                    
000ee8   e002     BZ        0xeee                                                                                           
000eea   0e00     MOVLW     0x0                                                                                             
000eec   d001     BRA       0xef0                                                                                           
000eee   0e01     MOVLW     0x1                                                                                             
000ef0   d000     BRA       0xef2                                                                                           
000ef2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\controller.c
000ef4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ef6   ffd9                                                                                                               
000ef8   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* called every 10ms */                                                          C:\fw\midicontroller\x011\controller.c
                                           void controller_10msec_timer() {                                                 C:\fw\midicontroller\x011\controller.c
                                           	/* handle inc/dec acceleration: */                                              C:\fw\midicontroller\x011\controller.c
000efa   0101     MOVLB     0x1            	if (accel_state != ACCEL_NONE) {                                                C:\fw\midicontroller\x011\controller.c
000efc   5131     MOVF      0x31,0x0,0x1                                                                                    
000efe   e00a     BZ        0xf14                                                                                           
000f00   0101     MOVLB     0x1            		if (accel_time > 0) --accel_time;                                              C:\fw\midicontroller\x011\controller.c
000f02   0e00     MOVLW     0x0                                                                                             
000f04   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f06   5520     SUBFWB    0x20,0x0,0x1                                                                                    
000f08   0e00     MOVLW     0x0                                                                                             
000f0a   5521     SUBFWB    0x21,0x0,0x1                                                                                    
000f0c   e203     BC        0xf14                                                                                           
000f0e   0720     DECF      0x20,0x1,0x1                                                                                    
000f10   0e00     MOVLW     0x0                                                                                             
000f12   5b21     SUBWFB    0x21,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* handle simple count-down timers: */                                          C:\fw\midicontroller\x011\controller.c
000f14   0101     MOVLB     0x1            	if (cdtimer_store > 0) --cdtimer_store;                                         C:\fw\midicontroller\x011\controller.c
000f16   0e00     MOVLW     0x0                                                                                             
000f18   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f1a   552b     SUBFWB    0x2b,0x0,0x1                                                                                    
000f1c   0e00     MOVLW     0x0                                                                                             
000f1e   552c     SUBFWB    0x2c,0x0,0x1                                                                                    
000f20   e203     BC        0xf28                                                                                           
000f22   072b     DECF      0x2b,0x1,0x1                                                                                    
000f24   0e00     MOVLW     0x0                                                                                             
000f26   5b2c     SUBWFB    0x2c,0x1,0x1                                                                                    
000f28   0e00     MOVLW     0x0            	if (cdtimer_incdec_held > 0) --cdtimer_incdec_held;                             C:\fw\midicontroller\x011\controller.c
000f2a   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f2c   552d     SUBFWB    0x2d,0x0,0x1                                                                                    
000f2e   0e00     MOVLW     0x0                                                                                             
000f30   552e     SUBFWB    0x2e,0x0,0x1                                                                                    
000f32   e203     BC        0xf3a                                                                                           
000f34   072d     DECF      0x2d,0x1,0x1                                                                                    
000f36   0e00     MOVLW     0x0                                                                                             
000f38   5b2e     SUBWFB    0x2e,0x1,0x1                                                                                    
000f3a   0e00     MOVLW     0x0            	if (cdtimer_value > 0) {                                                        C:\fw\midicontroller\x011\controller.c
000f3c   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f3e   5527     SUBFWB    0x27,0x0,0x1                                                                                    
000f40   0e00     MOVLW     0x0                                                                                             
000f42   5528     SUBFWB    0x28,0x0,0x1                                                                                    
000f44   e20c     BC        0xf5e                                                                                           
000f46   0727     DECF      0x27,0x1,0x1   		--cdtimer_value;                                                               C:\fw\midicontroller\x011\controller.c
000f48   0e00     MOVLW     0x0                                                                                             
000f4a   5b28     SUBWFB    0x28,0x1,0x1                                                                                    
000f4c   5127     MOVF      0x27,0x0,0x1   		if (cdtimer_value == 0) {                                                      C:\fw\midicontroller\x011\controller.c
000f4e   1128     IORWF     0x28,0x0,0x1                                                                                    
000f50   e106     BNZ       0xf5e                                                                                           
000f52   0101     MOVLB     0x1            			if (mode == MODE_CONCERT) bank_showname();                                    C:\fw\midicontroller\x011\controller.c
000f54   0523     DECF      0x23,0x0,0x1                                                                                    
000f56   e102     BNZ       0xf5c                                                                                           
000f58   df0c     RCALL     0xd72                                                                                           
000f5a   d001     BRA       0xf5e          			else sortedbank_showname();                                                   C:\fw\midicontroller\x011\controller.c
000f5c   df21     RCALL     0xda0                                                                                           
                                           		}                                                                              C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
000f5e   0101     MOVLB     0x1            	if (cdtimer_holdenter > 0) --cdtimer_holdenter;                                 C:\fw\midicontroller\x011\controller.c
000f60   0e00     MOVLW     0x0                                                                                             
000f62   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f64   552f     SUBFWB    0x2f,0x0,0x1                                                                                    
000f66   0e00     MOVLW     0x0                                                                                             
000f68   5530     SUBFWB    0x30,0x0,0x1                                                                                    
000f6a   e203     BC        0xf72                                                                                           
000f6c   072f     DECF      0x2f,0x1,0x1                                                                                    
000f6e   0e00     MOVLW     0x0                                                                                             
000f70   5b30     SUBWFB    0x30,0x1,0x1                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* handle LED flashing states: */                                               C:\fw\midicontroller\x011\controller.c
000f72   0e00     MOVLW     0x0            	if (cdtimer_flash > 0) {                                                        C:\fw\midicontroller\x011\controller.c
000f74   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f76   5529     SUBFWB    0x29,0x0,0x1                                                                                    
000f78   0e00     MOVLW     0x0                                                                                             
000f7a   552a     SUBFWB    0x2a,0x0,0x1                                                                                    
000f7c   e301     BNC       0xf80                                                                                           
000f7e   d0bf     BRA       0x10fe                                                                                          
000f80   5132     MOVF      0x32,0x0,0x1   		switch (flash_state) {                                                         C:\fw\midicontroller\x011\controller.c
000f82   0a03     XORLW     0x3                                                                                             
000f84   e067     BZ        0x1054                                                                                          
000f86   0a01     XORLW     0x1                                                                                             
000f88   e01f     BZ        0xfc8                                                                                           
000f8a   0a03     XORLW     0x3                                                                                             
000f8c   e001     BZ        0xf90                                                                                           
000f8e   d0a8     BRA       0x10e0                                                                                          
                                           			case FLASH_STORE:                                                             C:\fw\midicontroller\x011\controller.c
000f90   5129     MOVF      0x29,0x0,0x1   				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x011\controller.c
000f92   0b1f     ANDLW     0x1f                                                                                            
000f94   e108     BNZ       0xfa6                                                                                           
000f96   5134     MOVF      0x34,0x0,0x1   					fsw_led_enable(flash_led);                                                  C:\fw\midicontroller\x011\controller.c
000f98   6ee6     MOVWF     0xe6,0x0                                                                                        
000f9a   6ae6     CLRF      0xe6,0x0                                                                                        
000f9c   ec09     CALL      0x2812,0x0                                                                                      
000f9e   f014                                                                                                               
000fa0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa4   d010     BRA       0xfc6          				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x011\controller.c
000fa6   0e1f     MOVLW     0x1f                                                                                            
000fa8   1529     ANDWF     0x29,0x0,0x1                                                                                    
000faa   6e10     MOVWF     0x10,0x0                                                                                        
000fac   6a11     CLRF      0x11,0x0                                                                                        
000fae   0e0f     MOVLW     0xf                                                                                             
000fb0   1810     XORWF     0x10,0x0,0x0                                                                                    
000fb2   e101     BNZ       0xfb6                                                                                           
000fb4   5011     MOVF      0x11,0x0,0x0                                                                                    
000fb6   e107     BNZ       0xfc6                                                                                           
000fb8   5134     MOVF      0x34,0x0,0x1   					fsw_led_disable(flash_led);                                                 C:\fw\midicontroller\x011\controller.c
000fba   6ee6     MOVWF     0xe6,0x0                                                                                        
000fbc   6ae6     CLRF      0xe6,0x0                                                                                        
000fbe   ec1d     CALL      0x283a,0x0                                                                                      
000fc0   f014                                                                                                               
000fc2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x011\controller.c
000fc6   d08c     BRA       0x10e0         				break;                                                                       C:\fw\midicontroller\x011\controller.c
                                           			case FLASH_BANK_SELECT_MODE:                                                  C:\fw\midicontroller\x011\controller.c
000fc8   5129     MOVF      0x29,0x0,0x1   				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x011\controller.c
000fca   0b1f     ANDLW     0x1f                                                                                            
000fcc   e11d     BNZ       0x1008                                                                                          
000fce   0e00     MOVLW     0x0            					fsw_led_enable(0);                                                          C:\fw\midicontroller\x011\controller.c
000fd0   6ee6     MOVWF     0xe6,0x0                                                                                        
000fd2   6ae6     CLRF      0xe6,0x0                                                                                        
000fd4   ec09     CALL      0x2812,0x0                                                                                      
000fd6   f014                                                                                                               
000fd8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fda   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fdc   0e01     MOVLW     0x1            					fsw_led_enable(1);                                                          C:\fw\midicontroller\x011\controller.c
000fde   6ee6     MOVWF     0xe6,0x0                                                                                        
000fe0   6ae6     CLRF      0xe6,0x0                                                                                        
000fe2   ec09     CALL      0x2812,0x0                                                                                      
000fe4   f014                                                                                                               
000fe6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fe8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fea   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x011\controller.c
000fec   6ee6     MOVWF     0xe6,0x0                                                                                        
000fee   6ae6     CLRF      0xe6,0x0                                                                                        
000ff0   ec1d     CALL      0x283a,0x0                                                                                      
000ff2   f014                                                                                                               
000ff4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ff6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ff8   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x011\controller.c
000ffa   6ee6     MOVWF     0xe6,0x0                                                                                        
000ffc   6ae6     CLRF      0xe6,0x0                                                                                        
000ffe   ec1d     CALL      0x283a,0x0                                                                                      
001000   f014                                                                                                               
001002   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001004   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001006   d025     BRA       0x1052         				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x011\controller.c
001008   0e1f     MOVLW     0x1f                                                                                            
00100a   1529     ANDWF     0x29,0x0,0x1                                                                                    
00100c   6e10     MOVWF     0x10,0x0                                                                                        
00100e   6a11     CLRF      0x11,0x0                                                                                        
001010   0e0f     MOVLW     0xf                                                                                             
001012   1810     XORWF     0x10,0x0,0x0                                                                                    
001014   e101     BNZ       0x1018                                                                                          
001016   5011     MOVF      0x11,0x0,0x0                                                                                    
001018   e11c     BNZ       0x1052                                                                                          
00101a   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x011\controller.c
00101c   6ee6     MOVWF     0xe6,0x0                                                                                        
00101e   6ae6     CLRF      0xe6,0x0                                                                                        
001020   ec1d     CALL      0x283a,0x0                                                                                      
001022   f014                                                                                                               
001024   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001026   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001028   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x011\controller.c
00102a   6ee6     MOVWF     0xe6,0x0                                                                                        
00102c   6ae6     CLRF      0xe6,0x0                                                                                        
00102e   ec1d     CALL      0x283a,0x0                                                                                      
001030   f014                                                                                                               
001032   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001034   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001036   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x011\controller.c
001038   6ee6     MOVWF     0xe6,0x0                                                                                        
00103a   6ae6     CLRF      0xe6,0x0                                                                                        
00103c   ec1d     CALL      0x283a,0x0                                                                                      
00103e   f014                                                                                                               
001040   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001042   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001044   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x011\controller.c
001046   6ee6     MOVWF     0xe6,0x0                                                                                        
001048   6ae6     CLRF      0xe6,0x0                                                                                        
00104a   ec1d     CALL      0x283a,0x0                                                                                      
00104c   f014                                                                                                               
00104e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001050   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x011\controller.c
001052   d046     BRA       0x10e0         				break;                                                                       C:\fw\midicontroller\x011\controller.c
                                           			case FLASH_PRGM_SELECT_MODE:                                                  C:\fw\midicontroller\x011\controller.c
001054   5129     MOVF      0x29,0x0,0x1   				if ((cdtimer_flash & 31) == 0) {                                             C:\fw\midicontroller\x011\controller.c
001056   0b1f     ANDLW     0x1f                                                                                            
001058   e11d     BNZ       0x1094                                                                                          
00105a   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x011\controller.c
00105c   6ee6     MOVWF     0xe6,0x0                                                                                        
00105e   6ae6     CLRF      0xe6,0x0                                                                                        
001060   ec1d     CALL      0x283a,0x0                                                                                      
001062   f014                                                                                                               
001064   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001066   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001068   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x011\controller.c
00106a   6ee6     MOVWF     0xe6,0x0                                                                                        
00106c   6ae6     CLRF      0xe6,0x0                                                                                        
00106e   ec1d     CALL      0x283a,0x0                                                                                      
001070   f014                                                                                                               
001072   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001074   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001076   0e02     MOVLW     0x2            					fsw_led_enable(2);                                                          C:\fw\midicontroller\x011\controller.c
001078   6ee6     MOVWF     0xe6,0x0                                                                                        
00107a   6ae6     CLRF      0xe6,0x0                                                                                        
00107c   ec09     CALL      0x2812,0x0                                                                                      
00107e   f014                                                                                                               
001080   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001082   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001084   0e03     MOVLW     0x3            					fsw_led_enable(3);                                                          C:\fw\midicontroller\x011\controller.c
001086   6ee6     MOVWF     0xe6,0x0                                                                                        
001088   6ae6     CLRF      0xe6,0x0                                                                                        
00108a   ec09     CALL      0x2812,0x0                                                                                      
00108c   f014                                                                                                               
00108e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001090   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001092   d025     BRA       0x10de         				} else if ((cdtimer_flash & 31) == 15) {                                     C:\fw\midicontroller\x011\controller.c
001094   0e1f     MOVLW     0x1f                                                                                            
001096   1529     ANDWF     0x29,0x0,0x1                                                                                    
001098   6e10     MOVWF     0x10,0x0                                                                                        
00109a   6a11     CLRF      0x11,0x0                                                                                        
00109c   0e0f     MOVLW     0xf                                                                                             
00109e   1810     XORWF     0x10,0x0,0x0                                                                                    
0010a0   e101     BNZ       0x10a4                                                                                          
0010a2   5011     MOVF      0x11,0x0,0x0                                                                                    
0010a4   e11c     BNZ       0x10de                                                                                          
0010a6   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         C:\fw\midicontroller\x011\controller.c
0010a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0010aa   6ae6     CLRF      0xe6,0x0                                                                                        
0010ac   ec1d     CALL      0x283a,0x0                                                                                      
0010ae   f014                                                                                                               
0010b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b4   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         C:\fw\midicontroller\x011\controller.c
0010b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0010b8   6ae6     CLRF      0xe6,0x0                                                                                        
0010ba   ec1d     CALL      0x283a,0x0                                                                                      
0010bc   f014                                                                                                               
0010be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c2   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         C:\fw\midicontroller\x011\controller.c
0010c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0010c6   6ae6     CLRF      0xe6,0x0                                                                                        
0010c8   ec1d     CALL      0x283a,0x0                                                                                      
0010ca   f014                                                                                                               
0010cc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010ce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010d0   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         C:\fw\midicontroller\x011\controller.c
0010d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0010d4   6ae6     CLRF      0xe6,0x0                                                                                        
0010d6   ec1d     CALL      0x283a,0x0                                                                                      
0010d8   f014                                                                                                               
0010da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x011\controller.c
0010de   d000     BRA       0x10e0         				break;                                                                       C:\fw\midicontroller\x011\controller.c
                                           		}                                                                              C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
0010e0   0101     MOVLB     0x1            		--cdtimer_flash;                                                               C:\fw\midicontroller\x011\controller.c
0010e2   0729     DECF      0x29,0x1,0x1                                                                                    
0010e4   0e00     MOVLW     0x0                                                                                             
0010e6   5b2a     SUBWFB    0x2a,0x1,0x1                                                                                    
0010e8   5129     MOVF      0x29,0x0,0x1   		if (cdtimer_flash == 0) {                                                      C:\fw\midicontroller\x011\controller.c
0010ea   112a     IORWF     0x2a,0x0,0x1                                                                                    
0010ec   e108     BNZ       0x10fe                                                                                          
                                           			/* reset LEDs to proper state */                                              C:\fw\midicontroller\x011\controller.c
0010ee   0101     MOVLB     0x1            			fsw_led_set_active(curr_preset);                                              C:\fw\midicontroller\x011\controller.c
0010f0   5116     MOVF      0x16,0x0,0x1                                                                                    
0010f2   6ee6     MOVWF     0xe6,0x0                                                                                        
0010f4   6ae6     CLRF      0xe6,0x0                                                                                        
0010f6   ecf3     CALL      0x27e6,0x0                                                                                      
0010f8   f013                                                                                                               
0010fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
0010fe   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           void inc_practice_value() {                                                      C:\fw\midicontroller\x011\controller.c
001100   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x011\controller.c
001102   5145     MOVF      0x45,0x0,0x1                                                                                    
001104   e115     BNZ       0x1130                                                                                          
001106   c11e     MOVFF     0x11e,0x10     		if (curr_sortedbank == bank_count - 1) curr_sortedbank = 0;                    C:\fw\midicontroller\x011\controller.c
001108   f010                                                                                                               
00110a   c11f     MOVFF     0x11f,0x11                                                                                      
00110c   f011                                                                                                               
00110e   0610     DECF      0x10,0x1,0x0                                                                                    
001110   0e00     MOVLW     0x0                                                                                             
001112   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001114   5010     MOVF      0x10,0x0,0x0                                                                                    
001116   0101     MOVLB     0x1                                                                                             
001118   191c     XORWF     0x1c,0x0,0x1                                                                                    
00111a   e102     BNZ       0x1120                                                                                          
00111c   5011     MOVF      0x11,0x0,0x0                                                                                    
00111e   191d     XORWF     0x1d,0x0,0x1                                                                                    
001120   e103     BNZ       0x1128                                                                                          
001122   6b1c     CLRF      0x1c,0x1                                                                                        
001124   6b1d     CLRF      0x1d,0x1                                                                                        
001126   d003     BRA       0x112e         		else ++curr_sortedbank;                                                        C:\fw\midicontroller\x011\controller.c
001128   2b1c     INCF      0x1c,0x1,0x1                                                                                    
00112a   0e00     MOVLW     0x0                                                                                             
00112c   231d     ADDWFC    0x1d,0x1,0x1                                                                                    
00112e   d007     BRA       0x113e         	} else {                                                                        C:\fw\midicontroller\x011\controller.c
001130   0e7f     MOVLW     0x7f           		if (curr_program == 127) curr_program = 0;                                     C:\fw\midicontroller\x011\controller.c
001132   0101     MOVLB     0x1                                                                                             
001134   5d15     SUBWF     0x15,0x0,0x1                                                                                    
001136   e102     BNZ       0x113c                                                                                          
001138   6b15     CLRF      0x15,0x1                                                                                        
00113a   d001     BRA       0x113e         		else ++curr_program;                                                           C:\fw\midicontroller\x011\controller.c
00113c   2b15     INCF      0x15,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
00113e   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           void dec_practice_value() {                                                      C:\fw\midicontroller\x011\controller.c
001140   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x011\controller.c
001142   5145     MOVF      0x45,0x0,0x1                                                                                    
001144   e111     BNZ       0x1168                                                                                          
001146   0101     MOVLB     0x1            		if (curr_sortedbank == 0) curr_sortedbank = bank_count - 1;                    C:\fw\midicontroller\x011\controller.c
001148   511c     MOVF      0x1c,0x0,0x1                                                                                    
00114a   111d     IORWF     0x1d,0x0,0x1                                                                                    
00114c   e109     BNZ       0x1160                                                                                          
00114e   c11e     MOVFF     0x11e,0x11c                                                                                     
001150   f11c                                                                                                               
001152   c11f     MOVFF     0x11f,0x11d                                                                                     
001154   f11d                                                                                                               
001156   0e01     MOVLW     0x1                                                                                             
001158   5f1c     SUBWF     0x1c,0x1,0x1                                                                                    
00115a   0e00     MOVLW     0x0                                                                                             
00115c   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
00115e   d003     BRA       0x1166         		else --curr_sortedbank;                                                        C:\fw\midicontroller\x011\controller.c
001160   071c     DECF      0x1c,0x1,0x1                                                                                    
001162   0e00     MOVLW     0x0                                                                                             
001164   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
001166   d007     BRA       0x1176         	} else {                                                                        C:\fw\midicontroller\x011\controller.c
001168   0101     MOVLB     0x1            		if (curr_program == 0) curr_program = 127;                                     C:\fw\midicontroller\x011\controller.c
00116a   5115     MOVF      0x15,0x0,0x1                                                                                    
00116c   e103     BNZ       0x1174                                                                                          
00116e   0e7f     MOVLW     0x7f                                                                                            
001170   6f15     MOVWF     0x15,0x1                                                                                        
001172   d001     BRA       0x1176         		else --curr_program;                                                           C:\fw\midicontroller\x011\controller.c
001174   0715     DECF      0x15,0x1,0x1                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
001176   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           void notify_practice_value() {                                                   C:\fw\midicontroller\x011\controller.c
001178   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x011\controller.c
00117a   5145     MOVF      0x45,0x0,0x1                                                                                    
00117c   e102     BNZ       0x1182                                                                                          
00117e   de10     RCALL     0xda0          		sortedbank_showname();                                                         C:\fw\midicontroller\x011\controller.c
001180   d001     BRA       0x1184         	} else {                                                                        C:\fw\midicontroller\x011\controller.c
001182   dd26     RCALL     0xbd0          		show_program();                                                                C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
001184   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           void activate_practice_value() {                                                 C:\fw\midicontroller\x011\controller.c
001186   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         C:\fw\midicontroller\x011\controller.c
001188   5145     MOVF      0x45,0x0,0x1                                                                                    
00118a   e104     BNZ       0x1194                                                                                          
00118c   6ae6     CLRF      0xe6,0x0       		sortedbank_activate(0);                                                        C:\fw\midicontroller\x011\controller.c
00118e   ddd8     RCALL     0xd40                                                                                           
001190   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001192   d004     BRA       0x119c         	} else {                                                                        C:\fw\midicontroller\x011\controller.c
001194   0e01     MOVLW     0x1            		program_activate(1);                                                           C:\fw\midicontroller\x011\controller.c
001196   6ee6     MOVWF     0xe6,0x0                                                                                        
001198   dd44     RCALL     0xc22                                                                                           
00119a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
00119c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* sequence programming completed, set state to repeat the sequence back: */     C:\fw\midicontroller\x011\controller.c
                                           void sequence_complete() {                                                       C:\fw\midicontroller\x011\controller.c
                                           	/* set the sequence length and store to the ROM: */                             C:\fw\midicontroller\x011\controller.c
00119e   c117     MOVFF     0x117,0x110    	bankmap_count = curr_mapindex;                                                  C:\fw\midicontroller\x011\controller.c
0011a0   f110                                                                                                               
0011a2   c110     MOVFF     0x110,0xfe6    	bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);            C:\fw\midicontroller\x011\controller.c
0011a4   ffe6                                                                                                               
0011a6   0e08     MOVLW     0x8                                                                                             
0011a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011aa   0e01     MOVLW     0x1                                                                                             
0011ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0011ae   0e04     MOVLW     0x4                                                                                             
0011b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b2   0e01     MOVLW     0x1                                                                                             
0011b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b6   0e00     MOVLW     0x0                                                                                             
0011b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011ba   0e01     MOVLW     0x1                                                                                             
0011bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0011be   c118     MOVFF     0x118,0xfe6                                                                                     
0011c0   ffe6                                                                                                               
0011c2   c119     MOVFF     0x119,0xfe6                                                                                     
0011c4   ffe6                                                                                                               
0011c6   ec4a     CALL      0x2894,0x0                                                                                      
0011c8   f014                                                                                                               
0011ca   6e10     MOVWF     0x10,0x0                                                                                        
0011cc   0e09     MOVLW     0x9                                                                                             
0011ce   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0011d0   5010     MOVF      0x10,0x0,0x0                                                                                    
                                           	/* set up state to repeat the stored sequence back on the preset LEDs: */       C:\fw\midicontroller\x011\controller.c
0011d2   0101     MOVLB     0x1            	program_mode = PROGRAM_COMPLETE;                                                C:\fw\midicontroller\x011\controller.c
0011d4   0e02     MOVLW     0x2                                                                                             
0011d6   6f33     MOVWF     0x33,0x1                                                                                        
0011d8   0e32     MOVLW     0x32           	cdtimer_holdenter = 50;                                                         C:\fw\midicontroller\x011\controller.c
0011da   6f2f     MOVWF     0x2f,0x1                                                                                        
0011dc   6b30     CLRF      0x30,0x1                                                                                        
0011de   0101     MOVLB     0x1            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x011\controller.c
0011e0   6b17     CLRF      0x17,0x1                                                                                        
0011e2   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* set the controller to an initial state */                                     C:\fw\midicontroller\x011\controller.c
                                           void controller_init() {                                                         C:\fw\midicontroller\x011\controller.c
0011e4   ec41     CALL      0x2882,0x0     	bank_count = banks_count();                                                     C:\fw\midicontroller\x011\controller.c
0011e6   f014                                                                                                               
0011e8   cff3     MOVFF     0xff3,0x11e                                                                                     
0011ea   f11e                                                                                                               
0011ec   cff4     MOVFF     0xff4,0x11f                                                                                     
0011ee   f11f                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
0011f0   0101     MOVLB     0x1            	curr_bank = 0;                                                                  C:\fw\midicontroller\x011\controller.c
0011f2   6b18     CLRF      0x18,0x1                                                                                        
0011f4   6b19     CLRF      0x19,0x1                                                                                        
0011f6   0e01     MOVLW     0x1            	bank_activate(1);                                                               C:\fw\midicontroller\x011\controller.c
0011f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011fa   dd6a     RCALL     0xcd0                                                                                           
0011fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\controller.c
0011fe   0101     MOVLB     0x1            	curr_mapindex = 0;                                                              C:\fw\midicontroller\x011\controller.c
001200   6b17     CLRF      0x17,0x1                                                                                        
001202   0e01     MOVLW     0x1            	bankmap_activate(1);                                                            C:\fw\midicontroller\x011\controller.c
001204   6ee6     MOVWF     0xe6,0x0                                                                                        
001206   dd49     RCALL     0xc9a                                                                                           
001208   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            C:\fw\midicontroller\x011\controller.c
00120a   0e00     MOVLW     0x0            	sw_curr = sw_last = 0;                                                          C:\fw\midicontroller\x011\controller.c
00120c   0101     MOVLB     0x1                                                                                             
00120e   6f3f     MOVWF     0x3f,0x1                                                                                        
001210   6b40     CLRF      0x40,0x1                                                                                        
001212   6f3d     MOVWF     0x3d,0x1                                                                                        
001214   6b3e     CLRF      0x3e,0x1                                                                                        
001216   ec3c     CALL      0x2878,0x0     	cc_curr = cc_last = expr_poll();                                                C:\fw\midicontroller\x011\controller.c
001218   f014                                                                                                               
00121a   0101     MOVLB     0x1                                                                                             
00121c   6f42     MOVWF     0x42,0x1                                                                                        
00121e   6f41     MOVWF     0x41,0x1                                                                                        
001220   ec37     CALL      0x286e,0x0     	mode = slider_poll();                                                           C:\fw\midicontroller\x011\controller.c
001222   f014                                                                                                               
001224   0101     MOVLB     0x1                                                                                             
001226   6f23     MOVWF     0x23,0x1                                                                                        
001228   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           /* main control loop */                                                          C:\fw\midicontroller\x011\controller.c
                                           void controller_handle() {                                                       C:\fw\midicontroller\x011\controller.c
                                           	/* poll foot-switch depression status: */                                       C:\fw\midicontroller\x011\controller.c
00122a   ecaf     CALL      0x275e,0x0     	sw_curr = fsw_poll();                                                           C:\fw\midicontroller\x011\controller.c
00122c   f013                                                                                                               
00122e   cff3     MOVFF     0xff3,0x13d                                                                                     
001230   f13d                                                                                                               
001232   cff4     MOVFF     0xff4,0x13e                                                                                     
001234   f13e                                                                                                               
                                           	/* poll expression pedal value: */                                              C:\fw\midicontroller\x011\controller.c
001236   ec3c     CALL      0x2878,0x0     	cc_curr = expr_poll();                                                          C:\fw\midicontroller\x011\controller.c
001238   f014                                                                                                               
00123a   0101     MOVLB     0x1                                                                                             
00123c   6f41     MOVWF     0x41,0x1                                                                                        
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* send CC message only if changed: */                                          C:\fw\midicontroller\x011\controller.c
00123e   5142     MOVF      0x42,0x0,0x1   	if (cc_curr != cc_last) {                                                       C:\fw\midicontroller\x011\controller.c
001240   5d41     SUBWF     0x41,0x0,0x1                                                                                    
001242   e016     BZ        0x1270                                                                                          
001244   0e7f     MOVLW     0x7f           		midi_send_cmd2(0xB, midi_channel, bankcontroller[curr_preset], cc_curr & 0x7F); C:\fw\midicontroller\x011\controller.c
001246   1541     ANDWF     0x41,0x0,0x1                                                                                    
001248   6ee6     MOVWF     0xe6,0x0                                                                                        
00124a   0101     MOVLB     0x1                                                                                             
00124c   5116     MOVF      0x16,0x0,0x1                                                                                    
00124e   6aea     CLRF      0xea,0x0                                                                                        
001250   0f04     ADDLW     0x4                                                                                             
001252   6ee9     MOVWF     0xe9,0x0                                                                                        
001254   0e01     MOVLW     0x1                                                                                             
001256   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001258   50ef     MOVF      0xef,0x0,0x0                                                                                    
00125a   6ee6     MOVWF     0xe6,0x0                                                                                        
00125c   c124     MOVFF     0x124,0xfe6                                                                                     
00125e   ffe6                                                                                                               
001260   0e0b     MOVLW     0xb                                                                                             
001262   6ee6     MOVWF     0xe6,0x0                                                                                        
001264   ec6a     CALL      0x28d4,0x0                                                                                      
001266   f014                                                                                                               
001268   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* determine mode */                                                            C:\fw\midicontroller\x011\controller.c
001270   ec37     CALL      0x286e,0x0     	if (slider_poll() == 0) {                                                       C:\fw\midicontroller\x011\controller.c
001272   f014                                                                                                               
001274   0900     IORLW     0x0                                                                                             
001276   e110     BNZ       0x1298                                                                                          
001278   0101     MOVLB     0x1            		if (mode == MODE_CONCERT) {                                                    C:\fw\midicontroller\x011\controller.c
00127a   0523     DECF      0x23,0x0,0x1                                                                                    
00127c   e10c     BNZ       0x1296                                                                                          
                                           			/* switched from CONCERT to PRACTICE */                                       C:\fw\midicontroller\x011\controller.c
00127e   6b23     CLRF      0x23,0x1       			mode = MODE_PRACTICE;                                                         C:\fw\midicontroller\x011\controller.c
                                           			/* load the alphabetically first bank and start from the beginning of its program */ C:\fw\midicontroller\x011\controller.c
001280   6b1c     CLRF      0x1c,0x1       			curr_sortedbank = 0;                                                          C:\fw\midicontroller\x011\controller.c
001282   6b1d     CLRF      0x1d,0x1                                                                                        
001284   0e01     MOVLW     0x1            			sortedbank_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
001286   6ee6     MOVWF     0xe6,0x0                                                                                        
001288   dd5b     RCALL     0xd40                                                                                           
00128a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00128c   0101     MOVLB     0x1            			curr_mapindex = 0;                                                            C:\fw\midicontroller\x011\controller.c
00128e   6b17     CLRF      0x17,0x1                                                                                        
001290   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          C:\fw\midicontroller\x011\controller.c
001292   dd03     RCALL     0xc9a                                                                                           
001294   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x011\controller.c
001296   d00f     BRA       0x12b6         	} else {                                                                        C:\fw\midicontroller\x011\controller.c
001298   0101     MOVLB     0x1            		if (mode == MODE_PRACTICE) {                                                   C:\fw\midicontroller\x011\controller.c
00129a   5123     MOVF      0x23,0x0,0x1                                                                                    
00129c   e10c     BNZ       0x12b6                                                                                          
                                           			/* switched from PRACTICE to CONCERT */                                       C:\fw\midicontroller\x011\controller.c
00129e   0e01     MOVLW     0x1            			mode = MODE_CONCERT;                                                          C:\fw\midicontroller\x011\controller.c
0012a0   6f23     MOVWF     0x23,0x1                                                                                        
                                           			/* load the sequentially first bank and start from the beginning of its program */ C:\fw\midicontroller\x011\controller.c
0012a2   6b18     CLRF      0x18,0x1       			curr_bank = 0;                                                                C:\fw\midicontroller\x011\controller.c
0012a4   6b19     CLRF      0x19,0x1                                                                                        
0012a6   6ee6     MOVWF     0xe6,0x0       			bank_activate(1);                                                             C:\fw\midicontroller\x011\controller.c
0012a8   dd13     RCALL     0xcd0                                                                                           
0012aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012ac   0101     MOVLB     0x1            			curr_mapindex = 0;                                                            C:\fw\midicontroller\x011\controller.c
0012ae   6b17     CLRF      0x17,0x1                                                                                        
0012b0   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          C:\fw\midicontroller\x011\controller.c
0012b2   dcf3     RCALL     0xc9a                                                                                           
0012b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* NEXT never changes function depending on mode */                             C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* NEXT pressed: */                                                             C:\fw\midicontroller\x011\controller.c
0012b6   0e00     MOVLW     0x0            	if (button_pressed(FSM_NEXT)) {                                                 C:\fw\midicontroller\x011\controller.c
0012b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0012ba   6ae6     CLRF      0xe6,0x0                                                                                        
0012bc   dda0     RCALL     0xdfe                                                                                           
0012be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012c2   0900     IORLW     0x0                                                                                             
0012c4   e04b     BZ        0x135c                                                                                          
0012c6   0101     MOVLB     0x1            		if (loaded_bank != curr_bank) {                                                C:\fw\midicontroller\x011\controller.c
0012c8   5118     MOVF      0x18,0x0,0x1                                                                                    
0012ca   191a     XORWF     0x1a,0x0,0x1                                                                                    
0012cc   e102     BNZ       0x12d2                                                                                          
0012ce   5119     MOVF      0x19,0x0,0x1                                                                                    
0012d0   191b     XORWF     0x1b,0x0,0x1                                                                                    
0012d2   e005     BZ        0x12de                                                                                          
                                           			/* prepared to switch to a bank, but did not activate the first map */        C:\fw\midicontroller\x011\controller.c
0012d4   0e01     MOVLW     0x1            			bankmap_activate(1);                                                          C:\fw\midicontroller\x011\controller.c
0012d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0012d8   dce0     RCALL     0xc9a                                                                                           
0012da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012dc   d03f     BRA       0x135c         		} else {                                                                       C:\fw\midicontroller\x011\controller.c
0012de   0510     DECF      0x10,0x0,0x1   			if (curr_mapindex == bankmap_count - 1) {                                     C:\fw\midicontroller\x011\controller.c
0012e0   5d17     SUBWF     0x17,0x0,0x1                                                                                    
0012e2   e137     BNZ       0x1352                                                                                          
                                           				/* crossed the upper bank-map boundary, load the next bank */                C:\fw\midicontroller\x011\controller.c
0012e4   5123     MOVF      0x23,0x0,0x1   				if (mode == MODE_PRACTICE) {                                                 C:\fw\midicontroller\x011\controller.c
0012e6   e118     BNZ       0x1318                                                                                          
                                           					/* PRACTICE mode cycles through banks by sorted index #: */                 C:\fw\midicontroller\x011\controller.c
0012e8   c11e     MOVFF     0x11e,0x10     					if (curr_sortedbank == bank_count - 1) {                                    C:\fw\midicontroller\x011\controller.c
0012ea   f010                                                                                                               
0012ec   c11f     MOVFF     0x11f,0x11                                                                                      
0012ee   f011                                                                                                               
0012f0   0610     DECF      0x10,0x1,0x0                                                                                    
0012f2   0e00     MOVLW     0x0                                                                                             
0012f4   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
0012f6   5010     MOVF      0x10,0x0,0x0                                                                                    
0012f8   191c     XORWF     0x1c,0x0,0x1                                                                                    
0012fa   e102     BNZ       0x1300                                                                                          
0012fc   5011     MOVF      0x11,0x0,0x0                                                                                    
0012fe   191d     XORWF     0x1d,0x0,0x1                                                                                    
001300   e103     BNZ       0x1308                                                                                          
001302   6b1c     CLRF      0x1c,0x1       						curr_sortedbank = 0;                                                       C:\fw\midicontroller\x011\controller.c
001304   6b1d     CLRF      0x1d,0x1                                                                                        
001306   d003     BRA       0x130e         					} else {                                                                    C:\fw\midicontroller\x011\controller.c
001308   2b1c     INCF      0x1c,0x1,0x1   						++curr_sortedbank;                                                         C:\fw\midicontroller\x011\controller.c
00130a   0e00     MOVLW     0x0                                                                                             
00130c   231d     ADDWFC    0x1d,0x1,0x1                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* show the bank name */                                                    C:\fw\midicontroller\x011\controller.c
00130e   0e01     MOVLW     0x1            					sortedbank_activate(1);                                                     C:\fw\midicontroller\x011\controller.c
001310   6ee6     MOVWF     0xe6,0x0                                                                                        
001312   dd16     RCALL     0xd40                                                                                           
001314   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001316   d017     BRA       0x1346         				} else {                                                                     C:\fw\midicontroller\x011\controller.c
                                           					/* CONCERT mode cycles through banks by index #: */                         C:\fw\midicontroller\x011\controller.c
001318   c11e     MOVFF     0x11e,0x10     					if (curr_bank == bank_count - 1) {                                          C:\fw\midicontroller\x011\controller.c
00131a   f010                                                                                                               
00131c   c11f     MOVFF     0x11f,0x11                                                                                      
00131e   f011                                                                                                               
001320   0610     DECF      0x10,0x1,0x0                                                                                    
001322   0e00     MOVLW     0x0                                                                                             
001324   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001326   5010     MOVF      0x10,0x0,0x0                                                                                    
001328   1918     XORWF     0x18,0x0,0x1                                                                                    
00132a   e102     BNZ       0x1330                                                                                          
00132c   5011     MOVF      0x11,0x0,0x0                                                                                    
00132e   1919     XORWF     0x19,0x0,0x1                                                                                    
001330   e103     BNZ       0x1338                                                                                          
001332   6b18     CLRF      0x18,0x1       						curr_bank = 0;                                                             C:\fw\midicontroller\x011\controller.c
001334   6b19     CLRF      0x19,0x1                                                                                        
001336   d003     BRA       0x133e         					} else {                                                                    C:\fw\midicontroller\x011\controller.c
001338   2b18     INCF      0x18,0x1,0x1   						++curr_bank;                                                               C:\fw\midicontroller\x011\controller.c
00133a   0e00     MOVLW     0x0                                                                                             
00133c   2319     ADDWFC    0x19,0x1,0x1                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* show the bank name */                                                    C:\fw\midicontroller\x011\controller.c
00133e   0e01     MOVLW     0x1            					bank_activate(1);                                                           C:\fw\midicontroller\x011\controller.c
001340   6ee6     MOVWF     0xe6,0x0                                                                                        
001342   dcc6     RCALL     0xcd0                                                                                           
001344   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            C:\fw\midicontroller\x011\controller.c
                                           				/* activate the first map for the new bank, but do not display the MIDI program # */ C:\fw\midicontroller\x011\controller.c
001346   0101     MOVLB     0x1            				curr_mapindex = 0;                                                           C:\fw\midicontroller\x011\controller.c
001348   6b17     CLRF      0x17,0x1                                                                                        
00134a   6ae6     CLRF      0xe6,0x0       				bankmap_activate(0);                                                         C:\fw\midicontroller\x011\controller.c
00134c   dca6     RCALL     0xc9a                                                                                           
00134e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001350   d005     BRA       0x135c         			} else {                                                                      C:\fw\midicontroller\x011\controller.c
                                           				/* activate the next map for the new bank, and display the MIDI program # */ C:\fw\midicontroller\x011\controller.c
001352   2b17     INCF      0x17,0x1,0x1   				++curr_mapindex;                                                             C:\fw\midicontroller\x011\controller.c
001354   0e01     MOVLW     0x1            				bankmap_activate(1);                                                         C:\fw\midicontroller\x011\controller.c
001356   6ee6     MOVWF     0xe6,0x0                                                                                        
001358   dca0     RCALL     0xc9a                                                                                           
00135a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                           		}                                                                              C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           	/* PRACTICE vs. CONCERT modes: */                                               C:\fw\midicontroller\x011\controller.c
00135c   0101     MOVLB     0x1            	switch (mode) {                                                                 C:\fw\midicontroller\x011\controller.c
00135e   5123     MOVF      0x23,0x0,0x1                                                                                    
001360   0a01     XORLW     0x1                                                                                             
001362   e101     BNZ       0x1366                                                                                          
001364   d317     BRA       0x1994                                                                                          
001366   0a01     XORLW     0x1                                                                                             
001368   e002     BZ        0x136e                                                                                          
00136a   efb4     GOTO      0x1d68                                                                                          
00136c   f00e                                                                                                               
                                           		case MODE_PRACTICE:                                                            C:\fw\midicontroller\x011\controller.c
                                           			/* PRACTICE mode has sub-modes of its own: */                                 C:\fw\midicontroller\x011\controller.c
00136e   0101     MOVLB     0x1            			switch (program_mode) {                                                       C:\fw\midicontroller\x011\controller.c
001370   5133     MOVF      0x33,0x0,0x1                                                                                    
001372   0a02     XORLW     0x2                                                                                             
001374   e101     BNZ       0x1378                                                                                          
001376   d2d8     BRA       0x1928                                                                                          
001378   0a03     XORLW     0x3                                                                                             
00137a   e101     BNZ       0x137e                                                                                          
00137c   d23a     BRA       0x17f2                                                                                          
00137e   0a01     XORLW     0x1                                                                                             
001380   e001     BZ        0x1384                                                                                          
001382   d307     BRA       0x1992                                                                                          
                                           				case PROGRAM_NONE:                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* one of preset 1-4 pressed: */                                            C:\fw\midicontroller\x011\controller.c
001384   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         C:\fw\midicontroller\x011\controller.c
001386   6ee6     MOVWF     0xe6,0x0                                                                                        
001388   6ae6     CLRF      0xe6,0x0                                                                                        
00138a   dd39     RCALL     0xdfe                                                                                           
00138c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00138e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001390   0900     IORLW     0x0                                                                                             
001392   e00e     BZ        0x13b0                                                                                          
001394   0101     MOVLB     0x1            						curr_preset = 0;                                                           C:\fw\midicontroller\x011\controller.c
001396   6b16     CLRF      0x16,0x1                                                                                        
001398   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x011\controller.c
00139a   0545     DECF      0x45,0x0,0x1                                                                                    
00139c   e105     BNZ       0x13a8                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x011\controller.c
00139e   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x011\controller.c
0013a0   6f2b     MOVWF     0x2b,0x1                                                                                        
0013a2   6b2c     CLRF      0x2c,0x1                                                                                        
0013a4   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x011\controller.c
0013a6   d004     BRA       0x13b0         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
0013a8   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
0013aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0013ac   dc51     RCALL     0xc50                                                                                           
0013ae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
0013b0   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         C:\fw\midicontroller\x011\controller.c
0013b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0013b4   6ae6     CLRF      0xe6,0x0                                                                                        
0013b6   dd23     RCALL     0xdfe                                                                                           
0013b8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013bc   0900     IORLW     0x0                                                                                             
0013be   e00f     BZ        0x13de                                                                                          
0013c0   0101     MOVLB     0x1            						curr_preset = 1;                                                           C:\fw\midicontroller\x011\controller.c
0013c2   0e01     MOVLW     0x1                                                                                             
0013c4   6f16     MOVWF     0x16,0x1                                                                                        
0013c6   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x011\controller.c
0013c8   0545     DECF      0x45,0x0,0x1                                                                                    
0013ca   e105     BNZ       0x13d6                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x011\controller.c
0013cc   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x011\controller.c
0013ce   6f2b     MOVWF     0x2b,0x1                                                                                        
0013d0   6b2c     CLRF      0x2c,0x1                                                                                        
0013d2   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x011\controller.c
0013d4   d004     BRA       0x13de         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
0013d6   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
0013d8   6ee6     MOVWF     0xe6,0x0                                                                                        
0013da   dc3a     RCALL     0xc50                                                                                           
0013dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
0013de   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         C:\fw\midicontroller\x011\controller.c
0013e0   6ee6     MOVWF     0xe6,0x0                                                                                        
0013e2   6ae6     CLRF      0xe6,0x0                                                                                        
0013e4   dd0c     RCALL     0xdfe                                                                                           
0013e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013e8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013ea   0900     IORLW     0x0                                                                                             
0013ec   e00f     BZ        0x140c                                                                                          
0013ee   0101     MOVLB     0x1            						curr_preset = 2;                                                           C:\fw\midicontroller\x011\controller.c
0013f0   0e02     MOVLW     0x2                                                                                             
0013f2   6f16     MOVWF     0x16,0x1                                                                                        
0013f4   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x011\controller.c
0013f6   0545     DECF      0x45,0x0,0x1                                                                                    
0013f8   e105     BNZ       0x1404                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x011\controller.c
0013fa   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x011\controller.c
0013fc   6f2b     MOVWF     0x2b,0x1                                                                                        
0013fe   6b2c     CLRF      0x2c,0x1                                                                                        
001400   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x011\controller.c
001402   d004     BRA       0x140c         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
001404   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
001406   6ee6     MOVWF     0xe6,0x0                                                                                        
001408   dc23     RCALL     0xc50                                                                                           
00140a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
00140c   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         C:\fw\midicontroller\x011\controller.c
00140e   6ee6     MOVWF     0xe6,0x0                                                                                        
001410   6ae6     CLRF      0xe6,0x0                                                                                        
001412   dcf5     RCALL     0xdfe                                                                                           
001414   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001416   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001418   0900     IORLW     0x0                                                                                             
00141a   e00f     BZ        0x143a                                                                                          
00141c   0101     MOVLB     0x1            						curr_preset = 3;                                                           C:\fw\midicontroller\x011\controller.c
00141e   0e03     MOVLW     0x3                                                                                             
001420   6f16     MOVWF     0x16,0x1                                                                                        
001422   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    C:\fw\midicontroller\x011\controller.c
001424   0545     DECF      0x45,0x0,0x1                                                                                    
001426   e105     BNZ       0x1432                                                                                          
                                           							/* check if held for ~300msec */                                          C:\fw\midicontroller\x011\controller.c
001428   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       C:\fw\midicontroller\x011\controller.c
00142a   6f2b     MOVWF     0x2b,0x1                                                                                        
00142c   6b2c     CLRF      0x2c,0x1                                                                                        
00142e   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          C:\fw\midicontroller\x011\controller.c
001430   d004     BRA       0x143a         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
001432   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
001434   6ee6     MOVWF     0xe6,0x0                                                                                        
001436   dc0c     RCALL     0xc50                                                                                           
001438   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
00143a   0101     MOVLB     0x1            					if (incdec_mode == 1) {                                                     C:\fw\midicontroller\x011\controller.c
00143c   0545     DECF      0x45,0x0,0x1                                                                                    
00143e   e001     BZ        0x1442                                                                                          
001440   d087     BRA       0x1550                                                                                          
                                           						/* check if the store-timer ran out and we're able to store: */            C:\fw\midicontroller\x011\controller.c
001442   512b     MOVF      0x2b,0x0,0x1   						if ((cdtimer_store == 0) && (store_state == 0)) {                          C:\fw\midicontroller\x011\controller.c
001444   112c     IORWF     0x2c,0x0,0x1                                                                                    
001446   e153     BNZ       0x14ee                                                                                          
001448   5144     MOVF      0x44,0x0,0x1                                                                                    
00144a   e151     BNZ       0x14ee                                                                                          
                                           							/* still holding a button? */                                             C:\fw\midicontroller\x011\controller.c
00144c   0e01     MOVLW     0x1            							if (button_held(FSM_PRESET_1) || button_held(FSM_PRESET_2) || button_held(FSM_PRESET_3) || button_held(FSM_PRESET_4)) { C:\fw\midicontroller\x011\controller.c
00144e   6ee6     MOVWF     0xe6,0x0                                                                                        
001450   6ae6     CLRF      0xe6,0x0                                                                                        
001452   dd04     RCALL     0xe5c                                                                                           
001454   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001456   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001458   0900     IORLW     0x0                                                                                             
00145a   e118     BNZ       0x148c                                                                                          
00145c   0e02     MOVLW     0x2                                                                                             
00145e   6ee6     MOVWF     0xe6,0x0                                                                                        
001460   6ae6     CLRF      0xe6,0x0                                                                                        
001462   dcfc     RCALL     0xe5c                                                                                           
001464   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001466   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001468   0900     IORLW     0x0                                                                                             
00146a   e110     BNZ       0x148c                                                                                          
00146c   0e04     MOVLW     0x4                                                                                             
00146e   6ee6     MOVWF     0xe6,0x0                                                                                        
001470   6ae6     CLRF      0xe6,0x0                                                                                        
001472   dcf4     RCALL     0xe5c                                                                                           
001474   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001476   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001478   0900     IORLW     0x0                                                                                             
00147a   e108     BNZ       0x148c                                                                                          
00147c   0e08     MOVLW     0x8                                                                                             
00147e   6ee6     MOVWF     0xe6,0x0                                                                                        
001480   6ae6     CLRF      0xe6,0x0                                                                                        
001482   dcec     RCALL     0xe5c                                                                                           
001484   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001486   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001488   0900     IORLW     0x0                                                                                             
00148a   e031     BZ        0x14ee                                                                                          
                                           								/* store the program */                                                  C:\fw\midicontroller\x011\controller.c
00148c   0101     MOVLB     0x1            								store_state = 1;                                                         C:\fw\midicontroller\x011\controller.c
00148e   0e01     MOVLW     0x1                                                                                             
001490   6f44     MOVWF     0x44,0x1                                                                                        
001492   0101     MOVLB     0x1            								bank[curr_preset] = curr_program;                                        C:\fw\midicontroller\x011\controller.c
001494   5116     MOVF      0x16,0x0,0x1                                                                                    
001496   6aea     CLRF      0xea,0x0                                                                                        
001498   0f00     ADDLW     0x0                                                                                             
00149a   6ee9     MOVWF     0xe9,0x0                                                                                        
00149c   0e01     MOVLW     0x1                                                                                             
00149e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0014a0   c115     MOVFF     0x115,0xfef                                                                                     
0014a2   ffef                                                                                                               
0014a4   c110     MOVFF     0x110,0xfe6    								bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);     C:\fw\midicontroller\x011\controller.c
0014a6   ffe6                                                                                                               
0014a8   0e08     MOVLW     0x8                                                                                             
0014aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0014ac   0e01     MOVLW     0x1                                                                                             
0014ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b0   0e04     MOVLW     0x4                                                                                             
0014b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b4   0e01     MOVLW     0x1                                                                                             
0014b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b8   0e00     MOVLW     0x0                                                                                             
0014ba   6ee6     MOVWF     0xe6,0x0                                                                                        
0014bc   0e01     MOVLW     0x1                                                                                             
0014be   6ee6     MOVWF     0xe6,0x0                                                                                        
0014c0   c118     MOVFF     0x118,0xfe6                                                                                     
0014c2   ffe6                                                                                                               
0014c4   c119     MOVFF     0x119,0xfe6                                                                                     
0014c6   ffe6                                                                                                               
0014c8   ec4a     CALL      0x2894,0x0                                                                                      
0014ca   f014                                                                                                               
0014cc   6e10     MOVWF     0x10,0x0                                                                                        
0014ce   0e09     MOVLW     0x9                                                                                             
0014d0   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0014d2   5010     MOVF      0x10,0x0,0x0                                                                                    
0014d4   0e01     MOVLW     0x1            								preset_activate(1);                                                      C:\fw\midicontroller\x011\controller.c
0014d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014d8   ec28     CALL      0xc50,0x0                                                                                       
0014da   f006                                                                                                               
0014dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           								/* flash the stored LED */                                               C:\fw\midicontroller\x011\controller.c
0014de   0101     MOVLB     0x1            								flash_state = FLASH_STORE;                                               C:\fw\midicontroller\x011\controller.c
0014e0   0e01     MOVLW     0x1                                                                                             
0014e2   6f32     MOVWF     0x32,0x1                                                                                        
0014e4   c116     MOVFF     0x116,0x134    								flash_led = curr_preset;                                                 C:\fw\midicontroller\x011\controller.c
0014e6   f134                                                                                                               
0014e8   0e64     MOVLW     0x64           								cdtimer_flash = 100;                                                     C:\fw\midicontroller\x011\controller.c
0014ea   6f29     MOVWF     0x29,0x1                                                                                        
0014ec   6b2a     CLRF      0x2a,0x1                                                                                        
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           						/* check if a button was released: */                                      C:\fw\midicontroller\x011\controller.c
0014ee   0e01     MOVLW     0x1            						if (button_released(FSM_PRESET_1) || button_released(FSM_PRESET_2) || button_released(FSM_PRESET_3) || button_released(FSM_PRESET_4)) { C:\fw\midicontroller\x011\controller.c
0014f0   6ee6     MOVWF     0xe6,0x0                                                                                        
0014f2   6ae6     CLRF      0xe6,0x0                                                                                        
0014f4   dcd3     RCALL     0xe9c                                                                                           
0014f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014fa   0900     IORLW     0x0                                                                                             
0014fc   e118     BNZ       0x152e                                                                                          
0014fe   0e02     MOVLW     0x2                                                                                             
001500   6ee6     MOVWF     0xe6,0x0                                                                                        
001502   6ae6     CLRF      0xe6,0x0                                                                                        
001504   dccb     RCALL     0xe9c                                                                                           
001506   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001508   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00150a   0900     IORLW     0x0                                                                                             
00150c   e110     BNZ       0x152e                                                                                          
00150e   0e04     MOVLW     0x4                                                                                             
001510   6ee6     MOVWF     0xe6,0x0                                                                                        
001512   6ae6     CLRF      0xe6,0x0                                                                                        
001514   dcc3     RCALL     0xe9c                                                                                           
001516   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001518   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00151a   0900     IORLW     0x0                                                                                             
00151c   e108     BNZ       0x152e                                                                                          
00151e   0e08     MOVLW     0x8                                                                                             
001520   6ee6     MOVWF     0xe6,0x0                                                                                        
001522   6ae6     CLRF      0xe6,0x0                                                                                        
001524   dcbb     RCALL     0xe9c                                                                                           
001526   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001528   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00152a   0900     IORLW     0x0                                                                                             
00152c   e011     BZ        0x1550                                                                                          
00152e   0101     MOVLB     0x1            							if ((cdtimer_store > 0) && (store_state == 0)) {                          C:\fw\midicontroller\x011\controller.c
001530   0e00     MOVLW     0x0                                                                                             
001532   80d8     BSF       0xd8,0x0,0x0                                                                                    
001534   552b     SUBFWB    0x2b,0x0,0x1                                                                                    
001536   0e00     MOVLW     0x0                                                                                             
001538   552c     SUBFWB    0x2c,0x0,0x1                                                                                    
00153a   e20a     BC        0x1550                                                                                          
00153c   5144     MOVF      0x44,0x0,0x1                                                                                    
00153e   e108     BNZ       0x1550                                                                                          
                                           								/* was only tapped (held less than ~300msec) */                          C:\fw\midicontroller\x011\controller.c
001540   0e01     MOVLW     0x1            								preset_activate(1);                                                      C:\fw\midicontroller\x011\controller.c
001542   6ee6     MOVWF     0xe6,0x0                                                                                        
001544   ec28     CALL      0xc50,0x0                                                                                       
001546   f006                                                                                                               
001548   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00154a   0101     MOVLB     0x1            								cdtimer_store = 0;                                                       C:\fw\midicontroller\x011\controller.c
00154c   6b2b     CLRF      0x2b,0x1                                                                                        
00154e   6b2c     CLRF      0x2c,0x1                                                                                        
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           					/* INC pressed: */                                                          C:\fw\midicontroller\x011\controller.c
001550   0e00     MOVLW     0x0            					if (button_pressed(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x011\controller.c
001552   6ee6     MOVWF     0xe6,0x0                                                                                        
001554   6ae6     CLRF      0xe6,0x0                                                                                        
001556   dc53     RCALL     0xdfe                                                                                           
001558   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00155a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00155c   0900     IORLW     0x0                                                                                             
00155e   e00f     BZ        0x157e                                                                                          
001560   0e00     MOVLW     0x0                                                                                             
001562   6ee6     MOVWF     0xe6,0x0                                                                                        
001564   6ae6     CLRF      0xe6,0x0                                                                                        
001566   dc7a     RCALL     0xe5c                                                                                           
001568   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00156a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00156c   0900     IORLW     0x0                                                                                             
00156e   e107     BNZ       0x157e                                                                                          
001570   0101     MOVLB     0x1                                                                                             
001572   512d     MOVF      0x2d,0x0,0x1                                                                                    
001574   112e     IORWF     0x2e,0x0,0x1                                                                                    
001576   e103     BNZ       0x157e                                                                                          
                                           						/* INC pushed first */                                                     C:\fw\midicontroller\x011\controller.c
001578   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  C:\fw\midicontroller\x011\controller.c
00157a   6f2d     MOVWF     0x2d,0x1                                                                                        
00157c   6b2e     CLRF      0x2e,0x1                                                                                        
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* Still holding INC alone after ~300 ms: */                                C:\fw\midicontroller\x011\controller.c
00157e   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x011\controller.c
001580   5131     MOVF      0x31,0x0,0x1                                                                                    
001582   e11b     BNZ       0x15ba                                                                                          
001584   0e00     MOVLW     0x0                                                                                             
001586   6ee6     MOVWF     0xe6,0x0                                                                                        
001588   6ae6     CLRF      0xe6,0x0                                                                                        
00158a   dc68     RCALL     0xe5c                                                                                           
00158c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00158e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001590   0900     IORLW     0x0                                                                                             
001592   e013     BZ        0x15ba                                                                                          
001594   0e00     MOVLW     0x0                                                                                             
001596   6ee6     MOVWF     0xe6,0x0                                                                                        
001598   6ae6     CLRF      0xe6,0x0                                                                                        
00159a   dc60     RCALL     0xe5c                                                                                           
00159c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00159e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015a0   0900     IORLW     0x0                                                                                             
0015a2   e10b     BNZ       0x15ba                                                                                          
0015a4   0101     MOVLB     0x1                                                                                             
0015a6   512d     MOVF      0x2d,0x0,0x1                                                                                    
0015a8   112e     IORWF     0x2e,0x0,0x1                                                                                    
0015aa   e107     BNZ       0x15ba                                                                                          
0015ac   0101     MOVLB     0x1            						accel_time = 0;                                                            C:\fw\midicontroller\x011\controller.c
0015ae   6b20     CLRF      0x20,0x1                                                                                        
0015b0   6b21     CLRF      0x21,0x1                                                                                        
0015b2   6b22     CLRF      0x22,0x1       						accel_count = 0;                                                           C:\fw\midicontroller\x011\controller.c
0015b4   0101     MOVLB     0x1            						accel_state = ACCEL_INC_SLOW;                                              C:\fw\midicontroller\x011\controller.c
0015b6   0e01     MOVLW     0x1                                                                                             
0015b8   6f31     MOVWF     0x31,0x1                                                                                        
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* INC released: */                                                         C:\fw\midicontroller\x011\controller.c
0015ba   0e00     MOVLW     0x0            					if (button_released(FSM_INC)) {                                             C:\fw\midicontroller\x011\controller.c
0015bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0015be   6ae6     CLRF      0xe6,0x0                                                                                        
0015c0   dc6d     RCALL     0xe9c                                                                                           
0015c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c6   0900     IORLW     0x0                                                                                             
0015c8   e00c     BZ        0x15e2                                                                                          
0015ca   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             C:\fw\midicontroller\x011\controller.c
0015cc   0e00     MOVLW     0x0                                                                                             
0015ce   80d8     BSF       0xd8,0x0,0x0                                                                                    
0015d0   552d     SUBFWB    0x2d,0x0,0x1                                                                                    
0015d2   0e00     MOVLW     0x0                                                                                             
0015d4   552e     SUBFWB    0x2e,0x0,0x1                                                                                    
0015d6   e202     BC        0x15dc                                                                                          
0015d8   dd93     RCALL     0x1100         							inc_practice_value();                                                     C:\fw\midicontroller\x011\controller.c
0015da   ddce     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
0015dc   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  C:\fw\midicontroller\x011\controller.c
0015de   6b31     CLRF      0x31,0x1                                                                                        
0015e0   ddd2     RCALL     0x1186         						activate_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           					/* DEC pressed: */                                                          C:\fw\midicontroller\x011\controller.c
0015e2   0e00     MOVLW     0x0            					if (button_pressed(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x011\controller.c
0015e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0015e6   6ae6     CLRF      0xe6,0x0                                                                                        
0015e8   dc0a     RCALL     0xdfe                                                                                           
0015ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ee   0900     IORLW     0x0                                                                                             
0015f0   e00f     BZ        0x1610                                                                                          
0015f2   0e00     MOVLW     0x0                                                                                             
0015f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0015f6   6ae6     CLRF      0xe6,0x0                                                                                        
0015f8   dc31     RCALL     0xe5c                                                                                           
0015fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015fe   0900     IORLW     0x0                                                                                             
001600   e107     BNZ       0x1610                                                                                          
001602   0101     MOVLB     0x1                                                                                             
001604   512d     MOVF      0x2d,0x0,0x1                                                                                    
001606   112e     IORWF     0x2e,0x0,0x1                                                                                    
001608   e103     BNZ       0x1610                                                                                          
                                           						/* DEC pushed first */                                                     C:\fw\midicontroller\x011\controller.c
00160a   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  C:\fw\midicontroller\x011\controller.c
00160c   6f2d     MOVWF     0x2d,0x1                                                                                        
00160e   6b2e     CLRF      0x2e,0x1                                                                                        
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* Still holding DEC alone after ~300 ms: */                                C:\fw\midicontroller\x011\controller.c
001610   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { C:\fw\midicontroller\x011\controller.c
001612   5131     MOVF      0x31,0x0,0x1                                                                                    
001614   e11b     BNZ       0x164c                                                                                          
001616   0e00     MOVLW     0x0                                                                                             
001618   6ee6     MOVWF     0xe6,0x0                                                                                        
00161a   6ae6     CLRF      0xe6,0x0                                                                                        
00161c   dc1f     RCALL     0xe5c                                                                                           
00161e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001620   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001622   0900     IORLW     0x0                                                                                             
001624   e013     BZ        0x164c                                                                                          
001626   0e00     MOVLW     0x0                                                                                             
001628   6ee6     MOVWF     0xe6,0x0                                                                                        
00162a   6ae6     CLRF      0xe6,0x0                                                                                        
00162c   dc17     RCALL     0xe5c                                                                                           
00162e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001630   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001632   0900     IORLW     0x0                                                                                             
001634   e10b     BNZ       0x164c                                                                                          
001636   0101     MOVLB     0x1                                                                                             
001638   512d     MOVF      0x2d,0x0,0x1                                                                                    
00163a   112e     IORWF     0x2e,0x0,0x1                                                                                    
00163c   e107     BNZ       0x164c                                                                                          
00163e   0101     MOVLB     0x1            						accel_time = 0;                                                            C:\fw\midicontroller\x011\controller.c
001640   6b20     CLRF      0x20,0x1                                                                                        
001642   6b21     CLRF      0x21,0x1                                                                                        
001644   6b22     CLRF      0x22,0x1       						accel_count = 0;                                                           C:\fw\midicontroller\x011\controller.c
001646   0101     MOVLB     0x1            						accel_state = ACCEL_DEC_SLOW;                                              C:\fw\midicontroller\x011\controller.c
001648   0e04     MOVLW     0x4                                                                                             
00164a   6f31     MOVWF     0x31,0x1                                                                                        
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* DEC released: */                                                         C:\fw\midicontroller\x011\controller.c
00164c   0e00     MOVLW     0x0            					if (button_released(FSM_DEC)) {                                             C:\fw\midicontroller\x011\controller.c
00164e   6ee6     MOVWF     0xe6,0x0                                                                                        
001650   6ae6     CLRF      0xe6,0x0                                                                                        
001652   dc24     RCALL     0xe9c                                                                                           
001654   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001656   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001658   0900     IORLW     0x0                                                                                             
00165a   e00c     BZ        0x1674                                                                                          
00165c   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             C:\fw\midicontroller\x011\controller.c
00165e   0e00     MOVLW     0x0                                                                                             
001660   80d8     BSF       0xd8,0x0,0x0                                                                                    
001662   552d     SUBFWB    0x2d,0x0,0x1                                                                                    
001664   0e00     MOVLW     0x0                                                                                             
001666   552e     SUBFWB    0x2e,0x0,0x1                                                                                    
001668   e202     BC        0x166e                                                                                          
00166a   dd6a     RCALL     0x1140         							dec_practice_value();                                                     C:\fw\midicontroller\x011\controller.c
00166c   dd85     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
00166e   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  C:\fw\midicontroller\x011\controller.c
001670   6b31     CLRF      0x31,0x1                                                                                        
001672   dd89     RCALL     0x1186         						activate_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           					/* ENTER pressed */                                                         C:\fw\midicontroller\x011\controller.c
001674   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            C:\fw\midicontroller\x011\controller.c
001676   6ee6     MOVWF     0xe6,0x0                                                                                        
001678   6ae6     CLRF      0xe6,0x0                                                                                        
00167a   ecff     CALL      0xdfe,0x0                                                                                       
00167c   f006                                                                                                               
00167e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001680   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001682   0900     IORLW     0x0                                                                                             
001684   e004     BZ        0x168e                                                                                          
001686   0e1e     MOVLW     0x1e           						cdtimer_holdenter = 30;                                                    C:\fw\midicontroller\x011\controller.c
001688   0101     MOVLB     0x1                                                                                             
00168a   6f2f     MOVWF     0x2f,0x1                                                                                        
00168c   6b30     CLRF      0x30,0x1                                                                                        
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* ENTER held at least ~300msec: */                                         C:\fw\midicontroller\x011\controller.c
00168e   0e00     MOVLW     0x0            					if (button_held(FSM_ENTER) && (cdtimer_holdenter == 0) && (program_mode == PROGRAM_NONE)) { C:\fw\midicontroller\x011\controller.c
001690   6ee6     MOVWF     0xe6,0x0                                                                                        
001692   6ae6     CLRF      0xe6,0x0                                                                                        
001694   ec2e     CALL      0xe5c,0x0                                                                                       
001696   f007                                                                                                               
001698   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00169a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00169c   0900     IORLW     0x0                                                                                             
00169e   e00e     BZ        0x16bc                                                                                          
0016a0   0101     MOVLB     0x1                                                                                             
0016a2   512f     MOVF      0x2f,0x0,0x1                                                                                    
0016a4   1130     IORWF     0x30,0x0,0x1                                                                                    
0016a6   e10a     BNZ       0x16bc                                                                                          
0016a8   5133     MOVF      0x33,0x0,0x1                                                                                    
0016aa   e108     BNZ       0x16bc                                                                                          
                                           						/* enter sequence program mode */                                          C:\fw\midicontroller\x011\controller.c
0016ac   0e01     MOVLW     0x1            						program_mode = PROGRAM_SEQUENCE;                                           C:\fw\midicontroller\x011\controller.c
0016ae   6f33     MOVWF     0x33,0x1                                                                                        
0016b0   0101     MOVLB     0x1            						curr_mapindex = 0;                                                         C:\fw\midicontroller\x011\controller.c
0016b2   6b17     CLRF      0x17,0x1                                                                                        
0016b4   0e04     MOVLW     0x4            						curr_preset = 4;                                                           C:\fw\midicontroller\x011\controller.c
0016b6   6f16     MOVWF     0x16,0x1                                                                                        
0016b8   ecd0     CALL      0xda0,0x0      						sortedbank_showname();                                                     C:\fw\midicontroller\x011\controller.c
0016ba   f006                                                                                                               
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           					/* ENTER released before ~300msec was up: */                                C:\fw\midicontroller\x011\controller.c
0016bc   0e00     MOVLW     0x0            					if (button_released(FSM_ENTER) && (cdtimer_holdenter > 0)) {                C:\fw\midicontroller\x011\controller.c
0016be   6ee6     MOVWF     0xe6,0x0                                                                                        
0016c0   6ae6     CLRF      0xe6,0x0                                                                                        
0016c2   ec4e     CALL      0xe9c,0x0                                                                                       
0016c4   f007                                                                                                               
0016c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016ca   0900     IORLW     0x0                                                                                             
0016cc   e019     BZ        0x1700                                                                                          
0016ce   0101     MOVLB     0x1                                                                                             
0016d0   0e00     MOVLW     0x0                                                                                             
0016d2   80d8     BSF       0xd8,0x0,0x0                                                                                    
0016d4   552f     SUBFWB    0x2f,0x0,0x1                                                                                    
0016d6   0e00     MOVLW     0x0                                                                                             
0016d8   5530     SUBFWB    0x30,0x0,0x1                                                                                    
0016da   e212     BC        0x1700                                                                                          
0016dc   5145     MOVF      0x45,0x0,0x1   						if (incdec_mode == 0) {                                                    C:\fw\midicontroller\x011\controller.c
0016de   e109     BNZ       0x16f2                                                                                          
                                           							/* program-select mode */                                                 C:\fw\midicontroller\x011\controller.c
0016e0   0e01     MOVLW     0x1            							incdec_mode = 1;                                                          C:\fw\midicontroller\x011\controller.c
0016e2   6f45     MOVWF     0x45,0x1                                                                                        
0016e4   0e03     MOVLW     0x3            							flash_state = FLASH_PRGM_SELECT_MODE;                                     C:\fw\midicontroller\x011\controller.c
0016e6   6f32     MOVWF     0x32,0x1                                                                                        
0016e8   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      C:\fw\midicontroller\x011\controller.c
0016ea   6f29     MOVWF     0x29,0x1                                                                                        
0016ec   6b2a     CLRF      0x2a,0x1                                                                                        
0016ee   dd44     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x011\controller.c
0016f0   d007     BRA       0x1700         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
                                           							/* bank-select mode by alphabetical order */                              C:\fw\midicontroller\x011\controller.c
0016f2   6b45     CLRF      0x45,0x1       							incdec_mode = 0;                                                          C:\fw\midicontroller\x011\controller.c
0016f4   0e02     MOVLW     0x2            							flash_state = FLASH_BANK_SELECT_MODE;                                     C:\fw\midicontroller\x011\controller.c
0016f6   6f32     MOVWF     0x32,0x1                                                                                        
0016f8   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      C:\fw\midicontroller\x011\controller.c
0016fa   6f29     MOVWF     0x29,0x1                                                                                        
0016fc   6b2a     CLRF      0x2a,0x1                                                                                        
0016fe   dd3c     RCALL     0x1178         							notify_practice_value();                                                  C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           					/* acceleration countdown timer hit 0 and we're incrementing slowly */      C:\fw\midicontroller\x011\controller.c
001700   0101     MOVLB     0x1            					if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                     C:\fw\midicontroller\x011\controller.c
001702   5131     MOVF      0x31,0x0,0x1                                                                                    
001704   e075     BZ        0x17f0                                                                                          
001706   0101     MOVLB     0x1                                                                                             
001708   5120     MOVF      0x20,0x0,0x1                                                                                    
00170a   1121     IORWF     0x21,0x0,0x1                                                                                    
00170c   e171     BNZ       0x17f0                                                                                          
00170e   0101     MOVLB     0x1            						switch (accel_state) {                                                     C:\fw\midicontroller\x011\controller.c
001710   5131     MOVF      0x31,0x0,0x1                                                                                    
001712   0a06     XORLW     0x6                                                                                             
001714   e066     BZ        0x17e2                                                                                          
001716   0a03     XORLW     0x3                                                                                             
001718   e04f     BZ        0x17b8                                                                                          
00171a   0a01     XORLW     0x1                                                                                             
00171c   e038     BZ        0x178e                                                                                          
00171e   0a07     XORLW     0x7                                                                                             
001720   e02f     BZ        0x1780                                                                                          
001722   0a01     XORLW     0x1                                                                                             
001724   e018     BZ        0x1756                                                                                          
001726   0a03     XORLW     0x3                                                                                             
001728   e001     BZ        0x172c                                                                                          
00172a   d062     BRA       0x17f0                                                                                          
                                           							case ACCEL_INC_SLOW:                                                      C:\fw\midicontroller\x011\controller.c
00172c   dce9     RCALL     0x1100         								inc_practice_value();                                                    C:\fw\midicontroller\x011\controller.c
00172e   dd24     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x011\controller.c
001730   0101     MOVLB     0x1            								if (accel_count++ == 5) {                                                C:\fw\midicontroller\x011\controller.c
001732   5122     MOVF      0x22,0x0,0x1                                                                                    
001734   2b22     INCF      0x22,0x1,0x1                                                                                    
001736   0805     SUBLW     0x5                                                                                             
001738   e109     BNZ       0x174c                                                                                          
00173a   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x011\controller.c
00173c   0101     MOVLB     0x1            									accel_state = ACCEL_INC_MEDIUM;                                         C:\fw\midicontroller\x011\controller.c
00173e   0e02     MOVLW     0x2                                                                                             
001740   6f31     MOVWF     0x31,0x1                                                                                        
001742   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x011\controller.c
001744   f120                                                                                                               
001746   c138     MOVFF     0x138,0x121                                                                                     
001748   f121                                                                                                               
00174a   d004     BRA       0x1754         								} else {                                                                 C:\fw\midicontroller\x011\controller.c
00174c   c135     MOVFF     0x135,0x120    									accel_time = accel_time_slow;                                           C:\fw\midicontroller\x011\controller.c
00174e   f120                                                                                                               
001750   c136     MOVFF     0x136,0x121                                                                                     
001752   f121                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x011\controller.c
001754   d04d     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x011\controller.c
                                           							case ACCEL_INC_MEDIUM:                                                    C:\fw\midicontroller\x011\controller.c
001756   dcd4     RCALL     0x1100         								inc_practice_value();                                                    C:\fw\midicontroller\x011\controller.c
001758   dd0f     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x011\controller.c
00175a   0101     MOVLB     0x1            								if (accel_count++ == 20) {                                               C:\fw\midicontroller\x011\controller.c
00175c   5122     MOVF      0x22,0x0,0x1                                                                                    
00175e   2b22     INCF      0x22,0x1,0x1                                                                                    
001760   0814     SUBLW     0x14                                                                                            
001762   e109     BNZ       0x1776                                                                                          
001764   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x011\controller.c
001766   0101     MOVLB     0x1            									accel_state = ACCEL_INC_FAST;                                           C:\fw\midicontroller\x011\controller.c
001768   0e03     MOVLW     0x3                                                                                             
00176a   6f31     MOVWF     0x31,0x1                                                                                        
00176c   c139     MOVFF     0x139,0x120    									accel_time = accel_time_fast;                                           C:\fw\midicontroller\x011\controller.c
00176e   f120                                                                                                               
001770   c13a     MOVFF     0x13a,0x121                                                                                     
001772   f121                                                                                                               
001774   d004     BRA       0x177e         								} else {                                                                 C:\fw\midicontroller\x011\controller.c
001776   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x011\controller.c
001778   f120                                                                                                               
00177a   c138     MOVFF     0x138,0x121                                                                                     
00177c   f121                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x011\controller.c
00177e   d038     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x011\controller.c
                                           							case ACCEL_INC_FAST:                                                      C:\fw\midicontroller\x011\controller.c
001780   dcbf     RCALL     0x1100         								inc_practice_value();                                                    C:\fw\midicontroller\x011\controller.c
001782   dcfa     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
001784   c139     MOVFF     0x139,0x120    								accel_time = accel_time_fast;                                            C:\fw\midicontroller\x011\controller.c
001786   f120                                                                                                               
001788   c13a     MOVFF     0x13a,0x121                                                                                     
00178a   f121                                                                                                               
00178c   d031     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           							case ACCEL_DEC_SLOW:                                                      C:\fw\midicontroller\x011\controller.c
00178e   dcd8     RCALL     0x1140         								dec_practice_value();                                                    C:\fw\midicontroller\x011\controller.c
001790   dcf3     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x011\controller.c
001792   0101     MOVLB     0x1            								if (accel_count++ == 5) {                                                C:\fw\midicontroller\x011\controller.c
001794   5122     MOVF      0x22,0x0,0x1                                                                                    
001796   2b22     INCF      0x22,0x1,0x1                                                                                    
001798   0805     SUBLW     0x5                                                                                             
00179a   e109     BNZ       0x17ae                                                                                          
00179c   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x011\controller.c
00179e   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_MEDIUM;                                         C:\fw\midicontroller\x011\controller.c
0017a0   0e05     MOVLW     0x5                                                                                             
0017a2   6f31     MOVWF     0x31,0x1                                                                                        
0017a4   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x011\controller.c
0017a6   f120                                                                                                               
0017a8   c138     MOVFF     0x138,0x121                                                                                     
0017aa   f121                                                                                                               
0017ac   d004     BRA       0x17b6         								} else {                                                                 C:\fw\midicontroller\x011\controller.c
0017ae   c135     MOVFF     0x135,0x120    									accel_time = accel_time_slow;                                           C:\fw\midicontroller\x011\controller.c
0017b0   f120                                                                                                               
0017b2   c136     MOVFF     0x136,0x121                                                                                     
0017b4   f121                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x011\controller.c
0017b6   d01c     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x011\controller.c
                                           							case ACCEL_DEC_MEDIUM:                                                    C:\fw\midicontroller\x011\controller.c
0017b8   dcc3     RCALL     0x1140         								dec_practice_value();                                                    C:\fw\midicontroller\x011\controller.c
0017ba   dcde     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             C:\fw\midicontroller\x011\controller.c
0017bc   0101     MOVLB     0x1            								if (accel_count++ == 20) {                                               C:\fw\midicontroller\x011\controller.c
0017be   5122     MOVF      0x22,0x0,0x1                                                                                    
0017c0   2b22     INCF      0x22,0x1,0x1                                                                                    
0017c2   0814     SUBLW     0x14                                                                                            
0017c4   e109     BNZ       0x17d8                                                                                          
0017c6   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        C:\fw\midicontroller\x011\controller.c
0017c8   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_FAST;                                           C:\fw\midicontroller\x011\controller.c
0017ca   0e06     MOVLW     0x6                                                                                             
0017cc   6f31     MOVWF     0x31,0x1                                                                                        
0017ce   c139     MOVFF     0x139,0x120    									accel_time = accel_time_fast;                                           C:\fw\midicontroller\x011\controller.c
0017d0   f120                                                                                                               
0017d2   c13a     MOVFF     0x13a,0x121                                                                                     
0017d4   f121                                                                                                               
0017d6   d004     BRA       0x17e0         								} else {                                                                 C:\fw\midicontroller\x011\controller.c
0017d8   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         C:\fw\midicontroller\x011\controller.c
0017da   f120                                                                                                               
0017dc   c138     MOVFF     0x138,0x121                                                                                     
0017de   f121                                                                                                               
                                           								}                                                                        C:\fw\midicontroller\x011\controller.c
0017e0   d007     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x011\controller.c
                                           							case ACCEL_DEC_FAST:                                                      C:\fw\midicontroller\x011\controller.c
0017e2   dcae     RCALL     0x1140         								dec_practice_value();                                                    C:\fw\midicontroller\x011\controller.c
0017e4   dcc9     RCALL     0x1178         								notify_practice_value();                                                 C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
0017e6   c139     MOVFF     0x139,0x120    								accel_time = accel_time_fast;                                            C:\fw\midicontroller\x011\controller.c
0017e8   f120                                                                                                               
0017ea   c13a     MOVFF     0x13a,0x121                                                                                     
0017ec   f121                                                                                                               
0017ee   d000     BRA       0x17f0         								break;                                                                   C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
0017f0   d0d0     BRA       0x1992         					break;                                                                      C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           				/* sequence programming mode: */                                             C:\fw\midicontroller\x011\controller.c
                                           				case PROGRAM_SEQUENCE:                                                       C:\fw\midicontroller\x011\controller.c
                                           					/* one of preset 1-4 pressed: */                                            C:\fw\midicontroller\x011\controller.c
0017f2   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         C:\fw\midicontroller\x011\controller.c
0017f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0017f6   6ae6     CLRF      0xe6,0x0                                                                                        
0017f8   ecff     CALL      0xdfe,0x0                                                                                       
0017fa   f006                                                                                                               
0017fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001800   0900     IORLW     0x0                                                                                             
001802   e01a     BZ        0x1838                                                                                          
001804   0101     MOVLB     0x1            						if (curr_preset != 0) {                                                    C:\fw\midicontroller\x011\controller.c
001806   5116     MOVF      0x16,0x0,0x1                                                                                    
001808   e017     BZ        0x1838                                                                                          
00180a   6b16     CLRF      0x16,0x1       							curr_preset = 0;                                                          C:\fw\midicontroller\x011\controller.c
00180c   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
00180e   6ee6     MOVWF     0xe6,0x0                                                                                        
001810   ec28     CALL      0xc50,0x0                                                                                       
001812   f006                                                                                                               
001814   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001816   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x011\controller.c
001818   5117     MOVF      0x17,0x0,0x1                                                                                    
00181a   2b17     INCF      0x17,0x1,0x1                                                                                    
00181c   6aea     CLRF      0xea,0x0                                                                                        
00181e   0f08     ADDLW     0x8                                                                                             
001820   6ee9     MOVWF     0xe9,0x0                                                                                        
001822   0e01     MOVLW     0x1                                                                                             
001824   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001826   c116     MOVFF     0x116,0xfef                                                                                     
001828   ffef                                                                                                               
00182a   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x011\controller.c
00182c   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x011\controller.c
00182e   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x011\controller.c
001830   0101     MOVLB     0x1                                                                                             
001832   5d17     SUBWF     0x17,0x0,0x1                                                                                    
001834   e101     BNZ       0x1838                                                                                          
001836   dcb3     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x011\controller.c
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
001838   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         C:\fw\midicontroller\x011\controller.c
00183a   6ee6     MOVWF     0xe6,0x0                                                                                        
00183c   6ae6     CLRF      0xe6,0x0                                                                                        
00183e   ecff     CALL      0xdfe,0x0                                                                                       
001840   f006                                                                                                               
001842   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001844   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001846   0900     IORLW     0x0                                                                                             
001848   e01a     BZ        0x187e                                                                                          
00184a   0101     MOVLB     0x1            						if (curr_preset != 1) {                                                    C:\fw\midicontroller\x011\controller.c
00184c   0516     DECF      0x16,0x0,0x1                                                                                    
00184e   e017     BZ        0x187e                                                                                          
001850   0e01     MOVLW     0x1            							curr_preset = 1;                                                          C:\fw\midicontroller\x011\controller.c
001852   6f16     MOVWF     0x16,0x1                                                                                        
001854   6ee6     MOVWF     0xe6,0x0       							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
001856   ec28     CALL      0xc50,0x0                                                                                       
001858   f006                                                                                                               
00185a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00185c   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x011\controller.c
00185e   5117     MOVF      0x17,0x0,0x1                                                                                    
001860   2b17     INCF      0x17,0x1,0x1                                                                                    
001862   6aea     CLRF      0xea,0x0                                                                                        
001864   0f08     ADDLW     0x8                                                                                             
001866   6ee9     MOVWF     0xe9,0x0                                                                                        
001868   0e01     MOVLW     0x1                                                                                             
00186a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00186c   c116     MOVFF     0x116,0xfef                                                                                     
00186e   ffef                                                                                                               
001870   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x011\controller.c
001872   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x011\controller.c
001874   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x011\controller.c
001876   0101     MOVLB     0x1                                                                                             
001878   5d17     SUBWF     0x17,0x0,0x1                                                                                    
00187a   e101     BNZ       0x187e                                                                                          
00187c   dc90     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x011\controller.c
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
00187e   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         C:\fw\midicontroller\x011\controller.c
001880   6ee6     MOVWF     0xe6,0x0                                                                                        
001882   6ae6     CLRF      0xe6,0x0                                                                                        
001884   ecff     CALL      0xdfe,0x0                                                                                       
001886   f006                                                                                                               
001888   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188c   0900     IORLW     0x0                                                                                             
00188e   e01c     BZ        0x18c8                                                                                          
001890   0e02     MOVLW     0x2            						if (curr_preset != 2) {                                                    C:\fw\midicontroller\x011\controller.c
001892   0101     MOVLB     0x1                                                                                             
001894   5d16     SUBWF     0x16,0x0,0x1                                                                                    
001896   e018     BZ        0x18c8                                                                                          
001898   0e02     MOVLW     0x2            							curr_preset = 2;                                                          C:\fw\midicontroller\x011\controller.c
00189a   6f16     MOVWF     0x16,0x1                                                                                        
00189c   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
00189e   6ee6     MOVWF     0xe6,0x0                                                                                        
0018a0   ec28     CALL      0xc50,0x0                                                                                       
0018a2   f006                                                                                                               
0018a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018a6   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x011\controller.c
0018a8   5117     MOVF      0x17,0x0,0x1                                                                                    
0018aa   2b17     INCF      0x17,0x1,0x1                                                                                    
0018ac   6aea     CLRF      0xea,0x0                                                                                        
0018ae   0f08     ADDLW     0x8                                                                                             
0018b0   6ee9     MOVWF     0xe9,0x0                                                                                        
0018b2   0e01     MOVLW     0x1                                                                                             
0018b4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0018b6   c116     MOVFF     0x116,0xfef                                                                                     
0018b8   ffef                                                                                                               
0018ba   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x011\controller.c
0018bc   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x011\controller.c
0018be   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x011\controller.c
0018c0   0101     MOVLB     0x1                                                                                             
0018c2   5d17     SUBWF     0x17,0x0,0x1                                                                                    
0018c4   e101     BNZ       0x18c8                                                                                          
0018c6   dc6b     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x011\controller.c
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
0018c8   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         C:\fw\midicontroller\x011\controller.c
0018ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0018cc   6ae6     CLRF      0xe6,0x0                                                                                        
0018ce   ecff     CALL      0xdfe,0x0                                                                                       
0018d0   f006                                                                                                               
0018d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018d6   0900     IORLW     0x0                                                                                             
0018d8   e01c     BZ        0x1912                                                                                          
0018da   0e03     MOVLW     0x3            						if (curr_preset != 3) {                                                    C:\fw\midicontroller\x011\controller.c
0018dc   0101     MOVLB     0x1                                                                                             
0018de   5d16     SUBWF     0x16,0x0,0x1                                                                                    
0018e0   e018     BZ        0x1912                                                                                          
0018e2   0e03     MOVLW     0x3            							curr_preset = 3;                                                          C:\fw\midicontroller\x011\controller.c
0018e4   6f16     MOVWF     0x16,0x1                                                                                        
0018e6   0e01     MOVLW     0x1            							preset_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
0018e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0018ea   ec28     CALL      0xc50,0x0                                                                                       
0018ec   f006                                                                                                               
0018ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018f0   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   C:\fw\midicontroller\x011\controller.c
0018f2   5117     MOVF      0x17,0x0,0x1                                                                                    
0018f4   2b17     INCF      0x17,0x1,0x1                                                                                    
0018f6   6aea     CLRF      0xea,0x0                                                                                        
0018f8   0f08     ADDLW     0x8                                                                                             
0018fa   6ee9     MOVWF     0xe9,0x0                                                                                        
0018fc   0e01     MOVLW     0x1                                                                                             
0018fe   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001900   c116     MOVFF     0x116,0xfef                                                                                     
001902   ffef                                                                                                               
001904   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x011\controller.c
001906   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      C:\fw\midicontroller\x011\controller.c
001908   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 C:\fw\midicontroller\x011\controller.c
00190a   0101     MOVLB     0x1                                                                                             
00190c   5d17     SUBWF     0x17,0x0,0x1                                                                                    
00190e   e101     BNZ       0x1912                                                                                          
001910   dc46     RCALL     0x119e         								sequence_complete();                                                     C:\fw\midicontroller\x011\controller.c
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           					/* ENTER pressed */                                                         C:\fw\midicontroller\x011\controller.c
001912   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            C:\fw\midicontroller\x011\controller.c
001914   6ee6     MOVWF     0xe6,0x0                                                                                        
001916   6ae6     CLRF      0xe6,0x0                                                                                        
001918   ecff     CALL      0xdfe,0x0                                                                                       
00191a   f006                                                                                                               
00191c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00191e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001920   0900     IORLW     0x0                                                                                             
001922   e001     BZ        0x1926                                                                                          
                                           						/* stop programming early and save the sequence: */                        C:\fw\midicontroller\x011\controller.c
001924   dc3c     RCALL     0x119e         						sequence_complete();                                                       C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
001926   d035     BRA       0x1992         					break;                                                                      C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           				/* sequence repeat mode: */                                                  C:\fw\midicontroller\x011\controller.c
                                           				case PROGRAM_COMPLETE:                                                       C:\fw\midicontroller\x011\controller.c
001928   512f     MOVF      0x2f,0x0,0x1   					if (cdtimer_holdenter == 0) {                                               C:\fw\midicontroller\x011\controller.c
00192a   1130     IORWF     0x30,0x0,0x1                                                                                    
00192c   e131     BNZ       0x1990                                                                                          
00192e   0101     MOVLB     0x1            						if (curr_mapindex == bankmap_count) {                                      C:\fw\midicontroller\x011\controller.c
001930   5110     MOVF      0x10,0x0,0x1                                                                                    
001932   5d17     SUBWF     0x17,0x0,0x1                                                                                    
001934   e10a     BNZ       0x194a                                                                                          
                                           							/* we're done! */                                                         C:\fw\midicontroller\x011\controller.c
001936   0101     MOVLB     0x1            							program_mode = PROGRAM_NONE;                                              C:\fw\midicontroller\x011\controller.c
001938   6b33     CLRF      0x33,0x1                                                                                        
00193a   0101     MOVLB     0x1            							curr_mapindex = 0;                                                        C:\fw\midicontroller\x011\controller.c
00193c   6b17     CLRF      0x17,0x1                                                                                        
00193e   0e01     MOVLW     0x1            							bankmap_activate(1);                                                      C:\fw\midicontroller\x011\controller.c
001940   6ee6     MOVWF     0xe6,0x0                                                                                        
001942   ec4d     CALL      0xc9a,0x0                                                                                       
001944   f006                                                                                                               
001946   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001948   d023     BRA       0x1990         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
                                           							/* set the next LED active */                                             C:\fw\midicontroller\x011\controller.c
00194a   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           C:\fw\midicontroller\x011\controller.c
00194c   f006                                                                                                               
00194e   0101     MOVLB     0x1            							curr_preset = bankmap[curr_mapindex];                                     C:\fw\midicontroller\x011\controller.c
001950   5117     MOVF      0x17,0x0,0x1                                                                                    
001952   6aea     CLRF      0xea,0x0                                                                                        
001954   0f08     ADDLW     0x8                                                                                             
001956   6ee9     MOVWF     0xe9,0x0                                                                                        
001958   0e01     MOVLW     0x1                                                                                             
00195a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00195c   cfef     MOVFF     0xfef,0x116                                                                                     
00195e   f116                                                                                                               
001960   5116     MOVF      0x16,0x0,0x1   							fsw_led_set_active(curr_preset);                                          C:\fw\midicontroller\x011\controller.c
001962   6ee6     MOVWF     0xe6,0x0                                                                                        
001964   6ae6     CLRF      0xe6,0x0                                                                                        
001966   ecf3     CALL      0x27e6,0x0                                                                                      
001968   f013                                                                                                               
00196a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00196c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00196e   0101     MOVLB     0x1            							curr_program = bank[curr_preset];                                         C:\fw\midicontroller\x011\controller.c
001970   5116     MOVF      0x16,0x0,0x1                                                                                    
001972   6aea     CLRF      0xea,0x0                                                                                        
001974   0f00     ADDLW     0x0                                                                                             
001976   6ee9     MOVWF     0xe9,0x0                                                                                        
001978   0e01     MOVLW     0x1                                                                                             
00197a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00197c   cfef     MOVFF     0xfef,0x115                                                                                     
00197e   f115                                                                                                               
001980   ece8     CALL      0xbd0,0x0      							show_program();                                                           C:\fw\midicontroller\x011\controller.c
001982   f005                                                                                                               
001984   0101     MOVLB     0x1            							++curr_mapindex;                                                          C:\fw\midicontroller\x011\controller.c
001986   2b17     INCF      0x17,0x1,0x1                                                                                    
001988   0e32     MOVLW     0x32           							cdtimer_holdenter = 50;                                                   C:\fw\midicontroller\x011\controller.c
00198a   0101     MOVLB     0x1                                                                                             
00198c   6f2f     MOVWF     0x2f,0x1                                                                                        
00198e   6b30     CLRF      0x30,0x1                                                                                        
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
001990   d000     BRA       0x1992         					break;                                                                      C:\fw\midicontroller\x011\controller.c
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
001992   d1ea     BRA       0x1d68         			break;                                                                        C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           		case MODE_CONCERT:                                                             C:\fw\midicontroller\x011\controller.c
                                           			/*                                                                            C:\fw\midicontroller\x011\controller.c
                                           				next/prev buttons move bank map index pointer up/down by 1, cycling up/down bank # when bank C:\fw\midicontroller\x011\controller.c
                                           				map boundaries are crossed.  Single-digit 7-segment display shows map index # as 1-8. C:\fw\midicontroller\x011\controller.c
                                           				inc/dec buttons move through banks, resetting bank map index to 0.  Bank name displays on 4-digit display. C:\fw\midicontroller\x011\controller.c
                                           				preset button 1-4: change program # immediately, showing program # on 4-digit display for .5 sec, C:\fw\midicontroller\x011\controller.c
                                           				reverting display back to bank name.                                         C:\fw\midicontroller\x011\controller.c
                                           			*/                                                                            C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           			/* one of preset 1-4 pressed: */                                              C:\fw\midicontroller\x011\controller.c
001994   0e01     MOVLW     0x1            			if (button_pressed(FSM_PRESET_1)) {                                           C:\fw\midicontroller\x011\controller.c
001996   6ee6     MOVWF     0xe6,0x0                                                                                        
001998   6ae6     CLRF      0xe6,0x0                                                                                        
00199a   ecff     CALL      0xdfe,0x0                                                                                       
00199c   f006                                                                                                               
00199e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a2   0900     IORLW     0x0                                                                                             
0019a4   e007     BZ        0x19b4                                                                                          
0019a6   0101     MOVLB     0x1            				curr_preset = 0;                                                             C:\fw\midicontroller\x011\controller.c
0019a8   6b16     CLRF      0x16,0x1                                                                                        
0019aa   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x011\controller.c
0019ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0019ae   ec28     CALL      0xc50,0x0                                                                                       
0019b0   f006                                                                                                               
0019b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
0019b4   0e02     MOVLW     0x2            			if (button_pressed(FSM_PRESET_2)) {                                           C:\fw\midicontroller\x011\controller.c
0019b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0019b8   6ae6     CLRF      0xe6,0x0                                                                                        
0019ba   ecff     CALL      0xdfe,0x0                                                                                       
0019bc   f006                                                                                                               
0019be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c2   0900     IORLW     0x0                                                                                             
0019c4   e007     BZ        0x19d4                                                                                          
0019c6   0101     MOVLB     0x1            				curr_preset = 1;                                                             C:\fw\midicontroller\x011\controller.c
0019c8   0e01     MOVLW     0x1                                                                                             
0019ca   6f16     MOVWF     0x16,0x1                                                                                        
0019cc   6ee6     MOVWF     0xe6,0x0       				preset_activate(1);                                                          C:\fw\midicontroller\x011\controller.c
0019ce   ec28     CALL      0xc50,0x0                                                                                       
0019d0   f006                                                                                                               
0019d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
0019d4   0e04     MOVLW     0x4            			if (button_pressed(FSM_PRESET_3)) {                                           C:\fw\midicontroller\x011\controller.c
0019d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0019d8   6ae6     CLRF      0xe6,0x0                                                                                        
0019da   ecff     CALL      0xdfe,0x0                                                                                       
0019dc   f006                                                                                                               
0019de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019e2   0900     IORLW     0x0                                                                                             
0019e4   e008     BZ        0x19f6                                                                                          
0019e6   0101     MOVLB     0x1            				curr_preset = 2;                                                             C:\fw\midicontroller\x011\controller.c
0019e8   0e02     MOVLW     0x2                                                                                             
0019ea   6f16     MOVWF     0x16,0x1                                                                                        
0019ec   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x011\controller.c
0019ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0019f0   ec28     CALL      0xc50,0x0                                                                                       
0019f2   f006                                                                                                               
0019f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
0019f6   0e08     MOVLW     0x8            			if (button_pressed(FSM_PRESET_4)) {                                           C:\fw\midicontroller\x011\controller.c
0019f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0019fa   6ae6     CLRF      0xe6,0x0                                                                                        
0019fc   ecff     CALL      0xdfe,0x0                                                                                       
0019fe   f006                                                                                                               
001a00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a04   0900     IORLW     0x0                                                                                             
001a06   e008     BZ        0x1a18                                                                                          
001a08   0101     MOVLB     0x1            				curr_preset = 3;                                                             C:\fw\midicontroller\x011\controller.c
001a0a   0e03     MOVLW     0x3                                                                                             
001a0c   6f16     MOVWF     0x16,0x1                                                                                        
001a0e   0e01     MOVLW     0x1            				preset_activate(1);                                                          C:\fw\midicontroller\x011\controller.c
001a10   6ee6     MOVWF     0xe6,0x0                                                                                        
001a12   ec28     CALL      0xc50,0x0                                                                                       
001a14   f006                                                                                                               
001a16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           			/* INC pressed: */                                                            C:\fw\midicontroller\x011\controller.c
001a18   0e00     MOVLW     0x0            			if (button_pressed(FSM_INC)) {                                                C:\fw\midicontroller\x011\controller.c
001a1a   6ee6     MOVWF     0xe6,0x0                                                                                        
001a1c   6ae6     CLRF      0xe6,0x0                                                                                        
001a1e   ecff     CALL      0xdfe,0x0                                                                                       
001a20   f006                                                                                                               
001a22   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a24   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a26   0900     IORLW     0x0                                                                                             
001a28   e021     BZ        0x1a6c                                                                                          
001a2a   c11e     MOVFF     0x11e,0x10     				if (curr_bank == bank_count - 1) curr_bank = 0;                              C:\fw\midicontroller\x011\controller.c
001a2c   f010                                                                                                               
001a2e   c11f     MOVFF     0x11f,0x11                                                                                      
001a30   f011                                                                                                               
001a32   0610     DECF      0x10,0x1,0x0                                                                                    
001a34   0e00     MOVLW     0x0                                                                                             
001a36   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001a38   5010     MOVF      0x10,0x0,0x0                                                                                    
001a3a   0101     MOVLB     0x1                                                                                             
001a3c   1918     XORWF     0x18,0x0,0x1                                                                                    
001a3e   e102     BNZ       0x1a44                                                                                          
001a40   5011     MOVF      0x11,0x0,0x0                                                                                    
001a42   1919     XORWF     0x19,0x0,0x1                                                                                    
001a44   e103     BNZ       0x1a4c                                                                                          
001a46   6b18     CLRF      0x18,0x1                                                                                        
001a48   6b19     CLRF      0x19,0x1                                                                                        
001a4a   d003     BRA       0x1a52         				else ++curr_bank;                                                            C:\fw\midicontroller\x011\controller.c
001a4c   2b18     INCF      0x18,0x1,0x1                                                                                    
001a4e   0e00     MOVLW     0x0                                                                                             
001a50   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001a52   ecb9     CALL      0xd72,0x0      				bank_showname();                                                             C:\fw\midicontroller\x011\controller.c
001a54   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
001a56   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x011\controller.c
001a58   6b31     CLRF      0x31,0x1                                                                                        
001a5a   c135     MOVFF     0x135,0x120    				accel_time = accel_time_slow;                                                C:\fw\midicontroller\x011\controller.c
001a5c   f120                                                                                                               
001a5e   c136     MOVFF     0x136,0x121                                                                                     
001a60   f121                                                                                                               
001a62   0101     MOVLB     0x1            				accel_count = 0;                                                             C:\fw\midicontroller\x011\controller.c
001a64   6b22     CLRF      0x22,0x1                                                                                        
001a66   0101     MOVLB     0x1            				accel_state = ACCEL_INC_SLOW;                                                C:\fw\midicontroller\x011\controller.c
001a68   0e01     MOVLW     0x1                                                                                             
001a6a   6f31     MOVWF     0x31,0x1                                                                                        
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                           			/* INC released: */                                                           C:\fw\midicontroller\x011\controller.c
001a6c   0e00     MOVLW     0x0            			if (button_released(FSM_INC)) {                                               C:\fw\midicontroller\x011\controller.c
001a6e   6ee6     MOVWF     0xe6,0x0                                                                                        
001a70   6ae6     CLRF      0xe6,0x0                                                                                        
001a72   ec4e     CALL      0xe9c,0x0                                                                                       
001a74   f007                                                                                                               
001a76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a7a   0900     IORLW     0x0                                                                                             
001a7c   e006     BZ        0x1a8a                                                                                          
001a7e   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x011\controller.c
001a80   6b31     CLRF      0x31,0x1                                                                                        
                                           				/* load the bank, but don't change program # */                              C:\fw\midicontroller\x011\controller.c
001a82   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            C:\fw\midicontroller\x011\controller.c
001a84   ec68     CALL      0xcd0,0x0                                                                                       
001a86   f006                                                                                                               
001a88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           			/* DEC pressed: */                                                            C:\fw\midicontroller\x011\controller.c
001a8a   0e00     MOVLW     0x0            			if (button_pressed(FSM_DEC)) {                                                C:\fw\midicontroller\x011\controller.c
001a8c   6ee6     MOVWF     0xe6,0x0                                                                                        
001a8e   6ae6     CLRF      0xe6,0x0                                                                                        
001a90   ecff     CALL      0xdfe,0x0                                                                                       
001a92   f006                                                                                                               
001a94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a98   0900     IORLW     0x0                                                                                             
001a9a   e01d     BZ        0x1ad6                                                                                          
001a9c   0101     MOVLB     0x1            				if (curr_bank == 0) curr_bank = bank_count - 1;                              C:\fw\midicontroller\x011\controller.c
001a9e   5118     MOVF      0x18,0x0,0x1                                                                                    
001aa0   1119     IORWF     0x19,0x0,0x1                                                                                    
001aa2   e109     BNZ       0x1ab6                                                                                          
001aa4   c11e     MOVFF     0x11e,0x118                                                                                     
001aa6   f118                                                                                                               
001aa8   c11f     MOVFF     0x11f,0x119                                                                                     
001aaa   f119                                                                                                               
001aac   0e01     MOVLW     0x1                                                                                             
001aae   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001ab0   0e00     MOVLW     0x0                                                                                             
001ab2   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001ab4   d003     BRA       0x1abc         				else --curr_bank;                                                            C:\fw\midicontroller\x011\controller.c
001ab6   0718     DECF      0x18,0x1,0x1                                                                                    
001ab8   0e00     MOVLW     0x0                                                                                             
001aba   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001abc   ecb9     CALL      0xd72,0x0      				bank_showname();                                                             C:\fw\midicontroller\x011\controller.c
001abe   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
001ac0   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x011\controller.c
001ac2   6b31     CLRF      0x31,0x1                                                                                        
001ac4   c135     MOVFF     0x135,0x120    				accel_time = accel_time_slow;                                                C:\fw\midicontroller\x011\controller.c
001ac6   f120                                                                                                               
001ac8   c136     MOVFF     0x136,0x121                                                                                     
001aca   f121                                                                                                               
001acc   0101     MOVLB     0x1            				accel_count = 0;                                                             C:\fw\midicontroller\x011\controller.c
001ace   6b22     CLRF      0x22,0x1                                                                                        
001ad0   0101     MOVLB     0x1            				accel_state = ACCEL_DEC_SLOW;                                                C:\fw\midicontroller\x011\controller.c
001ad2   0e04     MOVLW     0x4                                                                                             
001ad4   6f31     MOVWF     0x31,0x1                                                                                        
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                           			/* DEC released: */                                                           C:\fw\midicontroller\x011\controller.c
001ad6   0e00     MOVLW     0x0            			if (button_released(FSM_DEC)) {                                               C:\fw\midicontroller\x011\controller.c
001ad8   6ee6     MOVWF     0xe6,0x0                                                                                        
001ada   6ae6     CLRF      0xe6,0x0                                                                                        
001adc   ec4e     CALL      0xe9c,0x0                                                                                       
001ade   f007                                                                                                               
001ae0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ae2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ae4   0900     IORLW     0x0                                                                                             
001ae6   e006     BZ        0x1af4                                                                                          
001ae8   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    C:\fw\midicontroller\x011\controller.c
001aea   6b31     CLRF      0x31,0x1                                                                                        
                                           				/* load the bank, but don't change program # */                              C:\fw\midicontroller\x011\controller.c
001aec   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            C:\fw\midicontroller\x011\controller.c
001aee   ec68     CALL      0xcd0,0x0                                                                                       
001af0   f006                                                                                                               
001af2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           			/* PREV/ENTER pressed: */                                                     C:\fw\midicontroller\x011\controller.c
001af4   0e00     MOVLW     0x0            			if (button_pressed(FSM_ENTER)) {                                              C:\fw\midicontroller\x011\controller.c
001af6   6ee6     MOVWF     0xe6,0x0                                                                                        
001af8   6ae6     CLRF      0xe6,0x0                                                                                        
001afa   ecff     CALL      0xdfe,0x0                                                                                       
001afc   f006                                                                                                               
001afe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b02   0900     IORLW     0x0                                                                                             
001b04   e048     BZ        0x1b96                                                                                          
001b06   0101     MOVLB     0x1            				if (loaded_bank != curr_bank) {                                              C:\fw\midicontroller\x011\controller.c
001b08   5118     MOVF      0x18,0x0,0x1                                                                                    
001b0a   191a     XORWF     0x1a,0x0,0x1                                                                                    
001b0c   e102     BNZ       0x1b12                                                                                          
001b0e   5119     MOVF      0x19,0x0,0x1                                                                                    
001b10   191b     XORWF     0x1b,0x0,0x1                                                                                    
001b12   e006     BZ        0x1b20                                                                                          
                                           					/* prepared to switch to a bank, but did not activate the first map */      C:\fw\midicontroller\x011\controller.c
001b14   0e01     MOVLW     0x1            					bankmap_activate(1);                                                        C:\fw\midicontroller\x011\controller.c
001b16   6ee6     MOVWF     0xe6,0x0                                                                                        
001b18   ec4d     CALL      0xc9a,0x0                                                                                       
001b1a   f006                                                                                                               
001b1c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b1e   d03b     BRA       0x1b96         				} else {                                                                     C:\fw\midicontroller\x011\controller.c
001b20   5117     MOVF      0x17,0x0,0x1   					if (curr_mapindex == 0) {                                                   C:\fw\midicontroller\x011\controller.c
001b22   e133     BNZ       0x1b8a                                                                                          
                                           						/* crossed the lower bank-map boundary, load the previous bank */          C:\fw\midicontroller\x011\controller.c
001b24   5123     MOVF      0x23,0x0,0x1   						if (mode == MODE_PRACTICE) {                                               C:\fw\midicontroller\x011\controller.c
001b26   e115     BNZ       0x1b52                                                                                          
                                           							/* PRACTICE mode cycles through banks by sorted index #: */               C:\fw\midicontroller\x011\controller.c
001b28   511c     MOVF      0x1c,0x0,0x1   							if (curr_sortedbank == 0) {                                               C:\fw\midicontroller\x011\controller.c
001b2a   111d     IORWF     0x1d,0x0,0x1                                                                                    
001b2c   e109     BNZ       0x1b40                                                                                          
001b2e   c11e     MOVFF     0x11e,0x11c    								curr_sortedbank = bank_count - 1;                                        C:\fw\midicontroller\x011\controller.c
001b30   f11c                                                                                                               
001b32   c11f     MOVFF     0x11f,0x11d                                                                                     
001b34   f11d                                                                                                               
001b36   0e01     MOVLW     0x1                                                                                             
001b38   5f1c     SUBWF     0x1c,0x1,0x1                                                                                    
001b3a   0e00     MOVLW     0x0                                                                                             
001b3c   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
001b3e   d003     BRA       0x1b46         							} else {                                                                  C:\fw\midicontroller\x011\controller.c
001b40   071c     DECF      0x1c,0x1,0x1   								--curr_sortedbank;                                                       C:\fw\midicontroller\x011\controller.c
001b42   0e00     MOVLW     0x0                                                                                             
001b44   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           							/* show the bank name */                                                  C:\fw\midicontroller\x011\controller.c
001b46   0e01     MOVLW     0x1            							sortedbank_activate(1);                                                   C:\fw\midicontroller\x011\controller.c
001b48   6ee6     MOVWF     0xe6,0x0                                                                                        
001b4a   eca0     CALL      0xd40,0x0                                                                                       
001b4c   f006                                                                                                               
001b4e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b50   d014     BRA       0x1b7a         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
                                           							/* CONCERT mode cycles through banks by index #: */                       C:\fw\midicontroller\x011\controller.c
001b52   5118     MOVF      0x18,0x0,0x1   							if (curr_bank == 0) {                                                     C:\fw\midicontroller\x011\controller.c
001b54   1119     IORWF     0x19,0x0,0x1                                                                                    
001b56   e109     BNZ       0x1b6a                                                                                          
001b58   c11e     MOVFF     0x11e,0x118    								curr_bank = bank_count - 1;                                              C:\fw\midicontroller\x011\controller.c
001b5a   f118                                                                                                               
001b5c   c11f     MOVFF     0x11f,0x119                                                                                     
001b5e   f119                                                                                                               
001b60   0e01     MOVLW     0x1                                                                                             
001b62   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001b64   0e00     MOVLW     0x0                                                                                             
001b66   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001b68   d003     BRA       0x1b70         							} else {                                                                  C:\fw\midicontroller\x011\controller.c
001b6a   0718     DECF      0x18,0x1,0x1   								--curr_bank;                                                             C:\fw\midicontroller\x011\controller.c
001b6c   0e00     MOVLW     0x0                                                                                             
001b6e   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
                                           							}                                                                         C:\fw\midicontroller\x011\controller.c
                                           							/* show the bank name */                                                  C:\fw\midicontroller\x011\controller.c
001b70   0e01     MOVLW     0x1            							bank_activate(1);                                                         C:\fw\midicontroller\x011\controller.c
001b72   6ee6     MOVWF     0xe6,0x0                                                                                        
001b74   ec68     CALL      0xcd0,0x0                                                                                       
001b76   f006                                                                                                               
001b78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
                                           						/* activate the last map for the new bank, but do not display the MIDI program # */ C:\fw\midicontroller\x011\controller.c
001b7a   0101     MOVLB     0x1            						curr_mapindex = bankmap_count - 1;                                         C:\fw\midicontroller\x011\controller.c
001b7c   0510     DECF      0x10,0x0,0x1                                                                                    
001b7e   6f17     MOVWF     0x17,0x1                                                                                        
001b80   6ae6     CLRF      0xe6,0x0       						bankmap_activate(0);                                                       C:\fw\midicontroller\x011\controller.c
001b82   ec4d     CALL      0xc9a,0x0                                                                                       
001b84   f006                                                                                                               
001b86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b88   d006     BRA       0x1b96         					} else {                                                                    C:\fw\midicontroller\x011\controller.c
                                           						/* activate the previous map for the new bank, and display the MIDI program # */ C:\fw\midicontroller\x011\controller.c
001b8a   0717     DECF      0x17,0x1,0x1   						--curr_mapindex;                                                           C:\fw\midicontroller\x011\controller.c
001b8c   0e01     MOVLW     0x1            						bankmap_activate(1);                                                       C:\fw\midicontroller\x011\controller.c
001b8e   6ee6     MOVWF     0xe6,0x0                                                                                        
001b90   ec4d     CALL      0xc9a,0x0                                                                                       
001b92   f006                                                                                                               
001b94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           					}                                                                           C:\fw\midicontroller\x011\controller.c
                                           				}                                                                            C:\fw\midicontroller\x011\controller.c
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           			/* acceleration countdown timer hit 0 and we're incrementing slowly */        C:\fw\midicontroller\x011\controller.c
001b96   0101     MOVLB     0x1            			if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                       C:\fw\midicontroller\x011\controller.c
001b98   5131     MOVF      0x31,0x0,0x1                                                                                    
001b9a   e101     BNZ       0x1b9e                                                                                          
001b9c   d0e4     BRA       0x1d66                                                                                          
001b9e   0101     MOVLB     0x1                                                                                             
001ba0   5120     MOVF      0x20,0x0,0x1                                                                                    
001ba2   1121     IORWF     0x21,0x0,0x1                                                                                    
001ba4   e001     BZ        0x1ba8                                                                                          
001ba6   d0df     BRA       0x1d66                                                                                          
001ba8   0101     MOVLB     0x1            				switch (accel_state) {                                                       C:\fw\midicontroller\x011\controller.c
001baa   5131     MOVF      0x31,0x0,0x1                                                                                    
001bac   0a06     XORLW     0x6                                                                                             
001bae   e101     BNZ       0x1bb2                                                                                          
001bb0   d0c3     BRA       0x1d38                                                                                          
001bb2   0a03     XORLW     0x3                                                                                             
001bb4   e101     BNZ       0x1bb8                                                                                          
001bb6   d09b     BRA       0x1cee                                                                                          
001bb8   0a01     XORLW     0x1                                                                                             
001bba   e074     BZ        0x1ca4                                                                                          
001bbc   0a07     XORLW     0x7                                                                                             
001bbe   e057     BZ        0x1c6e                                                                                          
001bc0   0a01     XORLW     0x1                                                                                             
001bc2   e02c     BZ        0x1c1c                                                                                          
001bc4   0a03     XORLW     0x3                                                                                             
001bc6   e001     BZ        0x1bca                                                                                          
001bc8   d0ce     BRA       0x1d66                                                                                          
                                           					case ACCEL_INC_SLOW:                                                        C:\fw\midicontroller\x011\controller.c
001bca   c11e     MOVFF     0x11e,0x10     						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x011\controller.c
001bcc   f010                                                                                                               
001bce   c11f     MOVFF     0x11f,0x11                                                                                      
001bd0   f011                                                                                                               
001bd2   0610     DECF      0x10,0x1,0x0                                                                                    
001bd4   0e00     MOVLW     0x0                                                                                             
001bd6   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001bd8   5010     MOVF      0x10,0x0,0x0                                                                                    
001bda   0101     MOVLB     0x1                                                                                             
001bdc   1918     XORWF     0x18,0x0,0x1                                                                                    
001bde   e102     BNZ       0x1be4                                                                                          
001be0   5011     MOVF      0x11,0x0,0x0                                                                                    
001be2   1919     XORWF     0x19,0x0,0x1                                                                                    
001be4   e103     BNZ       0x1bec                                                                                          
001be6   6b18     CLRF      0x18,0x1                                                                                        
001be8   6b19     CLRF      0x19,0x1                                                                                        
001bea   d003     BRA       0x1bf2         						else ++curr_bank;                                                          C:\fw\midicontroller\x011\controller.c
001bec   2b18     INCF      0x18,0x1,0x1                                                                                    
001bee   0e00     MOVLW     0x0                                                                                             
001bf0   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001bf2   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x011\controller.c
001bf4   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x011\controller.c
001bf6   0101     MOVLB     0x1            						if (accel_count++ == 5) {                                                  C:\fw\midicontroller\x011\controller.c
001bf8   5122     MOVF      0x22,0x0,0x1                                                                                    
001bfa   2b22     INCF      0x22,0x1,0x1                                                                                    
001bfc   0805     SUBLW     0x5                                                                                             
001bfe   e109     BNZ       0x1c12                                                                                          
001c00   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x011\controller.c
001c02   0101     MOVLB     0x1            							accel_state = ACCEL_INC_MEDIUM;                                           C:\fw\midicontroller\x011\controller.c
001c04   0e02     MOVLW     0x2                                                                                             
001c06   6f31     MOVWF     0x31,0x1                                                                                        
001c08   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x011\controller.c
001c0a   f120                                                                                                               
001c0c   c138     MOVFF     0x138,0x121                                                                                     
001c0e   f121                                                                                                               
001c10   d004     BRA       0x1c1a         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
001c12   c135     MOVFF     0x135,0x120    							accel_time = accel_time_slow;                                             C:\fw\midicontroller\x011\controller.c
001c14   f120                                                                                                               
001c16   c136     MOVFF     0x136,0x121                                                                                     
001c18   f121                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
001c1a   d0a5     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x011\controller.c
                                           					case ACCEL_INC_MEDIUM:                                                      C:\fw\midicontroller\x011\controller.c
001c1c   c11e     MOVFF     0x11e,0x10     						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x011\controller.c
001c1e   f010                                                                                                               
001c20   c11f     MOVFF     0x11f,0x11                                                                                      
001c22   f011                                                                                                               
001c24   0610     DECF      0x10,0x1,0x0                                                                                    
001c26   0e00     MOVLW     0x0                                                                                             
001c28   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c2a   5010     MOVF      0x10,0x0,0x0                                                                                    
001c2c   0101     MOVLB     0x1                                                                                             
001c2e   1918     XORWF     0x18,0x0,0x1                                                                                    
001c30   e102     BNZ       0x1c36                                                                                          
001c32   5011     MOVF      0x11,0x0,0x0                                                                                    
001c34   1919     XORWF     0x19,0x0,0x1                                                                                    
001c36   e103     BNZ       0x1c3e                                                                                          
001c38   6b18     CLRF      0x18,0x1                                                                                        
001c3a   6b19     CLRF      0x19,0x1                                                                                        
001c3c   d003     BRA       0x1c44         						else ++curr_bank;                                                          C:\fw\midicontroller\x011\controller.c
001c3e   2b18     INCF      0x18,0x1,0x1                                                                                    
001c40   0e00     MOVLW     0x0                                                                                             
001c42   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001c44   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x011\controller.c
001c46   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x011\controller.c
001c48   0101     MOVLB     0x1            						if (accel_count++ == 20) {                                                 C:\fw\midicontroller\x011\controller.c
001c4a   5122     MOVF      0x22,0x0,0x1                                                                                    
001c4c   2b22     INCF      0x22,0x1,0x1                                                                                    
001c4e   0814     SUBLW     0x14                                                                                            
001c50   e109     BNZ       0x1c64                                                                                          
001c52   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x011\controller.c
001c54   0101     MOVLB     0x1            							accel_state = ACCEL_INC_FAST;                                             C:\fw\midicontroller\x011\controller.c
001c56   0e03     MOVLW     0x3                                                                                             
001c58   6f31     MOVWF     0x31,0x1                                                                                        
001c5a   c139     MOVFF     0x139,0x120    							accel_time = accel_time_fast;                                             C:\fw\midicontroller\x011\controller.c
001c5c   f120                                                                                                               
001c5e   c13a     MOVFF     0x13a,0x121                                                                                     
001c60   f121                                                                                                               
001c62   d004     BRA       0x1c6c         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
001c64   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x011\controller.c
001c66   f120                                                                                                               
001c68   c138     MOVFF     0x138,0x121                                                                                     
001c6a   f121                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
001c6c   d07c     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x011\controller.c
                                           					case ACCEL_INC_FAST:                                                        C:\fw\midicontroller\x011\controller.c
001c6e   c11e     MOVFF     0x11e,0x10     						if (curr_bank == bank_count - 1) curr_bank = 0;                            C:\fw\midicontroller\x011\controller.c
001c70   f010                                                                                                               
001c72   c11f     MOVFF     0x11f,0x11                                                                                      
001c74   f011                                                                                                               
001c76   0610     DECF      0x10,0x1,0x0                                                                                    
001c78   0e00     MOVLW     0x0                                                                                             
001c7a   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c7c   5010     MOVF      0x10,0x0,0x0                                                                                    
001c7e   0101     MOVLB     0x1                                                                                             
001c80   1918     XORWF     0x18,0x0,0x1                                                                                    
001c82   e102     BNZ       0x1c88                                                                                          
001c84   5011     MOVF      0x11,0x0,0x0                                                                                    
001c86   1919     XORWF     0x19,0x0,0x1                                                                                    
001c88   e103     BNZ       0x1c90                                                                                          
001c8a   6b18     CLRF      0x18,0x1                                                                                        
001c8c   6b19     CLRF      0x19,0x1                                                                                        
001c8e   d003     BRA       0x1c96         						else ++curr_bank;                                                          C:\fw\midicontroller\x011\controller.c
001c90   2b18     INCF      0x18,0x1,0x1                                                                                    
001c92   0e00     MOVLW     0x0                                                                                             
001c94   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001c96   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x011\controller.c
001c98   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
001c9a   c139     MOVFF     0x139,0x120    						accel_time = accel_time_fast;                                              C:\fw\midicontroller\x011\controller.c
001c9c   f120                                                                                                               
001c9e   c13a     MOVFF     0x13a,0x121                                                                                     
001ca0   f121                                                                                                               
001ca2   d061     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x011\controller.c
                                           					case ACCEL_DEC_SLOW:                                                        C:\fw\midicontroller\x011\controller.c
001ca4   0101     MOVLB     0x1            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x011\controller.c
001ca6   5118     MOVF      0x18,0x0,0x1                                                                                    
001ca8   1119     IORWF     0x19,0x0,0x1                                                                                    
001caa   e109     BNZ       0x1cbe                                                                                          
001cac   c11e     MOVFF     0x11e,0x118                                                                                     
001cae   f118                                                                                                               
001cb0   c11f     MOVFF     0x11f,0x119                                                                                     
001cb2   f119                                                                                                               
001cb4   0e01     MOVLW     0x1                                                                                             
001cb6   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001cb8   0e00     MOVLW     0x0                                                                                             
001cba   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001cbc   d003     BRA       0x1cc4         						else --curr_bank;                                                          C:\fw\midicontroller\x011\controller.c
001cbe   0718     DECF      0x18,0x1,0x1                                                                                    
001cc0   0e00     MOVLW     0x0                                                                                             
001cc2   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001cc4   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x011\controller.c
001cc6   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x011\controller.c
001cc8   0101     MOVLB     0x1            						if (accel_count++ == 5) {                                                  C:\fw\midicontroller\x011\controller.c
001cca   5122     MOVF      0x22,0x0,0x1                                                                                    
001ccc   2b22     INCF      0x22,0x1,0x1                                                                                    
001cce   0805     SUBLW     0x5                                                                                             
001cd0   e109     BNZ       0x1ce4                                                                                          
001cd2   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x011\controller.c
001cd4   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_MEDIUM;                                           C:\fw\midicontroller\x011\controller.c
001cd6   0e05     MOVLW     0x5                                                                                             
001cd8   6f31     MOVWF     0x31,0x1                                                                                        
001cda   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x011\controller.c
001cdc   f120                                                                                                               
001cde   c138     MOVFF     0x138,0x121                                                                                     
001ce0   f121                                                                                                               
001ce2   d004     BRA       0x1cec         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
001ce4   c135     MOVFF     0x135,0x120    							accel_time = accel_time_slow;                                             C:\fw\midicontroller\x011\controller.c
001ce6   f120                                                                                                               
001ce8   c136     MOVFF     0x136,0x121                                                                                     
001cea   f121                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
001cec   d03c     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x011\controller.c
                                           					case ACCEL_DEC_MEDIUM:                                                      C:\fw\midicontroller\x011\controller.c
001cee   0101     MOVLB     0x1            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x011\controller.c
001cf0   5118     MOVF      0x18,0x0,0x1                                                                                    
001cf2   1119     IORWF     0x19,0x0,0x1                                                                                    
001cf4   e109     BNZ       0x1d08                                                                                          
001cf6   c11e     MOVFF     0x11e,0x118                                                                                     
001cf8   f118                                                                                                               
001cfa   c11f     MOVFF     0x11f,0x119                                                                                     
001cfc   f119                                                                                                               
001cfe   0e01     MOVLW     0x1                                                                                             
001d00   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001d02   0e00     MOVLW     0x0                                                                                             
001d04   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d06   d003     BRA       0x1d0e         						else --curr_bank;                                                          C:\fw\midicontroller\x011\controller.c
001d08   0718     DECF      0x18,0x1,0x1                                                                                    
001d0a   0e00     MOVLW     0x0                                                                                             
001d0c   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d0e   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x011\controller.c
001d10   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               C:\fw\midicontroller\x011\controller.c
001d12   0101     MOVLB     0x1            						if (accel_count++ == 20) {                                                 C:\fw\midicontroller\x011\controller.c
001d14   5122     MOVF      0x22,0x0,0x1                                                                                    
001d16   2b22     INCF      0x22,0x1,0x1                                                                                    
001d18   0814     SUBLW     0x14                                                                                            
001d1a   e109     BNZ       0x1d2e                                                                                          
001d1c   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          C:\fw\midicontroller\x011\controller.c
001d1e   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_FAST;                                             C:\fw\midicontroller\x011\controller.c
001d20   0e06     MOVLW     0x6                                                                                             
001d22   6f31     MOVWF     0x31,0x1                                                                                        
001d24   c139     MOVFF     0x139,0x120    							accel_time = accel_time_fast;                                             C:\fw\midicontroller\x011\controller.c
001d26   f120                                                                                                               
001d28   c13a     MOVFF     0x13a,0x121                                                                                     
001d2a   f121                                                                                                               
001d2c   d004     BRA       0x1d36         						} else {                                                                   C:\fw\midicontroller\x011\controller.c
001d2e   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           C:\fw\midicontroller\x011\controller.c
001d30   f120                                                                                                               
001d32   c138     MOVFF     0x138,0x121                                                                                     
001d34   f121                                                                                                               
                                           						}                                                                          C:\fw\midicontroller\x011\controller.c
001d36   d017     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x011\controller.c
                                           					case ACCEL_DEC_FAST:                                                        C:\fw\midicontroller\x011\controller.c
001d38   0101     MOVLB     0x1            						if (curr_bank == 0) curr_bank = bank_count - 1;                            C:\fw\midicontroller\x011\controller.c
001d3a   5118     MOVF      0x18,0x0,0x1                                                                                    
001d3c   1119     IORWF     0x19,0x0,0x1                                                                                    
001d3e   e109     BNZ       0x1d52                                                                                          
001d40   c11e     MOVFF     0x11e,0x118                                                                                     
001d42   f118                                                                                                               
001d44   c11f     MOVFF     0x11f,0x119                                                                                     
001d46   f119                                                                                                               
001d48   0e01     MOVLW     0x1                                                                                             
001d4a   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001d4c   0e00     MOVLW     0x0                                                                                             
001d4e   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d50   d003     BRA       0x1d58         						else --curr_bank;                                                          C:\fw\midicontroller\x011\controller.c
001d52   0718     DECF      0x18,0x1,0x1                                                                                    
001d54   0e00     MOVLW     0x0                                                                                             
001d56   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d58   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           C:\fw\midicontroller\x011\controller.c
001d5a   f006                                                                                                               
                                                                                                                            C:\fw\midicontroller\x011\controller.c
001d5c   c139     MOVFF     0x139,0x120    						accel_time = accel_time_fast;                                              C:\fw\midicontroller\x011\controller.c
001d5e   f120                                                                                                               
001d60   c13a     MOVFF     0x13a,0x121                                                                                     
001d62   f121                                                                                                               
001d64   d000     BRA       0x1d66         						break;                                                                     C:\fw\midicontroller\x011\controller.c
                                           				}                                                                            C:\fw\midicontroller\x011\controller.c
                                           			}                                                                             C:\fw\midicontroller\x011\controller.c
001d66   d000     BRA       0x1d68         			break;                                                                        C:\fw\midicontroller\x011\controller.c
                                           	}                                                                               C:\fw\midicontroller\x011\controller.c
001d68   c13d     MOVFF     0x13d,0x13f    	sw_last = sw_curr;                                                              C:\fw\midicontroller\x011\controller.c
001d6a   f13f                                                                                                               
001d6c   c13e     MOVFF     0x13e,0x140                                                                                     
001d6e   f140                                                                                                               
001d70   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\controller.c
                                           ;###########################################################################     C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;#			Author: Joe Dunne											  #                                             C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;#			Date 4/06/07					      						  #                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;#			This file handles writing to the FLASH  (ROM).				  #                       C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;#			File Name: writeprogmem.asm   										  #                                 C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;#														 				  #                                                         C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;############################################################################    C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           	INCLUDE "p18F4455.inc"                                                          C:\fw\midicontroller\x011\writeprogmem.asm
                                                   LIST                                                                     C:\fw\midicontroller\x011\p18F4455.inc
                                                                                                                            C:\fw\midicontroller\x011\p18F4455.inc
                                           ;==========================================================================      C:\fw\midicontroller\x011\p18F4455.inc
                                           ;  $Id: P18F4455.INC,v 1.9 2006/10/25 17:47:56 nairnj Exp $                      C:\fw\midicontroller\x011\p18F4455.inc
                                           ;  MPASM PIC18F4455 processor include                                            C:\fw\midicontroller\x011\p18F4455.inc
                                           ;                                                                                C:\fw\midicontroller\x011\p18F4455.inc
                                           ;  (c) Copyright 1999-2006 Microchip Technology, All rights reserved             C:\fw\midicontroller\x011\p18F4455.inc
                                           ;==========================================================================      C:\fw\midicontroller\x011\p18F4455.inc
                                                                                                                            C:\fw\midicontroller\x011\p18F4455.inc
                                                   LIST                                                                     C:\fw\midicontroller\x011\p18F4455.inc
                                           	LIST R=DEC                                                                      C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           	extern	WpmCounter, WpmCounter1                                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           	global	READ_BLOCK_FROM_ROM, WRITE_BLOCK_INTO_ROM                                C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           	code                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;void	Read64BytesFromRom(                                                        C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;;READ_BLOCK_FROM_ROM                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;Before calling, set FSR0 = address of RAM buffer                                C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;Also, set TLPTR = address of ROM to read into RAM.                              C:\fw\midicontroller\x011\writeprogmem.asm
                                           READ_BLOCK_FROM_ROM                                                              C:\fw\midicontroller\x011\writeprogmem.asm
0034c6   0100     MOVLB     0x0            	movlb	high(WpmCounter)	;set appropriate bank.                                   C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
0034c8   0e40     MOVLW     0x40           	MOVLW	64			; number of bytes in erase block                                     C:\fw\midicontroller\x011\writeprogmem.asm
0034ca   6fb9     MOVWF     0xb9,0x1       	MOVWF	WpmCounter                                                                C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW BUFFER_ADDR_HIGH 		; point to buffer                                     C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF FSR0H                                                                    C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW BUFFER_ADDR_LOW                                                          C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF FSR0L                                                                    C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_UPPER		; Load TBLPTR with the base                             C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF TBLPTRU			; address of the memory block                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_HIGH                                                           C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF TBLPTRH                                                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_LOW                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF TBLPTRL                                                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           READ_BLOCK                                                                       C:\fw\midicontroller\x011\writeprogmem.asm
0034cc   0009     TBLRDPOSTINC             	TBLRD*+				; read into TABLAT, and inc                                          C:\fw\midicontroller\x011\writeprogmem.asm
0034ce   50f5     MOVF      0xf5,0x0,0x0   	MOVF	TABLAT, W		; get data                                                      C:\fw\midicontroller\x011\writeprogmem.asm
0034d0   6eee     MOVWF     0xee,0x0       	MOVWF	POSTINC0		; store data                                                    C:\fw\midicontroller\x011\writeprogmem.asm
0034d2   2fb9     DECFSZ    0xb9,0x1,0x1   	DECFSZ	WpmCounter			; done?                                                     C:\fw\midicontroller\x011\writeprogmem.asm
0034d4   d7fb     BRA       0x34cc         	BRA	READ_BLOCK		; repeat                                                        C:\fw\midicontroller\x011\writeprogmem.asm
0034d6   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;;WRITE_BLOCK_INTO_ROM                                                           C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;Before calling, set FSR0 = address of RAM buffer                                C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;Also, set TBLPTR = address of ROM to write to  (must be on 64 byte boundary).   C:\fw\midicontroller\x011\writeprogmem.asm
                                           WRITE_BLOCK_INTO_ROM                                                             C:\fw\midicontroller\x011\writeprogmem.asm
0034d8   0100     MOVLB     0x0            	movlb	high(WpmCounter)	;set appropriate bank.                                   C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_UPPER 	                                                        C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF TBLPTRU                                                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_HIGH                                                           C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF TBLPTRH                                                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_LOW                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF TBLPTRL                                                                  C:\fw\midicontroller\x011\writeprogmem.asm
0034da   8ea6     BSF       0xa6,0x7,0x0   	BSF	EECON1, EEPGD		; point to Flash program memory                              C:\fw\midicontroller\x011\writeprogmem.asm
0034dc   9ca6     BCF       0xa6,0x6,0x0   	BCF	EECON1, CFGS		; access Flash program memory                                 C:\fw\midicontroller\x011\writeprogmem.asm
0034de   84a6     BSF       0xa6,0x2,0x0   	BSF	EECON1, WREN		; enable write to memory                                      C:\fw\midicontroller\x011\writeprogmem.asm
0034e0   88a6     BSF       0xa6,0x4,0x0   	BSF	EECON1, FREE		; enable Row Erase operation                                  C:\fw\midicontroller\x011\writeprogmem.asm
0034e2   9ef2     BCF       0xf2,0x7,0x0   	BCF	INTCON, GIE 		; disable interrupts                                          C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;perform erase opration:                                                         C:\fw\midicontroller\x011\writeprogmem.asm
0034e4   0e55     MOVLW     0x55           	MOVLW	55h                                                                       C:\fw\midicontroller\x011\writeprogmem.asm
0034e6   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 55h                                                      C:\fw\midicontroller\x011\writeprogmem.asm
0034e8   0eaa     MOVLW     0xaa           	MOVLW	0AAh                                                                      C:\fw\midicontroller\x011\writeprogmem.asm
0034ea   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 0AAh                                                     C:\fw\midicontroller\x011\writeprogmem.asm
0034ec   82a6     BSF       0xa6,0x1,0x0   	BSF	EECON1, WR		; start erase (CPU stall)                                       C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
0034ee   8ef2     BSF       0xf2,0x7,0x0   	BSF	INTCON, GIE 		; re-enable interrupts                                        C:\fw\midicontroller\x011\writeprogmem.asm
0034f0   000a     TBLRDPOSTDEC             	TBLRD*- 			; dummy read decrement                                               C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW	BUFFER_ADDR_HIGH	; point to buffer                                       C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF	FSR0H                                                                    C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVLW	BUFFER_ADDR_LOW                                                          C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;	MOVWF	FSR0L                                                                    C:\fw\midicontroller\x011\writeprogmem.asm
0034f2   0e02     MOVLW     0x2            	MOVLW	2                                                                         C:\fw\midicontroller\x011\writeprogmem.asm
0034f4   6fba     MOVWF     0xba,0x1       	MOVWF	WpmCounter1                                                               C:\fw\midicontroller\x011\writeprogmem.asm
                                           WRITE_BUFFER_BACK                                                                C:\fw\midicontroller\x011\writeprogmem.asm
0034f6   0e20     MOVLW     0x20           	MOVLW	32	 		; number of bytes in holding register                               C:\fw\midicontroller\x011\writeprogmem.asm
0034f8   6fb9     MOVWF     0xb9,0x1       	MOVWF	WpmCounter                                                                C:\fw\midicontroller\x011\writeprogmem.asm
                                           WRITE_BYTE_TO_HREGS                                                              C:\fw\midicontroller\x011\writeprogmem.asm
0034fa   50ee     MOVF      0xee,0x0,0x0   	MOVF	POSTINC0, W 		; get low byte of buffer data                                C:\fw\midicontroller\x011\writeprogmem.asm
0034fc   6ef5     MOVWF     0xf5,0x0       	MOVWF	TABLAT 			; present data to table latch                                   C:\fw\midicontroller\x011\writeprogmem.asm
0034fe   000f     TBLWTPREINC              	TBLWT+* 			; write data, perform a short write                                  C:\fw\midicontroller\x011\writeprogmem.asm
                                           					; to internal TBLWT holding register.                                       C:\fw\midicontroller\x011\writeprogmem.asm
003500   2fb9     DECFSZ    0xb9,0x1,0x1   	DECFSZ	WpmCounter 		; loop until buffers are full                               C:\fw\midicontroller\x011\writeprogmem.asm
003502   d7fb     BRA       0x34fa         	BRA	WRITE_BYTE_TO_HREGS                                                         C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           PROGRAM_MEMORY                                                                   C:\fw\midicontroller\x011\writeprogmem.asm
003504   8ea6     BSF       0xa6,0x7,0x0   	BSF	EECON1, EEPGD		; point to Flash program memory                              C:\fw\midicontroller\x011\writeprogmem.asm
003506   9ca6     BCF       0xa6,0x6,0x0   	BCF	EECON1, CFGS		; access Flash program memory                                 C:\fw\midicontroller\x011\writeprogmem.asm
003508   84a6     BSF       0xa6,0x2,0x0   	BSF	EECON1, WREN		; enable write to memory                                      C:\fw\midicontroller\x011\writeprogmem.asm
00350a   9ef2     BCF       0xf2,0x7,0x0   	BCF	INTCON, GIE		; disable interrupts                                           C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           ;Write to program memmory:                                                       C:\fw\midicontroller\x011\writeprogmem.asm
00350c   0e55     MOVLW     0x55           	MOVLW	55h                                                                       C:\fw\midicontroller\x011\writeprogmem.asm
00350e   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 55h                                                      C:\fw\midicontroller\x011\writeprogmem.asm
003510   0eaa     MOVLW     0xaa           	MOVLW	0AAh                                                                      C:\fw\midicontroller\x011\writeprogmem.asm
003512   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 0AAh                                                     C:\fw\midicontroller\x011\writeprogmem.asm
003514   82a6     BSF       0xa6,0x1,0x0   	BSF	EECON1, WR		; start program (CPU stall)                                     C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
003516   2fba     DECFSZ    0xba,0x1,0x1   	DECFSZ	WpmCounter1                                                              C:\fw\midicontroller\x011\writeprogmem.asm
003518   d7ee     BRA       0x34f6         	BRA	WRITE_BUFFER_BACK                                                           C:\fw\midicontroller\x011\writeprogmem.asm
00351a   8ef2     BSF       0xf2,0x7,0x0   	BSF	INTCON, GIE		; re-enable interrupts                                         C:\fw\midicontroller\x011\writeprogmem.asm
00351c   94a6     BCF       0xa6,0x2,0x0   	BCF	EECON1, WREN		; disable write to memory                                     C:\fw\midicontroller\x011\writeprogmem.asm
00351e   0012     RETURN    0x0            	return                                                                          C:\fw\midicontroller\x011\writeprogmem.asm
                                                                                                                            C:\fw\midicontroller\x011\writeprogmem.asm
                                           	END                                                                             C:\fw\midicontroller\x011\writeprogmem.asm
                                           //*;###########################################################################  C:\fw\midicontroller\x011\vectors.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\vectors.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x011\vectors.c
                                           //;#			vectors									  			  #                                                  C:\fw\midicontroller\x011\vectors.c
                                           //;#			File Name: vectors.c   										  #                                      C:\fw\midicontroller\x011\vectors.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\vectors.c
                                           //;############################################################################  C:\fw\midicontroller\x011\vectors.c
                                                                                                                            C:\fw\midicontroller\x011\vectors.c
                                                                                                                            C:\fw\midicontroller\x011\vectors.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\vectors.c
                                                                                                                            C:\fw\midicontroller\x011\vectors.c
                                           void main(void);                                                                 C:\fw\midicontroller\x011\vectors.c
                                                                                                                            C:\fw\midicontroller\x011\vectors.c
                                           #pragma code RealInitVector = 0x00                                               C:\fw\midicontroller\x011\vectors.c
                                           void                                                                             C:\fw\midicontroller\x011\vectors.c
                                           RealInitVector (void)                                                            C:\fw\midicontroller\x011\vectors.c
                                           {                                                                                C:\fw\midicontroller\x011\vectors.c
                                             _asm                                                                           C:\fw\midicontroller\x011\vectors.c
000000   ef15     GOTO      0xa2a          	goto main //jump to interrupt routine                                           C:\fw\midicontroller\x011\vectors.c
000002   f005                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x011\vectors.c
000004   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\vectors.c
                                                                                                                            C:\fw\midicontroller\x011\vectors.c
                                           #pragma code RealInterruptVectorHigh = 0x08                                      C:\fw\midicontroller\x011\vectors.c
                                           void                                                                             C:\fw\midicontroller\x011\vectors.c
                                           RealInterruptVectorHigh (void)                                                   C:\fw\midicontroller\x011\vectors.c
                                           {                                                                                C:\fw\midicontroller\x011\vectors.c
                                             _asm                                                                           C:\fw\midicontroller\x011\vectors.c
000008   efef     GOTO      0x35de         	goto InterruptHandlerHigh //jump to interrupt routine                           C:\fw\midicontroller\x011\vectors.c
00000a   f01a                                                                                                               
                                             _endasm                                                                        C:\fw\midicontroller\x011\vectors.c
00000c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\vectors.c
                                                                                                                            C:\fw\midicontroller\x011\vectors.c
                                           //*;###########################################################################  C:\fw\midicontroller\x011\eeprom.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\eeprom.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x011\eeprom.c
                                           //;#			EEProm access functions							  			  #                                    C:\fw\midicontroller\x011\eeprom.c
                                           //;#			File Name: eeprom.c   										  #                                       C:\fw\midicontroller\x011\eeprom.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\eeprom.c
                                           //;############################################################################  C:\fw\midicontroller\x011\eeprom.c
                                                                                                                            C:\fw\midicontroller\x011\eeprom.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\eeprom.c
                                                                                                                            C:\fw\midicontroller\x011\eeprom.c
003586   cfd9     MOVFF     0xfd9,0xfe6    unsigned char EERead(unsigned char addr) {                                       C:\fw\midicontroller\x011\eeprom.c
003588   ffe6                                                                                                               
00358a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00358c   ffd9                                                                                                               
00358e   0efe     MOVLW     0xfe           	EEADR=(unsigned char)addr;	// Address to read                                   C:\fw\midicontroller\x011\eeprom.c
003590   50db     MOVF      0xdb,0x0,0x0                                                                                    
003592   6ea9     MOVWF     0xa9,0x0                                                                                        
003594   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   C:\fw\midicontroller\x011\eeprom.c
003596   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           C:\fw\midicontroller\x011\eeprom.c
003598   80a6     BSF       0xa6,0x0,0x0   	EECON1bits.RD=1;			// EE Read                                                   C:\fw\midicontroller\x011\eeprom.c
00359a   50a8     MOVF      0xa8,0x0,0x0   	return EEDATA;				// W = EEDATA                                                 C:\fw\midicontroller\x011\eeprom.c
00359c   d000     BRA       0x359e                                                                                          
00359e   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\eeprom.c
0035a0   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0035a2   ffd9                                                                                                               
0035a4   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\eeprom.c
                                           //blocking write that takes approximately 4mS ??                                 C:\fw\midicontroller\x011\eeprom.c
0035a6   cfd9     MOVFF     0xfd9,0xfe6    void EEWrite(unsigned char addr,unsigned char data) {                            C:\fw\midicontroller\x011\eeprom.c
0035a8   ffe6                                                                                                               
0035aa   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0035ac   ffd9                                                                                                               
0035ae   0efe     MOVLW     0xfe           	EEADR = (unsigned char)addr;                                                    C:\fw\midicontroller\x011\eeprom.c
0035b0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0035b2   6ea9     MOVWF     0xa9,0x0                                                                                        
0035b4   0efd     MOVLW     0xfd           	EEDATA=data;                                                                    C:\fw\midicontroller\x011\eeprom.c
0035b6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0035b8   6ea8     MOVWF     0xa8,0x0                                                                                        
                                           	                                                                                C:\fw\midicontroller\x011\eeprom.c
0035ba   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   C:\fw\midicontroller\x011\eeprom.c
0035bc   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           C:\fw\midicontroller\x011\eeprom.c
0035be   84a6     BSF       0xa6,0x2,0x0   	EECON1bits.WREN=1;                                                              C:\fw\midicontroller\x011\eeprom.c
                                                                                                                            C:\fw\midicontroller\x011\eeprom.c
0035c0   9ef2     BCF       0xf2,0x7,0x0   	INTCONbits.GIE = 0;			// Disable global interrupts                              C:\fw\midicontroller\x011\eeprom.c
0035c2   0e55     MOVLW     0x55           	EECON2=0x55;				// Required                                                     C:\fw\midicontroller\x011\eeprom.c
0035c4   6ea7     MOVWF     0xa7,0x0                                                                                        
0035c6   0eaa     MOVLW     0xaa           	EECON2=0xAA;				// Required                                                     C:\fw\midicontroller\x011\eeprom.c
0035c8   6ea7     MOVWF     0xa7,0x0                                                                                        
0035ca   82a6     BSF       0xa6,0x1,0x0   	EECON1bits.WR=1;			// Enable writes                                             C:\fw\midicontroller\x011\eeprom.c
                                           	do {                                                                            C:\fw\midicontroller\x011\eeprom.c
0035cc   0004     CLRWDT                   		ClrWdt();                                                                      C:\fw\midicontroller\x011\eeprom.c
0035ce   b2a6     BTFSC     0xa6,0x1,0x0   	} while(EECON1bits.WR);		// block until write complete                          C:\fw\midicontroller\x011\eeprom.c
0035d0   d7fd     BRA       0x35cc                                                                                          
                                                                                                                            C:\fw\midicontroller\x011\eeprom.c
0035d2   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIE = 1;			// Enable global interrupts                               C:\fw\midicontroller\x011\eeprom.c
0035d4   94a6     BCF       0xa6,0x2,0x0   	EECON1bits.WREN=0;			// Disable writes                                          C:\fw\midicontroller\x011\eeprom.c
0035d6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\eeprom.c
0035d8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0035da   ffd9                                                                                                               
0035dc   0012     RETURN    0x0                                                                                             
                                           //*;###########################################################################  C:\fw\midicontroller\x011\leds.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\leds.c
                                           //;#			Date 4/06/07					      						  #                                          C:\fw\midicontroller\x011\leds.c
                                           //;#			Main arbitrator									  			  #                                          C:\fw\midicontroller\x011\leds.c
                                           //;#			File Name: main.c   										  #                                         C:\fw\midicontroller\x011\leds.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\leds.c
                                           //;############################################################################  C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\leds.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\leds.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           void	ProcessLeds(void) {                                                         C:\fw\midicontroller\x011\leds.c
                                           	static unsigned char ComPointer;                                                C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
0028e4   d834     RCALL     0x294e         	AllDigitsOff();                                                                 C:\fw\midicontroller\x011\leds.c
0028e6   0100     MOVLB     0x0            	switch (ComPointer) {                                                           C:\fw\midicontroller\x011\leds.c
0028e8   51fb     MOVF      0xfb,0x0,0x1                                                                                    
0028ea   0a04     XORLW     0x4                                                                                             
0028ec   e021     BZ        0x2930                                                                                          
0028ee   0a07     XORLW     0x7                                                                                             
0028f0   e019     BZ        0x2924                                                                                          
0028f2   0a01     XORLW     0x1                                                                                             
0028f4   e011     BZ        0x2918                                                                                          
0028f6   0a03     XORLW     0x3                                                                                             
0028f8   e009     BZ        0x290c                                                                                          
0028fa   0a01     XORLW     0x1                                                                                             
0028fc   e001     BZ        0x2900                                                                                          
                                           		case 0:                                                                        C:\fw\midicontroller\x011\leds.c
002900   9a8a     BCF       0x8a,0x5,0x0   			DISP_COM0_LAT_BIT = false;                                                    C:\fw\midicontroller\x011\leds.c
002902   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x011\leds.c
002904   ffe6                                                                                                               
002906   d831     RCALL     0x296a                                                                                          
002908   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00290a   d018     BRA       0x293c         			break;                                                                        C:\fw\midicontroller\x011\leds.c
                                           		case 1:                                                                        C:\fw\midicontroller\x011\leds.c
00290c   908b     BCF       0x8b,0x0,0x0   			DISP_COM1_LAT_BIT = false;                                                    C:\fw\midicontroller\x011\leds.c
00290e   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x011\leds.c
002910   ffe6                                                                                                               
002912   d82b     RCALL     0x296a                                                                                          
002914   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002916   d012     BRA       0x293c         			break;                                                                        C:\fw\midicontroller\x011\leds.c
                                           		case 2:                                                                        C:\fw\midicontroller\x011\leds.c
002918   968a     BCF       0x8a,0x3,0x0   			DISP_COM2_LAT_BIT = false;                                                    C:\fw\midicontroller\x011\leds.c
00291a   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x011\leds.c
00291c   ffe6                                                                                                               
00291e   d825     RCALL     0x296a                                                                                          
002920   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002922   d00c     BRA       0x293c         			break;                                                                        C:\fw\midicontroller\x011\leds.c
                                           		case 3:                                                                        C:\fw\midicontroller\x011\leds.c
002924   948a     BCF       0x8a,0x2,0x0   			DISP_COM3_LAT_BIT = false;                                                    C:\fw\midicontroller\x011\leds.c
002926   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x011\leds.c
002928   ffe6                                                                                                               
00292a   d81f     RCALL     0x296a                                                                                          
00292c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00292e   d006     BRA       0x293c         			break;                                                                        C:\fw\midicontroller\x011\leds.c
                                           		case 4:                                                                        C:\fw\midicontroller\x011\leds.c
002930   928a     BCF       0x8a,0x1,0x0   			DISP_COM4_LAT_BIT = false;                                                    C:\fw\midicontroller\x011\leds.c
002932   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      C:\fw\midicontroller\x011\leds.c
002934   ffe6                                                                                                               
002936   d819     RCALL     0x296a                                                                                          
002938   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00293a   d000     BRA       0x293c         			break;                                                                        C:\fw\midicontroller\x011\leds.c
                                           		default:                                                                       C:\fw\midicontroller\x011\leds.c
                                           			//do nothing                                                                  C:\fw\midicontroller\x011\leds.c
0028fe   d01e     BRA       0x293c         			break;                                                                        C:\fw\midicontroller\x011\leds.c
                                           	}                                                                               C:\fw\midicontroller\x011\leds.c
00293c   0100     MOVLB     0x0            	if (++ComPointer >= DispNumOfCommons) ComPointer = 0;                           C:\fw\midicontroller\x011\leds.c
00293e   2bfb     INCF      0xfb,0x1,0x1                                                                                    
002940   0100     MOVLB     0x0                                                                                             
002942   5167     MOVF      0x67,0x0,0x1                                                                                    
002944   0100     MOVLB     0x0                                                                                             
002946   5dfb     SUBWF     0xfb,0x0,0x1                                                                                    
002948   e301     BNC       0x294c                                                                                          
00294a   6bfb     CLRF      0xfb,0x1                                                                                        
00294c   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           void	AllDigitsOff(void) {                                                        C:\fw\midicontroller\x011\leds.c
00294e   908a     BCF       0x8a,0x0,0x0   	DISP_SEG0_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
002950   9e8c     BCF       0x8c,0x7,0x0   	DISP_SEG1_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
002952   9c8c     BCF       0x8c,0x6,0x0   	DISP_SEG2_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
002954   9a8c     BCF       0x8c,0x5,0x0   	DISP_SEG3_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
002956   988c     BCF       0x8c,0x4,0x0   	DISP_SEG4_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
002958   948b     BCF       0x8b,0x2,0x0   	DISP_SEG5_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
00295a   968c     BCF       0x8c,0x3,0x0   	DISP_SEG6_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
00295c   948c     BCF       0x8c,0x2,0x0   	DISP_SEG7_LAT_BIT = false;                                                      C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
00295e   8a8a     BSF       0x8a,0x5,0x0   	DISP_COM0_LAT_BIT = true;                                                       C:\fw\midicontroller\x011\leds.c
002960   808b     BSF       0x8b,0x0,0x0   	DISP_COM1_LAT_BIT = true;                                                       C:\fw\midicontroller\x011\leds.c
002962   868a     BSF       0x8a,0x3,0x0   	DISP_COM2_LAT_BIT = true;                                                       C:\fw\midicontroller\x011\leds.c
002964   848a     BSF       0x8a,0x2,0x0   	DISP_COM3_LAT_BIT = true;                                                       C:\fw\midicontroller\x011\leds.c
002966   828a     BSF       0x8a,0x1,0x0   	DISP_COM4_LAT_BIT = true;                                                       C:\fw\midicontroller\x011\leds.c
002968   0012     RETURN    0x0            }                                                                                C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
00296a   cfd9     MOVFF     0xfd9,0xfe6    void	HandleDigit(unsigned char ComPointer) {                                     C:\fw\midicontroller\x011\leds.c
00296c   ffe6                                                                                                               
00296e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002970   ffd9                                                                                                               
002972   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	BitField x;                                                                     C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
002974   0efe     MOVLW     0xfe           	x.byte = DispSegData[ComPointer].byte;                                          C:\fw\midicontroller\x011\leds.c
002976   50db     MOVF      0xdb,0x0,0x0                                                                                    
002978   6aea     CLRF      0xea,0x0                                                                                        
00297a   0f62     ADDLW     0x62                                                                                            
00297c   6ee9     MOVWF     0xe9,0x0                                                                                        
00297e   0e00     MOVLW     0x0                                                                                             
002980   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002982   cfef     MOVFF     0xfef,0xfdf                                                                                     
002984   ffdf                                                                                                               
002986   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit0) DISP_SEG0_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
002988   ffe9                                                                                                               
00298a   cfda     MOVFF     0xfda,0xfea                                                                                     
00298c   ffea                                                                                                               
00298e   50ef     MOVF      0xef,0x0,0x0                                                                                    
002990   0b01     ANDLW     0x1                                                                                             
002992   e001     BZ        0x2996                                                                                          
002994   808a     BSF       0x8a,0x0,0x0                                                                                    
002996   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit1) DISP_SEG1_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
002998   ffe9                                                                                                               
00299a   cfda     MOVFF     0xfda,0xfea                                                                                     
00299c   ffea                                                                                                               
00299e   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029a0   0b02     ANDLW     0x2                                                                                             
0029a2   e001     BZ        0x29a6                                                                                          
0029a4   8e8c     BSF       0x8c,0x7,0x0                                                                                    
0029a6   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit2) DISP_SEG2_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
0029a8   ffe9                                                                                                               
0029aa   cfda     MOVFF     0xfda,0xfea                                                                                     
0029ac   ffea                                                                                                               
0029ae   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029b0   0b04     ANDLW     0x4                                                                                             
0029b2   e001     BZ        0x29b6                                                                                          
0029b4   8c8c     BSF       0x8c,0x6,0x0                                                                                    
0029b6   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit3) DISP_SEG3_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
0029b8   ffe9                                                                                                               
0029ba   cfda     MOVFF     0xfda,0xfea                                                                                     
0029bc   ffea                                                                                                               
0029be   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029c0   0b08     ANDLW     0x8                                                                                             
0029c2   e001     BZ        0x29c6                                                                                          
0029c4   8a8c     BSF       0x8c,0x5,0x0                                                                                    
0029c6   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit4) DISP_SEG4_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
0029c8   ffe9                                                                                                               
0029ca   cfda     MOVFF     0xfda,0xfea                                                                                     
0029cc   ffea                                                                                                               
0029ce   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029d0   0b10     ANDLW     0x10                                                                                            
0029d2   e001     BZ        0x29d6                                                                                          
0029d4   888c     BSF       0x8c,0x4,0x0                                                                                    
0029d6   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit5) DISP_SEG5_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
0029d8   ffe9                                                                                                               
0029da   cfda     MOVFF     0xfda,0xfea                                                                                     
0029dc   ffea                                                                                                               
0029de   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029e0   0b20     ANDLW     0x20                                                                                            
0029e2   e001     BZ        0x29e6                                                                                          
0029e4   848b     BSF       0x8b,0x2,0x0                                                                                    
0029e6   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit6) DISP_SEG6_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
0029e8   ffe9                                                                                                               
0029ea   cfda     MOVFF     0xfda,0xfea                                                                                     
0029ec   ffea                                                                                                               
0029ee   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029f0   0b40     ANDLW     0x40                                                                                            
0029f2   e001     BZ        0x29f6                                                                                          
0029f4   868c     BSF       0x8c,0x3,0x0                                                                                    
0029f6   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit7) DISP_SEG7_LAT_BIT = true;                                           C:\fw\midicontroller\x011\leds.c
0029f8   ffe9                                                                                                               
0029fa   cfda     MOVFF     0xfda,0xfea                                                                                     
0029fc   ffea                                                                                                               
0029fe   50ef     MOVF      0xef,0x0,0x0                                                                                    
002a00   0b80     ANDLW     0x80                                                                                            
002a02   e001     BZ        0x2a06                                                                                          
002a04   848c     BSF       0x8c,0x2,0x0                                                                                    
002a06   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\leds.c
002a08   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a0a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002a0c   ffd9                                                                                                               
002a0e   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\leds.c
002a10   cfd9     MOVFF     0xfd9,0xfe6    void	SetDispAscii(unsigned char chars[]) {                                       C:\fw\midicontroller\x011\leds.c
002a12   ffe6                                                                                                               
002a14   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002a16   ffd9                                                                                                               
002a18   0e02     MOVLW     0x2                                                                                             
002a1a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
002a1c   0e01     MOVLW     0x1            	for (i = 0;i<5;i++) {                                                           C:\fw\midicontroller\x011\leds.c
002a1e   6adb     CLRF      0xdb,0x0                                                                                        
002a20   0e05     MOVLW     0x5                                                                                             
002a22   6ef3     MOVWF     0xf3,0x0                                                                                        
002a24   0e01     MOVLW     0x1                                                                                             
002a26   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002a28   fff4                                                                                                               
002a2a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002a2c   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002a2e   e221     BC        0x2a72                                                                                          
002a6c   0e01     MOVLW     0x1                                                                                             
002a6e   2adb     INCF      0xdb,0x1,0x0                                                                                    
002a70   d7d7     BRA       0x2a20                                                                                          
002a30   0e01     MOVLW     0x1            		x = chars[i];                                                                  C:\fw\midicontroller\x011\leds.c
002a32   50db     MOVF      0xdb,0x0,0x0                                                                                    
002a34   6ee7     MOVWF     0xe7,0x0                                                                                        
002a36   0efd     MOVLW     0xfd                                                                                            
002a38   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002a3a   ffe9                                                                                                               
002a3c   0efe     MOVLW     0xfe                                                                                            
002a3e   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002a40   ffea                                                                                                               
002a42   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002a44   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002a46   0e00     MOVLW     0x0                                                                                             
002a48   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002a4a   cfef     MOVFF     0xfef,0xfdf                                                                                     
002a4c   ffdf                                                                                                               
002a4e   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          C:\fw\midicontroller\x011\leds.c
002a50   ffe6                                                                                                               
002a52   d864     RCALL     0x2b1c                                                                                          
002a54   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a56   6ee6     MOVWF     0xe6,0x0                                                                                        
002a58   0e01     MOVLW     0x1                                                                                             
002a5a   50db     MOVF      0xdb,0x0,0x0                                                                                    
002a5c   6aea     CLRF      0xea,0x0                                                                                        
002a5e   0f62     ADDLW     0x62                                                                                            
002a60   6ee9     MOVWF     0xe9,0x0                                                                                        
002a62   0e00     MOVLW     0x0                                                                                             
002a64   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002a66   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a68   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002a6a   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x011\leds.c
002a72   0e02     MOVLW     0x2            }                                                                                C:\fw\midicontroller\x011\leds.c
002a74   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002a76   e202     BC        0x2a7c                                                                                          
002a78   6ae1     CLRF      0xe1,0x0                                                                                        
002a7a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a7c   6ee1     MOVWF     0xe1,0x0                                                                                        
002a7e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a80   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002a82   ffd9                                                                                                               
002a84   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           /* show 4 alphas on the 4-digit display */                                       C:\fw\midicontroller\x011\leds.c
002a86   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_4alphas(char text[LEDS_MAX_ALPHAS]){                              C:\fw\midicontroller\x011\leds.c
002a88   ffe6                                                                                                               
002a8a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002a8c   ffd9                                                                                                               
002a8e   0e02     MOVLW     0x2                                                                                             
002a90   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
002a92   0e01     MOVLW     0x1            	for (i = 0;i<4;i++) {                                                           C:\fw\midicontroller\x011\leds.c
002a94   6adb     CLRF      0xdb,0x0                                                                                        
002a96   0e04     MOVLW     0x4                                                                                             
002a98   6ef3     MOVWF     0xf3,0x0                                                                                        
002a9a   0e01     MOVLW     0x1                                                                                             
002a9c   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002a9e   fff4                                                                                                               
002aa0   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002aa2   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002aa4   e221     BC        0x2ae8                                                                                          
002ae2   0e01     MOVLW     0x1                                                                                             
002ae4   2adb     INCF      0xdb,0x1,0x0                                                                                    
002ae6   d7d7     BRA       0x2a96                                                                                          
002aa6   0e01     MOVLW     0x1            		x = text[i];                                                                   C:\fw\midicontroller\x011\leds.c
002aa8   50db     MOVF      0xdb,0x0,0x0                                                                                    
002aaa   6ee7     MOVWF     0xe7,0x0                                                                                        
002aac   0efd     MOVLW     0xfd                                                                                            
002aae   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002ab0   ffe9                                                                                                               
002ab2   0efe     MOVLW     0xfe                                                                                            
002ab4   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002ab6   ffea                                                                                                               
002ab8   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002aba   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002abc   0e00     MOVLW     0x0                                                                                             
002abe   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002ac0   cfef     MOVFF     0xfef,0xfdf                                                                                     
002ac2   ffdf                                                                                                               
002ac4   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          C:\fw\midicontroller\x011\leds.c
002ac6   ffe6                                                                                                               
002ac8   d829     RCALL     0x2b1c                                                                                          
002aca   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002acc   6ee6     MOVWF     0xe6,0x0                                                                                        
002ace   0e01     MOVLW     0x1                                                                                             
002ad0   50db     MOVF      0xdb,0x0,0x0                                                                                    
002ad2   6aea     CLRF      0xea,0x0                                                                                        
002ad4   0f62     ADDLW     0x62                                                                                            
002ad6   6ee9     MOVWF     0xe9,0x0                                                                                        
002ad8   0e00     MOVLW     0x0                                                                                             
002ada   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002adc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ade   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002ae0   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               C:\fw\midicontroller\x011\leds.c
002ae8   0e02     MOVLW     0x2            }                                                                                C:\fw\midicontroller\x011\leds.c
002aea   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002aec   e202     BC        0x2af2                                                                                          
002aee   6ae1     CLRF      0xe1,0x0                                                                                        
002af0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002af2   6ee1     MOVWF     0xe1,0x0                                                                                        
002af4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002af6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002af8   ffd9                                                                                                               
002afa   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           /* show single digit on the single digit display */                              C:\fw\midicontroller\x011\leds.c
002afc   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_1digit(u8 value){                                                 C:\fw\midicontroller\x011\leds.c
002afe   ffe6                                                                                                               
002b00   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002b02   ffd9                                                                                                               
002b04   0efe     MOVLW     0xfe           	DispSegData[4].byte = AsciiTo7Seg(value+'0');                                   C:\fw\midicontroller\x011\leds.c
002b06   50db     MOVF      0xdb,0x0,0x0                                                                                    
002b08   0f30     ADDLW     0x30                                                                                            
002b0a   6ee6     MOVWF     0xe6,0x0                                                                                        
002b0c   d807     RCALL     0x2b1c                                                                                          
002b0e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002b10   0100     MOVLB     0x0                                                                                             
002b12   6f66     MOVWF     0x66,0x1                                                                                        
002b14   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\leds.c
002b16   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002b18   ffd9                                                                                                               
002b1a   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\leds.c
002b1c   cfd9     MOVFF     0xfd9,0xfe6    unsigned char AsciiTo7Seg(unsigned char chr) {                                   C:\fw\midicontroller\x011\leds.c
002b1e   ffe6                                                                                                               
002b20   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002b22   ffd9                                                                                                               
                                           	                                                                                C:\fw\midicontroller\x011\leds.c
002b24   0e41     MOVLW     0x41           	if (chr >= 'A') {                                                               C:\fw\midicontroller\x011\leds.c
002b26   6ef3     MOVWF     0xf3,0x0                                                                                        
002b28   0efe     MOVLW     0xfe                                                                                            
002b2a   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002b2c   fff4                                                                                                               
002b2e   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002b30   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002b32   e328     BNC       0x2b84                                                                                          
002b34   0e61     MOVLW     0x61           		if (chr >= 'a') chr -= 'a';	//lower case                                       C:\fw\midicontroller\x011\leds.c
002b36   6ef3     MOVWF     0xf3,0x0                                                                                        
002b38   0efe     MOVLW     0xfe                                                                                            
002b3a   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002b3c   fff4                                                                                                               
002b3e   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002b40   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002b42   e30b     BNC       0x2b5a                                                                                          
002b44   0e61     MOVLW     0x61                                                                                            
002b46   6e10     MOVWF     0x10,0x0                                                                                        
002b48   0efe     MOVLW     0xfe                                                                                            
002b4a   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002b4c   ffe7                                                                                                               
002b4e   5010     MOVF      0x10,0x0,0x0                                                                                    
002b50   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002b52   0efe     MOVLW     0xfe                                                                                            
002b54   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002b56   ffdb                                                                                                               
002b58   d00a     BRA       0x2b6e         		else chr-='A';			//capital                                                     C:\fw\midicontroller\x011\leds.c
002b5a   0e41     MOVLW     0x41                                                                                            
002b5c   6e10     MOVWF     0x10,0x0                                                                                        
002b5e   0efe     MOVLW     0xfe                                                                                            
002b60   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002b62   ffe7                                                                                                               
002b64   5010     MOVF      0x10,0x0,0x0                                                                                    
002b66   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002b68   0efe     MOVLW     0xfe                                                                                            
002b6a   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002b6c   ffdb                                                                                                               
002b6e   50db     MOVF      0xdb,0x0,0x0   		chr=LettersSegTable[chr];                                                      C:\fw\midicontroller\x011\leds.c
002b70   6af7     CLRF      0xf7,0x0                                                                                        
002b72   0f18     ADDLW     0x18                                                                                            
002b74   6ef6     MOVWF     0xf6,0x0                                                                                        
002b76   0e36     MOVLW     0x36                                                                                            
002b78   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002b7a   0008     TBLRD                                                                                                     
002b7c   0efe     MOVLW     0xfe                                                                                            
002b7e   cff5     MOVFF     0xff5,0xfdb                                                                                     
002b80   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x011\leds.c
002b82   d026     BRA       0x2bd0         	else if (chr >= '0') {                                                          C:\fw\midicontroller\x011\leds.c
002b84   0e30     MOVLW     0x30                                                                                            
002b86   6ef3     MOVWF     0xf3,0x0                                                                                        
002b88   0efe     MOVLW     0xfe                                                                                            
002b8a   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002b8c   fff4                                                                                                               
002b8e   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002b90   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002b92   e315     BNC       0x2bbe                                                                                          
002b94   0e30     MOVLW     0x30           		chr -= '0';	//numbers                                                          C:\fw\midicontroller\x011\leds.c
002b96   6e10     MOVWF     0x10,0x0                                                                                        
002b98   0efe     MOVLW     0xfe                                                                                            
002b9a   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002b9c   ffe7                                                                                                               
002b9e   5010     MOVF      0x10,0x0,0x0                                                                                    
002ba0   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002ba2   0efe     MOVLW     0xfe                                                                                            
002ba4   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002ba6   ffdb                                                                                                               
002ba8   50db     MOVF      0xdb,0x0,0x0   		chr=NumbersSegTable[chr];                                                      C:\fw\midicontroller\x011\leds.c
002baa   6af7     CLRF      0xf7,0x0                                                                                        
002bac   0f0e     ADDLW     0xe                                                                                             
002bae   6ef6     MOVWF     0xf6,0x0                                                                                        
002bb0   0e36     MOVLW     0x36                                                                                            
002bb2   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002bb4   0008     TBLRD                                                                                                     
002bb6   0efe     MOVLW     0xfe                                                                                            
002bb8   cff5     MOVFF     0xff5,0xfdb                                                                                     
002bba   ffdb                                                                                                               
                                           	}                                                                               C:\fw\midicontroller\x011\leds.c
002bbc   d009     BRA       0x2bd0         	else if (chr == ' ') chr = 0;		//space characters                               C:\fw\midicontroller\x011\leds.c
002bbe   0efe     MOVLW     0xfe                                                                                            
002bc0   50db     MOVF      0xdb,0x0,0x0                                                                                    
002bc2   0820     SUBLW     0x20                                                                                            
002bc4   e103     BNZ       0x2bcc                                                                                          
002bc6   0efe     MOVLW     0xfe                                                                                            
002bc8   6adb     CLRF      0xdb,0x0                                                                                        
002bca   d002     BRA       0x2bd0         	else chr = 0;				//all other characters are spaces                              C:\fw\midicontroller\x011\leds.c
002bcc   0efe     MOVLW     0xfe                                                                                            
002bce   6adb     CLRF      0xdb,0x0                                                                                        
002bd0   50db     MOVF      0xdb,0x0,0x0   	return chr;                                                                     C:\fw\midicontroller\x011\leds.c
002bd2   d000     BRA       0x2bd4                                                                                          
002bd4   52e5     MOVF      0xe5,0x1,0x0   }                                                                                C:\fw\midicontroller\x011\leds.c
002bd6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002bd8   ffd9                                                                                                               
002bda   0012     RETURN    0x0                                                                                             
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           rom unsigned char NumbersSegTable[10] = {                                        C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<4)|(1<<2)|(1<<3),			//0                                C:\fw\midicontroller\x011\leds.c
                                           	(1<<1)|(1<<2),										//1                                                     C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3),					//2                                     C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<2)|(1<<3),					//3                                     C:\fw\midicontroller\x011\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2),						//4                                           C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<2)|(1<<3),					//5                                     C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<2)|(1<<3),			//6                                C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),								//7                                                C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<3)|(1<<4)|(1<<5)|(1<<6),	//8                           C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)					//9                                      C:\fw\midicontroller\x011\leds.c
                                           };                                                                               C:\fw\midicontroller\x011\leds.c
                                                                                                                            C:\fw\midicontroller\x011\leds.c
                                           rom unsigned char LettersSegTable[26] = {                                        C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<4)|(1<<5)|(1<<6),	//A                                  C:\fw\midicontroller\x011\leds.c
                                           	(1<<4)|(1<<6)|(1<<5)|(1<<2)|(1<<3),			//b                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<6)|(1<<4)|(1<<3),						//c                                                  C:\fw\midicontroller\x011\leds.c
                                           	(1<<6)|(1<<4)|(1<<3)|(1<<2)|(1<<1),			//d                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<3),			//E                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4),				//F                                             C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),	//g                                  C:\fw\midicontroller\x011\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4),				//h                                             C:\fw\midicontroller\x011\leds.c
                                           	(1<<1)|(1<<2),								//I                                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<1)|(1<<2)|(1<<3)|(1<<4),				//J                                             C:\fw\midicontroller\x011\leds.c
                                           	0,											//K                                                                C:\fw\midicontroller\x011\leds.c
                                           	(1<<5)|(1<<4)|(1<<3),						//L                                                  C:\fw\midicontroller\x011\leds.c
                                           	0,											//m                                                                C:\fw\midicontroller\x011\leds.c
                                           	(1<<4)|(1<<6)|(1<<2),						//n                                                  C:\fw\midicontroller\x011\leds.c
                                           	(1<<6)|(1<<4)|(1<<2)|(1<<3),				//o                                             C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<4),			//P                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2),			//q                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<4)|(1<<6),								//r                                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<3)|(1<<2)|(1<<6)|(1<<5)|(1<<0),			//S                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),						//T                                                  C:\fw\midicontroller\x011\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//u                                                  C:\fw\midicontroller\x011\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//v                                                  C:\fw\midicontroller\x011\leds.c
                                           	0,											//w                                                                C:\fw\midicontroller\x011\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4)|(1<<1),			//x                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),			//y                                       C:\fw\midicontroller\x011\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3)			//z                                        C:\fw\midicontroller\x011\leds.c
                                           };                                                                               C:\fw\midicontroller\x011\leds.c
                                           //*;###########################################################################  C:\fw\midicontroller\x011\tables.c
                                           //;#			Author: Joe Dunne											  #                                           C:\fw\midicontroller\x011\tables.c
                                           //;#			Date 5/28/07					      						  #                                          C:\fw\midicontroller\x011\tables.c
                                           //;#			Tables in the code								  			  #                                        C:\fw\midicontroller\x011\tables.c
                                           //;#			File Name: tables.c   										  #                                       C:\fw\midicontroller\x011\tables.c
                                           //;#																		  #                                                        C:\fw\midicontroller\x011\tables.c
                                           //;############################################################################  C:\fw\midicontroller\x011\tables.c
                                                                                                                            C:\fw\midicontroller\x011\tables.c
                                                                                                                            C:\fw\midicontroller\x011\tables.c
                                           #include "c_system.h"                                                            C:\fw\midicontroller\x011\tables.c
                                           #include "usb.h"                                                                 C:\fw\midicontroller\x011\tables.c
                                           #include "hardware.h"                                                            C:\fw\midicontroller\x011\tables.c
                                                                                                                            C:\fw\midicontroller\x011\tables.c
                                           #pragma romdata                                                                  C:\fw\midicontroller\x011\tables.c
                                                                                                                            C:\fw\midicontroller\x011\tables.c
                                           rom unsigned char EXPP_PEDAL_LINEAR_CONV_TABLE[256] =                            C:\fw\midicontroller\x011\tables.c
                                           {                                                                                C:\fw\midicontroller\x011\tables.c
                                           	0                                                                               C:\fw\midicontroller\x011\tables.c
                                           };                                                                               C:\fw\midicontroller\x011\tables.c
                                                                                                                            C:\fw\midicontroller\x011\tables.c
                                           #pragma romdata ROMSAVEDATA=0x4000                                               C:\fw\midicontroller\x011\tables.c
                                           rom unsigned char ROM_SAVEDATA[8191] = {                                         C:\fw\midicontroller\x011\tables.c
                                           	0                                                                               C:\fw\midicontroller\x011\tables.c
                                           };                                                                               C:\fw\midicontroller\x011\tables.c
                                                                                                                            C:\fw\midicontroller\x011\tables.c
                                           #pragma code                                                                     C:\fw\midicontroller\x011\tables.c
