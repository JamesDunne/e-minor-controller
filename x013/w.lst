MP2COD 4.1, COFF to COD File Converter
Copyright (c) 2006 Microchip Technology Inc.
Listing File Generated: Sun Jun 03 14:35:33 2007


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           //*;###########################################################################  D:\work\midicontroller\x013x\main.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\main.c
                                           //;#			Date 4/06/07					      						  #                                          D:\work\midicontroller\x013x\main.c
                                           //;#			Main arbitrator									  			  #                                          D:\work\midicontroller\x013x\main.c
                                           //;#			File Name: main.c   										  #                                         D:\work\midicontroller\x013x\main.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\main.c
                                           //;############################################################################  D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\main.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                           unsigned char	ADC_CONVERSION(unsigned char Channel);                             D:\work\midicontroller\x013x\main.c
                                           void	ServiceUSB(void);                                                           D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                           //#define	RX_TRIS_BIT		TRISCbits.TRISC7		// Receive direction bit                D:\work\midicontroller\x013x\main.c
                                           //#define	TX_TRIS_BIT		TRISCbits.TRISC6		// Transmit direction bit               D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                           #pragma code	main_code=0xA2A                                                     D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
000a2a   cfd9     MOVFF     0xfd9,0xfe6    void main() {                                                                    D:\work\midicontroller\x013x\main.c
000a2c   ffe6                                                                                                               
000a2e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000a30   ffd9                                                                                                               
000a32   0e05     MOVLW     0x5                                                                                             
000a34   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char chars[5];                                                         D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
000a36   ecf6     CALL      0x35ec,0x0     	init();                                                                         D:\work\midicontroller\x013x\main.c
000a38   f01a                                                                                                               
                                           //	controllerinit();                                                             D:\work\midicontroller\x013x\main.c
                                           	                                                                                D:\work\midicontroller\x013x\main.c
000a3a   0e20     MOVLW     0x20           	chars[0] = ' ';                                                                 D:\work\midicontroller\x013x\main.c
000a3c   6edf     MOVWF     0xdf,0x0                                                                                        
000a3e   52de     MOVF      0xde,0x1,0x0   	chars[1] = 'p';                                                                 D:\work\midicontroller\x013x\main.c
000a40   0e70     MOVLW     0x70                                                                                            
000a42   6edd     MOVWF     0xdd,0x0                                                                                        
000a44   0e61     MOVLW     0x61           	chars[2] = 'a';                                                                 D:\work\midicontroller\x013x\main.c
000a46   6ef3     MOVWF     0xf3,0x0                                                                                        
000a48   0e02     MOVLW     0x2                                                                                             
000a4a   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a4c   ffdb                                                                                                               
000a4e   0e72     MOVLW     0x72           	chars[3] = 'r';                                                                 D:\work\midicontroller\x013x\main.c
000a50   6ef3     MOVWF     0xf3,0x0                                                                                        
000a52   0e03     MOVLW     0x3                                                                                             
000a54   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a56   ffdb                                                                                                               
000a58   0e63     MOVLW     0x63           	chars[4] = 'c';                                                                 D:\work\midicontroller\x013x\main.c
000a5a   6ef3     MOVWF     0xf3,0x0                                                                                        
000a5c   0e04     MOVLW     0x4                                                                                             
000a5e   cff3     MOVFF     0xff3,0xfdb                                                                                     
000a60   ffdb                                                                                                               
000a62   cfd9     MOVFF     0xfd9,0xfe6    	SetDispAscii(chars);                                                            D:\work\midicontroller\x013x\main.c
000a64   ffe6                                                                                                               
000a66   cfda     MOVFF     0xfda,0xfe6                                                                                     
000a68   ffe6                                                                                                               
000a6a   ec8b     CALL      0x2d16,0x0                                                                                      
000a6c   f016                                                                                                               
000a6e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a70   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000a72   0eaa     MOVLW     0xaa           	SendDataToShiftReg(0xAA);                                                       D:\work\midicontroller\x013x\main.c
000a74   6ee6     MOVWF     0xe6,0x0                                                                                        
000a76   ec86     CALL      0x250c,0x0                                                                                      
000a78   f012                                                                                                               
000a7a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
000a7c   0e00     MOVLW     0x0            	chars[0] = ROM_SAVEDATA[0];                                                     D:\work\midicontroller\x013x\main.c
000a7e   6ef6     MOVWF     0xf6,0x0                                                                                        
000a80   0e40     MOVLW     0x40                                                                                            
000a82   6ef7     MOVWF     0xf7,0x0                                                                                        
000a84   0008     TBLRD                                                                                                     
000a86   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000a88   6edf     MOVWF     0xdf,0x0                                                                                        
000a8a   0e01     MOVLW     0x1            	chars[1] = ROM_SAVEDATA[1];                                                     D:\work\midicontroller\x013x\main.c
000a8c   6ef6     MOVWF     0xf6,0x0                                                                                        
000a8e   0e40     MOVLW     0x40                                                                                            
000a90   6ef7     MOVWF     0xf7,0x0                                                                                        
000a92   0008     TBLRD                                                                                                     
000a94   0e01     MOVLW     0x1                                                                                             
000a96   cff5     MOVFF     0xff5,0xfdb                                                                                     
000a98   ffdb                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\main.c
000a9a   0100     MOVLB     0x0            	ProgmemBuffer[0] = 0xAA;                                                        D:\work\midicontroller\x013x\main.c
000a9c   0eaa     MOVLW     0xaa                                                                                            
000a9e   6fbb     MOVWF     0xbb,0x1                                                                                        
000aa0   0e55     MOVLW     0x55           	ProgmemBuffer[1] = 0x55;                                                        D:\work\midicontroller\x013x\main.c
000aa2   6fbc     MOVWF     0xbc,0x1                                                                                        
000aa4   0ebb     MOVLW     0xbb           	Write64BytesProgMem(ROM_SAVEDATA,ProgmemBuffer);                                D:\work\midicontroller\x013x\main.c
000aa6   6ee6     MOVWF     0xe6,0x0                                                                                        
000aa8   0e00     MOVLW     0x0                                                                                             
000aaa   6ee6     MOVWF     0xe6,0x0                                                                                        
000aac   0e00     MOVLW     0x0                                                                                             
000aae   6ee6     MOVWF     0xe6,0x0                                                                                        
000ab0   0e40     MOVLW     0x40                                                                                            
000ab2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ab4   ec7f     CALL      0x26fe,0x0                                                                                      
000ab6   f013                                                                                                               
000ab8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000aba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000abc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000abe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ac0   0e00     MOVLW     0x0            	chars[0] = ROM_SAVEDATA[0];                                                     D:\work\midicontroller\x013x\main.c
000ac2   6ef6     MOVWF     0xf6,0x0                                                                                        
000ac4   0e40     MOVLW     0x40                                                                                            
000ac6   6ef7     MOVWF     0xf7,0x0                                                                                        
000ac8   0008     TBLRD                                                                                                     
000aca   50f5     MOVF      0xf5,0x0,0x0                                                                                    
000acc   6edf     MOVWF     0xdf,0x0                                                                                        
000ace   0e01     MOVLW     0x1            	chars[1] = ROM_SAVEDATA[1];                                                     D:\work\midicontroller\x013x\main.c
000ad0   6ef6     MOVWF     0xf6,0x0                                                                                        
000ad2   0e40     MOVLW     0x40                                                                                            
000ad4   6ef7     MOVWF     0xf7,0x0                                                                                        
000ad6   0008     TBLRD                                                                                                     
000ad8   0e01     MOVLW     0x1                                                                                             
000ada   cff5     MOVFF     0xff5,0xfdb                                                                                     
000adc   ffdb                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                                                                                                            D:\work\midicontroller\x013x\main.c
000aee   d7f7     BRA       0xade          	for(;;) {                                                                       D:\work\midicontroller\x013x\main.c
000ade   0100     MOVLB     0x0            		if (Systick) {                                                                 D:\work\midicontroller\x013x\main.c
000ae0   a160     BTFSS     0x60,0x0,0x1                                                                                    
000ae2   d004     BRA       0xaec                                                                                           
                                                                                                                            D:\work\midicontroller\x013x\main.c
000ae4   ecae     CALL      0x255c,0x0     			ReadButtons();                                                                D:\work\midicontroller\x013x\main.c
000ae6   f012                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                           //			ProcessControl();                                                           D:\work\midicontroller\x013x\main.c
                                           //			if (LATE == 0x05) LATE = 0x2;                                               D:\work\midicontroller\x013x\main.c
                                           //			else LATE = 0x05;                                                           D:\work\midicontroller\x013x\main.c
000ae8   ecf5     CALL      0x2bea,0x0     			ProcessLeds();                                                                D:\work\midicontroller\x013x\main.c
000aea   f015                                                                                                               
                                           			//ServiceRequests();                                                          D:\work\midicontroller\x013x\main.c
                                           			                                                                              D:\work\midicontroller\x013x\main.c
                                           		}                                                                              D:\work\midicontroller\x013x\main.c
000aec   d80b     RCALL     0xb04          		ServiceUSB();                                                                  D:\work\midicontroller\x013x\main.c
                                           	}                                                                               D:\work\midicontroller\x013x\main.c
000af0   0e05     MOVLW     0x5            }                                                                                D:\work\midicontroller\x013x\main.c
000af2   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000af4   e202     BC        0xafa                                                                                           
000af6   6ae1     CLRF      0xe1,0x0                                                                                        
000af8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000afa   6ee1     MOVWF     0xe1,0x0                                                                                        
000afc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000afe   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000b00   ffd9                                                                                                               
000b02   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\main.c
                                           void	ServiceUSB(void) {                                                          D:\work\midicontroller\x013x\main.c
000b04   eca7     CALL      0x234e,0x0     	USBCheckBusStatus();                    // Must use polling method              D:\work\midicontroller\x013x\main.c
000b06   f011                                                                                                               
000b08   be6f     BTFSC     0x6f,0x7,0x0       if(UCFGbits.UTEYE!=1) {                                                      D:\work\midicontroller\x013x\main.c
000b0a   d002     BRA       0xb10                                                                                           
000b0c   ecc6     CALL      0x238c,0x0             USBDriverService();                 // Interrupt or polling method       D:\work\midicontroller\x013x\main.c
000b0e   f011                                                                                                               
                                           	}                                                                               D:\work\midicontroller\x013x\main.c
000b10   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\main.c
                                           /* $Id: c018.c,v 1.2.14.1 2006/01/24 14:50:12 rhinec Exp $ */                    D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
                                           /* Copyright (c)1999 Microchip Technology */                                     D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
                                           /* MPLAB-C18 startup code */                                                     D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
                                           /* external reference to the user's main routine */                              D:\work\midicontroller\x013x\startup.c
                                           extern void main (void);                                                         D:\work\midicontroller\x013x\startup.c
                                           /* prototype for the startup function */                                         D:\work\midicontroller\x013x\startup.c
                                           void _entry (void);                                                              D:\work\midicontroller\x013x\startup.c
                                           void _startup (void);                                                            D:\work\midicontroller\x013x\startup.c
                                           extern near char __FPFLAGS;                                                      D:\work\midicontroller\x013x\startup.c
                                           #define RND 6                                                                    D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
                                           #pragma code _entry_scn=0x000A00                                                 D:\work\midicontroller\x013x\startup.c
                                           void                                                                             D:\work\midicontroller\x013x\startup.c
                                           _entry (void)                                                                    D:\work\midicontroller\x013x\startup.c
                                           {                                                                                D:\work\midicontroller\x013x\startup.c
000a00   ef8d     GOTO      0x371a         _asm goto _startup _endasm                                                       D:\work\midicontroller\x013x\startup.c
000a02   f01b                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\startup.c
000a04   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
                                           #pragma code _startup_scn                                                        D:\work\midicontroller\x013x\startup.c
                                           void                                                                             D:\work\midicontroller\x013x\startup.c
                                           _startup (void)                                                                  D:\work\midicontroller\x013x\startup.c
                                           {                                                                                D:\work\midicontroller\x013x\startup.c
                                             _asm                                                                           D:\work\midicontroller\x013x\startup.c
                                               // Initialize the stack pointer                                              D:\work\midicontroller\x013x\startup.c
00371a   ee17     LFSR      0x1,0x700          lfsr 1, _stack                                                               D:\work\midicontroller\x013x\startup.c
00371c   f000                                                                                                               
00371e   ee27     LFSR      0x2,0x700          lfsr 2, _stack                                                               D:\work\midicontroller\x013x\startup.c
003720   f000                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\startup.c
003722   6af8     CLRF      0xf8,0x0           clrf TBLPTRU, 0 // 1st silicon doesn't do this on POR                        D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
003724   9c0f     BCF       0xf,0x6,0x0        bcf __FPFLAGS,RND,0 // Initalize rounding flag for floating point libs       D:\work\midicontroller\x013x\startup.c
                                           _endasm loop:                                                                    D:\work\midicontroller\x013x\startup.c
                                                                                                                            D:\work\midicontroller\x013x\startup.c
                                             // Call the user's main routine                                                D:\work\midicontroller\x013x\startup.c
003726   ec15     CALL      0xa2a,0x0        main ();                                                                       D:\work\midicontroller\x013x\startup.c
003728   f005                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\startup.c
00372a   d7fd     BRA       0x3726           goto loop;                                                                     D:\work\midicontroller\x013x\startup.c
00372c   0012     RETURN    0x0            }                               /* end _startup() */                             D:\work\midicontroller\x013x\startup.c
                                           /*********************************************************************           D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                Microchip USB C18 Firmware Version 1.0                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *********************************************************************           D:\work\midicontroller\x013x\usb.c
                                            * FileName:        usb9.c                                                       D:\work\midicontroller\x013x\usb.c
                                            * Dependencies:    See INCLUDES section below                                   D:\work\midicontroller\x013x\usb.c
                                            * Processor:       PIC18                                                        D:\work\midicontroller\x013x\usb.c
                                            * Compiler:        C18 2.30.01+                                                 D:\work\midicontroller\x013x\usb.c
                                            * Company:         Microchip Technology, Inc.                                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Software License Agreement                                                    D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * The software supplied herewith by Microchip Technology Incorporated           D:\work\midicontroller\x013x\usb.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             D:\work\midicontroller\x013x\usb.c
                                            * supplied to you, the Company’s customer, for use solely and                   D:\work\midicontroller\x013x\usb.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               D:\work\midicontroller\x013x\usb.c
                                            * software is owned by the Company and/or its supplier, and is                  D:\work\midicontroller\x013x\usb.c
                                            * protected under applicable copyright laws. All rights are reserved.           D:\work\midicontroller\x013x\usb.c
                                            * Any use in violation of the foregoing restrictions may subject the            D:\work\midicontroller\x013x\usb.c
                                            * user to criminal sanctions under applicable laws, as well as to               D:\work\midicontroller\x013x\usb.c
                                            * civil liability for the breach of the terms and conditions of this            D:\work\midicontroller\x013x\usb.c
                                            * license.                                                                      D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             D:\work\midicontroller\x013x\usb.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             D:\work\midicontroller\x013x\usb.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   D:\work\midicontroller\x013x\usb.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             D:\work\midicontroller\x013x\usb.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    D:\work\midicontroller\x013x\usb.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Author               Date        Comment                                      D:\work\midicontroller\x013x\usb.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           D:\work\midicontroller\x013x\usb.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    D:\work\midicontroller\x013x\usb.c
                                            ********************************************************************/           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** I N C L U D E S **********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #include "p18f4455.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\usb.c
                                           //#include "io_cfg.h"                     // Required for self_power status      D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** V A R I A B L E S ********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma udata usb5                                                               D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBStdGetDscHandler(void);                                                  D:\work\midicontroller\x013x\usb.c
                                           void USBStdSetCfgHandler(void);                                                  D:\work\midicontroller\x013x\usb.c
                                           void USBStdGetStatusHandler(void);                                               D:\work\midicontroller\x013x\usb.c
                                           void USBStdFeatureReqHandler(void);                                              D:\work\midicontroller\x013x\usb.c
                                           void HIDSetReportHandler(void);                                                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCheckStdRequest(void)                                D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine checks the setup data packet to see if it       D:\work\midicontroller\x013x\usb.c
                                            *                  knows how to handle it                                       D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCheckStdRequest(void)                                                    D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
001d72   0104     MOVLB     0x4                if(SetupPkt.RequestType != STANDARD) return;                                 D:\work\midicontroller\x013x\usb.c
001d74   5110     MOVF      0x10,0x0,0x1                                                                                    
001d76   0b60     ANDLW     0x60                                                                                            
001d78   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d7a   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d7c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d7e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d80   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
001d82   0900     IORLW     0x0                                                                                             
001d84   e001     BZ        0x1d88                                                                                          
001d86   d04f     BRA       0x1e26                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001d88   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    D:\work\midicontroller\x013x\usb.c
001d8a   0a07     XORLW     0x7                                                                                             
001d8c   e04b     BZ        0x1e24                                                                                          
001d8e   0a0b     XORLW     0xb                                                                                             
001d90   e049     BZ        0x1e24                                                                                          
001d92   0a07     XORLW     0x7                                                                                             
001d94   e03a     BZ        0x1e0a                                                                                          
001d96   0a01     XORLW     0x1                                                                                             
001d98   e028     BZ        0x1dea                                                                                          
001d9a   0a0b     XORLW     0xb                                                                                             
001d9c   e024     BZ        0x1de6                                                                                          
001d9e   0a02     XORLW     0x2                                                                                             
001da0   e022     BZ        0x1de6                                                                                          
001da2   0a03     XORLW     0x3                                                                                             
001da4   e01e     BZ        0x1de2                                                                                          
001da6   0a08     XORLW     0x8                                                                                             
001da8   e011     BZ        0x1dcc                                                                                          
001daa   0a01     XORLW     0x1                                                                                             
001dac   e00d     BZ        0x1dc8                                                                                          
001dae   0a0f     XORLW     0xf                                                                                             
001db0   e009     BZ        0x1dc4                                                                                          
001db2   0a03     XORLW     0x3                                                                                             
001db4   e001     BZ        0x1db8                                                                                          
001db6   d036     BRA       0x1e24                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
                                                   case SET_ADR:                                                            D:\work\midicontroller\x013x\usb.c
001db8   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  D:\work\midicontroller\x013x\usb.c
001dba   0e01     MOVLW     0x1                                                                                             
001dbc   6f4b     MOVWF     0x4b,0x1                                                                                        
001dbe   0e04     MOVLW     0x4                        usb_device_state = ADR_PENDING_STATE;       // Update state only     D:\work\midicontroller\x013x\usb.c
001dc0   6f46     MOVWF     0x46,0x1                                                                                        
                                                       /* See USBCtrlTrfInHandler() in usbctrltrf.c for the next step */    D:\work\midicontroller\x013x\usb.c
001dc2   d031     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case GET_DSC:                                                            D:\work\midicontroller\x013x\usb.c
001dc4   d831     RCALL     0x1e28                     USBStdGetDscHandler();                                               D:\work\midicontroller\x013x\usb.c
001dc6   d02f     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case SET_CFG:                                                            D:\work\midicontroller\x013x\usb.c
001dc8   d890     RCALL     0x1eea                     USBStdSetCfgHandler();                                               D:\work\midicontroller\x013x\usb.c
001dca   d02d     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case GET_CFG:                                                            D:\work\midicontroller\x013x\usb.c
001dcc   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  D:\work\midicontroller\x013x\usb.c
001dce   0e01     MOVLW     0x1                                                                                             
001dd0   6f4b     MOVWF     0x4b,0x1                                                                                        
001dd2   0e48     MOVLW     0x48                       pSrc.bRam = (byte*)&usb_active_cfg;         // Set Source            D:\work\midicontroller\x013x\usb.c
001dd4   6f4c     MOVWF     0x4c,0x1                                                                                        
001dd6   0e01     MOVLW     0x1                                                                                             
001dd8   6f4d     MOVWF     0x4d,0x1                                                                                        
001dda   9347     BCF       0x47,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       D:\work\midicontroller\x013x\usb.c
001ddc   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        D:\work\midicontroller\x013x\usb.c
001dde   6f50     MOVWF     0x50,0x1                                                                                        
001de0   d022     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case GET_STATUS:                                                         D:\work\midicontroller\x013x\usb.c
001de2   d8a9     RCALL     0x1f36                     USBStdGetStatusHandler();                                            D:\work\midicontroller\x013x\usb.c
001de4   d020     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case CLR_FEATURE:                                                        D:\work\midicontroller\x013x\usb.c
                                                   case SET_FEATURE:                                                        D:\work\midicontroller\x013x\usb.c
001de6   d8f1     RCALL     0x1fca                     USBStdFeatureReqHandler();                                           D:\work\midicontroller\x013x\usb.c
001de8   d01e     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case GET_INTF:                                                           D:\work\midicontroller\x013x\usb.c
001dea   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  D:\work\midicontroller\x013x\usb.c
001dec   0e01     MOVLW     0x1                                                                                             
001dee   6f4b     MOVWF     0x4b,0x1                                                                                        
001df0   0104     MOVLB     0x4                        pSrc.bRam = (byte*)&usb_alt_intf+SetupPkt.bIntfID;  // Set source    D:\work\midicontroller\x013x\usb.c
001df2   5114     MOVF      0x14,0x0,0x1                                                                                    
001df4   0101     MOVLB     0x1                                                                                             
001df6   6f4c     MOVWF     0x4c,0x1                                                                                        
001df8   6b4d     CLRF      0x4d,0x1                                                                                        
001dfa   0e49     MOVLW     0x49                                                                                            
001dfc   274c     ADDWF     0x4c,0x1,0x1                                                                                    
001dfe   0e01     MOVLW     0x1                                                                                             
001e00   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
001e02   9347     BCF       0x47,0x1,0x1               usb_stat.ctrl_trf_mem = _RAM;               // Set memory type       D:\work\midicontroller\x013x\usb.c
001e04   0e01     MOVLW     0x1                        LSB(wCount) = 1;                            // Set data count        D:\work\midicontroller\x013x\usb.c
001e06   6f50     MOVWF     0x50,0x1                                                                                        
001e08   d00e     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case SET_INTF:                                                           D:\work\midicontroller\x013x\usb.c
001e0a   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  D:\work\midicontroller\x013x\usb.c
001e0c   0e01     MOVLW     0x1                                                                                             
001e0e   6f4b     MOVWF     0x4b,0x1                                                                                        
001e10   0104     MOVLB     0x4                        usb_alt_intf[SetupPkt.bIntfID] = SetupPkt.bAltID;                    D:\work\midicontroller\x013x\usb.c
001e12   5114     MOVF      0x14,0x0,0x1                                                                                    
001e14   6aea     CLRF      0xea,0x0                                                                                        
001e16   0f49     ADDLW     0x49                                                                                            
001e18   6ee9     MOVWF     0xe9,0x0                                                                                        
001e1a   0e01     MOVLW     0x1                                                                                             
001e1c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001e1e   c412     MOVFF     0x412,0xfef                                                                                     
001e20   ffef                                                                                                               
001e22   d001     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case SET_DSC:                                                            D:\work\midicontroller\x013x\usb.c
                                                   case SYNCH_FRAME:                                                        D:\work\midicontroller\x013x\usb.c
                                                   default:                                                                 D:\work\midicontroller\x013x\usb.c
001e24   d000     BRA       0x1e26                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                               }//end switch                                                                D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001e26   0012     RETURN    0x0            }//end USBCheckStdRequest                                                        D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBStdGetDscHandler(void)                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine handles the standard GET_DESCRIPTOR request.    D:\work\midicontroller\x013x\usb.c
                                            *                  It utilizes tables dynamically looks up descriptor size.     D:\work\midicontroller\x013x\usb.c
                                            *                  This routine should never have to be modified if the tables  D:\work\midicontroller\x013x\usb.c
                                            *                  in usbdsc.c are declared correctly.                          D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBStdGetDscHandler(void)                                                   D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
001e28   0e80     MOVLW     0x80               if(SetupPkt.bmRequestType == 0x80)                                           D:\work\midicontroller\x013x\usb.c
001e2a   0104     MOVLB     0x4                                                                                             
001e2c   5d10     SUBWF     0x10,0x0,0x1                                                                                    
001e2e   e15c     BNZ       0x1ee8                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
001e30   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                D:\work\midicontroller\x013x\usb.c
001e32   0a03     XORLW     0x3                                                                                             
001e34   e032     BZ        0x1e9a                                                                                          
001e36   0a01     XORLW     0x1                                                                                             
001e38   e00e     BZ        0x1e56                                                                                          
001e3a   0a03     XORLW     0x3                                                                                             
001e3c   e001     BZ        0x1e40                                                                                          
001e3e   d04b     BRA       0x1ed6                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
                                                       case DSC_DEV:                                                        D:\work\midicontroller\x013x\usb.c
001e40   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              D:\work\midicontroller\x013x\usb.c
001e42   0e01     MOVLW     0x1                                                                                             
001e44   6f4b     MOVWF     0x4b,0x1                                                                                        
001e46   0e5c     MOVLW     0x5c                           pSrc.bRom = (rom byte*)&device_dsc;                              D:\work\midicontroller\x013x\usb.c
001e48   6f4c     MOVWF     0x4c,0x1                                                                                        
001e4a   0e33     MOVLW     0x33                                                                                            
001e4c   6f4d     MOVWF     0x4d,0x1                                                                                        
001e4e   0e12     MOVLW     0x12                           wCount._word = sizeof(device_dsc);          // Set data count    D:\work\midicontroller\x013x\usb.c
001e50   6f50     MOVWF     0x50,0x1                                                                                        
001e52   6b51     CLRF      0x51,0x1                                                                                        
001e54   d040     BRA       0x1ed6                         break;                                                           D:\work\midicontroller\x013x\usb.c
                                                       case DSC_CFG:                                                        D:\work\midicontroller\x013x\usb.c
001e56   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              D:\work\midicontroller\x013x\usb.c
001e58   0e01     MOVLW     0x1                                                                                             
001e5a   6f4b     MOVWF     0x4b,0x1                                                                                        
001e5c   0104     MOVLB     0x4                            pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);                    D:\work\midicontroller\x013x\usb.c
001e5e   5112     MOVF      0x12,0x0,0x1                                                                                    
001e60   6ef6     MOVWF     0xf6,0x0                                                                                        
001e62   6af7     CLRF      0xf7,0x0                                                                                        
001e64   90d8     BCF       0xd8,0x0,0x0                                                                                    
001e66   36f6     RLCF      0xf6,0x1,0x0                                                                                    
001e68   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001e6a   0e76     MOVLW     0x76                                                                                            
001e6c   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001e6e   0e34     MOVLW     0x34                                                                                            
001e70   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e72   0009     TBLRDPOSTINC                                                                                              
001e74   cff5     MOVFF     0xff5,0x14c                                                                                     
001e76   f14c                                                                                                               
001e78   000a     TBLRDPOSTDEC                                                                                              
001e7a   cff5     MOVFF     0xff5,0x14d                                                                                     
001e7c   f14d                                                                                                               
001e7e   0e02     MOVLW     0x2                            wCount._word = *(pSrc.wRom+1);              // Set data count    D:\work\midicontroller\x013x\usb.c
001e80   0101     MOVLB     0x1                                                                                             
001e82   6af7     CLRF      0xf7,0x0                                                                                        
001e84   254c     ADDWF     0x4c,0x0,0x1                                                                                    
001e86   6ef6     MOVWF     0xf6,0x0                                                                                        
001e88   514d     MOVF      0x4d,0x0,0x1                                                                                    
001e8a   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001e8c   0009     TBLRDPOSTINC                                                                                              
001e8e   cff5     MOVFF     0xff5,0x150                                                                                     
001e90   f150                                                                                                               
001e92   000a     TBLRDPOSTDEC                                                                                              
001e94   cff5     MOVFF     0xff5,0x151                                                                                     
001e96   f151                                                                                                               
001e98   d01e     BRA       0x1ed6                         break;                                                           D:\work\midicontroller\x013x\usb.c
                                                       case DSC_STR:                                                        D:\work\midicontroller\x013x\usb.c
001e9a   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_USB9;                              D:\work\midicontroller\x013x\usb.c
001e9c   0e01     MOVLW     0x1                                                                                             
001e9e   6f4b     MOVWF     0x4b,0x1                                                                                        
001ea0   0104     MOVLB     0x4            				pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);                                D:\work\midicontroller\x013x\usb.c
001ea2   5112     MOVF      0x12,0x0,0x1                                                                                    
001ea4   6ef6     MOVWF     0xf6,0x0                                                                                        
001ea6   6af7     CLRF      0xf7,0x0                                                                                        
001ea8   90d8     BCF       0xd8,0x0,0x0                                                                                    
001eaa   36f6     RLCF      0xf6,0x1,0x0                                                                                    
001eac   36f7     RLCF      0xf7,0x1,0x0                                                                                    
001eae   0e7a     MOVLW     0x7a                                                                                            
001eb0   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
001eb2   0e34     MOVLW     0x34                                                                                            
001eb4   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
001eb6   0009     TBLRDPOSTINC                                                                                              
001eb8   cff5     MOVFF     0xff5,0x14c                                                                                     
001eba   f14c                                                                                                               
001ebc   000a     TBLRDPOSTDEC                                                                                              
001ebe   cff5     MOVFF     0xff5,0x14d                                                                                     
001ec0   f14d                                                                                                               
001ec2   c14c     MOVFF     0x14c,0xff6    				wCount._word = *pSrc.bRom;                  // Set data count                D:\work\midicontroller\x013x\usb.c
001ec4   fff6                                                                                                               
001ec6   c14d     MOVFF     0x14d,0xff7                                                                                     
001ec8   fff7                                                                                                               
001eca   0008     TBLRD                                                                                                     
001ecc   50f5     MOVF      0xf5,0x0,0x0                                                                                    
001ece   0101     MOVLB     0x1                                                                                             
001ed0   6f50     MOVWF     0x50,0x1                                                                                        
001ed2   6b51     CLRF      0x51,0x1                                                                                        
001ed4   d000     BRA       0x1ed6                         break;                                                           D:\work\midicontroller\x013x\usb.c
                                                   }//end switch                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001ed6   0e02     MOVLW     0x2            		if (SetupPkt.bDscIndex != INDEX_NAME && SetupPkt.bDscIndex != INDEX_SERIALNUM) { //handle as NVR (or ram) read D:\work\midicontroller\x013x\usb.c
001ed8   0104     MOVLB     0x4                                                                                             
001eda   5d12     SUBWF     0x12,0x0,0x1                                                                                    
001edc   e005     BZ        0x1ee8                                                                                          
001ede   0e03     MOVLW     0x3                                                                                             
001ee0   5d12     SUBWF     0x12,0x0,0x1                                                                                    
001ee2   e002     BZ        0x1ee8                                                                                          
001ee4   0101     MOVLB     0x1                    	usb_stat.ctrl_trf_mem = _ROM;                       // Set memory type  D:\work\midicontroller\x013x\usb.c
001ee6   8347     BSF       0x47,0x1,0x1                                                                                    
                                                   }                                                                        D:\work\midicontroller\x013x\usb.c
                                               }//end if                                                                    D:\work\midicontroller\x013x\usb.c
001ee8   0012     RETURN    0x0            }//end USBStdGetDscHandler                                                       D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBStdSetCfgHandler(void)                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine first disables all endpoints by clearing        D:\work\midicontroller\x013x\usb.c
                                            *                  UEP registers. It then configures (initializes) endpoints    D:\work\midicontroller\x013x\usb.c
                                            *                  specified in the modifiable section.                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBStdSetCfgHandler(void)                                                   D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
001eea   0101     MOVLB     0x1                ctrl_trf_session_owner = MUID_USB9;                                          D:\work\midicontroller\x013x\usb.c
001eec   0e01     MOVLW     0x1                                                                                             
001eee   6f4b     MOVWF     0x4b,0x1                                                                                        
001ef0   0e0f     MOVLW     0xf                mDisableEP1to15();                          // See usbdrv.h                  D:\work\midicontroller\x013x\usb.c
001ef2   6ee6     MOVWF     0xe6,0x0                                                                                        
001ef4   0e71     MOVLW     0x71                                                                                            
001ef6   6ee6     MOVWF     0xe6,0x0                                                                                        
001ef8   0e0f     MOVLW     0xf                                                                                             
001efa   6ee6     MOVWF     0xe6,0x0                                                                                        
001efc   dac9     RCALL     0x2490                                                                                          
001efe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f04   0e01     MOVLW     0x1                ClearArray((byte*)&usb_alt_intf,MAX_NUM_INT);                                D:\work\midicontroller\x013x\usb.c
001f06   6ee6     MOVWF     0xe6,0x0                                                                                        
001f08   0e49     MOVLW     0x49                                                                                            
001f0a   6ee6     MOVWF     0xe6,0x0                                                                                        
001f0c   0e01     MOVLW     0x1                                                                                             
001f0e   6ee6     MOVWF     0xe6,0x0                                                                                        
001f10   dabf     RCALL     0x2490                                                                                          
001f12   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f14   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001f18   c412     MOVFF     0x412,0x148        usb_active_cfg = SetupPkt.bCfgValue;                                         D:\work\midicontroller\x013x\usb.c
001f1a   f148                                                                                                               
001f1c   0104     MOVLB     0x4                if(SetupPkt.bCfgValue == 0)                                                  D:\work\midicontroller\x013x\usb.c
001f1e   5112     MOVF      0x12,0x0,0x1                                                                                    
001f20   e104     BNZ       0x1f2a                                                                                          
001f22   0101     MOVLB     0x1                    usb_device_state = ADDRESS_STATE;                                        D:\work\midicontroller\x013x\usb.c
001f24   0e05     MOVLW     0x5                                                                                             
001f26   6f46     MOVWF     0x46,0x1                                                                                        
001f28   d005     BRA       0x1f34             else                                                                         D:\work\midicontroller\x013x\usb.c
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
001f2a   0101     MOVLB     0x1                    usb_device_state = CONFIGURED_STATE;                                     D:\work\midicontroller\x013x\usb.c
001f2c   0e06     MOVLW     0x6                                                                                             
001f2e   6f46     MOVWF     0x46,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /* Modifiable Section */                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   #if defined(USB_USE_HID)                // See autofiles\usbcfg.h        D:\work\midicontroller\x013x\usb.c
001f30   ec1e     CALL      0x323c,0x0             HIDInitEP();                                                             D:\work\midicontroller\x013x\usb.c
001f32   f019                                                                                                               
                                                   #endif                                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /* End modifiable section */                                             D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               }//end if(SetupPkt.bcfgValue == 0)                                           D:\work\midicontroller\x013x\usb.c
001f34   0012     RETURN    0x0            }//end USBStdSetCfgHandler                                                       D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBStdGetStatusHandler(void)                            D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine handles the standard GET_STATUS request         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBStdGetStatusHandler(void)                                                D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
001f36   0104     MOVLB     0x4                CtrlTrfData._byte0 = 0;                         // Initialize content        D:\work\midicontroller\x013x\usb.c
001f38   6b50     CLRF      0x50,0x1                                                                                        
001f3a   6b51     CLRF      0x51,0x1           CtrlTrfData._byte1 = 0;                                                      D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001f3c   5110     MOVF      0x10,0x0,0x1       switch(SetupPkt.Recipient)                                                   D:\work\midicontroller\x013x\usb.c
001f3e   0b1f     ANDLW     0x1f                                                                                            
001f40   0a02     XORLW     0x2                                                                                             
001f42   e014     BZ        0x1f6c                                                                                          
001f44   0a03     XORLW     0x3                                                                                             
001f46   e00e     BZ        0x1f64                                                                                          
001f48   0a01     XORLW     0x1                                                                                             
001f4a   e001     BZ        0x1f4e                                                                                          
001f4c   d033     BRA       0x1fb4                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
                                                   case RCPT_DEV:                                                           D:\work\midicontroller\x013x\usb.c
001f4e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  D:\work\midicontroller\x013x\usb.c
001f50   0e01     MOVLW     0x1                                                                                             
001f52   6f4b     MOVWF     0x4b,0x1                                                                                        
                                                       /*                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * _byte0: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered D:\work\midicontroller\x013x\usb.c
                                                        *         bit1: RemoteWakeup        [0] Disabled    [1] Enabled     D:\work\midicontroller\x013x\usb.c
                                                        */                                                                  D:\work\midicontroller\x013x\usb.c
                                                       if(self_power == 1)                     // self_power defined in io_cfg.h D:\work\midicontroller\x013x\usb.c
001f54   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b000000001;    // Set bit0                  D:\work\midicontroller\x013x\usb.c
001f56   8150     BSF       0x50,0x0,0x1                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001f58   0101     MOVLB     0x1                        if(usb_stat.RemoteWakeup == 1)          // usb_stat defined in usbmmap.c D:\work\midicontroller\x013x\usb.c
001f5a   a147     BTFSS     0x47,0x0,0x1                                                                                    
001f5c   d002     BRA       0x1f62                                                                                          
001f5e   0104     MOVLB     0x4                            CtrlTrfData._byte0|=0b00000010;     // Set bit1                  D:\work\midicontroller\x013x\usb.c
001f60   8350     BSF       0x50,0x1,0x1                                                                                    
001f62   d028     BRA       0x1fb4                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case RCPT_INTF:                                                          D:\work\midicontroller\x013x\usb.c
001f64   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;     // No data to update         D:\work\midicontroller\x013x\usb.c
001f66   0e01     MOVLW     0x1                                                                                             
001f68   6f4b     MOVWF     0x4b,0x1                                                                                        
001f6a   d024     BRA       0x1fb4                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                                   case RCPT_EP:                                                            D:\work\midicontroller\x013x\usb.c
001f6c   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_USB9;                                  D:\work\midicontroller\x013x\usb.c
001f6e   0e01     MOVLW     0x1                                                                                             
001f70   6f4b     MOVWF     0x4b,0x1                                                                                        
                                                       /*                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * _byte0: bit0: Halt Status [0] Not Halted [1] Halted               D:\work\midicontroller\x013x\usb.c
                                                        */                                                                  D:\work\midicontroller\x013x\usb.c
001f72   0104     MOVLB     0x4                        pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);     D:\work\midicontroller\x013x\usb.c
001f74   5114     MOVF      0x14,0x0,0x1                                                                                    
001f76   0b0f     ANDLW     0xf                                                                                             
001f78   0d08     MULLW     0x8                                                                                             
001f7a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001f7c   6a11     CLRF      0x11,0x0                                                                                        
001f7e   0f00     ADDLW     0x0                                                                                             
001f80   6e10     MOVWF     0x10,0x0                                                                                        
001f82   0e04     MOVLW     0x4                                                                                             
001f84   2211     ADDWFC    0x11,0x1,0x0                                                                                    
001f86   5114     MOVF      0x14,0x0,0x1                                                                                    
001f88   0b80     ANDLW     0x80                                                                                            
001f8a   e001     BZ        0x1f8e                                                                                          
001f8c   0e01     MOVLW     0x1                                                                                             
001f8e   0d04     MULLW     0x4                                                                                             
001f90   50f3     MOVF      0xf3,0x0,0x0                                                                                    
001f92   0101     MOVLB     0x1                                                                                             
001f94   2410     ADDWF     0x10,0x0,0x0                                                                                    
001f96   6f4e     MOVWF     0x4e,0x1                                                                                        
001f98   0e00     MOVLW     0x0                                                                                             
001f9a   2011     ADDWFC    0x11,0x0,0x0                                                                                    
001f9c   6f4f     MOVWF     0x4f,0x1                                                                                        
001f9e   c14e     MOVFF     0x14e,0xfe9                if(*pDst.bRam & _BSTALL)    // Use _BSTALL as a bit mask             D:\work\midicontroller\x013x\usb.c
001fa0   ffe9                                                                                                               
001fa2   c14f     MOVFF     0x14f,0xfea                                                                                     
001fa4   ffea                                                                                                               
001fa6   50ef     MOVF      0xef,0x0,0x0                                                                                    
001fa8   0b04     ANDLW     0x4                                                                                             
001faa   e003     BZ        0x1fb2                                                                                          
001fac   0104     MOVLB     0x4                            CtrlTrfData._byte0=0x01;// Set bit0                              D:\work\midicontroller\x013x\usb.c
001fae   0e01     MOVLW     0x1                                                                                             
001fb0   6f50     MOVWF     0x50,0x1                                                                                        
001fb2   d000     BRA       0x1fb4                     break;                                                               D:\work\midicontroller\x013x\usb.c
                                               }//end switch                                                                D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001fb4   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_USB9)                                      D:\work\midicontroller\x013x\usb.c
001fb6   054b     DECF      0x4b,0x0,0x1                                                                                    
001fb8   e107     BNZ       0x1fc8                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
001fba   0e50     MOVLW     0x50                   pSrc.bRam = (byte*)&CtrlTrfData;            // Set Source                D:\work\midicontroller\x013x\usb.c
001fbc   6f4c     MOVWF     0x4c,0x1                                                                                        
001fbe   0e04     MOVLW     0x4                                                                                             
001fc0   6f4d     MOVWF     0x4d,0x1                                                                                        
001fc2   9347     BCF       0x47,0x1,0x1           usb_stat.ctrl_trf_mem = _RAM;               // Set memory type           D:\work\midicontroller\x013x\usb.c
001fc4   0e02     MOVLW     0x2                    LSB(wCount) = 2;                            // Set data count            D:\work\midicontroller\x013x\usb.c
001fc6   6f50     MOVWF     0x50,0x1                                                                                        
                                               }//end if(...)                                                               D:\work\midicontroller\x013x\usb.c
001fc8   0012     RETURN    0x0            }//end USBStdGetStatusHandler                                                    D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBStdFeatureReqHandler(void)                           D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine handles the standard SET & CLEAR FEATURES       D:\work\midicontroller\x013x\usb.c
                                            *                  requests                                                     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBStdFeatureReqHandler(void)                                               D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
001fca   0104     MOVLB     0x4                if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&                             D:\work\midicontroller\x013x\usb.c
001fcc   0512     DECF      0x12,0x0,0x1                                                                                    
001fce   e110     BNZ       0x1ff0                (SetupPkt.Recipient == RCPT_DEV))                                         D:\work\midicontroller\x013x\usb.c
001fd0   5110     MOVF      0x10,0x0,0x1                                                                                    
001fd2   0b1f     ANDLW     0x1f                                                                                            
001fd4   0900     IORLW     0x0                                                                                             
001fd6   e10c     BNZ       0x1ff0                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
001fd8   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      D:\work\midicontroller\x013x\usb.c
001fda   0e01     MOVLW     0x1                                                                                             
001fdc   6f4b     MOVWF     0x4b,0x1                                                                                        
001fde   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     D:\work\midicontroller\x013x\usb.c
001fe0   0104     MOVLB     0x4                                                                                             
001fe2   5d11     SUBWF     0x11,0x0,0x1                                                                                    
001fe4   e103     BNZ       0x1fec                                                                                          
001fe6   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 1;                                           D:\work\midicontroller\x013x\usb.c
001fe8   8147     BSF       0x47,0x0,0x1                                                                                    
001fea   d002     BRA       0x1ff0                 else                                                                     D:\work\midicontroller\x013x\usb.c
001fec   0101     MOVLB     0x1                        usb_stat.RemoteWakeup = 0;                                           D:\work\midicontroller\x013x\usb.c
001fee   9147     BCF       0x47,0x0,0x1                                                                                    
                                               }//end if                                                                    D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
001ff0   0104     MOVLB     0x4                if((SetupPkt.bFeature == ENDPOINT_HALT)&&                                    D:\work\midicontroller\x013x\usb.c
001ff2   5112     MOVF      0x12,0x0,0x1                                                                                    
001ff4   e13a     BNZ       0x206a                (SetupPkt.Recipient == RCPT_EP)&&                                         D:\work\midicontroller\x013x\usb.c
001ff6   5110     MOVF      0x10,0x0,0x1                                                                                    
001ff8   0b1f     ANDLW     0x1f                                                                                            
001ffa   0802     SUBLW     0x2                                                                                             
001ffc   e136     BNZ       0x206a                                                                                          
001ffe   5114     MOVF      0x14,0x0,0x1          (SetupPkt.EPNum != 0))                                                    D:\work\midicontroller\x013x\usb.c
002000   0b0f     ANDLW     0xf                                                                                             
002002   0900     IORLW     0x0                                                                                             
002004   e032     BZ        0x206a                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
002006   0101     MOVLB     0x1                    ctrl_trf_session_owner = MUID_USB9;                                      D:\work\midicontroller\x013x\usb.c
002008   0e01     MOVLW     0x1                                                                                             
00200a   6f4b     MOVWF     0x4b,0x1                                                                                        
                                                   /* Must do address calculation here */                                   D:\work\midicontroller\x013x\usb.c
00200c   0104     MOVLB     0x4                    pDst.bRam = (byte*)&ep0Bo+(SetupPkt.EPNum*8)+(SetupPkt.EPDir*4);         D:\work\midicontroller\x013x\usb.c
00200e   5114     MOVF      0x14,0x0,0x1                                                                                    
002010   0b0f     ANDLW     0xf                                                                                             
002012   0d08     MULLW     0x8                                                                                             
002014   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002016   6a11     CLRF      0x11,0x0                                                                                        
002018   0f00     ADDLW     0x0                                                                                             
00201a   6e10     MOVWF     0x10,0x0                                                                                        
00201c   0e04     MOVLW     0x4                                                                                             
00201e   2211     ADDWFC    0x11,0x1,0x0                                                                                    
002020   5114     MOVF      0x14,0x0,0x1                                                                                    
002022   0b80     ANDLW     0x80                                                                                            
002024   e001     BZ        0x2028                                                                                          
002026   0e01     MOVLW     0x1                                                                                             
002028   0d04     MULLW     0x4                                                                                             
00202a   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00202c   0101     MOVLB     0x1                                                                                             
00202e   2410     ADDWF     0x10,0x0,0x0                                                                                    
002030   6f4e     MOVWF     0x4e,0x1                                                                                        
002032   0e00     MOVLW     0x0                                                                                             
002034   2011     ADDWFC    0x11,0x0,0x0                                                                                    
002036   6f4f     MOVWF     0x4f,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002038   0e03     MOVLW     0x3                    if(SetupPkt.bRequest == SET_FEATURE)                                     D:\work\midicontroller\x013x\usb.c
00203a   0104     MOVLB     0x4                                                                                             
00203c   5d11     SUBWF     0x11,0x0,0x1                                                                                    
00203e   e107     BNZ       0x204e                                                                                          
002040   0e84     MOVLW     0x84                       *pDst.bRam = _USIE|_BSTALL;                                          D:\work\midicontroller\x013x\usb.c
002042   c14e     MOVFF     0x14e,0xfe9                                                                                     
002044   ffe9                                                                                                               
002046   c14f     MOVFF     0x14f,0xfea                                                                                     
002048   ffea                                                                                                               
00204a   6eef     MOVWF     0xef,0x0                                                                                        
00204c   d00e     BRA       0x206a                 else                                                                     D:\work\midicontroller\x013x\usb.c
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
00204e   af14     BTFSS     0x14,0x7,0x1               if(SetupPkt.EPDir == 1) // IN                                        D:\work\midicontroller\x013x\usb.c
002050   d006     BRA       0x205e                                                                                          
002052   c14e     MOVFF     0x14e,0xfe9                    *pDst.bRam = _UCPU;                                              D:\work\midicontroller\x013x\usb.c
002054   ffe9                                                                                                               
002056   c14f     MOVFF     0x14f,0xfea                                                                                     
002058   ffea                                                                                                               
00205a   6aef     CLRF      0xef,0x0                                                                                        
00205c   d006     BRA       0x206a                     else                                                                 D:\work\midicontroller\x013x\usb.c
00205e   0e88     MOVLW     0x88                           *pDst.bRam = _USIE|_DAT0|_DTSEN;                                 D:\work\midicontroller\x013x\usb.c
002060   c14e     MOVFF     0x14e,0xfe9                                                                                     
002062   ffe9                                                                                                               
002064   c14f     MOVFF     0x14f,0xfea                                                                                     
002066   ffea                                                                                                               
002068   6eef     MOVWF     0xef,0x0                                                                                        
                                                   }//end if                                                                D:\work\midicontroller\x013x\usb.c
                                               }//end if                                                                    D:\work\midicontroller\x013x\usb.c
00206a   0012     RETURN    0x0            }//end USBStdFeatureReqHandler                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** EOF usb9.c ***************************************************************/  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           //usbmmap.c                                                                      D:\work\midicontroller\x013x\usb.c
                                           /** I N C L U D E S **********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** U S B  G L O B A L  V A R I A B L E S ************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma udata usb5                                                               D:\work\midicontroller\x013x\usb.c
                                           byte usb_device_state;          // Device States: DETACHED, ATTACHED, ...        D:\work\midicontroller\x013x\usb.c
                                           USB_DEVICE_STATUS usb_stat;     // Global USB flags                              D:\work\midicontroller\x013x\usb.c
                                           byte usb_active_cfg;            // Value of current configuration                D:\work\midicontroller\x013x\usb.c
                                           byte usb_alt_intf[MAX_NUM_INT]; // Array to keep track of the current alternate  D:\work\midicontroller\x013x\usb.c
                                                                           // setting for each interface ID                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** U S B  F I X E D  L O C A T I O N  V A R I A B L E S *********************/  D:\work\midicontroller\x013x\usb.c
                                           //#pragma udata usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) D:\work\midicontroller\x013x\usb.c
                                           #pragma udata overlay usbram4=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte) D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Section A: Buffer Descriptor Table                                            D:\work\midicontroller\x013x\usb.c
                                            * - 0x400 - 0x4FF(max)                                                          D:\work\midicontroller\x013x\usb.c
                                            * - MAX_EP_NUMBER is defined in autofiles\usbcfg.h                              D:\work\midicontroller\x013x\usb.c
                                            * - BDT data type is defined in system\usb\usbmmap.h                            D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(0 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep0Bo;         //Endpoint #0 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep0Bi;         //Endpoint #0 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(1 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep1Bo;         //Endpoint #1 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep1Bi;         //Endpoint #1 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(2 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep2Bo;         //Endpoint #2 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep2Bi;         //Endpoint #2 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(3 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep3Bo;         //Endpoint #3 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep3Bi;         //Endpoint #3 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(4 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep4Bo;         //Endpoint #4 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep4Bi;         //Endpoint #4 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(5 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep5Bo;         //Endpoint #5 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep5Bi;         //Endpoint #5 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(6 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep6Bo;         //Endpoint #6 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep6Bi;         //Endpoint #6 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(7 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep7Bo;         //Endpoint #7 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep7Bi;         //Endpoint #7 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(8 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep8Bo;         //Endpoint #8 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep8Bi;         //Endpoint #8 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(9 <= MAX_EP_NUMBER)                                                          D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep9Bo;         //Endpoint #9 BD Out                             D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep9Bi;         //Endpoint #9 BD In                              D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(10 <= MAX_EP_NUMBER)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep10Bo;        //Endpoint #10 BD Out                            D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep10Bi;        //Endpoint #10 BD In                             D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(11 <= MAX_EP_NUMBER)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep11Bo;        //Endpoint #11 BD Out                            D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep11Bi;        //Endpoint #11 BD In                             D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(12 <= MAX_EP_NUMBER)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep12Bo;        //Endpoint #12 BD Out                            D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep12Bi;        //Endpoint #12 BD In                             D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(13 <= MAX_EP_NUMBER)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep13Bo;        //Endpoint #13 BD Out                            D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep13Bi;        //Endpoint #13 BD In                             D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(14 <= MAX_EP_NUMBER)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep14Bo;        //Endpoint #14 BD Out                            D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep14Bi;        //Endpoint #14 BD In                             D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #if(15 <= MAX_EP_NUMBER)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep15Bo;        //Endpoint #15 BD Out                            D:\work\midicontroller\x013x\usb.c
                                           volatile far BDT ep15Bi;        //Endpoint #15 BD In                             D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Section B: EP0 Buffer Space                                                   D:\work\midicontroller\x013x\usb.c
                                            ******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * - Two buffer areas are defined:                                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *   A. CTRL_TRF_SETUP                                                           D:\work\midicontroller\x013x\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  D:\work\midicontroller\x013x\usb.c
                                            *      - Detailed data structure allows direct adddressing of bits and bytes.   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *   B. CTRL_TRF_DATA                                                            D:\work\midicontroller\x013x\usb.c
                                            *      - Size = EP0_BUFF_SIZE as defined in autofiles\usbcfg.h                  D:\work\midicontroller\x013x\usb.c
                                            *      - Data structure allows direct adddressing of the first 8 bytes.         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * - Both data types are defined in system\usb\usbdefs\usbdefs_ep0_buff.h        D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           volatile far CTRL_TRF_SETUP SetupPkt;                                            D:\work\midicontroller\x013x\usb.c
                                           volatile far CTRL_TRF_DATA CtrlTrfData;                                          D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Section C: HID Buffer                                                         D:\work\midicontroller\x013x\usb.c
                                            ******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #if defined(USB_USE_HID)                                                         D:\work\midicontroller\x013x\usb.c
                                           volatile far unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];                  D:\work\midicontroller\x013x\usb.c
                                           volatile far unsigned char hid_report_in[HID_INT_IN_EP_SIZE];                    D:\work\midicontroller\x013x\usb.c
                                           #endif                                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           #pragma udata usb5                                                               D:\work\midicontroller\x013x\usb.c
                                           /** EOF usbmmap.c ************************************************************/  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           //usbctrltrf.c                                                                   D:\work\midicontroller\x013x\usb.c
                                           /** I N C L U D E S **********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #include "p18f4455.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** V A R I A B L E S ********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma udata usb5                                                               D:\work\midicontroller\x013x\usb.c
                                           byte ctrl_trf_state;                // Control Transfer State                    D:\work\midicontroller\x013x\usb.c
                                           byte ctrl_trf_session_owner;        // Current transfer session owner            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           POINTER pSrc;                       // Data source pointer                       D:\work\midicontroller\x013x\usb.c
                                           POINTER pDst;                       // Data destination pointer                  D:\work\midicontroller\x013x\usb.c
                                           WORD wCount;                        // Data counter                              D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlTrfSetupHandler(void);                                               D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlTrfOutHandler(void);                                                 D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlTrfInHandler(void);                                                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlEPService(void)                                  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    USTAT is loaded with a valid endpoint address.               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        USBCtrlEPService checks for three transaction types that     D:\work\midicontroller\x013x\usb.c
                                            *                  it knows how to service and services them:                   D:\work\midicontroller\x013x\usb.c
                                            *                  1. EP0 SETUP                                                 D:\work\midicontroller\x013x\usb.c
                                            *                  2. EP0 OUT                                                   D:\work\midicontroller\x013x\usb.c
                                            *                  3. EP0 IN                                                    D:\work\midicontroller\x013x\usb.c
                                            *                  It ignores all other types (i.e. EP1, EP2, etc.)             D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlEPService(void)                                                      D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
00206c   506c     MOVF      0x6c,0x0,0x0       if(USTAT == EP00_OUT)                                                        D:\work\midicontroller\x013x\usb.c
00206e   e10b     BNZ       0x2086                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
002070   0104     MOVLB     0x4                    if(ep0Bo.Stat.PID == SETUP_TOKEN)           // EP0 SETUP                 D:\work\midicontroller\x013x\usb.c
002072   5100     MOVF      0x0,0x0,0x1                                                                                     
002074   0b3c     ANDLW     0x3c                                                                                            
002076   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
002078   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00207a   080d     SUBLW     0xd                                                                                             
00207c   e102     BNZ       0x2082                                                                                          
00207e   d808     RCALL     0x2090                     USBCtrlTrfSetupHandler();                                            D:\work\midicontroller\x013x\usb.c
002080   d001     BRA       0x2084                 else                                        // EP0 OUT                   D:\work\midicontroller\x013x\usb.c
002082   d83b     RCALL     0x20fa                     USBCtrlTrfOutHandler();                                              D:\work\midicontroller\x013x\usb.c
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
002084   d004     BRA       0x208e             else if(USTAT == EP00_IN)                       // EP0 IN                    D:\work\midicontroller\x013x\usb.c
002086   0e04     MOVLW     0x4                                                                                             
002088   5c6c     SUBWF     0x6c,0x0,0x0                                                                                    
00208a   e101     BNZ       0x208e                                                                                          
00208c   d846     RCALL     0x211a                 USBCtrlTrfInHandler();                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00208e   0012     RETURN    0x0            }//end USBCtrlEPService                                                          D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlTrfSetupHandler(void)                            D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data          D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine is a task dispatcher and has 3 stages.          D:\work\midicontroller\x013x\usb.c
                                            *                  1. It initializes the control transfer state machine.        D:\work\midicontroller\x013x\usb.c
                                            *                  2. It calls on each of the module that may know how to       D:\work\midicontroller\x013x\usb.c
                                            *                     service the Setup Request from the host.                  D:\work\midicontroller\x013x\usb.c
                                            *                     Module Example: USB9, HID, CDC, MSD, ...                  D:\work\midicontroller\x013x\usb.c
                                            *                     As new classes are added, ClassReqHandler table in        D:\work\midicontroller\x013x\usb.c
                                            *                     usbdsc.c should be updated to call all available          D:\work\midicontroller\x013x\usb.c
                                            *                     class handlers.                                           D:\work\midicontroller\x013x\usb.c
                                            *                  3. Once each of the modules has had a chance to check if     D:\work\midicontroller\x013x\usb.c
                                            *                     it is responsible for servicing the request, stage 3      D:\work\midicontroller\x013x\usb.c
                                            *                     then checks direction of the transfer to determine how    D:\work\midicontroller\x013x\usb.c
                                            *                     to prepare EP0 for the control transfer.                  D:\work\midicontroller\x013x\usb.c
                                            *                     Refer to USBCtrlEPServiceComplete() for more details.     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            Microchip USB Firmware has three different states for        D:\work\midicontroller\x013x\usb.c
                                            *                  the control transfer state machine:                          D:\work\midicontroller\x013x\usb.c
                                            *                  1. WAIT_SETUP                                                D:\work\midicontroller\x013x\usb.c
                                            *                  2. CTRL_TRF_TX                                               D:\work\midicontroller\x013x\usb.c
                                            *                  3. CTRL_TRF_RX                                               D:\work\midicontroller\x013x\usb.c
                                            *                  Refer to firmware manual to find out how one state           D:\work\midicontroller\x013x\usb.c
                                            *                  is transitioned to another.                                  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                  A Control Transfer is composed of many USB transactions.     D:\work\midicontroller\x013x\usb.c
                                            *                  When transferring data over multiple transactions,           D:\work\midicontroller\x013x\usb.c
                                            *                  it is important to keep track of data source, data           D:\work\midicontroller\x013x\usb.c
                                            *                  destination, and data count. These three parameters are      D:\work\midicontroller\x013x\usb.c
                                            *                  stored in pSrc,pDst, and wCount. A flag is used to           D:\work\midicontroller\x013x\usb.c
                                            *                  note if the data source is from ROM or RAM.                  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
002090   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfSetupHandler(void)                                                D:\work\midicontroller\x013x\usb.c
002092   ffe6                                                                                                               
002094   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002096   ffd9                                                                                                               
002098   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               byte i;                                                                      D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /* Stage 1 */                                                                D:\work\midicontroller\x013x\usb.c
00209a   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;                                                 D:\work\midicontroller\x013x\usb.c
00209c   6b4a     CLRF      0x4a,0x1                                                                                        
00209e   6b4b     CLRF      0x4b,0x1           ctrl_trf_session_owner = MUID_NULL;     // Set owner to NULL                 D:\work\midicontroller\x013x\usb.c
0020a0   6b50     CLRF      0x50,0x1           wCount._word = 0;                                                            D:\work\midicontroller\x013x\usb.c
0020a2   6b51     CLRF      0x51,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /* Stage 2 */                                                                D:\work\midicontroller\x013x\usb.c
0020a4   de66     RCALL     0x1d72             USBCheckStdRequest();                   // See system\usb9\usb9.c            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /* Modifiable Section */                                                     D:\work\midicontroller\x013x\usb.c
0020a6   6adf     CLRF      0xdf,0x0           for(i=0;i < (sizeof(ClassReqHandler)/sizeof(pFunc));i++)                     D:\work\midicontroller\x013x\usb.c
0020a8   50df     MOVF      0xdf,0x0,0x0                                                                                    
0020aa   6e10     MOVWF     0x10,0x0                                                                                        
0020ac   6a11     CLRF      0x11,0x0                                                                                        
0020ae   0e01     MOVLW     0x1                                                                                             
0020b0   5c10     SUBWF     0x10,0x0,0x0                                                                                    
0020b2   0e00     MOVLW     0x0                                                                                             
0020b4   5811     SUBWFB    0x11,0x0,0x0                                                                                    
0020b6   e21b     BC        0x20ee                                                                                          
0020ea   2adf     INCF      0xdf,0x1,0x0                                                                                    
0020ec   d7dd     BRA       0x20a8                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
0020b8   0101     MOVLB     0x1                    if(ctrl_trf_session_owner != MUID_NULL)break;                            D:\work\midicontroller\x013x\usb.c
0020ba   514b     MOVF      0x4b,0x0,0x1                                                                                    
0020bc   e001     BZ        0x20c0                                                                                          
0020be   d017     BRA       0x20ee                                                                                          
0020c0   6af7     CLRF      0xf7,0x0               ClassReqHandler[i]();               // See autofiles\usbdsc.c            D:\work\midicontroller\x013x\usb.c
0020c2   34df     RLCF      0xdf,0x0,0x0                                                                                    
0020c4   0bfe     ANDLW     0xfe                                                                                            
0020c6   36f7     RLCF      0xf7,0x1,0x0                                                                                    
0020c8   6ef6     MOVWF     0xf6,0x0                                                                                        
0020ca   0e82     MOVLW     0x82                                                                                            
0020cc   26f6     ADDWF     0xf6,0x1,0x0                                                                                    
0020ce   0e34     MOVLW     0x34                                                                                            
0020d0   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
0020d2   0009     TBLRDPOSTINC                                                                                              
0020d4   cff5     MOVFF     0xff5,0x10                                                                                      
0020d6   f010                                                                                                               
0020d8   0008     TBLRD                                                                                                     
0020da   cff5     MOVFF     0xff5,0x11                                                                                      
0020dc   f011                                                                                                               
0020de   d004     BRA       0x20e8                                                                                          
0020e0   c011     MOVFF     0x11,0xffa                                                                                      
0020e2   fffa                                                                                                               
0020e4   5010     MOVF      0x10,0x0,0x0                                                                                    
0020e6   6ef9     MOVWF     0xf9,0x0                                                                                        
0020e8   dffb     RCALL     0x20e0                                                                                          
                                               }//end while                                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /* End Modifiable Section */                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /* Stage 3 */                                                                D:\work\midicontroller\x013x\usb.c
0020ee   d8df     RCALL     0x22ae             USBCtrlEPServiceComplete();                                                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
0020f0   52e5     MOVF      0xe5,0x1,0x0   }//end USBCtrlTrfSetupHandler                                                    D:\work\midicontroller\x013x\usb.c
0020f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0020f4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0020f6   ffd9                                                                                                               
0020f8   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlTrfOutHandler(void)                              D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine handles an OUT transaction according to         D:\work\midicontroller\x013x\usb.c
                                            *                  which control transfer state is currently active.            D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            Note that if the the control transfer was from               D:\work\midicontroller\x013x\usb.c
                                            *                  host to device, the session owner should be notified         D:\work\midicontroller\x013x\usb.c
                                            *                  at the end of each OUT transaction to service the            D:\work\midicontroller\x013x\usb.c
                                            *                  received data.                                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlTrfOutHandler(void)                                                  D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
0020fa   0e02     MOVLW     0x2                if(ctrl_trf_state == CTRL_TRF_RX)                                            D:\work\midicontroller\x013x\usb.c
0020fc   0101     MOVLB     0x1                                                                                             
0020fe   5d4a     SUBWF     0x4a,0x0,0x1                                                                                    
002100   e10a     BNZ       0x2116                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
002102   d898     RCALL     0x2234                 USBCtrlTrfRxService();                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /*                                                                       D:\work\midicontroller\x013x\usb.c
                                                    * Don't have to worry about overwriting _KEEP bit                       D:\work\midicontroller\x013x\usb.c
                                                    * because if _KEEP was set, TRNIF would not have been                   D:\work\midicontroller\x013x\usb.c
                                                    * generated in the first place.                                         D:\work\midicontroller\x013x\usb.c
                                                    */                                                                      D:\work\midicontroller\x013x\usb.c
002104   0104     MOVLB     0x4                    if(ep0Bo.Stat.DTS == 0)                                                  D:\work\midicontroller\x013x\usb.c
002106   bd00     BTFSC     0x0,0x6,0x1                                                                                     
002108   d003     BRA       0x2110                                                                                          
00210a   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
00210c   6f00     MOVWF     0x0,0x1                                                                                         
00210e   d002     BRA       0x2114                 else                                                                     D:\work\midicontroller\x013x\usb.c
002110   0e88     MOVLW     0x88                       ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
002112   6f00     MOVWF     0x0,0x1                                                                                         
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
002114   d001     BRA       0x2118             else    // CTRL_TRF_TX                                                       D:\work\midicontroller\x013x\usb.c
002116   d90e     RCALL     0x2334                 USBPrepareForNextSetupTrf();                                             D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002118   0012     RETURN    0x0            }//end USBCtrlTrfOutHandler                                                      D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlTrfInHandler(void)                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine handles an IN transaction according to          D:\work\midicontroller\x013x\usb.c
                                            *                  which control transfer state is currently active.            D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            A Set Address Request must not change the acutal address     D:\work\midicontroller\x013x\usb.c
                                            *                  of the device until the completion of the control            D:\work\midicontroller\x013x\usb.c
                                            *                  transfer. The end of the control transfer for Set Address    D:\work\midicontroller\x013x\usb.c
                                            *                  Request is an IN transaction. Therefore it is necessary      D:\work\midicontroller\x013x\usb.c
                                            *                  to service this unique situation when the condition is       D:\work\midicontroller\x013x\usb.c
                                            *                  right. Macro mUSBCheckAdrPendingState is defined in          D:\work\midicontroller\x013x\usb.c
                                            *                  usb9.h and its function is to specifically service this      D:\work\midicontroller\x013x\usb.c
                                            *                  event.                                                       D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlTrfInHandler(void)                                                   D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
00211a   0e04     MOVLW     0x4                mUSBCheckAdrPendingState();         // Must check if in ADR_PENDING_STATE    D:\work\midicontroller\x013x\usb.c
00211c   0101     MOVLB     0x1                                                                                             
00211e   5d46     SUBWF     0x46,0x0,0x1                                                                                    
002120   e10a     BNZ       0x2136                                                                                          
002122   c412     MOVFF     0x412,0xf6e                                                                                     
002124   ff6e                                                                                                               
002126   506e     MOVF      0x6e,0x0,0x0                                                                                    
002128   0800     SUBLW     0x0                                                                                             
00212a   e203     BC        0x2132                                                                                          
00212c   0e05     MOVLW     0x5                                                                                             
00212e   6f46     MOVWF     0x46,0x1                                                                                        
002130   d002     BRA       0x2136                                                                                          
002132   0e03     MOVLW     0x3                                                                                             
002134   6f46     MOVWF     0x46,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002136   054a     DECF      0x4a,0x0,0x1       if(ctrl_trf_state == CTRL_TRF_TX)                                            D:\work\midicontroller\x013x\usb.c
002138   e10a     BNZ       0x214e                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
00213a   d811     RCALL     0x215e                 USBCtrlTrfTxService();                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00213c   0104     MOVLB     0x4                    if(ep0Bi.Stat.DTS == 0)                                                  D:\work\midicontroller\x013x\usb.c
00213e   bd04     BTFSC     0x4,0x6,0x1                                                                                     
002140   d003     BRA       0x2148                                                                                          
002142   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
002144   6f04     MOVWF     0x4,0x1                                                                                         
002146   d002     BRA       0x214c                 else                                                                     D:\work\midicontroller\x013x\usb.c
002148   0e88     MOVLW     0x88                       ep0Bi.Stat._byte = _USIE|_DAT0|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
00214a   6f04     MOVWF     0x4,0x1                                                                                         
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
00214c   d007     BRA       0x215c             else { // CTRL_TRF_RX                                                        D:\work\midicontroller\x013x\usb.c
                                           //Rawin's code change to handle setreport data:                                  D:\work\midicontroller\x013x\usb.c
00214e   0e09     MOVLW     0x9            		if (SetupPkt.bRequest == SET_REPORT) {                                         D:\work\midicontroller\x013x\usb.c
002150   0104     MOVLB     0x4                                                                                             
002152   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002154   e102     BNZ       0x215a                                                                                          
002156   ec71     CALL      0x2ee2,0x0     			HIDSetReportHandler();                                                        D:\work\midicontroller\x013x\usb.c
002158   f017                                                                                                               
                                           		}                                                                              D:\work\midicontroller\x013x\usb.c
00215a   d8ec     RCALL     0x2334         		USBPrepareForNextSetupTrf();                                                   D:\work\midicontroller\x013x\usb.c
                                           	}                                                                               D:\work\midicontroller\x013x\usb.c
00215c   0012     RETURN    0x0            }//end USBCtrlTrfInHandler                                                       D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlTrfTxService(void)                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine should be called from only two places.          D:\work\midicontroller\x013x\usb.c
                                            *                  One from USBCtrlEPServiceComplete() and one from             D:\work\midicontroller\x013x\usb.c
                                            *                  USBCtrlTrfInHandler(). It takes care of managing a           D:\work\midicontroller\x013x\usb.c
                                            *                  transfer over multiple USB transactions.                     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            This routine works with isochronous endpoint larger than     D:\work\midicontroller\x013x\usb.c
                                            *                  256 bytes and is shown here as an example of how to deal     D:\work\midicontroller\x013x\usb.c
                                            *                  with BC9 and BC8. In reality, a control endpoint can never   D:\work\midicontroller\x013x\usb.c
                                            *                  be larger than 64 bytes.                                     D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
00215e   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfTxService(void)                                                   D:\work\midicontroller\x013x\usb.c
002160   ffe6                                                                                                               
002162   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002164   ffd9                                                                                                               
002166   0e02     MOVLW     0x2                                                                                             
002168   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               WORD byte_to_send;                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * First, have to figure out how many byte of data to send.                  D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
00216a   0101     MOVLB     0x1                if(wCount._word < EP0_BUFF_SIZE)                                             D:\work\midicontroller\x013x\usb.c
00216c   0e40     MOVLW     0x40                                                                                            
00216e   5d50     SUBWF     0x50,0x0,0x1                                                                                    
002170   0e00     MOVLW     0x0                                                                                             
002172   5951     SUBWFB    0x51,0x0,0x1                                                                                    
002174   e205     BC        0x2180                                                                                          
002176   c150     MOVFF     0x150,0xfde            byte_to_send._word = wCount._word;                                       D:\work\midicontroller\x013x\usb.c
002178   ffde                                                                                                               
00217a   c151     MOVFF     0x151,0xfdd                                                                                     
00217c   ffdd                                                                                                               
00217e   d003     BRA       0x2186             else                                                                         D:\work\midicontroller\x013x\usb.c
002180   0e40     MOVLW     0x40                   byte_to_send._word = EP0_BUFF_SIZE;                                      D:\work\midicontroller\x013x\usb.c
002182   6ede     MOVWF     0xde,0x0                                                                                        
002184   6add     CLRF      0xdd,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Next, load the number of bytes to send to BC9..0 in buffer descriptor     D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002186   0104     MOVLB     0x4                ep0Bi.Stat.BC9 = 0;                                                          D:\work\midicontroller\x013x\usb.c
002188   9304     BCF       0x4,0x1,0x1                                                                                     
00218a   9104     BCF       0x4,0x0,0x1        ep0Bi.Stat.BC8 = 0;                                                          D:\work\midicontroller\x013x\usb.c
00218c   0e01     MOVLW     0x1                ep0Bi.Stat._byte |= MSB(byte_to_send);                                       D:\work\midicontroller\x013x\usb.c
00218e   50db     MOVF      0xdb,0x0,0x0                                                                                    
002190   1304     IORWF     0x4,0x1,0x1                                                                                     
002192   cfdf     MOVFF     0xfdf,0x405        ep0Bi.Cnt = LSB(byte_to_send);                                               D:\work\midicontroller\x013x\usb.c
002194   f405                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Subtract the number of bytes just about to be sent from the total.        D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002196   0e00     MOVLW     0x0                wCount._word = wCount._word - byte_to_send._word;                            D:\work\midicontroller\x013x\usb.c
002198   50db     MOVF      0xdb,0x0,0x0                                                                                    
00219a   0101     MOVLB     0x1                                                                                             
00219c   5f50     SUBWF     0x50,0x1,0x1                                                                                    
00219e   0e01     MOVLW     0x1                                                                                             
0021a0   50db     MOVF      0xdb,0x0,0x0                                                                                    
0021a2   5b51     SUBWFB    0x51,0x1,0x1                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\usb.c
0021a4   0e50     MOVLW     0x50               pDst.bRam = (byte*)&CtrlTrfData;        // Set destination pointer           D:\work\midicontroller\x013x\usb.c
0021a6   6f4e     MOVWF     0x4e,0x1                                                                                        
0021a8   0e04     MOVLW     0x4                                                                                             
0021aa   6f4f     MOVWF     0x4f,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
0021ac   a347     BTFSS     0x47,0x1,0x1       if(usb_stat.ctrl_trf_mem == _ROM)       // Determine type of memory source   D:\work\midicontroller\x013x\usb.c
0021ae   d01d     BRA       0x21ea                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
0021b0   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                D:\work\midicontroller\x013x\usb.c
0021b2   ffe9                                                                                                               
0021b4   cfda     MOVFF     0xfda,0xfea                                                                                     
0021b6   ffea                                                                                                               
0021b8   50ee     MOVF      0xee,0x0,0x0                                                                                    
0021ba   10ed     IORWF     0xed,0x0,0x0                                                                                    
0021bc   e015     BZ        0x21e8                                                                                          
0021e6   d7e4     BRA       0x21b0                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
0021be   c14c     MOVFF     0x14c,0xff6                *pDst.bRam = *pSrc.bRom;                                             D:\work\midicontroller\x013x\usb.c
0021c0   fff6                                                                                                               
0021c2   c14d     MOVFF     0x14d,0xff7                                                                                     
0021c4   fff7                                                                                                               
0021c6   0008     TBLRD                                                                                                     
0021c8   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0021ca   c14e     MOVFF     0x14e,0xfe9                                                                                     
0021cc   ffe9                                                                                                               
0021ce   c14f     MOVFF     0x14f,0xfea                                                                                     
0021d0   ffea                                                                                                               
0021d2   6eef     MOVWF     0xef,0x0                                                                                        
0021d4   2b4e     INCF      0x4e,0x1,0x1               pDst.bRam++;                                                         D:\work\midicontroller\x013x\usb.c
0021d6   0e00     MOVLW     0x0                                                                                             
0021d8   234f     ADDWFC    0x4f,0x1,0x1                                                                                    
0021da   2b4c     INCF      0x4c,0x1,0x1               pSrc.bRom++;                                                         D:\work\midicontroller\x013x\usb.c
0021dc   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
0021de   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                D:\work\midicontroller\x013x\usb.c
0021e0   0e01     MOVLW     0x1                                                                                             
0021e2   e201     BC        0x21e6                                                                                          
0021e4   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         D:\work\midicontroller\x013x\usb.c
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
0021e8   d01b     BRA       0x2220             else // RAM                                                                  D:\work\midicontroller\x013x\usb.c
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
0021ea   cfd9     MOVFF     0xfd9,0xfe9            while(byte_to_send._word)                                                D:\work\midicontroller\x013x\usb.c
0021ec   ffe9                                                                                                               
0021ee   cfda     MOVFF     0xfda,0xfea                                                                                     
0021f0   ffea                                                                                                               
0021f2   50ee     MOVF      0xee,0x0,0x0                                                                                    
0021f4   10ed     IORWF     0xed,0x0,0x0                                                                                    
0021f6   e014     BZ        0x2220                                                                                          
00221e   d7e5     BRA       0x21ea                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
0021f8   c14c     MOVFF     0x14c,0xfe9                *pDst.bRam = *pSrc.bRam;                                             D:\work\midicontroller\x013x\usb.c
0021fa   ffe9                                                                                                               
0021fc   c14d     MOVFF     0x14d,0xfea                                                                                     
0021fe   ffea                                                                                                               
002200   50ef     MOVF      0xef,0x0,0x0                                                                                    
002202   c14e     MOVFF     0x14e,0xfe9                                                                                     
002204   ffe9                                                                                                               
002206   c14f     MOVFF     0x14f,0xfea                                                                                     
002208   ffea                                                                                                               
00220a   6eef     MOVWF     0xef,0x0                                                                                        
00220c   2b4e     INCF      0x4e,0x1,0x1               pDst.bRam++;                                                         D:\work\midicontroller\x013x\usb.c
00220e   0e00     MOVLW     0x0                                                                                             
002210   234f     ADDWFC    0x4f,0x1,0x1                                                                                    
002212   2b4c     INCF      0x4c,0x1,0x1               pSrc.bRam++;                                                         D:\work\midicontroller\x013x\usb.c
002214   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
002216   06df     DECF      0xdf,0x1,0x0               byte_to_send._word--;                                                D:\work\midicontroller\x013x\usb.c
002218   0e01     MOVLW     0x1                                                                                             
00221a   e201     BC        0x221e                                                                                          
00221c   06db     DECF      0xdb,0x1,0x0                                                                                    
                                                   }//end while(byte_to_send._word)                                         D:\work\midicontroller\x013x\usb.c
                                               }//end if(usb_stat.ctrl_trf_mem == _ROM)                                     D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002220   0e02     MOVLW     0x2            }//end USBCtrlTrfTxService                                                       D:\work\midicontroller\x013x\usb.c
002222   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002224   e202     BC        0x222a                                                                                          
002226   6ae1     CLRF      0xe1,0x0                                                                                        
002228   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00222a   6ee1     MOVWF     0xe1,0x0                                                                                        
00222c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00222e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002230   ffd9                                                                                                               
002232   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlTrfRxService(void)                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    pDst and wCount are setup properly.                          D:\work\midicontroller\x013x\usb.c
                                            *                  pSrc is always &CtrlTrfData                                  D:\work\midicontroller\x013x\usb.c
                                            *                  usb_stat.ctrl_trf_mem is always _RAM.                        D:\work\midicontroller\x013x\usb.c
                                            *                  wCount should be set to 0 at the start of each control       D:\work\midicontroller\x013x\usb.c
                                            *                  transfer.                                                    D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        *** This routine is only partially complete. Check for       D:\work\midicontroller\x013x\usb.c
                                            *                  new version of the firmware.                                 D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
002234   cfd9     MOVFF     0xfd9,0xfe6    void USBCtrlTrfRxService(void)                                                   D:\work\midicontroller\x013x\usb.c
002236   ffe6                                                                                                               
002238   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00223a   ffd9                                                                                                               
00223c   0e02     MOVLW     0x2                                                                                             
00223e   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               WORD byte_to_read;                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002240   0e03     MOVLW     0x3                MSB(byte_to_read) = 0x03 & ep0Bo.Stat._byte;    // Filter out last 2 bits    D:\work\midicontroller\x013x\usb.c
002242   0104     MOVLB     0x4                                                                                             
002244   1500     ANDWF     0x0,0x0,0x1                                                                                     
002246   6ee7     MOVWF     0xe7,0x0                                                                                        
002248   0e01     MOVLW     0x1                                                                                             
00224a   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
00224c   ffdb                                                                                                               
00224e   c401     MOVFF     0x401,0xfdf        LSB(byte_to_read) = ep0Bo.Cnt;                                               D:\work\midicontroller\x013x\usb.c
002250   ffdf                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Accumulate total number of bytes read                                     D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002252   50de     MOVF      0xde,0x0,0x0       wCount._word = wCount._word + byte_to_read._word;                            D:\work\midicontroller\x013x\usb.c
002254   0101     MOVLB     0x1                                                                                             
002256   2750     ADDWF     0x50,0x1,0x1                                                                                    
002258   50dd     MOVF      0xdd,0x0,0x0                                                                                    
00225a   2351     ADDWFC    0x51,0x1,0x1                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00225c   0e50     MOVLW     0x50               pSrc.bRam = (byte*)&CtrlTrfData;                                             D:\work\midicontroller\x013x\usb.c
00225e   6f4c     MOVWF     0x4c,0x1                                                                                        
002260   0e04     MOVLW     0x4                                                                                             
002262   6f4d     MOVWF     0x4d,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002264   cfd9     MOVFF     0xfd9,0xfe9        while(byte_to_read._word)                                                    D:\work\midicontroller\x013x\usb.c
002266   ffe9                                                                                                               
002268   cfda     MOVFF     0xfda,0xfea                                                                                     
00226a   ffea                                                                                                               
00226c   50ee     MOVF      0xee,0x0,0x0                                                                                    
00226e   10ed     IORWF     0xed,0x0,0x0                                                                                    
002270   e014     BZ        0x229a                                                                                          
002298   d7e5     BRA       0x2264                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
002272   c14c     MOVFF     0x14c,0xfe9            *pDst.bRam = *pSrc.bRam;                                                 D:\work\midicontroller\x013x\usb.c
002274   ffe9                                                                                                               
002276   c14d     MOVFF     0x14d,0xfea                                                                                     
002278   ffea                                                                                                               
00227a   50ef     MOVF      0xef,0x0,0x0                                                                                    
00227c   c14e     MOVFF     0x14e,0xfe9                                                                                     
00227e   ffe9                                                                                                               
002280   c14f     MOVFF     0x14f,0xfea                                                                                     
002282   ffea                                                                                                               
002284   6eef     MOVWF     0xef,0x0                                                                                        
002286   2b4e     INCF      0x4e,0x1,0x1           pDst.bRam++;                                                             D:\work\midicontroller\x013x\usb.c
002288   0e00     MOVLW     0x0                                                                                             
00228a   234f     ADDWFC    0x4f,0x1,0x1                                                                                    
00228c   2b4c     INCF      0x4c,0x1,0x1           pSrc.bRam++;                                                             D:\work\midicontroller\x013x\usb.c
00228e   234d     ADDWFC    0x4d,0x1,0x1                                                                                    
002290   06df     DECF      0xdf,0x1,0x0           byte_to_read._word--;                                                    D:\work\midicontroller\x013x\usb.c
002292   0e01     MOVLW     0x1                                                                                             
002294   e201     BC        0x2298                                                                                          
002296   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while(byte_to_read._word)                                             D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00229a   0e02     MOVLW     0x2            }//end USBCtrlTrfRxService                                                       D:\work\midicontroller\x013x\usb.c
00229c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00229e   e202     BC        0x22a4                                                                                          
0022a0   6ae1     CLRF      0xe1,0x0                                                                                        
0022a2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022a4   6ee1     MOVWF     0xe1,0x0                                                                                        
0022a6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0022a8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0022aa   ffd9                                                                                                               
0022ac   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCtrlEPServiceComplete(void)                          D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine wrap up the ramaining tasks in servicing        D:\work\midicontroller\x013x\usb.c
                                            *                  a Setup Request. Its main task is to set the endpoint        D:\work\midicontroller\x013x\usb.c
                                            *                  controls appropriately for a given situation. See code       D:\work\midicontroller\x013x\usb.c
                                            *                  below.                                                       D:\work\midicontroller\x013x\usb.c
                                            *                  There are three main scenarios:                              D:\work\midicontroller\x013x\usb.c
                                            *                  a) There was no handler for the Request, in this case        D:\work\midicontroller\x013x\usb.c
                                            *                     a STALL should be sent out.                               D:\work\midicontroller\x013x\usb.c
                                            *                  b) The host has requested a read control transfer,           D:\work\midicontroller\x013x\usb.c
                                            *                     endpoints are required to be setup in a specific way.     D:\work\midicontroller\x013x\usb.c
                                            *                  c) The host has requested a write control transfer, or       D:\work\midicontroller\x013x\usb.c
                                            *                     a control data stage is not required, endpoints are       D:\work\midicontroller\x013x\usb.c
                                            *                     required to be setup in a specific way.                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                  Packet processing is resumed by clearing PKTDIS bit.         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCtrlEPServiceComplete(void)                                              D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
0022ae   0101     MOVLB     0x1                if(ctrl_trf_session_owner == MUID_NULL)                                      D:\work\midicontroller\x013x\usb.c
0022b0   514b     MOVF      0x4b,0x0,0x1                                                                                    
0022b2   e10b     BNZ       0x22ca                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /*                                                                       D:\work\midicontroller\x013x\usb.c
                                                    * If no one knows how to service this request then stall.               D:\work\midicontroller\x013x\usb.c
                                                    * Must also prepare EP0 to receive the next SETUP transaction.          D:\work\midicontroller\x013x\usb.c
                                                    */                                                                      D:\work\midicontroller\x013x\usb.c
0022b4   0104     MOVLB     0x4                    ep0Bo.Cnt = EP0_BUFF_SIZE;                                               D:\work\midicontroller\x013x\usb.c
0022b6   0e40     MOVLW     0x40                                                                                            
0022b8   6f01     MOVWF     0x1,0x1                                                                                         
0022ba   0e10     MOVLW     0x10                   ep0Bo.ADR = (byte*)&SetupPkt;                                            D:\work\midicontroller\x013x\usb.c
0022bc   6f02     MOVWF     0x2,0x1                                                                                         
0022be   0e04     MOVLW     0x4                                                                                             
0022c0   6f03     MOVWF     0x3,0x1                                                                                         
                                                                                                                            D:\work\midicontroller\x013x\usb.c
0022c2   0e84     MOVLW     0x84                   ep0Bo.Stat._byte = _USIE|_BSTALL;                                        D:\work\midicontroller\x013x\usb.c
0022c4   6f00     MOVWF     0x0,0x1                                                                                         
0022c6   6f04     MOVWF     0x4,0x1                ep0Bi.Stat._byte = _USIE|_BSTALL;                                        D:\work\midicontroller\x013x\usb.c
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
0022c8   d033     BRA       0x2330             else    // A module has claimed ownership of the control transfer session.   D:\work\midicontroller\x013x\usb.c
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
0022ca   0104     MOVLB     0x4                    if(SetupPkt.DataDir == DEV_TO_HOST)                                      D:\work\midicontroller\x013x\usb.c
0022cc   af10     BTFSS     0x10,0x7,0x1                                                                                    
0022ce   d021     BRA       0x2312                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
0022d0   0101     MOVLB     0x1                        if(SetupPkt.wLength < wCount._word)                                  D:\work\midicontroller\x013x\usb.c
0022d2   5150     MOVF      0x50,0x0,0x1                                                                                    
0022d4   0104     MOVLB     0x4                                                                                             
0022d6   5d16     SUBWF     0x16,0x0,0x1                                                                                    
0022d8   0101     MOVLB     0x1                                                                                             
0022da   5151     MOVF      0x51,0x0,0x1                                                                                    
0022dc   0104     MOVLB     0x4                                                                                             
0022de   5917     SUBWFB    0x17,0x0,0x1                                                                                    
0022e0   e204     BC        0x22ea                                                                                          
0022e2   c416     MOVFF     0x416,0x150                    wCount._word = SetupPkt.wLength;                                 D:\work\midicontroller\x013x\usb.c
0022e4   f150                                                                                                               
0022e6   c417     MOVFF     0x417,0x151                                                                                     
0022e8   f151                                                                                                               
0022ea   df39     RCALL     0x215e                     USBCtrlTrfTxService();                                               D:\work\midicontroller\x013x\usb.c
0022ec   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_TX;                                        D:\work\midicontroller\x013x\usb.c
0022ee   0e01     MOVLW     0x1                                                                                             
0022f0   6f4a     MOVWF     0x4a,0x1                                                                                        
                                                       /*                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * Control Read:                                                     D:\work\midicontroller\x013x\usb.c
                                                        * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>                  D:\work\midicontroller\x013x\usb.c
                                                        * 1. Prepare OUT EP to respond to early termination                 D:\work\midicontroller\x013x\usb.c
                                                        *                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * NOTE:                                                             D:\work\midicontroller\x013x\usb.c
                                                        * If something went wrong during the control transfer,              D:\work\midicontroller\x013x\usb.c
                                                        * the last status stage may not be sent by the host.                D:\work\midicontroller\x013x\usb.c
                                                        * When this happens, two different things could happen              D:\work\midicontroller\x013x\usb.c
                                                        * depending on the host.                                            D:\work\midicontroller\x013x\usb.c
                                                        * a) The host could send out a RESET.                               D:\work\midicontroller\x013x\usb.c
                                                        * b) The host could send out a new SETUP transaction                D:\work\midicontroller\x013x\usb.c
                                                        *    without sending a RESET first.                                 D:\work\midicontroller\x013x\usb.c
                                                        * To properly handle case (b), the OUT EP must be setup             D:\work\midicontroller\x013x\usb.c
                                                        * to receive either a zero length OUT transaction, or a             D:\work\midicontroller\x013x\usb.c
                                                        * new SETUP transaction.                                            D:\work\midicontroller\x013x\usb.c
                                                        *                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * Since the SETUP transaction requires the DTS bit to be            D:\work\midicontroller\x013x\usb.c
                                                        * DAT0 while the zero length OUT status requires the DTS            D:\work\midicontroller\x013x\usb.c
                                                        * bit to be DAT1, the DTS bit check by the hardware should          D:\work\midicontroller\x013x\usb.c
                                                        * be disabled. This way the SIE could accept either of              D:\work\midicontroller\x013x\usb.c
                                                        * the two transactions.                                             D:\work\midicontroller\x013x\usb.c
                                                        *                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * Furthermore, the Cnt byte should be set to prepare for            D:\work\midicontroller\x013x\usb.c
                                                        * the SETUP data (8-byte or more), and the buffer address           D:\work\midicontroller\x013x\usb.c
                                                        * should be pointed to SetupPkt.                                    D:\work\midicontroller\x013x\usb.c
                                                        */                                                                  D:\work\midicontroller\x013x\usb.c
0022f2   0104     MOVLB     0x4                        ep0Bo.Cnt = EP0_BUFF_SIZE;                                           D:\work\midicontroller\x013x\usb.c
0022f4   0e40     MOVLW     0x40                                                                                            
0022f6   6f01     MOVWF     0x1,0x1                                                                                         
0022f8   0e10     MOVLW     0x10                       ep0Bo.ADR = (byte*)&SetupPkt;                                        D:\work\midicontroller\x013x\usb.c
0022fa   6f02     MOVWF     0x2,0x1                                                                                         
0022fc   0e04     MOVLW     0x4                                                                                             
0022fe   6f03     MOVWF     0x3,0x1                                                                                         
002300   0e80     MOVLW     0x80                       ep0Bo.Stat._byte = _USIE;           // Note: DTSEN is 0!             D:\work\midicontroller\x013x\usb.c
002302   6f00     MOVWF     0x0,0x1                                                                                         
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                       /*                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * 2. Prepare IN EP to transfer data, Cnt should have                D:\work\midicontroller\x013x\usb.c
                                                        *    been initialized by responsible request owner.                 D:\work\midicontroller\x013x\usb.c
                                                        */                                                                  D:\work\midicontroller\x013x\usb.c
002304   0e50     MOVLW     0x50                       ep0Bi.ADR = (byte*)&CtrlTrfData;                                     D:\work\midicontroller\x013x\usb.c
002306   6f06     MOVWF     0x6,0x1                                                                                         
002308   0e04     MOVLW     0x4                                                                                             
00230a   6f07     MOVWF     0x7,0x1                                                                                         
00230c   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
00230e   6f04     MOVWF     0x4,0x1                                                                                         
                                                   }                                                                        D:\work\midicontroller\x013x\usb.c
002310   d00f     BRA       0x2330                 else    // (SetupPkt.DataDir == HOST_TO_DEV)                             D:\work\midicontroller\x013x\usb.c
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
002312   0101     MOVLB     0x1                        ctrl_trf_state = CTRL_TRF_RX;                                        D:\work\midicontroller\x013x\usb.c
002314   0e02     MOVLW     0x2                                                                                             
002316   6f4a     MOVWF     0x4a,0x1                                                                                        
                                                       /*                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * Control Write:                                                    D:\work\midicontroller\x013x\usb.c
                                                        * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>                 D:\work\midicontroller\x013x\usb.c
                                                        *                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * 1. Prepare IN EP to respond to early termination                  D:\work\midicontroller\x013x\usb.c
                                                        *                                                                   D:\work\midicontroller\x013x\usb.c
                                                        *    This is the same as a Zero Length Packet Response              D:\work\midicontroller\x013x\usb.c
                                                        *    for control transfer without a data stage                      D:\work\midicontroller\x013x\usb.c
                                                        */                                                                  D:\work\midicontroller\x013x\usb.c
002318   0104     MOVLB     0x4                        ep0Bi.Cnt = 0;                                                       D:\work\midicontroller\x013x\usb.c
00231a   6b05     CLRF      0x5,0x1                                                                                         
00231c   0ec8     MOVLW     0xc8                       ep0Bi.Stat._byte = _USIE|_DAT1|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
00231e   6f04     MOVWF     0x4,0x1                                                                                         
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                       /*                                                                   D:\work\midicontroller\x013x\usb.c
                                                        * 2. Prepare OUT EP to receive data.                                D:\work\midicontroller\x013x\usb.c
                                                        */                                                                  D:\work\midicontroller\x013x\usb.c
002320   0e40     MOVLW     0x40                       ep0Bo.Cnt = EP0_BUFF_SIZE;                                           D:\work\midicontroller\x013x\usb.c
002322   6f01     MOVWF     0x1,0x1                                                                                         
002324   0e50     MOVLW     0x50                       ep0Bo.ADR = (byte*)&CtrlTrfData;                                     D:\work\midicontroller\x013x\usb.c
002326   6f02     MOVWF     0x2,0x1                                                                                         
002328   0e04     MOVLW     0x4                                                                                             
00232a   6f03     MOVWF     0x3,0x1                                                                                         
00232c   0ec8     MOVLW     0xc8                       ep0Bo.Stat._byte = _USIE|_DAT1|_DTSEN;                               D:\work\midicontroller\x013x\usb.c
00232e   6f00     MOVWF     0x0,0x1                                                                                         
                                                   }//end if(SetupPkt.DataDir == DEV_TO_HOST)                               D:\work\midicontroller\x013x\usb.c
                                               }//end if(ctrl_trf_session_owner == MUID_NULL)                               D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * PKTDIS bit is set when a Setup Transaction is received.                   D:\work\midicontroller\x013x\usb.c
                                                * Clear to resume packet processing.                                        D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002330   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;                                                         D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002332   0012     RETURN    0x0            }//end USBCtrlEPServiceComplete                                                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBPrepareForNextSetupTrf(void)                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        The routine forces EP0 OUT to be ready for a new Setup       D:\work\midicontroller\x013x\usb.c
                                            *                  transaction, and forces EP0 IN to be owned by CPU.           D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBPrepareForNextSetupTrf(void)                                             D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
002334   0101     MOVLB     0x1                ctrl_trf_state = WAIT_SETUP;            // See usbctrltrf.h                  D:\work\midicontroller\x013x\usb.c
002336   6b4a     CLRF      0x4a,0x1                                                                                        
002338   0104     MOVLB     0x4                ep0Bo.Cnt = EP0_BUFF_SIZE;              // Defined in usbcfg.h               D:\work\midicontroller\x013x\usb.c
00233a   0e40     MOVLW     0x40                                                                                            
00233c   6f01     MOVWF     0x1,0x1                                                                                         
00233e   0e10     MOVLW     0x10               ep0Bo.ADR = (byte*)&SetupPkt;                                                D:\work\midicontroller\x013x\usb.c
002340   6f02     MOVWF     0x2,0x1                                                                                         
002342   0e04     MOVLW     0x4                                                                                             
002344   6f03     MOVWF     0x3,0x1                                                                                         
002346   0e88     MOVLW     0x88               ep0Bo.Stat._byte = _USIE|_DAT0|_DTSEN;  // EP0 buff dsc init, see usbmmap.h  D:\work\midicontroller\x013x\usb.c
002348   6f00     MOVWF     0x0,0x1                                                                                         
00234a   6b04     CLRF      0x4,0x1            ep0Bi.Stat._byte = _UCPU;               // EP0 IN buffer initialization      D:\work\midicontroller\x013x\usb.c
00234c   0012     RETURN    0x0            }//end USBPrepareForNextSetupTrf                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** EOF usbctrltrf.c *********************************************************/  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           //usbdrv.c                                                                       D:\work\midicontroller\x013x\usb.c
                                           /** I N C L U D E S **********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #include "p18f4455.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\usb.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\usb.c
                                           //#include "io_cfg.h"             // Required for USBCheckBusStatus()            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** V A R I A B L E S ********************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma udata usb5                                                               D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBModuleEnable(void);                                                      D:\work\midicontroller\x013x\usb.c
                                           void USBModuleDisable(void);                                                     D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           void USBSuspend(void);                                                           D:\work\midicontroller\x013x\usb.c
                                           void USBWakeFromSuspend(void);                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           void USBProtocolResetHandler(void);                                              D:\work\midicontroller\x013x\usb.c
                                           void USB_SOF_Handler(void);                                                      D:\work\midicontroller\x013x\usb.c
                                           void USBStallHandler(void);                                                      D:\work\midicontroller\x013x\usb.c
                                           void USBErrorHandler(void);                                                      D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** D E C L A R A T I O N S **************************************************/  D:\work\midicontroller\x013x\usb.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBCheckBusStatus(void)                                 D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine enables/disables the USB module by monitoring   D:\work\midicontroller\x013x\usb.c
                                            *                  the USB power signal.                                        D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBCheckBusStatus(void)                                                     D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               /**************************************************************************  D:\work\midicontroller\x013x\usb.c
                                                * Bus Attachment & Detachment Detection                                     D:\work\midicontroller\x013x\usb.c
                                                * usb_bus_sense is an i/o pin defined in io_cfg.h                           D:\work\midicontroller\x013x\usb.c
                                                *************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                               #define USB_BUS_ATTACHED    1                                                D:\work\midicontroller\x013x\usb.c
                                               #define USB_BUS_DETACHED    0                                                D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               if(usb_bus_sense == USB_BUS_ATTACHED)       // Is USB bus attached?          D:\work\midicontroller\x013x\usb.c
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
00234e   a66d     BTFSS     0x6d,0x3,0x0           if(UCONbits.USBEN == 0)                 // Is the module off?            D:\work\midicontroller\x013x\usb.c
002350   d80f     RCALL     0x2370                     USBModuleEnable();                  // Is off, enable it             D:\work\midicontroller\x013x\usb.c
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
002352   d002     BRA       0x2358             else                                                                         D:\work\midicontroller\x013x\usb.c
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
002354   b66d     BTFSC     0x6d,0x3,0x0           if(UCONbits.USBEN == 1)                 // Is the module on?             D:\work\midicontroller\x013x\usb.c
002356   d813     RCALL     0x237e                     USBModuleDisable();                 // Is on, disable it             D:\work\midicontroller\x013x\usb.c
                                               }//end if(usb_bus_sense...)                                                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * After enabling the USB module, it takes some time for the voltage         D:\work\midicontroller\x013x\usb.c
                                                * on the D+ or D- line to rise high enough to get out of the SE0 condition. D:\work\midicontroller\x013x\usb.c
                                                * The USB Reset interrupt should not be unmasked until the SE0 condition is D:\work\midicontroller\x013x\usb.c
                                                * cleared. This helps preventing the firmware from misinterpreting this     D:\work\midicontroller\x013x\usb.c
                                                * unique event as a USB bus reset from the USB host.                        D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002358   0101     MOVLB     0x1                if(usb_device_state == ATTACHED_STATE)                                       D:\work\midicontroller\x013x\usb.c
00235a   0546     DECF      0x46,0x0,0x1                                                                                    
00235c   e108     BNZ       0x236e                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
00235e   ba6d     BTFSC     0x6d,0x5,0x0           if(!UCONbits.SE0)                                                        D:\work\midicontroller\x013x\usb.c
002360   d006     BRA       0x236e                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
002362   6a68     CLRF      0x68,0x0                   UIR = 0;                        // Clear all USB interrupts          D:\work\midicontroller\x013x\usb.c
002364   6a69     CLRF      0x69,0x0                   UIE = 0;                        // Mask all USB interrupts           D:\work\midicontroller\x013x\usb.c
002366   8069     BSF       0x69,0x0,0x0               UIEbits.URSTIE = 1;             // Unmask RESET interrupt            D:\work\midicontroller\x013x\usb.c
002368   8869     BSF       0x69,0x4,0x0               UIEbits.IDLEIE = 1;             // Unmask IDLE interrupt             D:\work\midicontroller\x013x\usb.c
00236a   0e02     MOVLW     0x2                        usb_device_state = POWERED_STATE;                                    D:\work\midicontroller\x013x\usb.c
00236c   6f46     MOVWF     0x46,0x1                                                                                        
                                                   }//end if                           // else wait until SE0 is cleared    D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               }//end if(usb_device_state == ATTACHED_STATE)                                D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00236e   0012     RETURN    0x0            }//end USBCheckBusStatus                                                         D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBModuleEnable(void)                                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine enables the USB module.                         D:\work\midicontroller\x013x\usb.c
                                            *                  An end designer should never have to call this routine       D:\work\midicontroller\x013x\usb.c
                                            *                  manually. This routine should only be called from            D:\work\midicontroller\x013x\usb.c
                                            *                  USBCheckBusStatus().                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBModuleEnable(void)                                                       D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
002370   6a6d     CLRF      0x6d,0x0           UCON = 0;                                                                    D:\work\midicontroller\x013x\usb.c
002372   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           D:\work\midicontroller\x013x\usb.c
002374   866d     BSF       0x6d,0x3,0x0       UCONbits.USBEN = 1;                     // Enable module & attach to bus     D:\work\midicontroller\x013x\usb.c
002376   0101     MOVLB     0x1                usb_device_state = ATTACHED_STATE;      // Defined in usbmmap.c & .h         D:\work\midicontroller\x013x\usb.c
002378   0e01     MOVLW     0x1                                                                                             
00237a   6f46     MOVWF     0x46,0x1                                                                                        
00237c   0012     RETURN    0x0            }//end USBModuleEnable                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBModuleDisable(void)                                  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine disables the USB module.                        D:\work\midicontroller\x013x\usb.c
                                            *                  An end designer should never have to call this routine       D:\work\midicontroller\x013x\usb.c
                                            *                  manually. This routine should only be called from            D:\work\midicontroller\x013x\usb.c
                                            *                  USBCheckBusStatus().                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            See USBCheckBusStatus() for more information.                D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBModuleDisable(void)                                                      D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
00237e   6a6d     CLRF      0x6d,0x0           UCON = 0;                               // Disable module & detach from bus  D:\work\midicontroller\x013x\usb.c
002380   6a69     CLRF      0x69,0x0           UIE = 0;                                // Mask all USB interrupts           D:\work\midicontroller\x013x\usb.c
002382   0101     MOVLB     0x1                usb_device_state = DETACHED_STATE;      // Defined in usbmmap.c & .h         D:\work\midicontroller\x013x\usb.c
002384   6b46     CLRF      0x46,0x1                                                                                        
002386   0012     RETURN    0x0            }//end USBModuleDisable                                                          D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBSoftDetach(void)                                     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    The device will have to be re-enumerated to function again.  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        USBSoftDetach electrically disconnects the device from       D:\work\midicontroller\x013x\usb.c
                                            *                  the bus. This is done by stop supplying Vusb voltage to      D:\work\midicontroller\x013x\usb.c
                                            *                  pull-up resistor. The pull-down resistors on the host        D:\work\midicontroller\x013x\usb.c
                                            *                  side will pull both differential signal lines low and        D:\work\midicontroller\x013x\usb.c
                                            *                  the host registers the event as a disconnect.                D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                  Since the USB cable is not physically disconnected, the      D:\work\midicontroller\x013x\usb.c
                                            *                  power supply through the cable can still be sensed by        D:\work\midicontroller\x013x\usb.c
                                            *                  the device. The next time USBCheckBusStatus() function       D:\work\midicontroller\x013x\usb.c
                                            *                  is called, it will reconnect the device back to the bus.     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBSoftDetach(void)                                                         D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
002388   efbf     GOTO      0x237e             USBModuleDisable();                                                          D:\work\midicontroller\x013x\usb.c
00238a   f011                                                                                                               
                                           }//end USBSoftDetach                                                             D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBDriverService(void)                                  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This routine is the heart of this firmware. It manages       D:\work\midicontroller\x013x\usb.c
                                            *                  all USB interrupts.                                          D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            Device state transitions through the following stages:       D:\work\midicontroller\x013x\usb.c
                                            *                  DETACHED -> ATTACHED -> POWERED -> DEFAULT ->                D:\work\midicontroller\x013x\usb.c
                                            *                  ADDRESS_PENDING -> ADDRESSED -> CONFIGURED -> READY          D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBDriverService(void)                                                      D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Pointless to continue servicing if USB cable is not even attached.        D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
00238c   0101     MOVLB     0x1                if(usb_device_state == DETACHED_STATE) return;                               D:\work\midicontroller\x013x\usb.c
00238e   5146     MOVF      0x46,0x0,0x1                                                                                    
002390   e101     BNZ       0x2394                                                                                          
002392   d039     BRA       0x2406                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Task A: Service USB Activity Interrupt                                    D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002394   5068     MOVF      0x68,0x0,0x0       if(UIRbits.ACTVIF && UIEbits.ACTVIE)    USBWakeFromSuspend();                D:\work\midicontroller\x013x\usb.c
002396   0b04     ANDLW     0x4                                                                                             
002398   e004     BZ        0x23a2                                                                                          
00239a   5069     MOVF      0x69,0x0,0x0                                                                                    
00239c   0b04     ANDLW     0x4                                                                                             
00239e   e001     BZ        0x23a2                                                                                          
0023a0   d838     RCALL     0x2412                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Pointless to continue servicing if the device is in suspend mode.         D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
0023a2   b26d     BTFSC     0x6d,0x1,0x0       if(UCONbits.SUSPND==1) return;                                               D:\work\midicontroller\x013x\usb.c
0023a4   d030     BRA       0x2406                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Task B: Service USB Bus Reset Interrupt.                                  D:\work\midicontroller\x013x\usb.c
                                                * When bus reset is received during suspend, ACTVIF will be set first,      D:\work\midicontroller\x013x\usb.c
                                                * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.  D:\work\midicontroller\x013x\usb.c
                                                * This is why URSTIF is checked after ACTVIF.                               D:\work\midicontroller\x013x\usb.c
                                                *                                                                           D:\work\midicontroller\x013x\usb.c
                                                * The USB reset flag is masked when the USB state is in                     D:\work\midicontroller\x013x\usb.c
                                                * DETACHED_STATE or ATTACHED_STATE, and therefore cannot                    D:\work\midicontroller\x013x\usb.c
                                                * cause a USB reset event during these two states.                          D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
0023a6   5068     MOVF      0x68,0x0,0x0       if(UIRbits.URSTIF && UIEbits.URSTIE)    USBProtocolResetHandler();           D:\work\midicontroller\x013x\usb.c
0023a8   0b01     ANDLW     0x1                                                                                             
0023aa   e004     BZ        0x23b4                                                                                          
0023ac   5069     MOVF      0x69,0x0,0x0                                                                                    
0023ae   0b01     ANDLW     0x1                                                                                             
0023b0   e001     BZ        0x23b4                                                                                          
0023b2   d84f     RCALL     0x2452                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Task C: Service other USB interrupts                                      D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
0023b4   5068     MOVF      0x68,0x0,0x0       if(UIRbits.IDLEIF && UIEbits.IDLEIE)    USBSuspend();                        D:\work\midicontroller\x013x\usb.c
0023b6   0b10     ANDLW     0x10                                                                                            
0023b8   e004     BZ        0x23c2                                                                                          
0023ba   5069     MOVF      0x69,0x0,0x0                                                                                    
0023bc   0b10     ANDLW     0x10                                                                                            
0023be   e001     BZ        0x23c2                                                                                          
0023c0   d823     RCALL     0x2408                                                                                          
0023c2   5068     MOVF      0x68,0x0,0x0       if(UIRbits.SOFIF && UIEbits.SOFIE)      USB_SOF_Handler();                   D:\work\midicontroller\x013x\usb.c
0023c4   0b40     ANDLW     0x40                                                                                            
0023c6   e004     BZ        0x23d0                                                                                          
0023c8   5069     MOVF      0x69,0x0,0x0                                                                                    
0023ca   0b40     ANDLW     0x40                                                                                            
0023cc   e001     BZ        0x23d0                                                                                          
0023ce   d837     RCALL     0x243e                                                                                          
0023d0   5068     MOVF      0x68,0x0,0x0       if(UIRbits.STALLIF && UIEbits.STALLIE)  USBStallHandler();                   D:\work\midicontroller\x013x\usb.c
0023d2   0b20     ANDLW     0x20                                                                                            
0023d4   e004     BZ        0x23de                                                                                          
0023d6   5069     MOVF      0x69,0x0,0x0                                                                                    
0023d8   0b20     ANDLW     0x20                                                                                            
0023da   e001     BZ        0x23de                                                                                          
0023dc   d832     RCALL     0x2442                                                                                          
0023de   5068     MOVF      0x68,0x0,0x0       if(UIRbits.UERRIF && UIEbits.UERRIE)    USBErrorHandler();                   D:\work\midicontroller\x013x\usb.c
0023e0   0b02     ANDLW     0x2                                                                                             
0023e2   e004     BZ        0x23ec                                                                                          
0023e4   5069     MOVF      0x69,0x0,0x0                                                                                    
0023e6   0b02     ANDLW     0x2                                                                                             
0023e8   e001     BZ        0x23ec                                                                                          
0023ea   d831     RCALL     0x244e                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Pointless to continue servicing if the host has not sent a bus reset.     D:\work\midicontroller\x013x\usb.c
                                                * Once bus reset is received, the device transitions into the DEFAULT       D:\work\midicontroller\x013x\usb.c
                                                * state and is ready for communication.                                     D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
0023ec   0e03     MOVLW     0x3                if(usb_device_state < DEFAULT_STATE) return;                                 D:\work\midicontroller\x013x\usb.c
0023ee   0101     MOVLB     0x1                                                                                             
0023f0   5d46     SUBWF     0x46,0x0,0x1                                                                                    
0023f2   e201     BC        0x23f6                                                                                          
0023f4   d008     BRA       0x2406                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Task D: Servicing USB Transaction Complete Interrupt                      D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
0023f6   5068     MOVF      0x68,0x0,0x0       if(UIRbits.TRNIF && UIEbits.TRNIE)                                           D:\work\midicontroller\x013x\usb.c
0023f8   0b08     ANDLW     0x8                                                                                             
0023fa   e005     BZ        0x2406                                                                                          
0023fc   5069     MOVF      0x69,0x0,0x0                                                                                    
0023fe   0b08     ANDLW     0x8                                                                                             
002400   e002     BZ        0x2406                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /*                                                                       D:\work\midicontroller\x013x\usb.c
                                                    * USBCtrlEPService only services transactions over EP0.                 D:\work\midicontroller\x013x\usb.c
                                                    * It ignores all other EP transactions.                                 D:\work\midicontroller\x013x\usb.c
                                                    */                                                                      D:\work\midicontroller\x013x\usb.c
002402   de34     RCALL     0x206c                 USBCtrlEPService();                                                      D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /*                                                                       D:\work\midicontroller\x013x\usb.c
                                                    * Other EP can be serviced later by responsible device class firmware.  D:\work\midicontroller\x013x\usb.c
                                                    * Each device driver knows when an OUT or IN transaction is ready by    D:\work\midicontroller\x013x\usb.c
                                                    * checking the buffer ownership bit.                                    D:\work\midicontroller\x013x\usb.c
                                                    * An OUT EP should always be owned by SIE until the data is ready.      D:\work\midicontroller\x013x\usb.c
                                                    * An IN EP should always be owned by CPU until the data is ready.       D:\work\midicontroller\x013x\usb.c
                                                    *                                                                       D:\work\midicontroller\x013x\usb.c
                                                    * Because of this logic, it is not necessary to save the USTAT value    D:\work\midicontroller\x013x\usb.c
                                                    * of non-EP0 transactions.                                              D:\work\midicontroller\x013x\usb.c
                                                    */                                                                      D:\work\midicontroller\x013x\usb.c
002404   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       D:\work\midicontroller\x013x\usb.c
                                               }//end if(UIRbits.TRNIF && UIEbits.TRNIE)                                    D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002406   0012     RETURN    0x0            }//end USBDriverService                                                          D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBSuspend(void)                                        D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:                                                                     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBSuspend(void)                                                            D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * NOTE: Do not clear UIRbits.ACTVIF here!                                   D:\work\midicontroller\x013x\usb.c
                                                * Reason:                                                                   D:\work\midicontroller\x013x\usb.c
                                                * ACTVIF is only generated once an IDLEIF has been generated.               D:\work\midicontroller\x013x\usb.c
                                                * This is a 1:1 ratio interrupt generation.                                 D:\work\midicontroller\x013x\usb.c
                                                * For every IDLEIF, there will be only one ACTVIF regardless of             D:\work\midicontroller\x013x\usb.c
                                                * the number of subsequent bus transitions.                                 D:\work\midicontroller\x013x\usb.c
                                                *                                                                           D:\work\midicontroller\x013x\usb.c
                                                * If the ACTIF is cleared here, a problem could occur when:                 D:\work\midicontroller\x013x\usb.c
                                                * [       IDLE       ][bus activity ->                                      D:\work\midicontroller\x013x\usb.c
                                                * <--- 3 ms ----->     ^                                                    D:\work\midicontroller\x013x\usb.c
                                                *                ^     ACTVIF=1                                             D:\work\midicontroller\x013x\usb.c
                                                *                IDLEIF=1                                                   D:\work\midicontroller\x013x\usb.c
                                                *  #           #           #           #   (#=Program polling flags)        D:\work\midicontroller\x013x\usb.c
                                                *                          ^                                                D:\work\midicontroller\x013x\usb.c
                                                *                          This polling loop will see both                  D:\work\midicontroller\x013x\usb.c
                                                *                          IDLEIF=1 and ACTVIF=1.                           D:\work\midicontroller\x013x\usb.c
                                                *                          However, the program services IDLEIF first       D:\work\midicontroller\x013x\usb.c
                                                *                          because ACTIVIE=0.                               D:\work\midicontroller\x013x\usb.c
                                                *                          If this routine clears the only ACTIVIF,         D:\work\midicontroller\x013x\usb.c
                                                *                          then it can never get out of the suspend         D:\work\midicontroller\x013x\usb.c
                                                *                          mode.                                            D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002408   8469     BSF       0x69,0x2,0x0       UIEbits.ACTVIE = 1;                     // Enable bus activity interrupt     D:\work\midicontroller\x013x\usb.c
00240a   9868     BCF       0x68,0x4,0x0       UIRbits.IDLEIF = 0;                                                          D:\work\midicontroller\x013x\usb.c
00240c   826d     BSF       0x6d,0x1,0x0       UCONbits.SUSPND = 1;                    // Put USB module in power conserve  D:\work\midicontroller\x013x\usb.c
                                                                                       // mode, SIE clock inactive          D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * At this point the PIC can go into sleep,idle, or                          D:\work\midicontroller\x013x\usb.c
                                                * switch to a slower clock, etc.                                            D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               /* Modifiable Section */                                                     D:\work\midicontroller\x013x\usb.c
00240e   9aa1     BCF       0xa1,0x5,0x0       PIR2bits.USBIF = 0;                                                          D:\work\midicontroller\x013x\usb.c
                                           /*                                                                               D:\work\midicontroller\x013x\usb.c
                                           //2/15/05 JD This was causing problems with USBIE being enabled..                D:\work\midicontroller\x013x\usb.c
                                               INTCONbits.RBIF = 0;                                                         D:\work\midicontroller\x013x\usb.c
                                               PIE2bits.USBIE = 1;                     // Set USB wakeup source             D:\work\midicontroller\x013x\usb.c
                                               INTCONbits.RBIE = 1;                    // Set sw2,3 wakeup source           D:\work\midicontroller\x013x\usb.c
                                               Sleep();                                // Goto sleep                        D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                               if(INTCONbits.RBIF == 1)                // Check if external stimulus        D:\work\midicontroller\x013x\usb.c
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
                                                   USBRemoteWakeup();                  // If yes, attempt RWU               D:\work\midicontroller\x013x\usb.c
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
                                               PIE2bits.USBIE = 0;                                                          D:\work\midicontroller\x013x\usb.c
                                               INTCONbits.RBIE = 0;                                                         D:\work\midicontroller\x013x\usb.c
                                           */                                                                               D:\work\midicontroller\x013x\usb.c
                                               /* End Modifiable Section */                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002410   0012     RETURN    0x0            }//end USBSuspend                                                                D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBWakeFromSuspend(void)                                D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:                                                                     D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBWakeFromSuspend(void)                                                    D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * If using clock switching, this is the place to restore the                D:\work\midicontroller\x013x\usb.c
                                                * original clock frequency.                                                 D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002412   926d     BCF       0x6d,0x1,0x0       UCONbits.SUSPND = 0;                                                         D:\work\midicontroller\x013x\usb.c
002414   9469     BCF       0x69,0x2,0x0       UIEbits.ACTVIE = 0;                                                          D:\work\midicontroller\x013x\usb.c
002416   9468     BCF       0x68,0x2,0x0       UIRbits.ACTVIF = 0;                                                          D:\work\midicontroller\x013x\usb.c
002418   0012     RETURN    0x0            }//end USBWakeFromSuspend                                                        D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBRemoteWakeup(void)                                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        This function should be called by user when the device       D:\work\midicontroller\x013x\usb.c
                                            *                  is waken up by an external stimulus other than ACTIVIF.      D:\work\midicontroller\x013x\usb.c
                                            *                  Please read the note below to understand the limitations.    D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            The modifiable section in this routine should be changed     D:\work\midicontroller\x013x\usb.c
                                            *                  to meet the application needs. Current implementation        D:\work\midicontroller\x013x\usb.c
                                            *                  temporary blocks other functions from executing for a        D:\work\midicontroller\x013x\usb.c
                                            *                  period of 1-13 ms depending on the core frequency.           D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                  According to USB 2.0 specification section 7.1.7.7,          D:\work\midicontroller\x013x\usb.c
                                            *                  "The remote wakeup device must hold the resume signaling     D:\work\midicontroller\x013x\usb.c
                                            *                  for at lest 1 ms but for no more than 15 ms."                D:\work\midicontroller\x013x\usb.c
                                            *                  The idea here is to use a delay counter loop, using a        D:\work\midicontroller\x013x\usb.c
                                            *                  common value that would work over a wide range of core       D:\work\midicontroller\x013x\usb.c
                                            *                  frequencies.                                                 D:\work\midicontroller\x013x\usb.c
                                            *                  That value selected is 1800. See table below:                D:\work\midicontroller\x013x\usb.c
                                            *                  ==========================================================   D:\work\midicontroller\x013x\usb.c
                                            *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)    D:\work\midicontroller\x013x\usb.c
                                            *                  ==========================================================   D:\work\midicontroller\x013x\usb.c
                                            *                      48              12          1.05                         D:\work\midicontroller\x013x\usb.c
                                            *                       4              1           12.6                         D:\work\midicontroller\x013x\usb.c
                                            *                  ==========================================================   D:\work\midicontroller\x013x\usb.c
                                            *                  * These timing could be incorrect when using code            D:\work\midicontroller\x013x\usb.c
                                            *                    optimization or extended instruction mode,                 D:\work\midicontroller\x013x\usb.c
                                            *                    or when having other interrupts enabled.                   D:\work\midicontroller\x013x\usb.c
                                            *                    Make sure to verify using the MPLAB SIM's Stopwatch        D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBRemoteWakeup(void)                                                       D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               static word delay_count;                                                     D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00241a   0101     MOVLB     0x1                if(usb_stat.RemoteWakeup == 1)          // Check if RemoteWakeup function    D:\work\midicontroller\x013x\usb.c
00241c   a147     BTFSS     0x47,0x0,0x1                                                                                    
00241e   d00e     BRA       0x243c                                                                                          
                                               {                                       // has been enabled by the host.     D:\work\midicontroller\x013x\usb.c
002420   dff8     RCALL     0x2412                 USBWakeFromSuspend();               // Unsuspend USB modue               D:\work\midicontroller\x013x\usb.c
002422   846d     BSF       0x6d,0x2,0x0           UCONbits.RESUME = 1;                // Start RESUME signaling            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /* Modifiable Section */                                                 D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002424   0101     MOVLB     0x1                    delay_count = 1800U;                // Set RESUME line for 1-13 ms       D:\work\midicontroller\x013x\usb.c
002426   0e08     MOVLW     0x8                                                                                             
002428   6f52     MOVWF     0x52,0x1                                                                                        
00242a   0e07     MOVLW     0x7                                                                                             
00242c   6f53     MOVWF     0x53,0x1                                                                                        
                                                   do                                                                       D:\work\midicontroller\x013x\usb.c
                                                   {                                                                        D:\work\midicontroller\x013x\usb.c
00242e   0752     DECF      0x52,0x1,0x1               delay_count--;                                                       D:\work\midicontroller\x013x\usb.c
002430   0e00     MOVLW     0x0                                                                                             
002432   5b53     SUBWFB    0x53,0x1,0x1                                                                                    
002434   5152     MOVF      0x52,0x0,0x1           }while(delay_count);                                                     D:\work\midicontroller\x013x\usb.c
002436   1153     IORWF     0x53,0x0,0x1                                                                                    
002438   e1fa     BNZ       0x242e                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                   /* End Modifiable Section */                                             D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00243a   946d     BCF       0x6d,0x2,0x0           UCONbits.RESUME = 0;                                                     D:\work\midicontroller\x013x\usb.c
                                               }//endif                                                                     D:\work\midicontroller\x013x\usb.c
00243c   0012     RETURN    0x0            }//end USBRemoteWakeup                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USB_SOF_Handler(void)                                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        The USB host sends out a SOF packet to full-speed devices    D:\work\midicontroller\x013x\usb.c
                                            *                  every 1 ms. This interrupt may be useful for isochronous     D:\work\midicontroller\x013x\usb.c
                                            *                  pipes. End designers should implement callback routine       D:\work\midicontroller\x013x\usb.c
                                            *                  as necessary.                                                D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USB_SOF_Handler(void)                                                       D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               /* Callback routine here */                                                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00243e   9c68     BCF       0x68,0x6,0x0       UIRbits.SOFIF = 0;                                                           D:\work\midicontroller\x013x\usb.c
002440   0012     RETURN    0x0            }//end USB_SOF_Handler                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBStallHandler(void)                                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    A STALL packet is sent to the host by the SIE.               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        The STALLIF is set anytime the SIE sends out a STALL         D:\work\midicontroller\x013x\usb.c
                                            *                  packet regardless of which endpoint causes it.               D:\work\midicontroller\x013x\usb.c
                                            *                  A Setup transaction overrides the STALL function. A stalled  D:\work\midicontroller\x013x\usb.c
                                            *                  endpoint stops stalling once it receives a setup packet.     D:\work\midicontroller\x013x\usb.c
                                            *                  In this case, the SIE will accepts the Setup packet and      D:\work\midicontroller\x013x\usb.c
                                            *                  set the TRNIF flag to notify the firmware. STALL function    D:\work\midicontroller\x013x\usb.c
                                            *                  for that particular endpoint pipe will be automatically      D:\work\midicontroller\x013x\usb.c
                                            *                  disabled (direction specific).                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            *                  There are a few reasons for an endpoint to be stalled.       D:\work\midicontroller\x013x\usb.c
                                            *                  1. When a non-supported USB request is received.             D:\work\midicontroller\x013x\usb.c
                                            *                     Example: GET_DESCRIPTOR(DEVICE_QUALIFIER)                 D:\work\midicontroller\x013x\usb.c
                                            *                  2. When an endpoint is currently halted.                     D:\work\midicontroller\x013x\usb.c
                                            *                  3. When the device class specifies that an endpoint must     D:\work\midicontroller\x013x\usb.c
                                            *                     stall in response to a specific event.                    D:\work\midicontroller\x013x\usb.c
                                            *                     Example: Mass Storage Device Class                        D:\work\midicontroller\x013x\usb.c
                                            *                              If the CBW is not valid, the device shall        D:\work\midicontroller\x013x\usb.c
                                            *                              STALL the Bulk-In pipe.                          D:\work\midicontroller\x013x\usb.c
                                            *                              See USB Mass Storage Class Bulk-only Transport   D:\work\midicontroller\x013x\usb.c
                                            *                              Specification for more details.                  D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            UEPn.EPSTALL can be scanned to see which endpoint causes     D:\work\midicontroller\x013x\usb.c
                                            *                  the stall event.                                             D:\work\midicontroller\x013x\usb.c
                                            *                  If                                                           D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBStallHandler(void)                                                       D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
                                               /*                                                                           D:\work\midicontroller\x013x\usb.c
                                                * Does not really have to do anything here,                                 D:\work\midicontroller\x013x\usb.c
                                                * even for the control endpoint.                                            D:\work\midicontroller\x013x\usb.c
                                                * All BDs of Endpoint 0 are owned by SIE right now,                         D:\work\midicontroller\x013x\usb.c
                                                * but once a Setup Transaction is received, the ownership                   D:\work\midicontroller\x013x\usb.c
                                                * for EP0_OUT will be returned to CPU.                                      D:\work\midicontroller\x013x\usb.c
                                                * When the Setup Transaction is serviced, the ownership                     D:\work\midicontroller\x013x\usb.c
                                                * for EP0_IN will then be forced back to CPU by firmware.                   D:\work\midicontroller\x013x\usb.c
                                                */                                                                          D:\work\midicontroller\x013x\usb.c
002442   a070     BTFSS     0x70,0x0,0x0       if(UEP0bits.EPSTALL == 1)                                                    D:\work\midicontroller\x013x\usb.c
002444   d002     BRA       0x244a                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
002446   df76     RCALL     0x2334                 USBPrepareForNextSetupTrf();        // Firmware work-around              D:\work\midicontroller\x013x\usb.c
002448   9070     BCF       0x70,0x0,0x0           UEP0bits.EPSTALL = 0;                                                    D:\work\midicontroller\x013x\usb.c
                                               }                                                                            D:\work\midicontroller\x013x\usb.c
00244a   9a68     BCF       0x68,0x5,0x0       UIRbits.STALLIF = 0;                                                         D:\work\midicontroller\x013x\usb.c
00244c   0012     RETURN    0x0            }//end USBStallHandler                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBErrorHandler(void)                                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        The purpose of this interrupt is mainly for debugging        D:\work\midicontroller\x013x\usb.c
                                            *                  during development. Check UEIR to see which error causes     D:\work\midicontroller\x013x\usb.c
                                            *                  the interrupt.                                               D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBErrorHandler(void)                                                       D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
00244e   9268     BCF       0x68,0x1,0x0       UIRbits.UERRIF = 0;                                                          D:\work\midicontroller\x013x\usb.c
002450   0012     RETURN    0x0            }//end USBErrorHandler                                                           D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\usb.c
                                            * Function:        void USBProtocolResetHandler(void)                           D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * PreCondition:    A USB bus reset is received from the host.                   D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Side Effects:    Currently, this routine flushes any pending USB              D:\work\midicontroller\x013x\usb.c
                                            *                  transactions. It empties out the USTAT FIFO. This action     D:\work\midicontroller\x013x\usb.c
                                            *                  might not be desirable in some applications.                 D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Overview:        Once a USB bus reset is received from the host, this         D:\work\midicontroller\x013x\usb.c
                                            *                  routine should be called. It resets the device address to    D:\work\midicontroller\x013x\usb.c
                                            *                  zero, disables all non-EP0 endpoints, initializes EP0 to     D:\work\midicontroller\x013x\usb.c
                                            *                  be ready for default communication, clears all USB           D:\work\midicontroller\x013x\usb.c
                                            *                  interrupt flags, unmasks applicable USB interrupts, and      D:\work\midicontroller\x013x\usb.c
                                            *                  reinitializes internal state-machine variables.              D:\work\midicontroller\x013x\usb.c
                                            *                                                                               D:\work\midicontroller\x013x\usb.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\usb.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\usb.c
                                           void USBProtocolResetHandler(void)                                               D:\work\midicontroller\x013x\usb.c
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
002452   6a6a     CLRF      0x6a,0x0           UEIR = 0;                       // Clear all USB error flags                 D:\work\midicontroller\x013x\usb.c
002454   6a68     CLRF      0x68,0x0           UIR = 0;                        // Clears all USB interrupts                 D:\work\midicontroller\x013x\usb.c
002456   0e9f     MOVLW     0x9f               UEIE = 0b10011111;              // Unmask all USB error interrupts           D:\work\midicontroller\x013x\usb.c
002458   6e6b     MOVWF     0x6b,0x0                                                                                        
00245a   0e7b     MOVLW     0x7b               UIE = 0b01111011;               // Enable all interrupts except ACTVIE       D:\work\midicontroller\x013x\usb.c
00245c   6e69     MOVWF     0x69,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
00245e   6a6e     CLRF      0x6e,0x0           UADDR = 0x00;                   // Reset to default address                  D:\work\midicontroller\x013x\usb.c
002460   0e0f     MOVLW     0xf                mDisableEP1to15();              // Reset all non-EP0 UEPn registers          D:\work\midicontroller\x013x\usb.c
002462   6ee6     MOVWF     0xe6,0x0                                                                                        
002464   0e71     MOVLW     0x71                                                                                            
002466   6ee6     MOVWF     0xe6,0x0                                                                                        
002468   0e0f     MOVLW     0xf                                                                                             
00246a   6ee6     MOVWF     0xe6,0x0                                                                                        
00246c   d811     RCALL     0x2490                                                                                          
00246e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002470   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002472   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002474   0e16     MOVLW     0x16               UEP0 = EP_CTRL|HSHK_EN;         // Init EP0 as a Ctrl EP, see usbdrv.h       D:\work\midicontroller\x013x\usb.c
002476   6e70     MOVWF     0x70,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002478   a668     BTFSS     0x68,0x3,0x0       while(UIRbits.TRNIF == 1)       // Flush any pending transactions            D:\work\midicontroller\x013x\usb.c
00247a   d002     BRA       0x2480                                                                                          
00247e   d7fc     BRA       0x2478                                                                                          
00247c   9668     BCF       0x68,0x3,0x0           UIRbits.TRNIF = 0;                                                       D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002480   986d     BCF       0x6d,0x4,0x0       UCONbits.PKTDIS = 0;            // Make sure packet processing is enabled    D:\work\midicontroller\x013x\usb.c
002482   df58     RCALL     0x2334             USBPrepareForNextSetupTrf();    // Declared in usbctrltrf.c                  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
002484   0101     MOVLB     0x1                usb_stat.RemoteWakeup = 0;      // Default status flag to disable            D:\work\midicontroller\x013x\usb.c
002486   9147     BCF       0x47,0x0,0x1                                                                                    
002488   6b48     CLRF      0x48,0x1           usb_active_cfg = 0;             // Clear active configuration                D:\work\midicontroller\x013x\usb.c
00248a   0e03     MOVLW     0x3                usb_device_state = DEFAULT_STATE;                                            D:\work\midicontroller\x013x\usb.c
00248c   6f46     MOVWF     0x46,0x1                                                                                        
00248e   0012     RETURN    0x0            }//end USBProtocolResetHandler                                                   D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /* Auxiliary Function */                                                         D:\work\midicontroller\x013x\usb.c
002490   cfd9     MOVFF     0xfd9,0xfe6    void ClearArray(byte* startAdr,byte count)                                       D:\work\midicontroller\x013x\usb.c
002492   ffe6                                                                                                               
002494   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002496   ffd9                                                                                                               
                                           {                                                                                D:\work\midicontroller\x013x\usb.c
002498   0efd     MOVLW     0xfd               *startAdr;                                                                   D:\work\midicontroller\x013x\usb.c
00249a   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
00249c   ffe9                                                                                                               
00249e   0efe     MOVLW     0xfe                                                                                            
0024a0   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0024a2   ffea                                                                                                               
0024a4   0efc     MOVLW     0xfc               while(count)                                                                 D:\work\midicontroller\x013x\usb.c
0024a6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0024a8   e004     BZ        0x24b2                                                                                          
0024b0   d7f9     BRA       0x24a4                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usb.c
                                                   _asm                                                                     D:\work\midicontroller\x013x\usb.c
0024aa   6aee     CLRF      0xee,0x0               clrf POSTINC0,0                                                          D:\work\midicontroller\x013x\usb.c
                                                   _endasm                                                                  D:\work\midicontroller\x013x\usb.c
0024ac   0efc     MOVLW     0xfc                   count--;                                                                 D:\work\midicontroller\x013x\usb.c
0024ae   06db     DECF      0xdb,0x1,0x0                                                                                    
                                               }//end while                                                                 D:\work\midicontroller\x013x\usb.c
0024b2   52e5     MOVF      0xe5,0x1,0x0   }//end ClearArray                                                                D:\work\midicontroller\x013x\usb.c
0024b4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024b6   ffd9                                                                                                               
0024b8   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                           /** EOF usbdrv.c *************************************************************/  D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usb.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           /** I N C L U D E S **********************************************************/  D:\work\midicontroller\x013x\usbapplet.c
                                           #include "p18f4455.h"                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           void PROCESS_COMM_REQUEST(void);                                                 D:\work\midicontroller\x013x\usbapplet.c
                                           //void RemCapCalculation(void);                                                  D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           void HIDSetReportHandler(void) {                                                 D:\work\midicontroller\x013x\usbapplet.c
002ee2   0100     MOVLB     0x0            	USBQuery = true;                                                                D:\work\midicontroller\x013x\usbapplet.c
002ee4   89b8     BSF       0xb8,0x4,0x1                                                                                    
002ee6   ec72     CALL      0x28e4,0x0     	PROCESS_COMM_REQUEST();                                                         D:\work\midicontroller\x013x\usbapplet.c
002ee8   f014                                                                                                               
002eea   0100     MOVLB     0x0            	USBQuery = false;	                                                              D:\work\midicontroller\x013x\usbapplet.c
002eec   99b8     BCF       0xb8,0x4,0x1                                                                                    
002eee   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\usbapplet.c
                                           //-----------------------------------------------------------------------        D:\work\midicontroller\x013x\usbapplet.c
                                           void HIDGetReportHandler(void) {                                                 D:\work\midicontroller\x013x\usbapplet.c
                                           //load up CtrlTrfData with data.                                                 D:\work\midicontroller\x013x\usbapplet.c
002ef0   0100     MOVLB     0x0            	USBQuery = true;                                                                D:\work\midicontroller\x013x\usbapplet.c
002ef2   89b8     BSF       0xb8,0x4,0x1                                                                                    
002ef4   ec72     CALL      0x28e4,0x0     	PROCESS_COMM_REQUEST();                                                         D:\work\midicontroller\x013x\usbapplet.c
002ef6   f014                                                                                                               
002ef8   0101     MOVLB     0x1            	ctrl_trf_session_owner = MUID_HID;                                              D:\work\midicontroller\x013x\usbapplet.c
002efa   0e02     MOVLW     0x2                                                                                             
002efc   6f4b     MOVWF     0x4b,0x1                                                                                        
002efe   0101     MOVLB     0x1            	pSrc.bRam = (byte*)&CtrlTrfData;                                                D:\work\midicontroller\x013x\usbapplet.c
002f00   0e50     MOVLW     0x50                                                                                            
002f02   6f4c     MOVWF     0x4c,0x1                                                                                        
002f04   0e04     MOVLW     0x4                                                                                             
002f06   6f4d     MOVWF     0x4d,0x1                                                                                        
002f08   0101     MOVLB     0x1            	usb_stat.ctrl_trf_mem = _RAM;       // Set memory type                          D:\work\midicontroller\x013x\usbapplet.c
002f0a   9347     BCF       0x47,0x1,0x1                                                                                    
002f0c   0100     MOVLB     0x0            	USBQuery = false;                                                               D:\work\midicontroller\x013x\usbapplet.c
002f0e   99b8     BCF       0xb8,0x4,0x1                                                                                    
002f10   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           typedef union DATA_PACKET                                                        D:\work\midicontroller\x013x\usbapplet.c
                                           {                                                                                D:\work\midicontroller\x013x\usbapplet.c
                                               byte _byte[HID_INT_OUT_EP_SIZE];  //For byte access                          D:\work\midicontroller\x013x\usbapplet.c
                                               word _word[HID_INT_OUT_EP_SIZE/2];//For word access(USBGEN_EP_SIZE msut be even) D:\work\midicontroller\x013x\usbapplet.c
                                               struct                                                                       D:\work\midicontroller\x013x\usbapplet.c
                                               {                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                   enum                                                                     D:\work\midicontroller\x013x\usbapplet.c
                                                   {                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                                       READ_VERSION    = 0x00,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       /*                                                                   D:\work\midicontroller\x013x\usbapplet.c
                                                       READ_FLASH      = 0x01,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       WRITE_FLASH     = 0x02,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       ERASE_FLASH     = 0x03,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       READ_EEDATA     = 0x04,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       WRITE_EEDATA    = 0x05,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       READ_CONFIG     = 0x06,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       WRITE_CONFIG    = 0x07,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       */                                                                   D:\work\midicontroller\x013x\usbapplet.c
                                                       ID_BOARD        = 0x31,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       UPDATE_LED      = 0x32,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       SET_TEMP_REAL   = 0x33,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       RD_TEMP         = 0x34,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       SET_TEMP_LOGGING= 0x35,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       RD_TEMP_LOGGING = 0x36,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       RD_POT          = 0x37,                                              D:\work\midicontroller\x013x\usbapplet.c
                                                       RESET           = 0xFF                                               D:\work\midicontroller\x013x\usbapplet.c
                                                   }CMD;                                                                    D:\work\midicontroller\x013x\usbapplet.c
                                                   byte len;                                                                D:\work\midicontroller\x013x\usbapplet.c
                                               };                                                                           D:\work\midicontroller\x013x\usbapplet.c
                                               struct                                                                       D:\work\midicontroller\x013x\usbapplet.c
                                               {                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                   unsigned :8;                                                             D:\work\midicontroller\x013x\usbapplet.c
                                                   byte ID;                                                                 D:\work\midicontroller\x013x\usbapplet.c
                                               };                                                                           D:\work\midicontroller\x013x\usbapplet.c
                                               struct                                                                       D:\work\midicontroller\x013x\usbapplet.c
                                               {                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                   unsigned :8;                                                             D:\work\midicontroller\x013x\usbapplet.c
                                                   byte led_num;                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                   byte led_status;                                                         D:\work\midicontroller\x013x\usbapplet.c
                                               };                                                                           D:\work\midicontroller\x013x\usbapplet.c
                                               struct                                                                       D:\work\midicontroller\x013x\usbapplet.c
                                               {                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                   unsigned :8;                                                             D:\work\midicontroller\x013x\usbapplet.c
                                                   word word_data;                                                          D:\work\midicontroller\x013x\usbapplet.c
                                               };                                                                           D:\work\midicontroller\x013x\usbapplet.c
                                           } DATA_PACKET;                                                                   D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           DATA_PACKET dataPacket;                                                          D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
002f12   cfd9     MOVFF     0xfd9,0xfe6    void ServiceRequests(void)                                                       D:\work\midicontroller\x013x\usbapplet.c
002f14   ffe6                                                                                                               
002f16   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002f18   ffd9                                                                                                               
002f1a   0e02     MOVLW     0x2                                                                                             
002f1c   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           {    byte index, counter;                                                        D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
002f1e   0e08     MOVLW     0x8                if(HIDRxReport((byte*)&dataPacket,sizeof(dataPacket)))                       D:\work\midicontroller\x013x\usbapplet.c
002f20   6ee6     MOVWF     0xe6,0x0                                                                                        
002f22   0e57     MOVLW     0x57                                                                                            
002f24   6ee6     MOVWF     0xe6,0x0                                                                                        
002f26   0e01     MOVLW     0x1                                                                                             
002f28   6ee6     MOVWF     0xe6,0x0                                                                                        
002f2a   ec6d     CALL      0x32da,0x0                                                                                      
002f2c   f019                                                                                                               
002f2e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f30   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f32   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f34   0900     IORLW     0x0                                                                                             
002f36   e028     BZ        0x2f88                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\usbapplet.c
002f38   0e01     MOVLW     0x1                    counter = 0;                                                             D:\work\midicontroller\x013x\usbapplet.c
002f3a   6adb     CLRF      0xdb,0x0                                                                                        
002f3c   0101     MOVLB     0x1                    switch(dataPacket.CMD)                                                   D:\work\midicontroller\x013x\usbapplet.c
002f3e   5157     MOVF      0x57,0x0,0x1                                                                                    
002f40   e008     BZ        0x2f52                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                                       case READ_VERSION:                                                   D:\work\midicontroller\x013x\usbapplet.c
                                                           //dataPacket._byte[1] is len                                     D:\work\midicontroller\x013x\usbapplet.c
002f52   0e01     MOVLW     0x1                            dataPacket._byte[2] = 0x01;                                      D:\work\midicontroller\x013x\usbapplet.c
002f54   6f59     MOVWF     0x59,0x1                                                                                        
002f56   0e02     MOVLW     0x2                            dataPacket._byte[3] = 0x02;                                      D:\work\midicontroller\x013x\usbapplet.c
002f58   6f5a     MOVWF     0x5a,0x1                                                                                        
002f5a   52de     MOVF      0xde,0x1,0x0                   counter=0x04;                                                    D:\work\midicontroller\x013x\usbapplet.c
002f5c   0e04     MOVLW     0x4                                                                                             
002f5e   6edd     MOVWF     0xdd,0x0                                                                                        
002f60   d001     BRA       0x2f64                         break;                                                           D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                       default:                                                             D:\work\midicontroller\x013x\usbapplet.c
                                                           //dataPacket._byte[1] is len                                     D:\work\midicontroller\x013x\usbapplet.c
002f42   0e01     MOVLW     0x1                            dataPacket._byte[2] = 0x01;                                      D:\work\midicontroller\x013x\usbapplet.c
002f44   6f59     MOVWF     0x59,0x1                                                                                        
002f46   0e02     MOVLW     0x2                            dataPacket._byte[3] = 0x02;                                      D:\work\midicontroller\x013x\usbapplet.c
002f48   6f5a     MOVWF     0x5a,0x1                                                                                        
002f4a   52de     MOVF      0xde,0x1,0x0                   counter=64;                                                      D:\work\midicontroller\x013x\usbapplet.c
002f4c   0e40     MOVLW     0x40                                                                                            
002f4e   6edd     MOVWF     0xdd,0x0                                                                                        
002f50   d009     BRA       0x2f64                         break;                                                           D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
002f62   d000     BRA       0x2f64                         break;                                                           D:\work\midicontroller\x013x\usbapplet.c
                                                   }//end switch()                                                          D:\work\midicontroller\x013x\usbapplet.c
002f64   0e01     MOVLW     0x1                    if(counter != 0)                                                         D:\work\midicontroller\x013x\usbapplet.c
002f66   50db     MOVF      0xdb,0x0,0x0                                                                                    
002f68   e00f     BZ        0x2f88                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\usbapplet.c
002f6a   0104     MOVLB     0x4                        if(!mHIDTxIsBusy())                                                  D:\work\midicontroller\x013x\usbapplet.c
002f6c   bf0c     BTFSC     0xc,0x7,0x1                                                                                     
002f6e   d00c     BRA       0x2f88                                                                                          
002f70   0e01     MOVLW     0x1                            HIDTxReport((byte*)&dataPacket,counter);                         D:\work\midicontroller\x013x\usbapplet.c
002f72   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
002f74   ffe6                                                                                                               
002f76   0e57     MOVLW     0x57                                                                                            
002f78   6ee6     MOVWF     0xe6,0x0                                                                                        
002f7a   0e01     MOVLW     0x1                                                                                             
002f7c   6ee6     MOVWF     0xe6,0x0                                                                                        
002f7e   ec33     CALL      0x3266,0x0                                                                                      
002f80   f019                                                                                                               
002f82   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                   }//end if                                                                D:\work\midicontroller\x013x\usbapplet.c
                                               }//end if                                                                    D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
002f88   0e02     MOVLW     0x2            }//end ServiceRequests                                                           D:\work\midicontroller\x013x\usbapplet.c
002f8a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002f8c   e202     BC        0x2f92                                                                                          
002f8e   6ae1     CLRF      0xe1,0x0                                                                                        
002f90   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f92   6ee1     MOVWF     0xe1,0x0                                                                                        
002f94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002f96   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002f98   ffd9                                                                                                               
002f9a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           #define	WRITE_NVR		3                                                             D:\work\midicontroller\x013x\usbapplet.c
                                           #define	READ_NVR		4                                                              D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           unsigned char PresentCmd;                                                        D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           //This handles data over report ID 44                                            D:\work\midicontroller\x013x\usbapplet.c
                                           //Device to host must always follow a host to device                             D:\work\midicontroller\x013x\usbapplet.c
002f9c   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ProcessGenericTransferRead(void) {                                 D:\work\midicontroller\x013x\usbapplet.c
002f9e   ffe6                                                                                                               
002fa0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002fa2   ffd9                                                                                                               
002fa4   0e02     MOVLW     0x2                                                                                             
002fa6   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char index, cmdrecognized;                                             D:\work\midicontroller\x013x\usbapplet.c
                                           	                                                                                D:\work\midicontroller\x013x\usbapplet.c
002fa8   52de     MOVF      0xde,0x1,0x0   	cmdrecognized = true;                                                           D:\work\midicontroller\x013x\usbapplet.c
002faa   0e01     MOVLW     0x1                                                                                             
002fac   6edd     MOVWF     0xdd,0x0                                                                                        
                                           	                                                                                D:\work\midicontroller\x013x\usbapplet.c
002fae   0101     MOVLB     0x1            	switch (PresentCmd) {                                                           D:\work\midicontroller\x013x\usbapplet.c
002fb0   515f     MOVF      0x5f,0x0,0x1                                                                                    
002fb2   0a04     XORLW     0x4                                                                                             
002fb4   e003     BZ        0x2fbc                                                                                          
                                           //		case	W64_1:                                                                  D:\work\midicontroller\x013x\usbapplet.c
                                           //			for (index=0;index<64;index++) {                                            D:\work\midicontroller\x013x\usbapplet.c
                                           //				TXENQ(2);                                                                  D:\work\midicontroller\x013x\usbapplet.c
                                           //			}                                                                           D:\work\midicontroller\x013x\usbapplet.c
                                           //			break;                                                                      D:\work\midicontroller\x013x\usbapplet.c
                                           		case	READ_NVR:		//use address set previously to send out new data              D:\work\midicontroller\x013x\usbapplet.c
002fbc   0e05     MOVLW     0x5            			TXENQ(5);                                                                     D:\work\midicontroller\x013x\usbapplet.c
002fbe   6ee6     MOVWF     0xe6,0x0                                                                                        
002fc0   ecde     CALL      0x2bbc,0x0                                                                                      
002fc2   f015                                                                                                               
002fc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002fc6   0e06     MOVLW     0x6            			TXENQ(6);                                                                     D:\work\midicontroller\x013x\usbapplet.c
002fc8   6ee6     MOVWF     0xe6,0x0                                                                                        
002fca   ecde     CALL      0x2bbc,0x0                                                                                      
002fcc   f015                                                                                                               
002fce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002fd0   6adf     CLRF      0xdf,0x0       			for (index=0;index<62;index++) {                                              D:\work\midicontroller\x013x\usbapplet.c
002fd2   0e3e     MOVLW     0x3e                                                                                            
002fd4   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
002fd6   e206     BC        0x2fe4                                                                                          
002fe0   2adf     INCF      0xdf,0x1,0x0                                                                                    
002fe2   d7f7     BRA       0x2fd2                                                                                          
002fd8   6ae6     CLRF      0xe6,0x0       				TXENQ(0);                                                                    D:\work\midicontroller\x013x\usbapplet.c
002fda   ecde     CALL      0x2bbc,0x0                                                                                      
002fdc   f015                                                                                                               
002fde   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\usbapplet.c
002fe4   d000     BRA       0x2fe6         			break;                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                           		default:                                                                       D:\work\midicontroller\x013x\usbapplet.c
002fb6   0e01     MOVLW     0x1            			cmdrecognized = false;                                                        D:\work\midicontroller\x013x\usbapplet.c
002fb8   6adb     CLRF      0xdb,0x0                                                                                        
002fba   d015     BRA       0x2fe6         			break;                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                           	}                                                                               D:\work\midicontroller\x013x\usbapplet.c
002fe6   0e01     MOVLW     0x1            	return cmdrecognized;                                                           D:\work\midicontroller\x013x\usbapplet.c
002fe8   50db     MOVF      0xdb,0x0,0x0                                                                                    
002fea   6e10     MOVWF     0x10,0x0       }                                                                                D:\work\midicontroller\x013x\usbapplet.c
002fec   0e02     MOVLW     0x2                                                                                             
002fee   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002ff0   e203     BC        0x2ff8                                                                                          
002ff2   d000     BRA       0x2ff4                                                                                          
002ff4   6ae1     CLRF      0xe1,0x0                                                                                        
002ff6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ff8   6ee1     MOVWF     0xe1,0x0                                                                                        
002ffa   5010     MOVF      0x10,0x0,0x0                                                                                    
002ffc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002ffe   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003000   ffd9                                                                                                               
003002   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                                                                                                            D:\work\midicontroller\x013x\usbapplet.c
                                           //This handles data over report ID 44.	                                          D:\work\midicontroller\x013x\usbapplet.c
003004   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ProcessGenericTransferWrite(void) {                                D:\work\midicontroller\x013x\usbapplet.c
003006   ffe6                                                                                                               
003008   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00300a   ffd9                                                                                                               
00300c   0e04     MOVLW     0x4                                                                                             
00300e   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char index, cmdrecognized;                                             D:\work\midicontroller\x013x\usbapplet.c
                                           	unsigned short Address;                                                         D:\work\midicontroller\x013x\usbapplet.c
                                           	                                                                                D:\work\midicontroller\x013x\usbapplet.c
003010   52de     MOVF      0xde,0x1,0x0   	cmdrecognized = true;                                                           D:\work\midicontroller\x013x\usbapplet.c
003012   0e01     MOVLW     0x1                                                                                             
003014   6edd     MOVWF     0xdd,0x0                                                                                        
003016   c072     MOVFF     0x72,0x15f     	PresentCmd = USBEP0DataInBuffer[1];                                             D:\work\midicontroller\x013x\usbapplet.c
003018   f15f                                                                                                               
00301a   0100     MOVLB     0x0            	switch (USBEP0DataInBuffer[1]) {                                                D:\work\midicontroller\x013x\usbapplet.c
00301c   5172     MOVF      0x72,0x0,0x1                                                                                    
00301e   0a32     XORLW     0x32                                                                                            
003020   e06e     BZ        0x30fe                                                                                          
003022   0a03     XORLW     0x3                                                                                             
003024   e01c     BZ        0x305e                                                                                          
003026   0a01     XORLW     0x1                                                                                             
003028   e001     BZ        0x302c                                                                                          
00302a   d069     BRA       0x30fe                                                                                          
                                           		case	W64_1:                                                                    D:\work\midicontroller\x013x\usbapplet.c
00302c   6adf     CLRF      0xdf,0x0       			for (index=0;index<32;index++)                                                D:\work\midicontroller\x013x\usbapplet.c
00302e   0e20     MOVLW     0x20                                                                                            
003030   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
003032   e214     BC        0x305c                                                                                          
003058   2adf     INCF      0xdf,0x1,0x0                                                                                    
00305a   d7e9     BRA       0x302e                                                                                          
003034   0e04     MOVLW     0x4            				ProgmemBuffer[index] = USBEP0DataInBuffer[index+4];                          D:\work\midicontroller\x013x\usbapplet.c
003036   24df     ADDWF     0xdf,0x0,0x0                                                                                    
003038   6aea     CLRF      0xea,0x0                                                                                        
00303a   0f71     ADDLW     0x71                                                                                            
00303c   6ee9     MOVWF     0xe9,0x0                                                                                        
00303e   0e00     MOVLW     0x0                                                                                             
003040   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003042   50ef     MOVF      0xef,0x0,0x0                                                                                    
003044   6ee6     MOVWF     0xe6,0x0                                                                                        
003046   50df     MOVF      0xdf,0x0,0x0                                                                                    
003048   6aea     CLRF      0xea,0x0                                                                                        
00304a   0fbb     ADDLW     0xbb                                                                                            
00304c   6ee9     MOVWF     0xe9,0x0                                                                                        
00304e   0e00     MOVLW     0x0                                                                                             
003050   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003052   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003054   50e7     MOVF      0xe7,0x0,0x0                                                                                    
003056   6eef     MOVWF     0xef,0x0                                                                                        
00305c   d053     BRA       0x3104         			break;                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                           		case	W64_2:                                                                    D:\work\midicontroller\x013x\usbapplet.c
00305e   6adf     CLRF      0xdf,0x0       			for (index=0;index<32;index++) ProgmemBuffer[index] = USBEP0DataInBuffer[index+4]; D:\work\midicontroller\x013x\usbapplet.c
003060   0e20     MOVLW     0x20                                                                                            
003062   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
003064   e214     BC        0x308e                                                                                          
003066   0e04     MOVLW     0x4                                                                                             
003068   24df     ADDWF     0xdf,0x0,0x0                                                                                    
00306a   6aea     CLRF      0xea,0x0                                                                                        
00306c   0f71     ADDLW     0x71                                                                                            
00306e   6ee9     MOVWF     0xe9,0x0                                                                                        
003070   0e00     MOVLW     0x0                                                                                             
003072   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003074   50ef     MOVF      0xef,0x0,0x0                                                                                    
003076   6ee6     MOVWF     0xe6,0x0                                                                                        
003078   50df     MOVF      0xdf,0x0,0x0                                                                                    
00307a   6aea     CLRF      0xea,0x0                                                                                        
00307c   0fbb     ADDLW     0xbb                                                                                            
00307e   6ee9     MOVWF     0xe9,0x0                                                                                        
003080   0e00     MOVLW     0x0                                                                                             
003082   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003084   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003086   50e7     MOVF      0xe7,0x0,0x0                                                                                    
003088   6eef     MOVWF     0xef,0x0                                                                                        
00308a   2adf     INCF      0xdf,0x1,0x0                                                                                    
00308c   d7e9     BRA       0x3060                                                                                          
00308e   0100     MOVLB     0x0            			Address = USBEP0DataInBuffer[2];                                              D:\work\midicontroller\x013x\usbapplet.c
003090   5173     MOVF      0x73,0x0,0x1                                                                                    
003092   6ee6     MOVWF     0xe6,0x0                                                                                        
003094   50d9     MOVF      0xd9,0x0,0x0                                                                                    
003096   0f02     ADDLW     0x2                                                                                             
003098   6ee9     MOVWF     0xe9,0x0                                                                                        
00309a   cfda     MOVFF     0xfda,0xfea                                                                                     
00309c   ffea                                                                                                               
00309e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030a0   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0030a2   6eee     MOVWF     0xee,0x0                                                                                        
0030a4   6aed     CLRF      0xed,0x0                                                                                        
0030a6   5174     MOVF      0x74,0x0,0x1   			Address |= USBEP0DataInBuffer[3]<<8;                                          D:\work\midicontroller\x013x\usbapplet.c
0030a8   0e00     MOVLW     0x0                                                                                             
0030aa   50f3     MOVF      0xf3,0x0,0x0                                                                                    
0030ac   6e10     MOVWF     0x10,0x0                                                                                        
0030ae   6a11     CLRF      0x11,0x0                                                                                        
0030b0   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0030b2   0f02     ADDLW     0x2                                                                                             
0030b4   6ee9     MOVWF     0xe9,0x0                                                                                        
0030b6   cfda     MOVFF     0xfda,0xfea                                                                                     
0030b8   ffea                                                                                                               
0030ba   5010     MOVF      0x10,0x0,0x0                                                                                    
0030bc   12ee     IORWF     0xee,0x1,0x0                                                                                    
0030be   5011     MOVF      0x11,0x0,0x0                                                                                    
0030c0   12ed     IORWF     0xed,0x1,0x0                                                                                    
0030c2   0ebb     MOVLW     0xbb           			Address += (unsigned short)&ProgmemBuffer;                                    D:\work\midicontroller\x013x\usbapplet.c
0030c4   6e10     MOVWF     0x10,0x0                                                                                        
0030c6   0e00     MOVLW     0x0                                                                                             
0030c8   6e11     MOVWF     0x11,0x0                                                                                        
0030ca   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0030cc   0f02     ADDLW     0x2                                                                                             
0030ce   6ee9     MOVWF     0xe9,0x0                                                                                        
0030d0   cfda     MOVFF     0xfda,0xfea                                                                                     
0030d2   ffea                                                                                                               
0030d4   5010     MOVF      0x10,0x0,0x0                                                                                    
0030d6   26ee     ADDWF     0xee,0x1,0x0                                                                                    
0030d8   5011     MOVF      0x11,0x0,0x0                                                                                    
0030da   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
0030dc   0ebb     MOVLW     0xbb           			Write64BytesProgMem((rom unsigned char *)Address, ProgmemBuffer);             D:\work\midicontroller\x013x\usbapplet.c
0030de   6ee6     MOVWF     0xe6,0x0                                                                                        
0030e0   0e00     MOVLW     0x0                                                                                             
0030e2   6ee6     MOVWF     0xe6,0x0                                                                                        
0030e4   0e02     MOVLW     0x2                                                                                             
0030e6   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
0030e8   ffe6                                                                                                               
0030ea   0e03     MOVLW     0x3                                                                                             
0030ec   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
0030ee   ffe6                                                                                                               
0030f0   ec7f     CALL      0x26fe,0x0                                                                                      
0030f2   f013                                                                                                               
0030f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0030fc   d003     BRA       0x3104         			break;                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                           		case	READ_32:                                                                  D:\work\midicontroller\x013x\usbapplet.c
                                           			                                                                              D:\work\midicontroller\x013x\usbapplet.c
                                           		default:                                                                       D:\work\midicontroller\x013x\usbapplet.c
0030fe   0e01     MOVLW     0x1            			cmdrecognized = false;                                                        D:\work\midicontroller\x013x\usbapplet.c
003100   6adb     CLRF      0xdb,0x0                                                                                        
003102   d000     BRA       0x3104         			break;                                                                        D:\work\midicontroller\x013x\usbapplet.c
                                           	}                                                                               D:\work\midicontroller\x013x\usbapplet.c
003104   0e01     MOVLW     0x1            	return cmdrecognized;                                                           D:\work\midicontroller\x013x\usbapplet.c
003106   50db     MOVF      0xdb,0x0,0x0                                                                                    
003108   6e10     MOVWF     0x10,0x0       }                                                                                D:\work\midicontroller\x013x\usbapplet.c
00310a   0e04     MOVLW     0x4                                                                                             
00310c   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
00310e   e203     BC        0x3116                                                                                          
003110   d000     BRA       0x3112                                                                                          
003112   6ae1     CLRF      0xe1,0x0                                                                                        
003114   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003116   6ee1     MOVWF     0xe1,0x0                                                                                        
003118   5010     MOVF      0x10,0x0,0x0                                                                                    
00311a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00311c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00311e   ffd9                                                                                                               
003120   0012     RETURN    0x0                                                                                             
                                           /*********************************************************************           D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            *                Microchip USB C18 Firmware Version 1.0                         D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            *********************************************************************           D:\work\midicontroller\x013x\usbdescript.c
                                            * FileName:        usbdsc.c                                                     D:\work\midicontroller\x013x\usbdescript.c
                                            * Dependencies:    See INCLUDES section below                                   D:\work\midicontroller\x013x\usbdescript.c
                                            * Processor:       PIC18                                                        D:\work\midicontroller\x013x\usbdescript.c
                                            * Compiler:        C18 2.30.01+                                                 D:\work\midicontroller\x013x\usbdescript.c
                                            * Company:         Microchip Technology, Inc.                                   D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * Software License Agreement                                                    D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * The software supplied herewith by Microchip Technology Incorporated           D:\work\midicontroller\x013x\usbdescript.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             D:\work\midicontroller\x013x\usbdescript.c
                                            * supplied to you, the Company’s customer, for use solely and                   D:\work\midicontroller\x013x\usbdescript.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               D:\work\midicontroller\x013x\usbdescript.c
                                            * software is owned by the Company and/or its supplier, and is                  D:\work\midicontroller\x013x\usbdescript.c
                                            * protected under applicable copyright laws. All rights are reserved.           D:\work\midicontroller\x013x\usbdescript.c
                                            * Any use in violation of the foregoing restrictions may subject the            D:\work\midicontroller\x013x\usbdescript.c
                                            * user to criminal sanctions under applicable laws, as well as to               D:\work\midicontroller\x013x\usbdescript.c
                                            * civil liability for the breach of the terms and conditions of this            D:\work\midicontroller\x013x\usbdescript.c
                                            * license.                                                                      D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             D:\work\midicontroller\x013x\usbdescript.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             D:\work\midicontroller\x013x\usbdescript.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   D:\work\midicontroller\x013x\usbdescript.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             D:\work\midicontroller\x013x\usbdescript.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    D:\work\midicontroller\x013x\usbdescript.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            ********************************************************************/           D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /*********************************************************************           D:\work\midicontroller\x013x\usbdescript.c
                                            * -usbdsc.c-                                                                    D:\work\midicontroller\x013x\usbdescript.c
                                            * This file contains the USB descriptor information. It is used                 D:\work\midicontroller\x013x\usbdescript.c
                                            * in conjunction with the usbdsc.h file. When a descriptor is added             D:\work\midicontroller\x013x\usbdescript.c
                                            * or removed from the main configuration descriptor, i.e. CFG01,                D:\work\midicontroller\x013x\usbdescript.c
                                            * the user must also change the descriptor structure defined in                 D:\work\midicontroller\x013x\usbdescript.c
                                            * the usbdsc.h file. The structure is used to calculate the                     D:\work\midicontroller\x013x\usbdescript.c
                                            * descriptor size, i.e. sizeof(CFG01).                                          D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * A typical configuration descriptor consists of:                               D:\work\midicontroller\x013x\usbdescript.c
                                            * At least one configuration descriptor (USB_CFG_DSC)                           D:\work\midicontroller\x013x\usbdescript.c
                                            * One or more interface descriptors (USB_INTF_DSC)                              D:\work\midicontroller\x013x\usbdescript.c
                                            * One or more endpoint descriptors (USB_EP_DSC)                                 D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * Naming Convention:                                                            D:\work\midicontroller\x013x\usbdescript.c
                                            * To resolve ambiguity, the naming convention are as followed:                  D:\work\midicontroller\x013x\usbdescript.c
                                            * - USB_CFG_DSC type should be named cdxx, where xx is the                      D:\work\midicontroller\x013x\usbdescript.c
                                            *   configuration number. This number should match the actual                   D:\work\midicontroller\x013x\usbdescript.c
                                            *   index value of this configuration.                                          D:\work\midicontroller\x013x\usbdescript.c
                                            * - USB_INTF_DSC type should be named i<yy>a<zz>, where yy is the               D:\work\midicontroller\x013x\usbdescript.c
                                            *   interface number and zz is the alternate interface number.                  D:\work\midicontroller\x013x\usbdescript.c
                                            * - USB_EP_DSC type should be named ep<##><d>_i<yy>a<zz>, where                 D:\work\midicontroller\x013x\usbdescript.c
                                            *   ## is the endpoint number and d is the direction of transfer.               D:\work\midicontroller\x013x\usbdescript.c
                                            *   The interface name should also be listed as a suffix to identify            D:\work\midicontroller\x013x\usbdescript.c
                                            *   which interface does the endpoint belong to.                                D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * Example:                                                                      D:\work\midicontroller\x013x\usbdescript.c
                                            * If a device has one configuration, two interfaces; interface 0                D:\work\midicontroller\x013x\usbdescript.c
                                            * has two endpoints (in and out), and interface 1 has one endpoint(in).         D:\work\midicontroller\x013x\usbdescript.c
                                            * Then the CFG01 structure in the usbdsc.h should be:                           D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * #define CFG01 rom struct                            \                         D:\work\midicontroller\x013x\usbdescript.c
                                            * {   USB_CFG_DSC             cd01;                   \                         D:\work\midicontroller\x013x\usbdescript.c
                                            *     USB_INTF_DSC            i00a00;                 \                         D:\work\midicontroller\x013x\usbdescript.c
                                            *     USB_EP_DSC              ep01o_i00a00;           \                         D:\work\midicontroller\x013x\usbdescript.c
                                            *     USB_EP_DSC              ep01i_i00a00;           \                         D:\work\midicontroller\x013x\usbdescript.c
                                            *     USB_INTF_DSC            i01a00;                 \                         D:\work\midicontroller\x013x\usbdescript.c
                                            *     USB_EP_DSC              ep02i_i01a00;           \                         D:\work\midicontroller\x013x\usbdescript.c
                                            * } cfg01                                                                       D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * Note the hierarchy of the descriptors above, it follows the USB               D:\work\midicontroller\x013x\usbdescript.c
                                            * specification requirement. All endpoints belonging to an interface            D:\work\midicontroller\x013x\usbdescript.c
                                            * should be listed immediately after that interface.                            D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * -------------------------------------------------------------------           D:\work\midicontroller\x013x\usbdescript.c
                                            * Filling in the descriptor values in the usbdsc.c file:                        D:\work\midicontroller\x013x\usbdescript.c
                                            * -------------------------------------------------------------------           D:\work\midicontroller\x013x\usbdescript.c
                                            * Most items should be self-explanatory, however, a few will be                 D:\work\midicontroller\x013x\usbdescript.c
                                            * explained for clarification.                                                  D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * [Configuration Descriptor(USB_CFG_DSC)]                                       D:\work\midicontroller\x013x\usbdescript.c
                                            * The configuration attribute must always have the _DEFAULT                     D:\work\midicontroller\x013x\usbdescript.c
                                            * definition at the minimum. Additional options can be ORed                     D:\work\midicontroller\x013x\usbdescript.c
                                            * to the _DEFAULT attribute. Available options are _SELF and _RWU.              D:\work\midicontroller\x013x\usbdescript.c
                                            * These definitions are defined in the usbdefs_std_dsc.h file. The              D:\work\midicontroller\x013x\usbdescript.c
                                            * _SELF tells the USB host that this device is self-powered. The                D:\work\midicontroller\x013x\usbdescript.c
                                            * _RWU tells the USB host that this device supports Remote Wakeup.              D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * [Endpoint Descriptor(USB_EP_DSC)]                                             D:\work\midicontroller\x013x\usbdescript.c
                                            * Assume the following example:                                                 D:\work\midicontroller\x013x\usbdescript.c
                                            * sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_BULK,64,0x00                             D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * The first two parameters are self-explanatory. They specify the               D:\work\midicontroller\x013x\usbdescript.c
                                            * length of this endpoint descriptor (7) and the descriptor type.               D:\work\midicontroller\x013x\usbdescript.c
                                            * The next parameter identifies the endpoint, the definitions are               D:\work\midicontroller\x013x\usbdescript.c
                                            * defined in usbdefs_std_dsc.h and has the following naming                     D:\work\midicontroller\x013x\usbdescript.c
                                            * convention:                                                                   D:\work\midicontroller\x013x\usbdescript.c
                                            * _EP<##>_<dir>                                                                 D:\work\midicontroller\x013x\usbdescript.c
                                            * where ## is the endpoint number and dir is the direction of                   D:\work\midicontroller\x013x\usbdescript.c
                                            * transfer. The dir has the value of either 'OUT' or 'IN'.                      D:\work\midicontroller\x013x\usbdescript.c
                                            * The next parameter identifies the type of the endpoint. Available             D:\work\midicontroller\x013x\usbdescript.c
                                            * options are _BULK, _INT, _ISO, and _CTRL. The _CTRL is not                    D:\work\midicontroller\x013x\usbdescript.c
                                            * typically used because the default control transfer endpoint is               D:\work\midicontroller\x013x\usbdescript.c
                                            * not defined in the USB descriptors. When _ISO option is used,                 D:\work\midicontroller\x013x\usbdescript.c
                                            * addition options can be ORed to _ISO. Example:                                D:\work\midicontroller\x013x\usbdescript.c
                                            * _ISO|_AD|_FE                                                                  D:\work\midicontroller\x013x\usbdescript.c
                                            * This describes the endpoint as an isochronous pipe with adaptive              D:\work\midicontroller\x013x\usbdescript.c
                                            * and feedback attributes. See usbdefs_std_dsc.h and the USB                    D:\work\midicontroller\x013x\usbdescript.c
                                            * specification for details. The next parameter defines the size of             D:\work\midicontroller\x013x\usbdescript.c
                                            * the endpoint. The last parameter in the polling interval.                     D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * -------------------------------------------------------------------           D:\work\midicontroller\x013x\usbdescript.c
                                            * Adding a USB String                                                           D:\work\midicontroller\x013x\usbdescript.c
                                            * -------------------------------------------------------------------           D:\work\midicontroller\x013x\usbdescript.c
                                            * A string descriptor array should have the following format:                   D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[size];}sdxxx={              D:\work\midicontroller\x013x\usbdescript.c
                                            * sizeof(sdxxx),DSC_STR,<text>};                                                D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * The above structure provides a means for the C compiler to                    D:\work\midicontroller\x013x\usbdescript.c
                                            * calculate the length of string descriptor sdxxx, where xxx is the             D:\work\midicontroller\x013x\usbdescript.c
                                            * index number. The first two bytes of the descriptor are descriptor            D:\work\midicontroller\x013x\usbdescript.c
                                            * length and type. The rest <text> are string texts which must be               D:\work\midicontroller\x013x\usbdescript.c
                                            * in the unicode format. The unicode format is achieved by declaring            D:\work\midicontroller\x013x\usbdescript.c
                                            * each character as a word type. The whole text string is declared              D:\work\midicontroller\x013x\usbdescript.c
                                            * as a word array with the number of characters equals to <size>.               D:\work\midicontroller\x013x\usbdescript.c
                                            * <size> has to be manually counted and entered into the array                  D:\work\midicontroller\x013x\usbdescript.c
                                            * declaration. Let's study this through an example:                             D:\work\midicontroller\x013x\usbdescript.c
                                            * if the string is "USB" , then the string descriptor should be:                D:\work\midicontroller\x013x\usbdescript.c
                                            * (Using index 02)                                                              D:\work\midicontroller\x013x\usbdescript.c
                                            * rom struct{byte bLength;byte bDscType;word string[3];}sd002={                 D:\work\midicontroller\x013x\usbdescript.c
                                            * sizeof(sd002),DSC_STR,'U','S','B'};                                           D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * A USB project may have multiple strings and the firmware supports             D:\work\midicontroller\x013x\usbdescript.c
                                            * the management of multiple strings through a look-up table.                   D:\work\midicontroller\x013x\usbdescript.c
                                            * The look-up table is defined as:                                              D:\work\midicontroller\x013x\usbdescript.c
                                            * rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&sd001,&sd002};             D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * The above declaration has 3 strings, sd000, sd001, and sd002.                 D:\work\midicontroller\x013x\usbdescript.c
                                            * Strings can be removed or added. sd000 is a specialized string                D:\work\midicontroller\x013x\usbdescript.c
                                            * descriptor. It defines the language code, usually this is                     D:\work\midicontroller\x013x\usbdescript.c
                                            * US English (0x0409). The index of the string must match the index             D:\work\midicontroller\x013x\usbdescript.c
                                            * position of the USB_SD_Ptr array, &sd000 must be in position                  D:\work\midicontroller\x013x\usbdescript.c
                                            * USB_SD_Ptr[0], &sd001 must be in position USB_SD_Ptr[1] and so on.            D:\work\midicontroller\x013x\usbdescript.c
                                            * The look-up table USB_SD_Ptr is used by the get string handler                D:\work\midicontroller\x013x\usbdescript.c
                                            * function in usb9.c.                                                           D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * -------------------------------------------------------------------           D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * The look-up table scheme also applies to the configuration                    D:\work\midicontroller\x013x\usbdescript.c
                                            * descriptor. A USB device may have multiple configuration                      D:\work\midicontroller\x013x\usbdescript.c
                                            * descriptors, i.e. CFG01, CFG02, etc. To add a configuration                   D:\work\midicontroller\x013x\usbdescript.c
                                            * descriptor, user must implement a structure similar to CFG01.                 D:\work\midicontroller\x013x\usbdescript.c
                                            * The next step is to add the configuration descriptor name, i.e.               D:\work\midicontroller\x013x\usbdescript.c
                                            * cfg01, cfg02,.., to the look-up table USB_CD_Ptr. USB_CD_Ptr[0]               D:\work\midicontroller\x013x\usbdescript.c
                                            * is a dummy place holder since configuration 0 is the un-configured            D:\work\midicontroller\x013x\usbdescript.c
                                            * state according to the definition in the USB specification.                   D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            ********************************************************************/           D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /*********************************************************************           D:\work\midicontroller\x013x\usbdescript.c
                                            * Descriptor specific type definitions are defined in:                          D:\work\midicontroller\x013x\usbdescript.c
                                            * system\usb\usbdefs\usbdefs_std_dsc.h                                          D:\work\midicontroller\x013x\usbdescript.c
                                            *                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                            * Configuration information is defined in:                                      D:\work\midicontroller\x013x\usbdescript.c
                                            * autofiles\usbcfg.h                                                            D:\work\midicontroller\x013x\usbdescript.c
                                            ********************************************************************/           D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           #define POLLING_INTERVAL	40                                                      D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /** I N C L U D E S *************************************************/           D:\work\midicontroller\x013x\usbdescript.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /** C O N S T A N T S ************************************************/          D:\work\midicontroller\x013x\usbdescript.c
                                           #pragma romdata                                                                  D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /* Device Descriptor */                                                          D:\work\midicontroller\x013x\usbdescript.c
                                           rom USB_DEV_DSC device_dsc=                                                      D:\work\midicontroller\x013x\usbdescript.c
                                           {                                                                                D:\work\midicontroller\x013x\usbdescript.c
                                               0x12,     	// bLength                                                        D:\work\midicontroller\x013x\usbdescript.c
                                               0x01,     	// bDescriptorType                                                D:\work\midicontroller\x013x\usbdescript.c
                                               0x0110,    	// bcdUSB (spec release #)                                       D:\work\midicontroller\x013x\usbdescript.c
                                               0x00,     	// bDeviceClass                                                   D:\work\midicontroller\x013x\usbdescript.c
                                               0x00,     	// bDeviceSubClass                                                D:\work\midicontroller\x013x\usbdescript.c
                                               0x00,     	// bDeviceProtocol                                                D:\work\midicontroller\x013x\usbdescript.c
                                               EP0_BUFF_SIZE,     	// bMaxPacketSize0                                       D:\work\midicontroller\x013x\usbdescript.c
                                               0x09AE,     // idVendor                                                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x4430,		// idProduct                                                        D:\work\midicontroller\x013x\usbdescript.c
                                               0x0010,    	// bcdDevice : Project version = 0.10                            D:\work\midicontroller\x013x\usbdescript.c
                                               INDEX_MANUFACTURER,	// Index of string Descriptor describing manufacturer      D:\work\midicontroller\x013x\usbdescript.c
                                               INDEX_NAME,			// Index of string Descriptor describing product               D:\work\midicontroller\x013x\usbdescript.c
                                               INDEX_SERIALNUM,	// Index of string Descriptor describing the device's serial number D:\work\midicontroller\x013x\usbdescript.c
                                               0x01				// bNumConfigurations : renaud 1 configuration                       D:\work\midicontroller\x013x\usbdescript.c
                                           };                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /* Configuration 1 Descriptor */                                                 D:\work\midicontroller\x013x\usbdescript.c
                                           CFG01={                                                                          D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09,		// bLength: Configuration Descriptor size                                D:\work\midicontroller\x013x\usbdescript.c
                                           	0x02,		// bDescriptorType: Configuration                                        D:\work\midicontroller\x013x\usbdescript.c
                                           	P1_CONFDESC_LEN,	//(word) Length of configuration descriptor. **Renaud : To update D:\work\midicontroller\x013x\usbdescript.c
                                           	0x01,		// bNumInterfaces: 1 interface.                                          D:\work\midicontroller\x013x\usbdescript.c
                                           	0x01,		// bConfigurationValue: Configuration value = 1                          D:\work\midicontroller\x013x\usbdescript.c
                                           	0,			// iConfiguration: Index of string descriptor describing the configuration (None) D:\work\midicontroller\x013x\usbdescript.c
                                           //	0x80,		// bmAttributes: Bus powered and NO Remote wakeup                      D:\work\midicontroller\x013x\usbdescript.c
                                           	0xA0,		// bmAttributes: Bus powered and Remote wakeup ** Renaud : changed from 0xE0 D:\work\midicontroller\x013x\usbdescript.c
                                           //	0xC0,		// bmAttributes: Self powered and NO Remote wakeup                     D:\work\midicontroller\x013x\usbdescript.c
                                           //	0xE0,		// bmAttributes: Self powered and Remote wakeup                        D:\work\midicontroller\x013x\usbdescript.c
                                           	0x32,		// MaxPower 50 mA : ** Renaud : MaxPowerself-powered draws 0 mA from the bus.  D:\work\midicontroller\x013x\usbdescript.c
                                           //	0x00,		// 0 mA power consumption.                                             D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           // Interface descriptor (Interface 0 = DemoKit)                                  D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09,		// bLength: Interface Descriptor size                                    D:\work\midicontroller\x013x\usbdescript.c
                                           	0x04,		// bDescriptorType: Interface descriptor type  ** Renaud : to check      D:\work\midicontroller\x013x\usbdescript.c
                                           	0x00,		// bInterfaceNumber: Interface Number = 0                                D:\work\midicontroller\x013x\usbdescript.c
                                           	0x00,		// bAlternateSetting: No Alternate setting                               D:\work\midicontroller\x013x\usbdescript.c
                                           	0x01,		// bNumEndpoints:                                                        D:\work\midicontroller\x013x\usbdescript.c
                                           	0x03,		// bInterfaceClass: HID                                                  D:\work\midicontroller\x013x\usbdescript.c
                                           	0x00,		// bInterfaceSubClass:                                                   D:\work\midicontroller\x013x\usbdescript.c
                                           	0x00,		// bInterfaceProtocol: ** Renaud : changed from 2 (protocol - mouse in tripplite descriptor) to 0 : no protocol  D:\work\midicontroller\x013x\usbdescript.c
                                           	0x00,		// iInterface: Index of string descriptor (No string value)              D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           // HID descriptor (Demokit)                                                      D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09,		// bLength: HID Descriptor size                                          D:\work\midicontroller\x013x\usbdescript.c
                                           	0x21,		// bDescriptorType: HID                                                  D:\work\midicontroller\x013x\usbdescript.c
                                           	0x0110,		// (word) bcdHID: HID Class Spec release number (1.10) ** Renaud : I let rev 1.10, but Tripplite has HID class release number (1.00) D:\work\midicontroller\x013x\usbdescript.c
                                           	0x00,		// bCountryCode: Hardware target country US ** Renaud changed from 0x21 (US) to 0x00 (none specified) D:\work\midicontroller\x013x\usbdescript.c
                                           	0x01,		// bNumDescriptors: Number of HID class descriptors to follow            D:\work\midicontroller\x013x\usbdescript.c
                                           	0x22,		// bDescriptorType: Report                                               D:\work\midicontroller\x013x\usbdescript.c
                                           	HID_RPT_UPS_SIZE,	// (word) Length of report descriptor interface 0 (2 bytes) ** Renaud : To update D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           // Endpoint 1 descriptor (Demokit)                                               D:\work\midicontroller\x013x\usbdescript.c
                                           	0x07,		// bLength: Endpoint Descriptor size                                     D:\work\midicontroller\x013x\usbdescript.c
                                           	0x05,		// bDescriptorType: Endpoint descriptor type   ** Renaud : To check      D:\work\midicontroller\x013x\usbdescript.c
                                           	0x81,		// bEndpointAddress: Endpoint  1 IN                                      D:\work\midicontroller\x013x\usbdescript.c
                                           	0x03,		// bmAttributes: Interrupt endpoint                                      D:\work\midicontroller\x013x\usbdescript.c
                                           	0x0008,		// wMaxPacketSize(LSB):                                                D:\work\midicontroller\x013x\usbdescript.c
                                           	POLLING_INTERVAL       // bInterval: Polling Interval (40 ms = 0x28)            D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //    sizeof(USB_EP_DSC),DSC_EP,_EP01_IN,_INT,HID_INT_IN_EP_SIZE,POLLING_INTERVAL D:\work\midicontroller\x013x\usbdescript.c
                                           };                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //    sizeof(USB_EP_DSC),DSC_EP,_EP01_OUT,_INT,HID_INT_OUT_EP_SIZE,POLLING_INTERVAL, D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //2/8/05 JD language selection I think..                                         D:\work\midicontroller\x013x\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[1];}sd000={                    D:\work\midicontroller\x013x\usbdescript.c
                                           sizeof(sd000),DSC_STR,0x0409};                                                   D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //Manufacturer string                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[11];}MfrString={               D:\work\midicontroller\x013x\usbdescript.c
                                           sizeof(MfrString),DSC_STR,                                                       D:\work\midicontroller\x013x\usbdescript.c
                                           'J','o','e'};                                                                    D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //Product String                                                                 D:\work\midicontroller\x013x\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[21];}PrdString={               D:\work\midicontroller\x013x\usbdescript.c
                                           sizeof(PrdString),DSC_STR,                                                       D:\work\midicontroller\x013x\usbdescript.c
                                           'M','I','D','I',' ','D','e','v','i','c','e',' '};                                D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //Serial Number                                                                  D:\work\midicontroller\x013x\usbdescript.c
                                           rom struct{byte bLength;byte bDscType;word string[16];}SerialNum={               D:\work\midicontroller\x013x\usbdescript.c
                                           sizeof(SerialNum),DSC_STR,                                                       D:\work\midicontroller\x013x\usbdescript.c
                                           '6','9','1','2','0','6','0','B',' '};                                            D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //the reason for this structure is so that sizeof() returns a value.             D:\work\midicontroller\x013x\usbdescript.c
                                           rom struct{byte report[HID_RPT_UPS_SIZE];}hid_rpt_UPS={                          D:\work\midicontroller\x013x\usbdescript.c
                                           //Production test information                                                    D:\work\midicontroller\x013x\usbdescript.c
                                               0x06, 0xff, 0xff,              //     USAGE_PAGE (Vendor Defined Page 0xffff) D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09,  0x01,               		// USAGE (Vendor Usage 1)                          D:\work\midicontroller\x013x\usbdescript.c
                                           	0xa1,  0x01,              	  // COLLECTION (Application)                        D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x95, 0x01,                    //       REPORT_COUNT (1)                     D:\work\midicontroller\x013x\usbdescript.c
                                               0x26, 0xff, 0x00,              //       LOGICAL_MAXIMUM (255)                D:\work\midicontroller\x013x\usbdescript.c
                                               0x15, 0x00,                    //       LOGICAL_MINIMUM (0)                  D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //NVR Operations                                                                 D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x96,                    //       REPORT_ID (150)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xC0,                    //       USAGE (***NVR Read/Write Data)       D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0xB4,                    //       REPORT_ID (180)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xD2,                    //       USAGE (***NVR Page Read/Write Data)  D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x97,                    //       REPORT_ID (151)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xC1,                    //       USAGE (***NVR Address 16bit)         D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //RAM Operations                                                                 D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x98,                    //       REPORT_ID (152)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xC2,                    //       USAGE (***RAM Read/Write Data)       D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x99,                    //       REPORT_ID (153)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xC3,                    //       USAGE (***RAM Address 16bit)         D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //ROM Operations                                                                 D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x9C,                    //       REPORT_ID (156)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xD4,                    //       USAGE (***ROM Read/Write Data)       D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x10,                    //       REPORT_SIZE (16)                     D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x9D,                    //       REPORT_ID (157)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xD5,                    //       USAGE (***ROM Address 16bit)         D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //Production test protocol #                                                     D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x9B,                    //       REPORT_ID (155)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xC5,                    //       USAGE (***Production Test Protocol #) D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x20,                    //       REPORT_SIZE (32)                     D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0xAF,                    //       REPORT_ID (175)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xE9,                    //       USAGE (***Voltage Data)              D:\work\midicontroller\x013x\usbdescript.c
                                           	0x81, 0xa2,					   //	 	INPUT (Data,Var,Abs, Vol, NPrf)                         D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x76, 0x00, 0x02,              //       REPORT_SIZE (512)                    D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0xB0,                    //       REPORT_ID (176)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xEA,                    //       USAGE (***Voltage Data Bulk)         D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //Firmware Partnumber                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           	0x75, 0x20,						//	   REPORT_SIZE (32)                                         D:\work\midicontroller\x013x\usbdescript.c
                                           	0x85, 0xC2,						//	   REPORT_ID (194)                                          D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09, 0xD6,						//	   USAGE (***Firmware Partnumber 32bit)                     D:\work\midicontroller\x013x\usbdescript.c
                                           	0xb1, 0x02,						//	   FEATURE (Data,Var,Abs)                                   D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //Production test password = 866E1942                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0x85, 0x9A,                    //       REPORT_ID (154)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x09, 0xC4,                    //       USAGE (***Production test Password - 32bit) D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                    //       FEATURE (Data,Var,Abs)               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //The input report		                                                             D:\work\midicontroller\x013x\usbdescript.c
                                               0x75, 0x08,                    //       REPORT_SIZE (8)                      D:\work\midicontroller\x013x\usbdescript.c
                                               0x95, 63,                    //       REPORT_COUNT (63)                      D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           	0x85, 44,					// REPORT_ID 44                                                   D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09, 0x04,					// usage - vendor defined                                       D:\work\midicontroller\x013x\usbdescript.c
                                           //	0x81, 0x02,					// Input (Data, Variable, Absolute)                           D:\work\midicontroller\x013x\usbdescript.c
                                           	0x09, 0x04,					// usage - vendor defined                                       D:\work\midicontroller\x013x\usbdescript.c
                                               0xb1, 0x02,                 //       FEATURE (Data,Var,Abs)                  D:\work\midicontroller\x013x\usbdescript.c
                                           		                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                           //The output report		                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           //	0x09, 0x06,					// usage - vendor defined                                     D:\work\midicontroller\x013x\usbdescript.c
                                           //	0x91, 0x02,					// Output (Data, Variable, Absolute)                          D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                               0xc0                          //     END_COLLECTION                          D:\work\midicontroller\x013x\usbdescript.c
                                           };                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                           //** Renaud : end_ReportDescriptor                                               D:\work\midicontroller\x013x\usbdescript.c
                                           	                                                                                D:\work\midicontroller\x013x\usbdescript.c
                                           rom const unsigned char *rom USB_CD_Ptr[]={&cfg01,&cfg01};                       D:\work\midicontroller\x013x\usbdescript.c
                                           rom const unsigned char *rom USB_SD_Ptr[]={&sd000,&MfrString,&PrdString,&SerialNum}; D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           rom pFunc ClassReqHandler[1]=                                                    D:\work\midicontroller\x013x\usbdescript.c
                                           {                                                                                D:\work\midicontroller\x013x\usbdescript.c
                                               &USBCheckHIDRequest                                                          D:\work\midicontroller\x013x\usbdescript.c
                                           };                                                                               D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\usbdescript.c
                                                                                                                            D:\work\midicontroller\x013x\usbdescript.c
                                           /** EOF usbdsc.c ****************************************************/           D:\work\midicontroller\x013x\usbdescript.c
                                           //############################################################################### D:\work\midicontroller\x013x\rs232.c
                                           //#										       						       		#                                             D:\work\midicontroller\x013x\rs232.c
                                           //#			Author: Joe Dunne											 		#                                           D:\work\midicontroller\x013x\rs232.c
                                           //#			RS232 Communication ROUTINE											#                                    D:\work\midicontroller\x013x\rs232.c
                                           //#			File Name: RXCOMM.ASM												#                                         D:\work\midicontroller\x013x\rs232.c
                                           //#																				#                                                         D:\work\midicontroller\x013x\rs232.c
                                           //#			Updated 2/02/05 by JD												#                                         D:\work\midicontroller\x013x\rs232.c
                                           //#									      	       	       	       	       		#                            D:\work\midicontroller\x013x\rs232.c
                                           //############################################################################### D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           #include	"c_system.h"                                                            D:\work\midicontroller\x013x\rs232.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\rs232.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           #define	FW_REV						0x10                                                         D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           #define	UPS_TYPE					(2|FW_REV)                                                  D:\work\midicontroller\x013x\rs232.c
                                           #define	PRODUCTION_TEST_PROTOCOL	0x0003                                          D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[];}SerialNum;           D:\work\midicontroller\x013x\rs232.c
                                           extern rom struct{byte bLength;byte bDscType;word string[24];}MfrString;         D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           void	RemCapCalculation(void);                                                    D:\work\midicontroller\x013x\rs232.c
                                           void	EE_READ(void);                                                              D:\work\midicontroller\x013x\rs232.c
                                           void	D_DIV(void);                                                                D:\work\midicontroller\x013x\rs232.c
                                           void	SQRT_16BIT(void);		//result is stored in RES0.                              D:\work\midicontroller\x013x\rs232.c
                                           void	HIDGetReportHandler(void);                                                  D:\work\midicontroller\x013x\rs232.c
                                           unsigned char	READ_SYSTEM_NVR(void);                                             D:\work\midicontroller\x013x\rs232.c
                                           void	EE_PAGE_WRITE(void);                                                        D:\work\midicontroller\x013x\rs232.c
                                           void	BOOT_LOAD_MODE(void);                                                       D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           //--------------------------------------------------------------                 D:\work\midicontroller\x013x\rs232.c
                                           //						Handle received query                                                    D:\work\midicontroller\x013x\rs232.c
                                           //--------------------------------------------------------------                 D:\work\midicontroller\x013x\rs232.c
0028e4   cfd9     MOVFF     0xfd9,0xfe6    void	PROCESS_COMM_REQUEST(void) {                                                D:\work\midicontroller\x013x\rs232.c
0028e6   ffe6                                                                                                               
0028e8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028ea   ffd9                                                                                                               
0028ec   0e11     MOVLW     0x11                                                                                            
0028ee   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char *RcvPtr;                                                          D:\work\midicontroller\x013x\rs232.c
                                           	unsigned char tempvar1, tempvar0;                                               D:\work\midicontroller\x013x\rs232.c
                                           	far unsigned char *Data;                                                        D:\work\midicontroller\x013x\rs232.c
                                           	BitField ByteToSend;                                                            D:\work\midicontroller\x013x\rs232.c
                                           	TwoBytes tempreg, tempnum0, value;                                              D:\work\midicontroller\x013x\rs232.c
                                           	FourBytes longreg;                                                              D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
0028f0   0100     MOVLB     0x0            	ResponseType = INVALID_REQUEST;		//no response                                  D:\work\midicontroller\x013x\rs232.c
0028f2   69b1     SETF      0xb1,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           	//USB query                                                                     D:\work\midicontroller\x013x\rs232.c
0028f4   0100     MOVLB     0x0            	USBDataPointer = 1;		//the 0th byte is the reportid                             D:\work\midicontroller\x013x\rs232.c
0028f6   0e01     MOVLW     0x1                                                                                             
0028f8   6f70     MOVWF     0x70,0x1                                                                                        
0028fa   0e72     MOVLW     0x72           	RcvPtr = (unsigned char *)&USBEP0DataInBuffer[1];                               D:\work\midicontroller\x013x\rs232.c
0028fc   6ede     MOVWF     0xde,0x0                                                                                        
0028fe   0e00     MOVLW     0x0                                                                                             
002900   6edd     MOVWF     0xdd,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           //Polling command:                                                               D:\work\midicontroller\x013x\rs232.c
002902   0104     MOVLB     0x4            	if (SetupPkt.bRequest == GET_REPORT) {                                          D:\work\midicontroller\x013x\rs232.c
002904   0511     DECF      0x11,0x0,0x1                                                                                    
002906   e001     BZ        0x290a                                                                                          
002908   d0ac     BRA       0x2a62                                                                                          
00290a   5112     MOVF      0x12,0x0,0x1   		switch (SetupPkt._byte[2]) {                                                   D:\work\midicontroller\x013x\rs232.c
00290c   0ab4     XORLW     0xb4                                                                                            
00290e   e101     BNZ       0x2912                                                                                          
002910   d08f     BRA       0x2a30                                                                                          
002912   0a2f     XORLW     0x2f                                                                                            
002914   e101     BNZ       0x2918                                                                                          
002916   d081     BRA       0x2a1a                                                                                          
002918   0a06     XORLW     0x6                                                                                             
00291a   e073     BZ        0x2a02                                                                                          
00291c   0a01     XORLW     0x1                                                                                             
00291e   e064     BZ        0x29e8                                                                                          
002920   0a05     XORLW     0x5                                                                                             
002922   e056     BZ        0x29d0                                                                                          
002924   0a01     XORLW     0x1                                                                                             
002926   e040     BZ        0x29a8                                                                                          
002928   0a0f     XORLW     0xf                                                                                             
00292a   e032     BZ        0x2990                                                                                          
00292c   0a01     XORLW     0x1                                                                                             
00292e   e025     BZ        0x297a                                                                                          
002930   0aba     XORLW     0xba                                                                                            
002932   e013     BZ        0x295a                                                                                          
002934   0a83     XORLW     0x83                                                                                            
002936   e001     BZ        0x293a                                                                                          
002938   d093     BRA       0x2a60                                                                                          
                                           			                                                                              D:\work\midicontroller\x013x\rs232.c
                                           		case 175:		//voltage data                                                      D:\work\midicontroller\x013x\rs232.c
00293a   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
00293c   0e05     MOVLW     0x5                                                                                             
00293e   6fb1     MOVWF     0xb1,0x1                                                                                        
002940   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     D:\work\midicontroller\x013x\rs232.c
002942   d93c     RCALL     0x2bbc                                                                                          
002944   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002946   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     D:\work\midicontroller\x013x\rs232.c
002948   d939     RCALL     0x2bbc                                                                                          
00294a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00294c   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     D:\work\midicontroller\x013x\rs232.c
00294e   d936     RCALL     0x2bbc                                                                                          
002950   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002952   6ae6     CLRF      0xe6,0x0       			TXENQ(0);                                                                     D:\work\midicontroller\x013x\rs232.c
002954   d933     RCALL     0x2bbc                                                                                          
002956   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002958   d084     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           		case 44:		//generic data transfer device to host                               D:\work\midicontroller\x013x\rs232.c
00295a   ecce     CALL      0x2f9c,0x0     			if (ProcessGenericTransferRead()) ResponseType = DATA_RETURNED;               D:\work\midicontroller\x013x\rs232.c
00295c   f017                                                                                                               
00295e   cff3     MOVFF     0xff3,0x10                                                                                      
002960   f010                                                                                                               
002962   cff4     MOVFF     0xff4,0x11                                                                                      
002964   f011                                                                                                               
002966   5010     MOVF      0x10,0x0,0x0                                                                                    
002968   1011     IORWF     0x11,0x0,0x0                                                                                    
00296a   e004     BZ        0x2974                                                                                          
00296c   0100     MOVLB     0x0                                                                                             
00296e   0e05     MOVLW     0x5                                                                                             
002970   6fb1     MOVWF     0xb1,0x1                                                                                        
002972   d002     BRA       0x2978         			else ResponseType = INVALID_REQUEST;                                          D:\work\midicontroller\x013x\rs232.c
002974   0100     MOVLB     0x0                                                                                             
002976   69b1     SETF      0xb1,0x1                                                                                        
002978   d074     BRA       0x2a62         			break;	                                                                       D:\work\midicontroller\x013x\rs232.c
                                           			                                                                              D:\work\midicontroller\x013x\rs232.c
                                           //production test commands:			                                                   D:\work\midicontroller\x013x\rs232.c
                                           		case 150:		//NVR Read                                                          D:\work\midicontroller\x013x\rs232.c
00297a   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
00297c   0e05     MOVLW     0x5                                                                                             
00297e   6fb1     MOVWF     0xb1,0x1                                                                                        
002980   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    D:\work\midicontroller\x013x\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        D:\work\midicontroller\x013x\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  D:\work\midicontroller\x013x\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();		//returns data through wreg                    D:\work\midicontroller\x013x\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   D:\work\midicontroller\x013x\rs232.c
                                           //				TXENQ(Temp6);                                                              D:\work\midicontroller\x013x\rs232.c
                                           			}                                                                             D:\work\midicontroller\x013x\rs232.c
002982   d005     BRA       0x298e         			else {                                                                        D:\work\midicontroller\x013x\rs232.c
002984   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             D:\work\midicontroller\x013x\rs232.c
002986   6fb1     MOVWF     0xb1,0x1                                                                                        
002988   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      D:\work\midicontroller\x013x\rs232.c
00298a   d918     RCALL     0x2bbc                                                                                          
00298c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\rs232.c
00298e   d069     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           			                                                                              D:\work\midicontroller\x013x\rs232.c
                                           		case 151:		//NVR Address                                                       D:\work\midicontroller\x013x\rs232.c
002990   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
002992   0e05     MOVLW     0x5                                                                                             
002994   6fb1     MOVWF     0xb1,0x1                                                                                        
002996   c0b2     MOVFF     0xb2,0xfe6     			TXENQ(NVRCommAddr.b_form.low);		//low byte                                    D:\work\midicontroller\x013x\rs232.c
002998   ffe6                                                                                                               
00299a   d910     RCALL     0x2bbc                                                                                          
00299c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00299e   c0b3     MOVFF     0xb3,0xfe6     			TXENQ(NVRCommAddr.b_form.high);		//high byte                                  D:\work\midicontroller\x013x\rs232.c
0029a0   ffe6                                                                                                               
0029a2   d90c     RCALL     0x2bbc                                                                                          
0029a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0029a6   d05d     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		case 152:		//RAM Read                                                          D:\work\midicontroller\x013x\rs232.c
0029a8   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
0029aa   0e05     MOVLW     0x5                                                                                             
0029ac   6fb1     MOVWF     0xb1,0x1                                                                                        
0029ae   0e04     MOVLW     0x4            			Data = (far unsigned char *)RAMCommAddr.s_form;                               D:\work\midicontroller\x013x\rs232.c
0029b0   c0b4     MOVFF     0xb4,0xfdb                                                                                      
0029b2   ffdb                                                                                                               
0029b4   0e05     MOVLW     0x5                                                                                             
0029b6   c0b5     MOVFF     0xb5,0xfdb                                                                                      
0029b8   ffdb                                                                                                               
0029ba   0e04     MOVLW     0x4            			TXENQ(*Data);                                                                 D:\work\midicontroller\x013x\rs232.c
0029bc   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
0029be   ffe9                                                                                                               
0029c0   0e05     MOVLW     0x5                                                                                             
0029c2   cfdb     MOVFF     0xfdb,0xfea                                                                                     
0029c4   ffea                                                                                                               
0029c6   50ef     MOVF      0xef,0x0,0x0                                                                                    
0029c8   6ee6     MOVWF     0xe6,0x0                                                                                        
0029ca   d8f8     RCALL     0x2bbc                                                                                          
0029cc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0029ce   d049     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           		case 153:		//RAM Address                                                       D:\work\midicontroller\x013x\rs232.c
0029d0   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
0029d2   0e05     MOVLW     0x5                                                                                             
0029d4   6fb1     MOVWF     0xb1,0x1                                                                                        
0029d6   c0b4     MOVFF     0xb4,0xfe6     			TXENQ(RAMCommAddr.b_form.low);		//low byte                                    D:\work\midicontroller\x013x\rs232.c
0029d8   ffe6                                                                                                               
0029da   d8f0     RCALL     0x2bbc                                                                                          
0029dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0029de   c0b5     MOVFF     0xb5,0xfe6     			TXENQ(RAMCommAddr.b_form.high);		//high byte                                  D:\work\midicontroller\x013x\rs232.c
0029e0   ffe6                                                                                                               
0029e2   d8ec     RCALL     0x2bbc                                                                                          
0029e4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
0029e6   d03d     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           		case 156:		//ROM Read                                                          D:\work\midicontroller\x013x\rs232.c
0029e8   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
0029ea   0e05     MOVLW     0x5                                                                                             
0029ec   6fb1     MOVWF     0xb1,0x1                                                                                        
0029ee   c0b6     MOVFF     0xb6,0xff6     			TXENQ(*(near unsigned char rom *)ROMCommAddr.s_form);                         D:\work\midicontroller\x013x\rs232.c
0029f0   fff6                                                                                                               
0029f2   c0b7     MOVFF     0xb7,0xff7                                                                                      
0029f4   fff7                                                                                                               
0029f6   0008     TBLRD                                                                                                     
0029f8   50f5     MOVF      0xf5,0x0,0x0                                                                                    
0029fa   6ee6     MOVWF     0xe6,0x0                                                                                        
0029fc   d8df     RCALL     0x2bbc                                                                                          
0029fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a00   d030     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           		case 157:		//ROM Address                                                       D:\work\midicontroller\x013x\rs232.c
002a02   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
002a04   0e05     MOVLW     0x5                                                                                             
002a06   6fb1     MOVWF     0xb1,0x1                                                                                        
002a08   c0b6     MOVFF     0xb6,0xfe6     			TXENQ(ROMCommAddr.b_form.low);		//low byte                                    D:\work\midicontroller\x013x\rs232.c
002a0a   ffe6                                                                                                               
002a0c   d8d7     RCALL     0x2bbc                                                                                          
002a0e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a10   c0b7     MOVFF     0xb7,0xfe6     			TXENQ(ROMCommAddr.b_form.high);		//high byte                                  D:\work\midicontroller\x013x\rs232.c
002a12   ffe6                                                                                                               
002a14   d8d3     RCALL     0x2bbc                                                                                          
002a16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a18   d024     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           		case 155:		//production test protocol                                          D:\work\midicontroller\x013x\rs232.c
002a1a   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
002a1c   0e05     MOVLW     0x5                                                                                             
002a1e   6fb1     MOVWF     0xb1,0x1                                                                                        
002a20   0e03     MOVLW     0x3            			TXENQ(PRODUCTION_TEST_PROTOCOL&255);                                          D:\work\midicontroller\x013x\rs232.c
002a22   6ee6     MOVWF     0xe6,0x0                                                                                        
002a24   d8cb     RCALL     0x2bbc                                                                                          
002a26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a28   6ae6     CLRF      0xe6,0x0       			TXENQ(PRODUCTION_TEST_PROTOCOL>>8);                                           D:\work\midicontroller\x013x\rs232.c
002a2a   d8c8     RCALL     0x2bbc                                                                                          
002a2c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a2e   d019     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           		case 180:		//NVR Page Read                                                     D:\work\midicontroller\x013x\rs232.c
002a30   0100     MOVLB     0x0            			ResponseType = DATA_RETURNED;                                                 D:\work\midicontroller\x013x\rs232.c
002a32   0e05     MOVLW     0x5                                                                                             
002a34   6fb1     MOVWF     0xb1,0x1                                                                                        
002a36   b8a0     BTFSC     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    D:\work\midicontroller\x013x\rs232.c
002a38   d004     BRA       0x2a42                                                                                          
002a3a   9ef2     BCF       0xf2,0x7,0x0   				DISABLE_ALL_INTERRUPTS();                                                    D:\work\midicontroller\x013x\rs232.c
002a3c   9cf2     BCF       0xf2,0x6,0x0                                                                                    
                                           //				EEAddress = NVRCommAddr.b_form.low;                                        D:\work\midicontroller\x013x\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 D:\work\midicontroller\x013x\rs232.c
                                           //				TXENQ(Temp6);                                                              D:\work\midicontroller\x013x\rs232.c
                                           //				EEAddress++;                                                               D:\work\midicontroller\x013x\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 D:\work\midicontroller\x013x\rs232.c
                                           //				TXENQ(Temp6);                                                              D:\work\midicontroller\x013x\rs232.c
                                           //				EEAddress++;                                                               D:\work\midicontroller\x013x\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 D:\work\midicontroller\x013x\rs232.c
                                           //				TXENQ(Temp6);                                                              D:\work\midicontroller\x013x\rs232.c
                                           //				EEAddress++;                                                               D:\work\midicontroller\x013x\rs232.c
                                           //				Temp6 = READ_SYSTEM_NVR();                                                 D:\work\midicontroller\x013x\rs232.c
                                           //				TXENQ(Temp6);                                                              D:\work\midicontroller\x013x\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   D:\work\midicontroller\x013x\rs232.c
002a3e   d011     BRA       0x2a62         				break;                                                                       D:\work\midicontroller\x013x\rs232.c
                                           			}                                                                             D:\work\midicontroller\x013x\rs232.c
002a40   d00f     BRA       0x2a60         			else {                                                                        D:\work\midicontroller\x013x\rs232.c
002a42   0e01     MOVLW     0x1            				ResponseType = COMMAND_REJECTED;                                             D:\work\midicontroller\x013x\rs232.c
002a44   6fb1     MOVWF     0xb1,0x1                                                                                        
002a46   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      D:\work\midicontroller\x013x\rs232.c
002a48   d8b9     RCALL     0x2bbc                                                                                          
002a4a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a4c   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      D:\work\midicontroller\x013x\rs232.c
002a4e   d8b6     RCALL     0x2bbc                                                                                          
002a50   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a52   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      D:\work\midicontroller\x013x\rs232.c
002a54   d8b3     RCALL     0x2bbc                                                                                          
002a56   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a58   68e6     SETF      0xe6,0x0       				TXENQ(INVALID_REQUEST);                                                      D:\work\midicontroller\x013x\rs232.c
002a5a   d8b0     RCALL     0x2bbc                                                                                          
002a5c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002a5e   d001     BRA       0x2a62         				break;                                                                       D:\work\midicontroller\x013x\rs232.c
                                           			}				                                                                         D:\work\midicontroller\x013x\rs232.c
                                           		default:                                                                       D:\work\midicontroller\x013x\rs232.c
002a60   d000     BRA       0x2a62         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		}                                                                              D:\work\midicontroller\x013x\rs232.c
                                           	}                                                                               D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           //Set command:                                                                   D:\work\midicontroller\x013x\rs232.c
002a62   0e09     MOVLW     0x9            	if (SetupPkt.bRequest == SET_REPORT) {                                          D:\work\midicontroller\x013x\rs232.c
002a64   0104     MOVLB     0x4                                                                                             
002a66   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002a68   e001     BZ        0x2a6c                                                                                          
002a6a   d08c     BRA       0x2b84                                                                                          
002a6c   5112     MOVF      0x12,0x0,0x1   		switch (SetupPkt._byte[2]) {                                                   D:\work\midicontroller\x013x\rs232.c
002a6e   0ab4     XORLW     0xb4                                                                                            
002a70   e101     BNZ       0x2a74                                                                                          
002a72   d084     BRA       0x2b7c                                                                                          
002a74   0a29     XORLW     0x29                                                                                            
002a76   e06a     BZ        0x2b4c                                                                                          
002a78   0a01     XORLW     0x1                                                                                             
002a7a   e064     BZ        0x2b44                                                                                          
002a7c   0a06     XORLW     0x6                                                                                             
002a7e   e05e     BZ        0x2b3c                                                                                          
002a80   0a03     XORLW     0x3                                                                                             
002a82   e048     BZ        0x2b14                                                                                          
002a84   0a01     XORLW     0x1                                                                                             
002a86   e038     BZ        0x2af8                                                                                          
002a88   0a0f     XORLW     0xf                                                                                             
002a8a   e01e     BZ        0x2ac8                                                                                          
002a8c   0a01     XORLW     0x1                                                                                             
002a8e   e014     BZ        0x2ab8                                                                                          
002a90   0aba     XORLW     0xba                                                                                            
002a92   e001     BZ        0x2a96                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           		case 44:		//generic data transfer host to device                               D:\work\midicontroller\x013x\rs232.c
002a96   ec02     CALL      0x3004,0x0     			if (ProcessGenericTransferWrite()) ResponseType = COMMAND_ACCEPTED;           D:\work\midicontroller\x013x\rs232.c
002a98   f018                                                                                                               
002a9a   cff3     MOVFF     0xff3,0x10                                                                                      
002a9c   f010                                                                                                               
002a9e   cff4     MOVFF     0xff4,0x11                                                                                      
002aa0   f011                                                                                                               
002aa2   5010     MOVF      0x10,0x0,0x0                                                                                    
002aa4   1011     IORWF     0x11,0x0,0x0                                                                                    
002aa6   e004     BZ        0x2ab0                                                                                          
002aa8   0100     MOVLB     0x0                                                                                             
002aaa   0e02     MOVLW     0x2                                                                                             
002aac   6fb1     MOVWF     0xb1,0x1                                                                                        
002aae   d003     BRA       0x2ab6         			else ResponseType = COMMAND_REJECTED;                                         D:\work\midicontroller\x013x\rs232.c
002ab0   0100     MOVLB     0x0                                                                                             
002ab2   0e01     MOVLW     0x1                                                                                             
002ab4   6fb1     MOVWF     0xb1,0x1                                                                                        
002ab6   d066     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           //Production test commands                                                       D:\work\midicontroller\x013x\rs232.c
                                           		case 150:		//NVR Write                                                         D:\work\midicontroller\x013x\rs232.c
002ab8   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002aba   0e02     MOVLW     0x2                                                                                             
002abc   6fb1     MOVWF     0xb1,0x1                                                                                        
002abe   a8a0     BTFSS     0xa0,0x4,0x0   			if (1 && !PIE2bits.EEIE) {                                                    D:\work\midicontroller\x013x\rs232.c
                                           //				DISABLE_ALL_INTERRUPTS();                                                  D:\work\midicontroller\x013x\rs232.c
                                           //				EECounterB = 1;						//Number of bytes to write.                           D:\work\midicontroller\x013x\rs232.c
                                           //				EEAddress = NVRCommAddr.b_form.low;	//EEPROM register starting address byte. D:\work\midicontroller\x013x\rs232.c
                                           //				EEData = RcvPtr[0];					//First byte of data to write.                     D:\work\midicontroller\x013x\rs232.c
                                           //diag disable ee_page_write                                                     D:\work\midicontroller\x013x\rs232.c
                                           //				EE_PAGE_WRITE();                                                           D:\work\midicontroller\x013x\rs232.c
                                           //				ENABLE_ALL_INTERRUPTS();                                                   D:\work\midicontroller\x013x\rs232.c
                                           			}                                                                             D:\work\midicontroller\x013x\rs232.c
002ac0   d002     BRA       0x2ac6         			else ResponseType = COMMAND_REJECTED;                                         D:\work\midicontroller\x013x\rs232.c
002ac2   0e01     MOVLW     0x1                                                                                             
002ac4   6fb1     MOVWF     0xb1,0x1                                                                                        
002ac6   d05e     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           			                                                                              D:\work\midicontroller\x013x\rs232.c
                                           		case 151:		//NVR Address                                                       D:\work\midicontroller\x013x\rs232.c
002ac8   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002aca   0e02     MOVLW     0x2                                                                                             
002acc   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           			if (1) {                                                                      D:\work\midicontroller\x013x\rs232.c
002ace   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.low = RcvPtr[0];		//low byte                              D:\work\midicontroller\x013x\rs232.c
002ad0   ffe9                                                                                                               
002ad2   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002ad4   ffea                                                                                                               
002ad6   cfef     MOVFF     0xfef,0xb2                                                                                      
002ad8   f0b2                                                                                                               
002ada   cfde     MOVFF     0xfde,0xfe9    				NVRCommAddr.b_form.high = RcvPtr[1];	//high byte                             D:\work\midicontroller\x013x\rs232.c
002adc   ffe9                                                                                                               
002ade   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002ae0   ffea                                                                                                               
002ae2   0e01     MOVLW     0x1                                                                                             
002ae4   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002ae6   0e00     MOVLW     0x0                                                                                             
002ae8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002aea   cfef     MOVFF     0xfef,0xb3                                                                                      
002aec   f0b3                                                                                                               
                                           			}                                                                             D:\work\midicontroller\x013x\rs232.c
002aee   d003     BRA       0x2af6         			else ResponseType = COMMAND_REJECTED;                                         D:\work\midicontroller\x013x\rs232.c
002af0   0100     MOVLB     0x0                                                                                             
002af2   0e01     MOVLW     0x1                                                                                             
002af4   6fb1     MOVWF     0xb1,0x1                                                                                        
002af6   d046     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		case 152:		//RAM Write                                                         D:\work\midicontroller\x013x\rs232.c
002af8   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002afa   0e02     MOVLW     0x2                                                                                             
002afc   6fb1     MOVWF     0xb1,0x1                                                                                        
002afe   cfde     MOVFF     0xfde,0xfe9    			*(far unsigned char *)RAMCommAddr.s_form = RcvPtr[0];                         D:\work\midicontroller\x013x\rs232.c
002b00   ffe9                                                                                                               
002b02   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002b04   ffea                                                                                                               
002b06   50ef     MOVF      0xef,0x0,0x0                                                                                    
002b08   c0b4     MOVFF     0xb4,0xfe9                                                                                      
002b0a   ffe9                                                                                                               
002b0c   c0b5     MOVFF     0xb5,0xfea                                                                                      
002b0e   ffea                                                                                                               
002b10   6eef     MOVWF     0xef,0x0                                                                                        
002b12   d038     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           		case 153:		//RAM Address                                                       D:\work\midicontroller\x013x\rs232.c
002b14   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002b16   0e02     MOVLW     0x2                                                                                             
002b18   6fb1     MOVWF     0xb1,0x1                                                                                        
002b1a   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.low = RcvPtr[0];		//low byte                               D:\work\midicontroller\x013x\rs232.c
002b1c   ffe9                                                                                                               
002b1e   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002b20   ffea                                                                                                               
002b22   cfef     MOVFF     0xfef,0xb4                                                                                      
002b24   f0b4                                                                                                               
002b26   cfde     MOVFF     0xfde,0xfe9    			RAMCommAddr.b_form.high = RcvPtr[1];	//high byte                              D:\work\midicontroller\x013x\rs232.c
002b28   ffe9                                                                                                               
002b2a   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002b2c   ffea                                                                                                               
002b2e   0e01     MOVLW     0x1                                                                                             
002b30   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002b32   0e00     MOVLW     0x0                                                                                             
002b34   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002b36   cfef     MOVFF     0xfef,0xb5                                                                                      
002b38   f0b5                                                                                                               
002b3a   d024     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		case 154:		//Password write (starting with low byte)                           D:\work\midicontroller\x013x\rs232.c
002b3c   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002b3e   0e02     MOVLW     0x2                                                                                             
002b40   6fb1     MOVWF     0xb1,0x1                                                                                        
002b42   d020     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		case 156:		//ROM Write (not supported)                                         D:\work\midicontroller\x013x\rs232.c
                                           //Writing a single byte is not supported by the chip.                            D:\work\midicontroller\x013x\rs232.c
002b44   0100     MOVLB     0x0            			ResponseType = COMMAND_REJECTED;                                              D:\work\midicontroller\x013x\rs232.c
002b46   0e01     MOVLW     0x1                                                                                             
002b48   6fb1     MOVWF     0xb1,0x1                                                                                        
002b4a   d01c     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           		case 157:		//ROM Address                                                       D:\work\midicontroller\x013x\rs232.c
002b4c   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002b4e   0e02     MOVLW     0x2                                                                                             
002b50   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           			if (1) {                                                                      D:\work\midicontroller\x013x\rs232.c
002b52   cfde     MOVFF     0xfde,0xfe9    				ROMCommAddr.b_form.low = RcvPtr[0];		//low byte                              D:\work\midicontroller\x013x\rs232.c
002b54   ffe9                                                                                                               
002b56   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002b58   ffea                                                                                                               
002b5a   cfef     MOVFF     0xfef,0xb6                                                                                      
002b5c   f0b6                                                                                                               
002b5e   cfde     MOVFF     0xfde,0xfe9    				ROMCommAddr.b_form.high = RcvPtr[1];	//high byte                             D:\work\midicontroller\x013x\rs232.c
002b60   ffe9                                                                                                               
002b62   cfdd     MOVFF     0xfdd,0xfea                                                                                     
002b64   ffea                                                                                                               
002b66   0e01     MOVLW     0x1                                                                                             
002b68   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002b6a   0e00     MOVLW     0x0                                                                                             
002b6c   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002b6e   cfef     MOVFF     0xfef,0xb7                                                                                      
002b70   f0b7                                                                                                               
                                           			}                                                                             D:\work\midicontroller\x013x\rs232.c
002b72   d003     BRA       0x2b7a         			else ResponseType = COMMAND_REJECTED;                                         D:\work\midicontroller\x013x\rs232.c
002b74   0100     MOVLB     0x0                                                                                             
002b76   0e01     MOVLW     0x1                                                                                             
002b78   6fb1     MOVWF     0xb1,0x1                                                                                        
002b7a   d004     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           		case 180:		//NVR Page Write                                                    D:\work\midicontroller\x013x\rs232.c
002b7c   0100     MOVLB     0x0            			ResponseType = COMMAND_ACCEPTED;                                              D:\work\midicontroller\x013x\rs232.c
002b7e   0e02     MOVLW     0x2                                                                                             
002b80   6fb1     MOVWF     0xb1,0x1                                                                                        
                                           //diag.. disable ee_page_write                                                   D:\work\midicontroller\x013x\rs232.c
002b82   d000     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		default:                                                                       D:\work\midicontroller\x013x\rs232.c
002a94   d077     BRA       0x2b84         			break;                                                                        D:\work\midicontroller\x013x\rs232.c
                                           		}                                                                              D:\work\midicontroller\x013x\rs232.c
                                           	}                                                                               D:\work\midicontroller\x013x\rs232.c
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
002b84   0eff     MOVLW     0xff           	if (ResponseType == INVALID_REQUEST) return;                                    D:\work\midicontroller\x013x\rs232.c
002b86   0100     MOVLB     0x0                                                                                             
002b88   5db1     SUBWF     0xb1,0x0,0x1                                                                                    
002b8a   e101     BNZ       0x2b8e                                                                                          
002b8c   d00d     BRA       0x2ba8                                                                                          
                                           //no response or ack?                                                            D:\work\midicontroller\x013x\rs232.c
002b8e   0e09     MOVLW     0x9            	if (SetupPkt.bRequest == SET_REPORT) return;		//no response to set_report       D:\work\midicontroller\x013x\rs232.c
002b90   0104     MOVLB     0x4                                                                                             
002b92   5d11     SUBWF     0x11,0x0,0x1                                                                                    
002b94   e101     BNZ       0x2b98                                                                                          
002b96   d008     BRA       0x2ba8                                                                                          
                                           	                                                                                D:\work\midicontroller\x013x\rs232.c
                                           //USB query setup data:                                                          D:\work\midicontroller\x013x\rs232.c
002b98   c412     MOVFF     0x412,0x450    	CtrlTrfData._byte[0] = SetupPkt._byte[2];                                       D:\work\midicontroller\x013x\rs232.c
002b9a   f450                                                                                                               
002b9c   0100     MOVLB     0x0            	wCount._word = USBDataPointer;		//Calculate number of bytes to send             D:\work\midicontroller\x013x\rs232.c
002b9e   5170     MOVF      0x70,0x0,0x1                                                                                    
002ba0   0101     MOVLB     0x1                                                                                             
002ba2   6f50     MOVWF     0x50,0x1                                                                                        
002ba4   6b51     CLRF      0x51,0x1                                                                                        
002ba6   d000     BRA       0x2ba8         	return;                                                                         D:\work\midicontroller\x013x\rs232.c
002ba8   0e11     MOVLW     0x11           }                                                                                D:\work\midicontroller\x013x\rs232.c
002baa   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002bac   e202     BC        0x2bb2                                                                                          
002bae   6ae1     CLRF      0xe1,0x0                                                                                        
002bb0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002bb2   6ee1     MOVWF     0xe1,0x0                                                                                        
002bb4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002bb6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002bb8   ffd9                                                                                                               
002bba   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\rs232.c
                                           //-----------------------------------------------------------------------        D:\work\midicontroller\x013x\rs232.c
                                           //This routine will store a character into the TxBuffer.                         D:\work\midicontroller\x013x\rs232.c
002bbc   cfd9     MOVFF     0xfd9,0xfe6    void	TXENQ(unsigned char Input) {                                                D:\work\midicontroller\x013x\rs232.c
002bbe   ffe6                                                                                                               
002bc0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002bc2   ffd9                                                                                                               
                                           	//USB Query                                                                     D:\work\midicontroller\x013x\rs232.c
002bc4   0e40     MOVLW     0x40           	if (USBDataPointer >= 64) return;		//Exit if buffer full.                       D:\work\midicontroller\x013x\rs232.c
002bc6   0100     MOVLB     0x0                                                                                             
002bc8   5d70     SUBWF     0x70,0x0,0x1                                                                                    
002bca   e301     BNC       0x2bce                                                                                          
002bcc   d00a     BRA       0x2be2                                                                                          
002bce   5170     MOVF      0x70,0x0,0x1   	CtrlTrfData._byte[USBDataPointer] = Input;                                      D:\work\midicontroller\x013x\rs232.c
002bd0   6aea     CLRF      0xea,0x0                                                                                        
002bd2   0f50     ADDLW     0x50                                                                                            
002bd4   6ee9     MOVWF     0xe9,0x0                                                                                        
002bd6   0e04     MOVLW     0x4                                                                                             
002bd8   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002bda   0efe     MOVLW     0xfe                                                                                            
002bdc   cfdb     MOVFF     0xfdb,0xfef                                                                                     
002bde   ffef                                                                                                               
002be0   2b70     INCF      0x70,0x1,0x1   	USBDataPointer++;                                                               D:\work\midicontroller\x013x\rs232.c
002be2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\rs232.c
002be4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002be6   ffd9                                                                                                               
002be8   0012     RETURN    0x0                                                                                             
                                           //-----------------------------------------------------------------------        D:\work\midicontroller\x013x\rs232.c
                                           /*********************************************************************           D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            *             Microchip USB C18 Firmware -  HID Version 1.0                     D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            *********************************************************************           D:\work\midicontroller\x013x\hid.c
                                            * FileName:        hid.c                                                        D:\work\midicontroller\x013x\hid.c
                                            * Dependencies:    See INCLUDES section below                                   D:\work\midicontroller\x013x\hid.c
                                            * Processor:       PIC18                                                        D:\work\midicontroller\x013x\hid.c
                                            * Compiler:        C18 2.30.01+                                                 D:\work\midicontroller\x013x\hid.c
                                            * Company:         Microchip Technology, Inc.                                   D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Software License Agreement                                                    D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * The software supplied herewith by Microchip Technology Incorporated           D:\work\midicontroller\x013x\hid.c
                                            * (the “Company”) for its PICmicro® Microcontroller is intended and             D:\work\midicontroller\x013x\hid.c
                                            * supplied to you, the Company’s customer, for use solely and                   D:\work\midicontroller\x013x\hid.c
                                            * exclusively on Microchip PICmicro Microcontroller products. The               D:\work\midicontroller\x013x\hid.c
                                            * software is owned by the Company and/or its supplier, and is                  D:\work\midicontroller\x013x\hid.c
                                            * protected under applicable copyright laws. All rights are reserved.           D:\work\midicontroller\x013x\hid.c
                                            * Any use in violation of the foregoing restrictions may subject the            D:\work\midicontroller\x013x\hid.c
                                            * user to criminal sanctions under applicable laws, as well as to               D:\work\midicontroller\x013x\hid.c
                                            * civil liability for the breach of the terms and conditions of this            D:\work\midicontroller\x013x\hid.c
                                            * license.                                                                      D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,             D:\work\midicontroller\x013x\hid.c
                                            * WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED             D:\work\midicontroller\x013x\hid.c
                                            * TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A                   D:\work\midicontroller\x013x\hid.c
                                            * PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,             D:\work\midicontroller\x013x\hid.c
                                            * IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR                    D:\work\midicontroller\x013x\hid.c
                                            * CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.                             D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Author               Date        Comment                                      D:\work\midicontroller\x013x\hid.c
                                            *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~           D:\work\midicontroller\x013x\hid.c
                                            * Rawin Rojvanit       11/19/04    Original.                                    D:\work\midicontroller\x013x\hid.c
                                            ********************************************************************/           D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** I N C L U D E S **********************************************************/  D:\work\midicontroller\x013x\hid.c
                                           #include "p18f4455.h"                                                            D:\work\midicontroller\x013x\hid.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\hid.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\hid.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           #ifdef USB_USE_HID                                                               D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** P R I V A T E  P R O T O T Y P E S ***************************************/  D:\work\midicontroller\x013x\hid.c
                                           void HIDGetReportHandler(void);                                                  D:\work\midicontroller\x013x\hid.c
                                           void HIDSetReportHandler(void);                                                  D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** V A R I A B L E S ********************************************************/  D:\work\midicontroller\x013x\hid.c
                                           #pragma udata usb5                                                               D:\work\midicontroller\x013x\hid.c
                                           byte idle_rate;                                                                  D:\work\midicontroller\x013x\hid.c
                                           byte active_protocol;               // [0] Boot Protocol [1] Report Protocol     D:\work\midicontroller\x013x\hid.c
                                           byte hid_rpt_rx_len;                                                             D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** D E C L A R A T I O N S **************************************************/  D:\work\midicontroller\x013x\hid.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** C L A S S  S P E C I F I C  R E Q ****************************************/  D:\work\midicontroller\x013x\hid.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\hid.c
                                            * Function:        void USBCheckHIDRequest(void)                                D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Overview:        This routine checks the setup data packet to see if it       D:\work\midicontroller\x013x\hid.c
                                            *                  knows how to handle it                                       D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\hid.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\hid.c
                                           void USBCheckHIDRequest(void)                                                    D:\work\midicontroller\x013x\hid.c
                                           {                                                                                D:\work\midicontroller\x013x\hid.c
003122   0104     MOVLB     0x4                if(SetupPkt.Recipient != RCPT_INTF) return;                                  D:\work\midicontroller\x013x\hid.c
003124   5110     MOVF      0x10,0x0,0x1                                                                                    
003126   0b1f     ANDLW     0x1f                                                                                            
003128   0801     SUBLW     0x1                                                                                             
00312a   e001     BZ        0x312e                                                                                          
00312c   d086     BRA       0x323a                                                                                          
00312e   5114     MOVF      0x14,0x0,0x1       if(SetupPkt.bIntfID != HID_INTF_ID) return;                                  D:\work\midicontroller\x013x\hid.c
003130   e001     BZ        0x3134                                                                                          
003132   d083     BRA       0x323a                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                               /*                                                                           D:\work\midicontroller\x013x\hid.c
                                                * There are two standard requests that hid.c may support.                   D:\work\midicontroller\x013x\hid.c
                                                * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      D:\work\midicontroller\x013x\hid.c
                                                * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);                                      D:\work\midicontroller\x013x\hid.c
                                                */                                                                          D:\work\midicontroller\x013x\hid.c
003134   0e06     MOVLW     0x6                if(SetupPkt.bRequest == GET_DSC)                                             D:\work\midicontroller\x013x\hid.c
003136   5d11     SUBWF     0x11,0x0,0x1                                                                                    
003138   e12e     BNZ       0x3196                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\hid.c
00313a   5113     MOVF      0x13,0x0,0x1           switch(SetupPkt.bDscType)                                                D:\work\midicontroller\x013x\hid.c
00313c   0a23     XORLW     0x23                                                                                            
00313e   e028     BZ        0x3190                                                                                          
003140   0a01     XORLW     0x1                                                                                             
003142   e013     BZ        0x316a                                                                                          
003144   0a03     XORLW     0x3                                                                                             
003146   e001     BZ        0x314a                                                                                          
003148   d024     BRA       0x3192                                                                                          
                                                   {                                                                        D:\work\midicontroller\x013x\hid.c
                                                       case DSC_HID:                                                        D:\work\midicontroller\x013x\hid.c
00314a   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               D:\work\midicontroller\x013x\hid.c
00314c   0e02     MOVLW     0x2                                                                                             
00314e   6f4b     MOVWF     0x4b,0x1                                                                                        
003150   0101     MOVLB     0x1                            mUSBGetHIDDscAdr(pSrc.bRom);        // See usbcfg.h              D:\work\midicontroller\x013x\hid.c
003152   0548     DECF      0x48,0x0,0x1                                                                                    
003154   e105     BNZ       0x3160                                                                                          
003156   0101     MOVLB     0x1                                                                                             
003158   0e80     MOVLW     0x80                                                                                            
00315a   6f4c     MOVWF     0x4c,0x1                                                                                        
00315c   0e33     MOVLW     0x33                                                                                            
00315e   6f4d     MOVWF     0x4d,0x1                                                                                        
003160   0e09     MOVLW     0x9                            wCount._word = sizeof(USB_HID_DSC);                              D:\work\midicontroller\x013x\hid.c
003162   0101     MOVLB     0x1                                                                                             
003164   6f50     MOVWF     0x50,0x1                                                                                        
003166   6b51     CLRF      0x51,0x1                                                                                        
003168   d014     BRA       0x3192                         break;                                                           D:\work\midicontroller\x013x\hid.c
                                                       case DSC_RPT:                                                        D:\work\midicontroller\x013x\hid.c
00316a   0101     MOVLB     0x1                            ctrl_trf_session_owner = MUID_HID;                               D:\work\midicontroller\x013x\hid.c
00316c   0e02     MOVLW     0x2                                                                                             
00316e   6f4b     MOVWF     0x4b,0x1                                                                                        
003170   0101     MOVLB     0x1                            mUSBGetHIDRptDscAdr(pSrc.bRom);     // See usbcfg.h              D:\work\midicontroller\x013x\hid.c
003172   0548     DECF      0x48,0x0,0x1                                                                                    
003174   e105     BNZ       0x3180                                                                                          
003176   0101     MOVLB     0x1                                                                                             
003178   0efa     MOVLW     0xfa                                                                                            
00317a   6f4c     MOVWF     0x4c,0x1                                                                                        
00317c   0e33     MOVLW     0x33                                                                                            
00317e   6f4d     MOVWF     0x4d,0x1                                                                                        
003180   0101     MOVLB     0x1                            mUSBGetHIDRptDscSize(wCount._word); // See usbcfg.h              D:\work\midicontroller\x013x\hid.c
003182   0548     DECF      0x48,0x0,0x1                                                                                    
003184   e104     BNZ       0x318e                                                                                          
003186   0e7c     MOVLW     0x7c                                                                                            
003188   0101     MOVLB     0x1                                                                                             
00318a   6f50     MOVWF     0x50,0x1                                                                                        
00318c   6b51     CLRF      0x51,0x1                                                                                        
00318e   d001     BRA       0x3192                         break;                                                           D:\work\midicontroller\x013x\hid.c
                                                       case DSC_PHY:                                                        D:\work\midicontroller\x013x\hid.c
                                                           // ctrl_trf_session_owner = MUID_HID;                            D:\work\midicontroller\x013x\hid.c
003190   d000     BRA       0x3192                         break;                                                           D:\work\midicontroller\x013x\hid.c
                                                   }//end switch(SetupPkt.bDscType)                                         D:\work\midicontroller\x013x\hid.c
003192   0101     MOVLB     0x1                    usb_stat.ctrl_trf_mem = _ROM;                                            D:\work\midicontroller\x013x\hid.c
003194   8347     BSF       0x47,0x1,0x1                                                                                    
                                               }//end if(SetupPkt.bRequest == GET_DSC)                                      D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
003196   0104     MOVLB     0x4                if(SetupPkt.RequestType != CLASS) return;                                    D:\work\midicontroller\x013x\hid.c
003198   5110     MOVF      0x10,0x0,0x1                                                                                    
00319a   0b60     ANDLW     0x60                                                                                            
00319c   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
00319e   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0031a0   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0031a2   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0031a4   42e8     RRNCF     0xe8,0x1,0x0                                                                                    
0031a6   0801     SUBLW     0x1                                                                                             
0031a8   e001     BZ        0x31ac                                                                                          
0031aa   d047     BRA       0x323a                                                                                          
0031ac   5111     MOVF      0x11,0x0,0x1       switch(SetupPkt.bRequest)                                                    D:\work\midicontroller\x013x\hid.c
0031ae   0a0b     XORLW     0xb                                                                                             
0031b0   e03e     BZ        0x322e                                                                                          
0031b2   0a08     XORLW     0x8                                                                                             
0031b4   e02e     BZ        0x3212                                                                                          
0031b6   0a09     XORLW     0x9                                                                                             
0031b8   e026     BZ        0x3206                                                                                          
0031ba   0a08     XORLW     0x8                                                                                             
0031bc   e016     BZ        0x31ea                                                                                          
0031be   0a0b     XORLW     0xb                                                                                             
0031c0   e006     BZ        0x31ce                                                                                          
0031c2   0a08     XORLW     0x8                                                                                             
0031c4   e001     BZ        0x31c8                                                                                          
0031c6   d039     BRA       0x323a                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\hid.c
                                                   case GET_REPORT:                                                         D:\work\midicontroller\x013x\hid.c
0031c8   ec78     CALL      0x2ef0,0x0                 HIDGetReportHandler();                                               D:\work\midicontroller\x013x\hid.c
0031ca   f017                                                                                                               
0031cc   d036     BRA       0x323a                     break;                                                               D:\work\midicontroller\x013x\hid.c
                                                   case SET_REPORT:                                                         D:\work\midicontroller\x013x\hid.c
                                           //            HIDSetReportHandler();      //2/8/05 JD this was not at the right location. D:\work\midicontroller\x013x\hid.c
0031ce   0101     MOVLB     0x1            			pDst.bRam = (byte*)&USBEP0DataInBuffer;	//Set destination for report data.    D:\work\midicontroller\x013x\hid.c
0031d0   0e71     MOVLW     0x71                                                                                            
0031d2   6f4e     MOVWF     0x4e,0x1                                                                                        
0031d4   0e00     MOVLW     0x0                                                                                             
0031d6   6f4f     MOVWF     0x4f,0x1                                                                                        
0031d8   0101     MOVLB     0x1            			usb_stat.ctrl_trf_mem = _RAM;		//Set memory type                              D:\work\midicontroller\x013x\hid.c
0031da   9347     BCF       0x47,0x1,0x1                                                                                    
0031dc   0101     MOVLB     0x1            			wCount._word = 0;					//reset counter                                         D:\work\midicontroller\x013x\hid.c
0031de   6b50     CLRF      0x50,0x1                                                                                        
0031e0   6b51     CLRF      0x51,0x1                                                                                        
0031e2   0101     MOVLB     0x1            			ctrl_trf_session_owner = MUID_HID;  //set owner to HID, service this when we have some data..	 D:\work\midicontroller\x013x\hid.c
0031e4   0e02     MOVLW     0x2                                                                                             
0031e6   6f4b     MOVWF     0x4b,0x1                                                                                        
0031e8   d028     BRA       0x323a                     break;                                                               D:\work\midicontroller\x013x\hid.c
                                                   case GET_IDLE:                                                           D:\work\midicontroller\x013x\hid.c
0031ea   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   D:\work\midicontroller\x013x\hid.c
0031ec   0e02     MOVLW     0x2                                                                                             
0031ee   6f4b     MOVWF     0x4b,0x1                                                                                        
0031f0   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&idle_rate;      // Set source                    D:\work\midicontroller\x013x\hid.c
0031f2   0e54     MOVLW     0x54                                                                                            
0031f4   6f4c     MOVWF     0x4c,0x1                                                                                        
0031f6   0e01     MOVLW     0x1                                                                                             
0031f8   6f4d     MOVWF     0x4d,0x1                                                                                        
0031fa   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               D:\work\midicontroller\x013x\hid.c
0031fc   9347     BCF       0x47,0x1,0x1                                                                                    
0031fe   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                D:\work\midicontroller\x013x\hid.c
003200   0e01     MOVLW     0x1                                                                                             
003202   6f50     MOVWF     0x50,0x1                                                                                        
003204   d01a     BRA       0x323a                     break;                                                               D:\work\midicontroller\x013x\hid.c
                                                   case SET_IDLE:                                                           D:\work\midicontroller\x013x\hid.c
003206   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   D:\work\midicontroller\x013x\hid.c
003208   0e02     MOVLW     0x2                                                                                             
00320a   6f4b     MOVWF     0x4b,0x1                                                                                        
00320c   c413     MOVFF     0x413,0x154                idle_rate = MSB(SetupPkt.W_Value);                                   D:\work\midicontroller\x013x\hid.c
00320e   f154                                                                                                               
003210   d014     BRA       0x323a                     break;                                                               D:\work\midicontroller\x013x\hid.c
                                                   case GET_PROTOCOL:                                                       D:\work\midicontroller\x013x\hid.c
003212   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   D:\work\midicontroller\x013x\hid.c
003214   0e02     MOVLW     0x2                                                                                             
003216   6f4b     MOVWF     0x4b,0x1                                                                                        
003218   0101     MOVLB     0x1                        pSrc.bRam = (byte*)&active_protocol;// Set source                    D:\work\midicontroller\x013x\hid.c
00321a   0e55     MOVLW     0x55                                                                                            
00321c   6f4c     MOVWF     0x4c,0x1                                                                                        
00321e   0e01     MOVLW     0x1                                                                                             
003220   6f4d     MOVWF     0x4d,0x1                                                                                        
003222   0101     MOVLB     0x1                        usb_stat.ctrl_trf_mem = _RAM;       // Set memory type               D:\work\midicontroller\x013x\hid.c
003224   9347     BCF       0x47,0x1,0x1                                                                                    
003226   0101     MOVLB     0x1                        LSB(wCount) = 1;                    // Set data count                D:\work\midicontroller\x013x\hid.c
003228   0e01     MOVLW     0x1                                                                                             
00322a   6f50     MOVWF     0x50,0x1                                                                                        
00322c   d006     BRA       0x323a                     break;                                                               D:\work\midicontroller\x013x\hid.c
                                                   case SET_PROTOCOL:                                                       D:\work\midicontroller\x013x\hid.c
00322e   0101     MOVLB     0x1                        ctrl_trf_session_owner = MUID_HID;                                   D:\work\midicontroller\x013x\hid.c
003230   0e02     MOVLW     0x2                                                                                             
003232   6f4b     MOVWF     0x4b,0x1                                                                                        
003234   c412     MOVFF     0x412,0x155                active_protocol = LSB(SetupPkt.W_Value);                             D:\work\midicontroller\x013x\hid.c
003236   f155                                                                                                               
003238   d000     BRA       0x323a                     break;                                                               D:\work\midicontroller\x013x\hid.c
                                               }//end switch(SetupPkt.bRequest)                                             D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
00323a   0012     RETURN    0x0            }//end USBCheckHIDRequest                                                        D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** U S E R  A P I ***********************************************************/  D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\hid.c
                                            * Function:        void HIDInitEP(void)                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * PreCondition:    None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Input:           None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Overview:        HIDInitEP initializes HID endpoints, buffer descriptors,     D:\work\midicontroller\x013x\hid.c
                                            *                  internal state-machine, and variables.                       D:\work\midicontroller\x013x\hid.c
                                            *                  It should be called after the USB host has sent out a        D:\work\midicontroller\x013x\hid.c
                                            *                  SET_CONFIGURATION request.                                   D:\work\midicontroller\x013x\hid.c
                                            *                  See USBStdSetCfgHandler() in usb9.c for examples.            D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\hid.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\hid.c
                                           void HIDInitEP(void)                                                             D:\work\midicontroller\x013x\hid.c
                                           {                                                                                D:\work\midicontroller\x013x\hid.c
00323c   0101     MOVLB     0x1                hid_rpt_rx_len =0;                                                           D:\work\midicontroller\x013x\hid.c
00323e   6b56     CLRF      0x56,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hid.c
003240   0e1e     MOVLW     0x1e               HID_UEP = EP_OUT_IN|HSHK_EN;                // Enable 2 data pipes           D:\work\midicontroller\x013x\hid.c
003242   6e71     MOVWF     0x71,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hid.c
003244   0104     MOVLB     0x4                HID_BD_OUT.Cnt = sizeof(hid_report_out);    // Set buffer size               D:\work\midicontroller\x013x\hid.c
003246   0e08     MOVLW     0x8                                                                                             
003248   6f09     MOVWF     0x9,0x1                                                                                         
00324a   0e90     MOVLW     0x90               HID_BD_OUT.ADR = (byte*)&hid_report_out;    // Set buffer address            D:\work\midicontroller\x013x\hid.c
00324c   6f0a     MOVWF     0xa,0x1                                                                                         
00324e   0e04     MOVLW     0x4                                                                                             
003250   6f0b     MOVWF     0xb,0x1                                                                                         
003252   0e88     MOVLW     0x88               HID_BD_OUT.Stat._byte = _USIE|_DAT0|_DTSEN; // Set status                    D:\work\midicontroller\x013x\hid.c
003254   6f08     MOVWF     0x8,0x1                                                                                         
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                               /*                                                                           D:\work\midicontroller\x013x\hid.c
                                                * Do not have to init Cnt of IN pipes here.                                 D:\work\midicontroller\x013x\hid.c
                                                * Reason:  Number of bytes to send to the host                              D:\work\midicontroller\x013x\hid.c
                                                *          varies from one transaction to                                   D:\work\midicontroller\x013x\hid.c
                                                *          another. Cnt should equal the exact                              D:\work\midicontroller\x013x\hid.c
                                                *          number of bytes to transmit for                                  D:\work\midicontroller\x013x\hid.c
                                                *          a given IN transaction.                                          D:\work\midicontroller\x013x\hid.c
                                                *          This number of bytes will only                                   D:\work\midicontroller\x013x\hid.c
                                                *          be known right before the data is                                D:\work\midicontroller\x013x\hid.c
                                                *          sent.                                                            D:\work\midicontroller\x013x\hid.c
                                                */                                                                          D:\work\midicontroller\x013x\hid.c
003256   0104     MOVLB     0x4                HID_BD_IN.ADR = (byte*)&hid_report_in;      // Set buffer address            D:\work\midicontroller\x013x\hid.c
003258   0e98     MOVLW     0x98                                                                                            
00325a   6f0e     MOVWF     0xe,0x1                                                                                         
00325c   0e04     MOVLW     0x4                                                                                             
00325e   6f0f     MOVWF     0xf,0x1                                                                                         
003260   0e40     MOVLW     0x40               HID_BD_IN.Stat._byte = _UCPU|_DAT1;         // Set status                    D:\work\midicontroller\x013x\hid.c
003262   6f0c     MOVWF     0xc,0x1                                                                                         
                                                                                                                            D:\work\midicontroller\x013x\hid.c
003264   0012     RETURN    0x0            }//end HIDInitEP                                                                 D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\hid.c
                                            * Function:        void HIDTxReport(char *buffer, byte len)                     D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * PreCondition:    mHIDTxIsBusy() must return false.                            D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            *                  Value of 'len' must be equal to or smaller than              D:\work\midicontroller\x013x\hid.c
                                            *                  HID_INT_IN_EP_SIZE                                           D:\work\midicontroller\x013x\hid.c
                                            *                  For an interrupt endpoint, the largest buffer size is        D:\work\midicontroller\x013x\hid.c
                                            *                  64 bytes.                                                    D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Input:           buffer  : Pointer to the starting location of data bytes     D:\work\midicontroller\x013x\hid.c
                                            *                  len     : Number of bytes to be transferred                  D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Output:          None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Side Effects:    None                                                         D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Overview:        Use this macro to transfer data located in data memory.      D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            *                  Remember: mHIDTxIsBusy() must return false before user       D:\work\midicontroller\x013x\hid.c
                                            *                  can call this function.                                      D:\work\midicontroller\x013x\hid.c
                                            *                  Unexpected behavior will occur if this function is called    D:\work\midicontroller\x013x\hid.c
                                            *                  when mHIDTxIsBusy() == 0                                     D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            *                  Typical Usage:                                               D:\work\midicontroller\x013x\hid.c
                                            *                  if(!mHIDTxIsBusy())                                          D:\work\midicontroller\x013x\hid.c
                                            *                      HIDTxReport(buffer, 3);                                  D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Note:            None                                                         D:\work\midicontroller\x013x\hid.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\hid.c
003266   cfd9     MOVFF     0xfd9,0xfe6    void HIDTxReport(char *buffer, byte len)                                         D:\work\midicontroller\x013x\hid.c
003268   ffe6                                                                                                               
00326a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00326c   ffd9                                                                                                               
00326e   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                D:\work\midicontroller\x013x\hid.c
                                           	byte i;                                                                         D:\work\midicontroller\x013x\hid.c
                                           	                                                                                D:\work\midicontroller\x013x\hid.c
                                               /*                                                                           D:\work\midicontroller\x013x\hid.c
                                                * Value of len should be equal to or smaller than HID_INT_IN_EP_SIZE.       D:\work\midicontroller\x013x\hid.c
                                                * This check forces the value of len to meet the precondition.              D:\work\midicontroller\x013x\hid.c
                                                */                                                                          D:\work\midicontroller\x013x\hid.c
003270   0efc     MOVLW     0xfc           	if(len > HID_INT_IN_EP_SIZE)                                                    D:\work\midicontroller\x013x\hid.c
003272   50db     MOVF      0xdb,0x0,0x0                                                                                    
003274   0808     SUBLW     0x8                                                                                             
003276   e205     BC        0x3282                                                                                          
003278   0e08     MOVLW     0x8            	    len = HID_INT_IN_EP_SIZE;                                                   D:\work\midicontroller\x013x\hid.c
00327a   6ef3     MOVWF     0xf3,0x0                                                                                        
00327c   0efc     MOVLW     0xfc                                                                                            
00327e   cff3     MOVFF     0xff3,0xfdb                                                                                     
003280   ffdb                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                              /*                                                                            D:\work\midicontroller\x013x\hid.c
                                               * Copy data from user's buffer to dual-ram buffer                            D:\work\midicontroller\x013x\hid.c
                                               */                                                                           D:\work\midicontroller\x013x\hid.c
003282   6adf     CLRF      0xdf,0x0           for (i = 0; i < len; i++)                                                    D:\work\midicontroller\x013x\hid.c
003284   0efc     MOVLW     0xfc                                                                                            
003286   50db     MOVF      0xdb,0x0,0x0                                                                                    
003288   5cdf     SUBWF     0xdf,0x0,0x0                                                                                    
00328a   e219     BC        0x32be                                                                                          
0032ba   2adf     INCF      0xdf,0x1,0x0                                                                                    
0032bc   d7e3     BRA       0x3284                                                                                          
00328c   50df     MOVF      0xdf,0x0,0x0       	hid_report_in[i] = buffer[i];                                               D:\work\midicontroller\x013x\hid.c
00328e   6ee7     MOVWF     0xe7,0x0                                                                                        
003290   0efd     MOVLW     0xfd                                                                                            
003292   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
003294   ffe9                                                                                                               
003296   0efe     MOVLW     0xfe                                                                                            
003298   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00329a   ffea                                                                                                               
00329c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00329e   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
0032a0   0e00     MOVLW     0x0                                                                                             
0032a2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0032a4   50ef     MOVF      0xef,0x0,0x0                                                                                    
0032a6   6ee6     MOVWF     0xe6,0x0                                                                                        
0032a8   50df     MOVF      0xdf,0x0,0x0                                                                                    
0032aa   6aea     CLRF      0xea,0x0                                                                                        
0032ac   0f98     ADDLW     0x98                                                                                            
0032ae   6ee9     MOVWF     0xe9,0x0                                                                                        
0032b0   0e04     MOVLW     0x4                                                                                             
0032b2   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0032b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0032b6   50e7     MOVF      0xe7,0x0,0x0                                                                                    
0032b8   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hid.c
0032be   0efc     MOVLW     0xfc               HID_BD_IN.Cnt = len;                                                         D:\work\midicontroller\x013x\hid.c
0032c0   cfdb     MOVFF     0xfdb,0x40d                                                                                     
0032c2   f40d                                                                                                               
0032c4   0e40     MOVLW     0x40               mUSBBufferReady(HID_BD_IN);                                                  D:\work\midicontroller\x013x\hid.c
0032c6   0104     MOVLB     0x4                                                                                             
0032c8   170c     ANDWF     0xc,0x1,0x1                                                                                     
0032ca   7d0c     BTG       0xc,0x6,0x1                                                                                     
0032cc   0e88     MOVLW     0x88                                                                                            
0032ce   130c     IORWF     0xc,0x1,0x1                                                                                     
                                                                                                                            D:\work\midicontroller\x013x\hid.c
0032d0   52e5     MOVF      0xe5,0x1,0x0   }//end HIDTxReport                                                               D:\work\midicontroller\x013x\hid.c
0032d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0032d4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0032d6   ffd9                                                                                                               
0032d8   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /******************************************************************************  D:\work\midicontroller\x013x\hid.c
                                            * Function:        byte HIDRxReport(char *buffer, byte len)                     D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * PreCondition:    Value of input argument 'len' should be smaller than the     D:\work\midicontroller\x013x\hid.c
                                            *                  maximum endpoint size responsible for receiving report       D:\work\midicontroller\x013x\hid.c
                                            *                  data from USB host for HID class.                            D:\work\midicontroller\x013x\hid.c
                                            *                  Input argument 'buffer' should point to a buffer area that   D:\work\midicontroller\x013x\hid.c
                                            *                  is bigger or equal to the size specified by 'len'.           D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Input:           buffer  : Pointer to where received bytes are to be stored   D:\work\midicontroller\x013x\hid.c
                                            *                  len     : The number of bytes expected.                      D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Output:          The number of bytes copied to buffer.                        D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Side Effects:    Publicly accessible variable hid_rpt_rx_len is updated       D:\work\midicontroller\x013x\hid.c
                                            *                  with the number of bytes copied to buffer.                   D:\work\midicontroller\x013x\hid.c
                                            *                  Once HIDRxReport is called, subsequent retrieval of          D:\work\midicontroller\x013x\hid.c
                                            *                  hid_rpt_rx_len can be done by calling macro                  D:\work\midicontroller\x013x\hid.c
                                            *                  mHIDGetRptRxLength().                                        D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Overview:        HIDRxReport copies a string of bytes received through        D:\work\midicontroller\x013x\hid.c
                                            *                  USB HID OUT endpoint to a user's specified location.         D:\work\midicontroller\x013x\hid.c
                                            *                  It is a non-blocking function. It does not wait              D:\work\midicontroller\x013x\hid.c
                                            *                  for data if there is no data available. Instead it returns   D:\work\midicontroller\x013x\hid.c
                                            *                  '0' to notify the caller that there is no data available.    D:\work\midicontroller\x013x\hid.c
                                            *                                                                               D:\work\midicontroller\x013x\hid.c
                                            * Note:            If the actual number of bytes received is larger than the    D:\work\midicontroller\x013x\hid.c
                                            *                  number of bytes expected (len), only the expected number     D:\work\midicontroller\x013x\hid.c
                                            *                  of bytes specified will be copied to buffer.                 D:\work\midicontroller\x013x\hid.c
                                            *                  If the actual number of bytes received is smaller than the   D:\work\midicontroller\x013x\hid.c
                                            *                  number of bytes expected (len), only the actual number       D:\work\midicontroller\x013x\hid.c
                                            *                  of bytes received will be copied to buffer.                  D:\work\midicontroller\x013x\hid.c
                                            *****************************************************************************/  D:\work\midicontroller\x013x\hid.c
0032da   cfd9     MOVFF     0xfd9,0xfe6    byte HIDRxReport(char *buffer, byte len)                                         D:\work\midicontroller\x013x\hid.c
0032dc   ffe6                                                                                                               
0032de   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0032e0   ffd9                                                                                                               
                                           {                                                                                D:\work\midicontroller\x013x\hid.c
0032e2   0101     MOVLB     0x1                hid_rpt_rx_len = 0;                                                          D:\work\midicontroller\x013x\hid.c
0032e4   6b56     CLRF      0x56,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hid.c
0032e6   0104     MOVLB     0x4                if(!mHIDRxIsBusy())                                                          D:\work\midicontroller\x013x\hid.c
0032e8   bf08     BTFSC     0x8,0x7,0x1                                                                                     
0032ea   d031     BRA       0x334e                                                                                          
                                               {                                                                            D:\work\midicontroller\x013x\hid.c
                                                   /*                                                                       D:\work\midicontroller\x013x\hid.c
                                                    * Adjust the expected number of bytes to equal                          D:\work\midicontroller\x013x\hid.c
                                                    * the actual number of bytes received.                                  D:\work\midicontroller\x013x\hid.c
                                                    */                                                                      D:\work\midicontroller\x013x\hid.c
0032ec   0efc     MOVLW     0xfc                   if(len > HID_BD_OUT.Cnt)                                                 D:\work\midicontroller\x013x\hid.c
0032ee   cfdb     MOVFF     0xfdb,0x10                                                                                      
0032f0   f010                                                                                                               
0032f2   5109     MOVF      0x9,0x0,0x1                                                                                     
0032f4   80d8     BSF       0xd8,0x0,0x0                                                                                    
0032f6   5410     SUBFWB    0x10,0x0,0x0                                                                                    
0032f8   e203     BC        0x3300                                                                                          
0032fa   0efc     MOVLW     0xfc                       len = HID_BD_OUT.Cnt;                                                D:\work\midicontroller\x013x\hid.c
0032fc   c409     MOVFF     0x409,0xfdb                                                                                     
0032fe   ffdb                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                                   /*                                                                       D:\work\midicontroller\x013x\hid.c
                                                    * Copy data from dual-ram buffer to user's buffer                       D:\work\midicontroller\x013x\hid.c
                                                    */                                                                      D:\work\midicontroller\x013x\hid.c
003300   0101     MOVLB     0x1                    for(hid_rpt_rx_len = 0; hid_rpt_rx_len < len; hid_rpt_rx_len++)          D:\work\midicontroller\x013x\hid.c
003302   6b56     CLRF      0x56,0x1                                                                                        
003304   0efc     MOVLW     0xfc                                                                                            
003306   50db     MOVF      0xdb,0x0,0x0                                                                                    
003308   5d56     SUBWF     0x56,0x0,0x1                                                                                    
00330a   e219     BC        0x333e                                                                                          
00333a   2b56     INCF      0x56,0x1,0x1                                                                                    
00333c   d7e3     BRA       0x3304                                                                                          
00330c   5156     MOVF      0x56,0x0,0x1               buffer[hid_rpt_rx_len] = hid_report_out[hid_rpt_rx_len];             D:\work\midicontroller\x013x\hid.c
00330e   6aea     CLRF      0xea,0x0                                                                                        
003310   0f90     ADDLW     0x90                                                                                            
003312   6ee9     MOVWF     0xe9,0x0                                                                                        
003314   0e04     MOVLW     0x4                                                                                             
003316   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003318   50ef     MOVF      0xef,0x0,0x0                                                                                    
00331a   6ee6     MOVWF     0xe6,0x0                                                                                        
00331c   5156     MOVF      0x56,0x0,0x1                                                                                    
00331e   6ee7     MOVWF     0xe7,0x0                                                                                        
003320   0efd     MOVLW     0xfd                                                                                            
003322   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
003324   ffe9                                                                                                               
003326   0efe     MOVLW     0xfe                                                                                            
003328   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00332a   ffea                                                                                                               
00332c   50e7     MOVF      0xe7,0x0,0x0                                                                                    
00332e   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
003330   0e00     MOVLW     0x0                                                                                             
003332   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
003334   52e5     MOVF      0xe5,0x1,0x0                                                                                    
003336   50e7     MOVF      0xe7,0x0,0x0                                                                                    
003338   6eef     MOVWF     0xef,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                                   /*                                                                       D:\work\midicontroller\x013x\hid.c
                                                    * Prepare dual-ram buffer for next OUT transaction                      D:\work\midicontroller\x013x\hid.c
                                                    */                                                                      D:\work\midicontroller\x013x\hid.c
00333e   0104     MOVLB     0x4                    HID_BD_OUT.Cnt = sizeof(hid_report_out);                                 D:\work\midicontroller\x013x\hid.c
003340   0e08     MOVLW     0x8                                                                                             
003342   6f09     MOVWF     0x9,0x1                                                                                         
003344   0e40     MOVLW     0x40                   mUSBBufferReady(HID_BD_OUT);                                             D:\work\midicontroller\x013x\hid.c
003346   1708     ANDWF     0x8,0x1,0x1                                                                                     
003348   7d08     BTG       0x8,0x6,0x1                                                                                     
00334a   0e88     MOVLW     0x88                                                                                            
00334c   1308     IORWF     0x8,0x1,0x1                                                                                     
                                               }//end if                                                                    D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
00334e   0101     MOVLB     0x1                return hid_rpt_rx_len;                                                       D:\work\midicontroller\x013x\hid.c
003350   5156     MOVF      0x56,0x0,0x1                                                                                    
003352   d000     BRA       0x3354                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hid.c
003354   52e5     MOVF      0xe5,0x1,0x0   }//end HIDRxReport                                                               D:\work\midicontroller\x013x\hid.c
003356   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
003358   ffd9                                                                                                               
00335a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           #endif //def USB_USE_HID                                                         D:\work\midicontroller\x013x\hid.c
                                                                                                                            D:\work\midicontroller\x013x\hid.c
                                           /** EOF hid.c ***************************************************************/   D:\work\midicontroller\x013x\hid.c
                                           //This file contains the global ram definitions for the project                  D:\work\midicontroller\x013x\ram_def.c
                                           #include	"c_system.h"                                                            D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           //----------------------------Main variables---------------------------------------- D:\work\midicontroller\x013x\ram_def.c
                                           TwoBytes NVRCommAddr;                                                            D:\work\midicontroller\x013x\ram_def.c
                                           TwoBytes RAMCommAddr;                                                            D:\work\midicontroller\x013x\ram_def.c
                                           TwoBytes ROMCommAddr;                                                            D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           BitField	CommFlags1;                                                             D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char WpmCounter;                                                        D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char WpmCounter1;                                                       D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char ProgmemBuffer[64];                                                 D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           #pragma udata RamData                                                            D:\work\midicontroller\x013x\ram_def.c
                                           BitField ArbFlags1;                                                              D:\work\midicontroller\x013x\ram_def.c
                                           BitField MiscFlags1;                                                             D:\work\midicontroller\x013x\ram_def.c
                                           BitField DispSegData[5];                                                         D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char DispNumOfCommons;                                                  D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char LedStates;			//footswitch leds                                     D:\work\midicontroller\x013x\ram_def.c
                                           unsigned long	ButtonState;                                                       D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char ExpPedalInst;                                                      D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           TwoBytes ExpPedalAvg;                                                            D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           //----------------------------USB stuff----------------------------------        D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char USBDataPointer;                                                    D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char USBEP0DataInBuffer[64];                                            D:\work\midicontroller\x013x\ram_def.c
                                           unsigned char ResponseType;                                                      D:\work\midicontroller\x013x\ram_def.c
                                                                                                                            D:\work\midicontroller\x013x\ram_def.c
                                           ;###########################################################################     D:\work\midicontroller\x013x\config.asm
                                           ;#			Author: Joe Dunne				  #                                                    D:\work\midicontroller\x013x\config.asm
                                           ;#			Date 4/06/07					  #                                                        D:\work\midicontroller\x013x\config.asm
                                           ;#			Main arbitrator					  #                                                     D:\work\midicontroller\x013x\config.asm
                                           ;#			File Name: config.asm  				  #                                              D:\work\midicontroller\x013x\config.asm
                                           ;#									  #                                                                   D:\work\midicontroller\x013x\config.asm
                                           ;############################################################################    D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           	ERRORLEVEL -208, -216                                                           D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           	LIST R=DEC                                                                      D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           	INCLUDE "a_MICRDEF.INC"                                                         D:\work\midicontroller\x013x\config.asm
                                                   LIST                                                                     D:\work\midicontroller\x013x\a_MICRDEF.INC
                                                                                                                            D:\work\midicontroller\x013x\a_MICRDEF.INC
                                           ;==========================================================================      D:\work\midicontroller\x013x\a_MICRDEF.INC
                                           ;  $Id: P18F4550.INC,v 1.7 2004/10/06 13:56:45 curtiss Exp $                     D:\work\midicontroller\x013x\a_MICRDEF.INC
                                           ;  MPASM PIC18F4550 processor include                                            D:\work\midicontroller\x013x\a_MICRDEF.INC
                                           ;                                                                                D:\work\midicontroller\x013x\a_MICRDEF.INC
                                           ;  (c) Copyright 1999-2004 Microchip Technology, All rights reserved             D:\work\midicontroller\x013x\a_MICRDEF.INC
                                           ;==========================================================================      D:\work\midicontroller\x013x\a_MICRDEF.INC
                                                                                                                            D:\work\midicontroller\x013x\a_MICRDEF.INC
                                                   LIST                                                                     D:\work\midicontroller\x013x\a_MICRDEF.INC
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           ;This section contains configuration bits for the processor                      D:\work\midicontroller\x013x\config.asm
                                           ;Don't change this unless you know what you're doing.                            D:\work\midicontroller\x013x\config.asm
                                           ;300000                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG USBDIV=2, CPUDIV=OSC2_PLL3, PLLDIV=2                                     D:\work\midicontroller\x013x\config.asm
                                           ;300001                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG FOSC=HSPLL_HS, FCMEN=OFF, IESO=OFF                                       D:\work\midicontroller\x013x\config.asm
                                           ;300002                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG VREGEN=ON, PWRT=ON, BOR=ON, BORV=2		;2 = 2.7V..                          D:\work\midicontroller\x013x\config.asm
                                           ;300003                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG WDT=OFF, WDTPS=128                                                       D:\work\midicontroller\x013x\config.asm
                                           ;300005                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG CCP2MX=ON, PBADEN=OFF, LPT1OSC=OFF, MCLRE=ON                             D:\work\midicontroller\x013x\config.asm
                                           ;300006                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG STVREN=ON, LVP=OFF, ICPRT=OFF, XINST=OFF, DEBUG=OFF                      D:\work\midicontroller\x013x\config.asm
                                           ;300008                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG CP0=OFF, CP1=OFF, CP2=OFF                                                D:\work\midicontroller\x013x\config.asm
                                           ;300009                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG CPB=OFF, CPD=OFF                                                         D:\work\midicontroller\x013x\config.asm
                                           ;30000A                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG WRT0=OFF, WRT1=OFF, WRT2=OFF                                             D:\work\midicontroller\x013x\config.asm
                                           ;30000B                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG WRTC=OFF, WRTB=OFF, WRTD=OFF                                             D:\work\midicontroller\x013x\config.asm
                                           ;30000C                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG EBTR0=OFF, EBTR1=OFF, EBTR2=OFF                                          D:\work\midicontroller\x013x\config.asm
                                           ;30000D                                                                          D:\work\midicontroller\x013x\config.asm
                                           	CONFIG EBTRB=OFF                                                                D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           	global	CLEAR_RAM                                                                D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           	code                                                                            D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           ;clear general purpose registers 0x000 through 0x7FF.                            D:\work\midicontroller\x013x\config.asm
                                           CLEAR_RAM                                                                        D:\work\midicontroller\x013x\config.asm
003584   6aea     CLRF      0xea,0x0       	clrf	FSR0H                                                                      D:\work\midicontroller\x013x\config.asm
003586   6ae9     CLRF      0xe9,0x0       	clrf	FSR0L                                                                      D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           RAMCLEAR                                                                         D:\work\midicontroller\x013x\config.asm
003588   0004     CLRWDT                   	CLRWDT                                                                          D:\work\midicontroller\x013x\config.asm
00358a   6aee     CLRF      0xee,0x0       	clrf	POSTINC0                                                                   D:\work\midicontroller\x013x\config.asm
00358c   a6ea     BTFSS     0xea,0x3,0x0   	btfss	FSR0H, 3                                                                  D:\work\midicontroller\x013x\config.asm
00358e   d7fc     BRA       0x3588         	bra	RAMCLEAR                                                                    D:\work\midicontroller\x013x\config.asm
003590   0012     RETURN    0x0            	return                                                                          D:\work\midicontroller\x013x\config.asm
                                                                                                                            D:\work\midicontroller\x013x\config.asm
                                           	END                                                                             D:\work\midicontroller\x013x\config.asm
                                           //#######################################################################        D:\work\midicontroller\x013x\intslct.c
                                           /**                                                                              D:\work\midicontroller\x013x\intslct.c
                                           * @file intslct.c                                                                D:\work\midicontroller\x013x\intslct.c
                                           * interrupt handler                                                              D:\work\midicontroller\x013x\intslct.c
                                           *                                                                                D:\work\midicontroller\x013x\intslct.c
                                           * @author Joe Dunne                                                              D:\work\midicontroller\x013x\intslct.c
                                           * @date 2/02/05                                                                  D:\work\midicontroller\x013x\intslct.c
                                           * @brief RS232/USB communication routine                                         D:\work\midicontroller\x013x\intslct.c
                                           */                                                                               D:\work\midicontroller\x013x\intslct.c
                                           //			*See Updates section at bottom of file*                                     D:\work\midicontroller\x013x\intslct.c
                                           //#######################################################################        D:\work\midicontroller\x013x\intslct.c
                                                                                                                            D:\work\midicontroller\x013x\intslct.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\intslct.c
                                                                                                                            D:\work\midicontroller\x013x\intslct.c
                                           #pragma code InterruptVectorHigh = 0xA08                                         D:\work\midicontroller\x013x\intslct.c
                                           void                                                                             D:\work\midicontroller\x013x\intslct.c
                                           InterruptVectorHigh (void)                                                       D:\work\midicontroller\x013x\intslct.c
                                           {                                                                                D:\work\midicontroller\x013x\intslct.c
                                             _asm                                                                           D:\work\midicontroller\x013x\intslct.c
000a08   ef55     GOTO      0x36aa         	goto InterruptHandlerHigh //jump to interrupt routine                           D:\work\midicontroller\x013x\intslct.c
000a0a   f01b                                                                                                               
                                             _endasm                                                                        D:\work\midicontroller\x013x\intslct.c
000a0c   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\intslct.c
                                                                                                                            D:\work\midicontroller\x013x\intslct.c
                                                                                                                            D:\work\midicontroller\x013x\intslct.c
                                           //----------------------------------------------------------------------------   D:\work\midicontroller\x013x\intslct.c
                                           // High priority interrupt routine                                               D:\work\midicontroller\x013x\intslct.c
                                                                                                                            D:\work\midicontroller\x013x\intslct.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\intslct.c
                                                                                                                            D:\work\midicontroller\x013x\intslct.c
                                           #pragma interruptlow InterruptHandlerHigh                                        D:\work\midicontroller\x013x\intslct.c
0036aa   cfd8     MOVFF     0xfd8,0xfe4    void	InterruptHandlerHigh ()                                                     D:\work\midicontroller\x013x\intslct.c
0036ac   ffe4                                                                                                               
0036ae   cfe0     MOVFF     0xfe0,0xfe4                                                                                     
0036b0   ffe4                                                                                                               
0036b2   6ee4     MOVWF     0xe4,0x0                                                                                        
0036b4   cfda     MOVFF     0xfda,0xfe4                                                                                     
0036b6   ffe4                                                                                                               
0036b8   cfe2     MOVFF     0xfe2,0xfda                                                                                     
0036ba   ffda                                                                                                               
0036bc   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           {                                                                                D:\work\midicontroller\x013x\intslct.c
0036be   a4f2     BTFSS     0xf2,0x2,0x0     if (INTCONbits.TMR0IF)                                                         D:\work\midicontroller\x013x\intslct.c
0036c0   d003     BRA       0x36c8                                                                                          
                                               {                                   //check for TMR0 overflow                D:\work\midicontroller\x013x\intslct.c
0036c2   94f2     BCF       0xf2,0x2,0x0         INTCONbits.TMR0IF = 0;            //clear interrupt flag                   D:\work\midicontroller\x013x\intslct.c
0036c4   0100     MOVLB     0x0                  Systick = true;                                                            D:\work\midicontroller\x013x\intslct.c
0036c6   8160     BSF       0x60,0x0,0x1                                                                                    
                                               }                                                                            D:\work\midicontroller\x013x\intslct.c
0036c8   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\intslct.c
0036ca   cfe5     MOVFF     0xfe5,0xfda                                                                                     
0036cc   ffda                                                                                                               
0036ce   50e5     MOVF      0xe5,0x0,0x0                                                                                    
0036d0   cfe5     MOVFF     0xfe5,0xfe0                                                                                     
0036d2   ffe0                                                                                                               
0036d4   cfe5     MOVFF     0xfe5,0xfd8                                                                                     
0036d6   ffd8                                                                                                               
0036d8   0010     RETFIE    0x0                                                                                             
                                           #pragma code                                                                     D:\work\midicontroller\x013x\intslct.c
                                           //----------------------------------------------------------------------------   D:\work\midicontroller\x013x\intslct.c
                                           //*;###########################################################################  D:\work\midicontroller\x013x\init.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\init.c
                                           //;#			Date 4/06/07					      						  #                                          D:\work\midicontroller\x013x\init.c
                                           //;#			Main arbitrator									  			  #                                          D:\work\midicontroller\x013x\init.c
                                           //;#			File Name: main.c   										  #                                         D:\work\midicontroller\x013x\init.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\init.c
                                           //;############################################################################  D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\init.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           void init(void) {                                                                D:\work\midicontroller\x013x\init.c
0035ec   ecc2     CALL      0x3584,0x0     	CLEAR_RAM();                                                                    D:\work\midicontroller\x013x\init.c
0035ee   f01a                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\init.c
0035f0   6a89     CLRF      0x89,0x0       	LATA = 0;                                                                       D:\work\midicontroller\x013x\init.c
0035f2   6a8a     CLRF      0x8a,0x0       	LATB = 0;                                                                       D:\work\midicontroller\x013x\init.c
0035f4   6a8b     CLRF      0x8b,0x0       	LATC = 0;                                                                       D:\work\midicontroller\x013x\init.c
0035f6   6a8c     CLRF      0x8c,0x0       	LATD = 0;                                                                       D:\work\midicontroller\x013x\init.c
0035f8   6a8d     CLRF      0x8d,0x0       	LATE = 0;                                                                       D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
0035fa   0e01     MOVLW     0x1            	TRISA = INIT_TRISA;                                                             D:\work\midicontroller\x013x\init.c
0035fc   6e92     MOVWF     0x92,0x0                                                                                        
0035fe   0e10     MOVLW     0x10           	TRISB = INIT_TRISB;                                                             D:\work\midicontroller\x013x\init.c
003600   6e93     MOVWF     0x93,0x0                                                                                        
003602   0ef8     MOVLW     0xf8           	TRISC = INIT_TRISC;                                                             D:\work\midicontroller\x013x\init.c
003604   6e94     MOVWF     0x94,0x0                                                                                        
003606   6a95     CLRF      0x95,0x0       	TRISD = INIT_TRISD;                                                             D:\work\midicontroller\x013x\init.c
003608   0e02     MOVLW     0x2            	TRISE = INIT_TRISE;                                                             D:\work\midicontroller\x013x\init.c
00360a   6e96     MOVWF     0x96,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\init.c
00360c   0100     MOVLB     0x0            	DispNumOfCommons = DISP_NUMBER_OF_COMMONS;                                      D:\work\midicontroller\x013x\init.c
00360e   0e05     MOVLW     0x5                                                                                             
003610   6f67     MOVWF     0x67,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           //	TRISCbits.TRISC6 = false;                                                     D:\work\midicontroller\x013x\init.c
                                           //	RCSTA = 0x90;                                                                 D:\work\midicontroller\x013x\init.c
                                           //	TXSTA = 0xA2;		//0x46;                                                        D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           //	SPBRG = 204;                                                                  D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           #ifdef UARTISRS232                                                               D:\work\midicontroller\x013x\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          D:\work\midicontroller\x013x\init.c
                                           //Initialize the USART control registers                                         D:\work\midicontroller\x013x\init.c
                                           	TXSTA = 0xA6;			//master,8bit,async,high speed                                  D:\work\midicontroller\x013x\init.c
                                           	RCSTA = 0x90;			//enabled,8bit, continuous                                      D:\work\midicontroller\x013x\init.c
                                           //	BAUDCONbits.BRG16 = true;                                                     D:\work\midicontroller\x013x\init.c
                                           	SPBRG = 16;			//115200 baud                                                     D:\work\midicontroller\x013x\init.c
                                           	SPBRGH = 0x01;                                                                  D:\work\midicontroller\x013x\init.c
                                           #else                                                                            D:\work\midicontroller\x013x\init.c
                                           //	TRISD = 0x00;		//assert all pins on portd as outputs                          D:\work\midicontroller\x013x\init.c
                                           //Initialize the USART control registers                                         D:\work\midicontroller\x013x\init.c
003612   0ee6     MOVLW     0xe6           	TXSTA = 0xE6;			//master,8bit,async, BRGH=1                                     D:\work\midicontroller\x013x\init.c
003614   6eac     MOVWF     0xac,0x0                                                                                        
003616   0e90     MOVLW     0x90           	RCSTA = 0x90;			//enabled,8bit, continuous                                      D:\work\midicontroller\x013x\init.c
003618   6eab     MOVWF     0xab,0x0                                                                                        
                                           //	BAUDCONbits.BRG16 = true;                                                     D:\work\midicontroller\x013x\init.c
00361a   0e3f     MOVLW     0x3f           	SPBRG = 63;			//31250 baud                                                      D:\work\midicontroller\x013x\init.c
00361c   6eaf     MOVWF     0xaf,0x0                                                                                        
00361e   6ab0     CLRF      0xb0,0x0       	SPBRGH = 0x00;                                                                  D:\work\midicontroller\x013x\init.c
                                           #endif                                                                           D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           //These constants setup the application's MCU Analog-to-Digital Converter module. D:\work\midicontroller\x013x\init.c
003620   0e40     MOVLW     0x40           	ADCON0	= 0b01000000;		//AN0, off                                                D:\work\midicontroller\x013x\init.c
003622   6ec2     MOVWF     0xc2,0x0                                                                                        
003624   0e0e     MOVLW     0xe            	ADCON1	= 0b00001110;		//1 analog channels                                       D:\work\midicontroller\x013x\init.c
003626   6ec1     MOVWF     0xc1,0x0                                                                                        
003628   0e86     MOVLW     0x86           	ADCON2	= 0b10000110;		//Right justified, 0 TAD(manual), FOSC/32                 D:\work\midicontroller\x013x\init.c
00362a   6ec0     MOVWF     0xc0,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                           //set up timer0 to interrupt at some interval..                                  D:\work\midicontroller\x013x\init.c
00362c   0e20     MOVLW     0x20           	INTCON = 0x20;                //disable global and enable TMR0 interrupt        D:\work\midicontroller\x013x\init.c
00362e   6ef2     MOVWF     0xf2,0x0                                                                                        
003630   0e84     MOVLW     0x84           	INTCON2 = 0x84;               //TMR0 high priority                              D:\work\midicontroller\x013x\init.c
003632   6ef1     MOVWF     0xf1,0x0                                                                                        
003634   8ed0     BSF       0xd0,0x7,0x0   	RCONbits.IPEN = 1;            //enable priority levels                          D:\work\midicontroller\x013x\init.c
003636   6ad7     CLRF      0xd7,0x0       	TMR0H = 0;                    //clear timer                                     D:\work\midicontroller\x013x\init.c
003638   6ad6     CLRF      0xd6,0x0       	TMR0L = 0;                    //clear timer                                     D:\work\midicontroller\x013x\init.c
00363a   0e80     MOVLW     0x80           	T0CON = 0x80;                 //set up timer0 - prescaler 1:8                   D:\work\midicontroller\x013x\init.c
00363c   6ed5     MOVWF     0xd5,0x0                                                                                        
00363e   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIEH = 1;          //enable interrupts                               D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
                                                                                                                            D:\work\midicontroller\x013x\init.c
003640   0e14     MOVLW     0x14           	mInitializeUSBDriver();                                                         D:\work\midicontroller\x013x\init.c
003642   6e6f     MOVWF     0x6f,0x0                                                                                        
003644   0101     MOVLB     0x1                                                                                             
003646   6b46     CLRF      0x46,0x1                                                                                        
003648   0101     MOVLB     0x1                                                                                             
00364a   6b47     CLRF      0x47,0x1                                                                                        
00364c   0101     MOVLB     0x1                                                                                             
00364e   6b48     CLRF      0x48,0x1                                                                                        
003650   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\init.c
                                           //*;###########################################################################  D:\work\midicontroller\x013x\hwcalls.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\hwcalls.c
                                           //;#			Date 4/06/07					      						  #                                          D:\work\midicontroller\x013x\hwcalls.c
                                           //;#			Main arbitrator									  			  #                                          D:\work\midicontroller\x013x\hwcalls.c
                                           //;#			File Name: hwcalls.c   										  #                                      D:\work\midicontroller\x013x\hwcalls.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\hwcalls.c
                                           //;############################################################################  D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           #include "typedefs.h"                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           #include "hardware.h"                                                            D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
0024ba   cfd9     MOVFF     0xfd9,0xfe6    unsigned char	ADC_CONVERSION(unsigned char Channel) {                            D:\work\midicontroller\x013x\hwcalls.c
0024bc   ffe6                                                                                                               
0024be   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0024c0   ffd9                                                                                                               
0024c2   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char tempcntr;                                                         D:\work\midicontroller\x013x\hwcalls.c
0024c4   0efe     MOVLW     0xfe           	ADCON0 = Channel;                                                               D:\work\midicontroller\x013x\hwcalls.c
0024c6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0024c8   6ec2     MOVWF     0xc2,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //Wait for the converter's holding capacitor to charge up.                       D:\work\midicontroller\x013x\hwcalls.c
                                           ADC_CHARGING_DELAY_LOOP:                                                         D:\work\midicontroller\x013x\hwcalls.c
0024ca   0e0a     MOVLW     0xa            	for(tempcntr = 10;tempcntr!=0;tempcntr--);                                      D:\work\midicontroller\x013x\hwcalls.c
0024cc   6edf     MOVWF     0xdf,0x0                                                                                        
0024ce   50df     MOVF      0xdf,0x0,0x0                                                                                    
0024d0   e002     BZ        0x24d6                                                                                          
0024d2   06df     DECF      0xdf,0x1,0x0                                                                                    
0024d4   d7fc     BRA       0x24ce                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //Start the conversion                                                           D:\work\midicontroller\x013x\hwcalls.c
0024d6   82c2     BSF       0xc2,0x1,0x0   	ADCON0bits.GO = true;                                                           D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //Wait for the conversion to complete, then exit                                 D:\work\midicontroller\x013x\hwcalls.c
                                           ADC_CONVERSION_DELAY:                                                            D:\work\midicontroller\x013x\hwcalls.c
0024d8   b2c2     BTFSC     0xc2,0x1,0x0   	for(;ADCON0bits.GO;);                                                           D:\work\midicontroller\x013x\hwcalls.c
0024da   d7fe     BRA       0x24d8                                                                                          
                                           	                                                                                D:\work\midicontroller\x013x\hwcalls.c
0024dc   50c4     MOVF      0xc4,0x0,0x0   	return ADRESH;                                                                  D:\work\midicontroller\x013x\hwcalls.c
0024de   d000     BRA       0x24e0                                                                                          
0024e0   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0024e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0024e4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0024e6   ffd9                                                                                                               
0024e8   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Send a single MIDI byte. */                                                   D:\work\midicontroller\x013x\hwcalls.c
0024ea   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_byte(u8 data) {                                                   D:\work\midicontroller\x013x\hwcalls.c
0024ec   ffe6                                                                                                               
0024ee   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0024f0   ffd9                                                                                                               
0024f2   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char temp;                                                             D:\work\midicontroller\x013x\hwcalls.c
                                           	//send out first byte.                                                          D:\work\midicontroller\x013x\hwcalls.c
0024f4   0efe     MOVLW     0xfe           	TXREG = data;                                                                   D:\work\midicontroller\x013x\hwcalls.c
0024f6   50db     MOVF      0xdb,0x0,0x0                                                                                    
0024f8   6ead     MOVWF     0xad,0x0                                                                                        
0024fa   509e     MOVF      0x9e,0x0,0x0   	temp = PIR1;			//clear TXIF..                                                   D:\work\midicontroller\x013x\hwcalls.c
0024fc   6edf     MOVWF     0xdf,0x0                                                                                        
0024fe   a89e     BTFSS     0x9e,0x4,0x0   	while(!PIR1bits.TXIF);                                                          D:\work\midicontroller\x013x\hwcalls.c
002500   d7fe     BRA       0x24fe                                                                                          
002502   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
002504   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002506   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002508   ffd9                                                                                                               
00250a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //****************************************************************************** D:\work\midicontroller\x013x\hwcalls.c
                                           //JDunne 5/27/07 - Converted routine from assembly to C.  (used to be called SEND_TO_LATCHES) D:\work\midicontroller\x013x\hwcalls.c
                                           //------------------------------------------------------------------------------ D:\work\midicontroller\x013x\hwcalls.c
00250c   cfd9     MOVFF     0xfd9,0xfe6    void	SendDataToShiftReg(unsigned char dataToSend) {                              D:\work\midicontroller\x013x\hwcalls.c
00250e   ffe6                                                                                                               
002510   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002512   ffd9                                                                                                               
002514   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	unsigned char DataCounter;                                                      D:\work\midicontroller\x013x\hwcalls.c
                                           //SEND_SPEC_TO_LATCHES                                                           D:\work\midicontroller\x013x\hwcalls.c
002516   0e08     MOVLW     0x8            	DataCounter = 8;								//Load number of bits to be transfered                  D:\work\midicontroller\x013x\hwcalls.c
002518   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //	bcf	SRCK_LAT_BIT						//Control clock signal, also prevent IIC start          D:\work\midicontroller\x013x\hwcalls.c
00251a   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Flush out garbage                              D:\work\midicontroller\x013x\hwcalls.c
00251c   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //STL_TRANSMIT_BIT                                                               D:\work\midicontroller\x013x\hwcalls.c
                                           	do {                                                                            D:\work\midicontroller\x013x\hwcalls.c
00251e   9289     BCF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = false;				//Clear strobe pin                           D:\work\midicontroller\x013x\hwcalls.c
002520   0efe     MOVLW     0xfe           		if (!chkbit(dataToSend, 7)) {		//MSB high?                                     D:\work\midicontroller\x013x\hwcalls.c
002522   bedb     BTFSC     0xdb,0x7,0x0                                                                                    
002524   d002     BRA       0x252a                                                                                          
002526   9689     BCF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = false;		//No, set data signal low                   D:\work\midicontroller\x013x\hwcalls.c
                                           		}                                                                              D:\work\midicontroller\x013x\hwcalls.c
002528   d001     BRA       0x252c         		else {								//MSB low?                                                       D:\work\midicontroller\x013x\hwcalls.c
00252a   8689     BSF       0x89,0x3,0x0   			SHIFTREG_SER_IN_LAT_BIT = true;		//No, release data signal                    D:\work\midicontroller\x013x\hwcalls.c
                                           		}                                                                              D:\work\midicontroller\x013x\hwcalls.c
00252c   cfdb     MOVFF     0xfdb,0xff3    		dataToSend <<=1;					//Shift next bit to MSB position                          D:\work\midicontroller\x013x\hwcalls.c
00252e   fff3                                                                                                               
002530   9ef3     BCF       0xf3,0x7,0x0                                                                                    
002532   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
002534   cff3     MOVFF     0xff3,0xfdb                                                                                     
002536   ffdb                                                                                                               
002538   8289     BSF       0x89,0x1,0x0   		SHIFTREG_SRCK_LAT_BIT = true;                                                  D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //STL_RESET_CLOCK_LEVEL                                                          D:\work\midicontroller\x013x\hwcalls.c
00253a   06df     DECF      0xdf,0x1,0x0   	} while (--DataCounter!=0);				//All 8 bits transfered? No, go transfer next bit D:\work\midicontroller\x013x\hwcalls.c
00253c   e1f0     BNZ       0x251e                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //STL_STROBE                                                                     D:\work\midicontroller\x013x\hwcalls.c
00253e   8489     BSF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = true;			//Strobe the data                                D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //STL_STROBE_DELAY                                                               D:\work\midicontroller\x013x\hwcalls.c
002540   0e10     MOVLW     0x10           	for (DataCounter = LATCH_STROBE_DELAY; DataCounter !=0;DataCounter--);		//Pause for data transfer from external latch_1's input to its output D:\work\midicontroller\x013x\hwcalls.c
002542   6edf     MOVWF     0xdf,0x0                                                                                        
002544   50df     MOVF      0xdf,0x0,0x0                                                                                    
002546   e002     BZ        0x254c                                                                                          
002548   06df     DECF      0xdf,0x1,0x0                                                                                    
00254a   d7fc     BRA       0x2544                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
00254c   9489     BCF       0x89,0x2,0x0   	SHIFTREG_RCK_LAT_BIT = false;                                                   D:\work\midicontroller\x013x\hwcalls.c
00254e   8689     BSF       0x89,0x3,0x0   	SHIFTREG_SER_IN_LAT_BIT = true;				//Release data signal                        D:\work\midicontroller\x013x\hwcalls.c
002550   8289     BSF       0x89,0x1,0x0   	SHIFTREG_SRCK_LAT_BIT = true;			//Release serial clk                            D:\work\midicontroller\x013x\hwcalls.c
002552   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
002554   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002556   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002558   ffd9                                                                                                               
00255a   0012     RETURN    0x0                                                                                             
                                           //------------------------------------------------------------------------------ D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //returns data into ButtonState.                                                 D:\work\midicontroller\x013x\hwcalls.c
00255c   cfd9     MOVFF     0xfd9,0xfe6    void	ReadButtons(void) {                                                         D:\work\midicontroller\x013x\hwcalls.c
00255e   ffe6                                                                                                               
002560   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002562   ffd9                                                                                                               
002564   0e04     MOVLW     0x4                                                                                             
002566   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char BtnAddress, bitloc, i;                                            D:\work\midicontroller\x013x\hwcalls.c
                                           	BitField TempButtons;                                                           D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           //the following only reads 7 buttons from the multiplexor, and the 8th from the pin directly. D:\work\midicontroller\x013x\hwcalls.c
                                           //the 7th bit of the multiplexor is the modeswitch which is read below.          D:\work\midicontroller\x013x\hwcalls.c
002568   52de     MOVF      0xde,0x1,0x0   	bitloc = 1;                                                                     D:\work\midicontroller\x013x\hwcalls.c
00256a   0e01     MOVLW     0x1                                                                                             
00256c   6edd     MOVWF     0xdd,0x0                                                                                        
00256e   0e03     MOVLW     0x3            	TempButtons.byte = 0;                                                           D:\work\midicontroller\x013x\hwcalls.c
002570   6adb     CLRF      0xdb,0x0                                                                                        
002572   6adf     CLRF      0xdf,0x0       	for (BtnAddress = 0;BtnAddress<=6;BtnAddress++) {                               D:\work\midicontroller\x013x\hwcalls.c
002574   50df     MOVF      0xdf,0x0,0x0                                                                                    
002576   0806     SUBLW     0x6                                                                                             
002578   e322     BNC       0x25be                                                                                          
0025ba   2adf     INCF      0xdf,0x1,0x0                                                                                    
0025bc   d7db     BRA       0x2574                                                                                          
00257a   cfdf     MOVFF     0xfdf,0xfe6    		SetDipAddress(BtnAddress);                                                     D:\work\midicontroller\x013x\hwcalls.c
00257c   ffe6                                                                                                               
00257e   d8dd     RCALL     0x273a                                                                                          
002580   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
002582   0e05     MOVLW     0x5            		for (i = BTN_SAMPLE_DELAY;i!=0;i--);		//delay for a sampling delay             D:\work\midicontroller\x013x\hwcalls.c
002584   6ef3     MOVWF     0xf3,0x0                                                                                        
002586   0e02     MOVLW     0x2                                                                                             
002588   cff3     MOVFF     0xff3,0xfdb                                                                                     
00258a   ffdb                                                                                                               
00258c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00258e   e003     BZ        0x2596                                                                                          
002590   0e02     MOVLW     0x2                                                                                             
002592   06db     DECF      0xdb,0x1,0x0                                                                                    
002594   d7fb     BRA       0x258c                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
002596   a284     BTFSS     0x84,0x1,0x0   		if (BTN_IN_PIN) TempButtons.byte |= bitloc;		//Or in the current bit if it is set. D:\work\midicontroller\x013x\hwcalls.c
002598   d009     BRA       0x25ac                                                                                          
00259a   0e03     MOVLW     0x3                                                                                             
00259c   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
00259e   ffe7                                                                                                               
0025a0   0e01     MOVLW     0x1                                                                                             
0025a2   50db     MOVF      0xdb,0x0,0x0                                                                                    
0025a4   12e7     IORWF     0xe7,0x1,0x0                                                                                    
0025a6   0e03     MOVLW     0x3                                                                                             
0025a8   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
0025aa   ffdb                                                                                                               
0025ac   0e01     MOVLW     0x1            		bitloc <<= 1;										//shift the bit over to the next                        D:\work\midicontroller\x013x\hwcalls.c
0025ae   cfdb     MOVFF     0xfdb,0xff3                                                                                     
0025b0   fff3                                                                                                               
0025b2   9ef3     BCF       0xf3,0x7,0x0                                                                                    
0025b4   46f3     RLNCF     0xf3,0x1,0x0                                                                                    
0025b6   cff3     MOVFF     0xff3,0xfdb                                                                                     
0025b8   ffdb                                                                                                               
                                           	}                                                                               D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
0025be   0e03     MOVLW     0x3            	ButtonState = TempButtons.byte;                                                 D:\work\midicontroller\x013x\hwcalls.c
0025c0   cfdb     MOVFF     0xfdb,0x69                                                                                      
0025c2   f069                                                                                                               
0025c4   0100     MOVLB     0x0                                                                                             
0025c6   6b6a     CLRF      0x6a,0x1                                                                                        
0025c8   6b6b     CLRF      0x6b,0x1                                                                                        
0025ca   6b6c     CLRF      0x6c,0x1                                                                                        
0025cc   90d8     BCF       0xd8,0x0,0x0   	ButtonState <<=1;			//shift everything over one because the 0th bit is supposed D:\work\midicontroller\x013x\hwcalls.c
0025ce   3769     RLCF      0x69,0x1,0x1                                                                                    
0025d0   376a     RLCF      0x6a,0x1,0x1                                                                                    
0025d2   376b     RLCF      0x6b,0x1,0x1                                                                                    
0025d4   376c     RLCF      0x6c,0x1,0x1                                                                                    
                                           								//to be PRESET_1, which is on another pin.                               D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
0025d6   696a     SETF      0x6a,0x1       	ButtonState |= 0xFFFFFF00;                                                      D:\work\midicontroller\x013x\hwcalls.c
0025d8   696b     SETF      0x6b,0x1                                                                                        
0025da   696c     SETF      0x6c,0x1                                                                                        
0025dc   b881     BTFSC     0x81,0x4,0x0   	if (BTN_PRESET_1_PIN) setbit(ButtonState,0);                                    D:\work\midicontroller\x013x\hwcalls.c
0025de   8169     BSF       0x69,0x0,0x1                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           	//all buttons are backwards logic, so simply invert the state of ButtonState.   D:\work\midicontroller\x013x\hwcalls.c
0025e0   1f69     COMF      0x69,0x1,0x1   	ButtonState = ~ButtonState;                                                     D:\work\midicontroller\x013x\hwcalls.c
0025e2   1f6a     COMF      0x6a,0x1,0x1                                                                                    
0025e4   1f6b     COMF      0x6b,0x1,0x1                                                                                    
0025e6   1f6c     COMF      0x6c,0x1,0x1                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           	//read the 7th bit of the shift register.  (Which is the slider mode switch)    D:\work\midicontroller\x013x\hwcalls.c
0025e8   0e07     MOVLW     0x7            	BtnAddress = 0x07;                                                              D:\work\midicontroller\x013x\hwcalls.c
0025ea   6edf     MOVWF     0xdf,0x0                                                                                        
0025ec   cfdf     MOVFF     0xfdf,0xfe6    	SetDipAddress(BtnAddress);                                                      D:\work\midicontroller\x013x\hwcalls.c
0025ee   ffe6                                                                                                               
0025f0   d8a4     RCALL     0x273a                                                                                          
0025f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0025f4   0100     MOVLB     0x0            	ModeSwitchState = true;                                                         D:\work\midicontroller\x013x\hwcalls.c
0025f6   8161     BSF       0x61,0x0,0x1                                                                                    
0025f8   b284     BTFSC     0x84,0x1,0x0   	if (BTN_IN_PIN) ModeSwitchState = false;                                        D:\work\midicontroller\x013x\hwcalls.c
0025fa   9161     BCF       0x61,0x0,0x1                                                                                    
0025fc   0e04     MOVLW     0x4            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0025fe   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002600   e202     BC        0x2606                                                                                          
002602   6ae1     CLRF      0xe1,0x0                                                                                        
002604   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002606   6ee1     MOVWF     0xe1,0x0                                                                                        
002608   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00260a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00260c   ffd9                                                                                                               
00260e   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           ///Average = ((Inst-Avg)/(2^Tau))+Avg                                            D:\work\midicontroller\x013x\hwcalls.c
002610   cfd9     MOVFF     0xfd9,0xfe6    TwoBytes Filtered2SampleAvg(TwoBytes Avg, unsigned char Inst, unsigned char Tau) { D:\work\midicontroller\x013x\hwcalls.c
002612   ffe6                                                                                                               
002614   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002616   ffd9                                                                                                               
002618   0e03     MOVLW     0x3                                                                                             
00261a   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char positive;                                                         D:\work\midicontroller\x013x\hwcalls.c
                                           	TwoBytes diff;                                                                  D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
00261c   0e01     MOVLW     0x1            	diff.s_form = 0;                                                                D:\work\midicontroller\x013x\hwcalls.c
00261e   6adb     CLRF      0xdb,0x0                                                                                        
002620   0e02     MOVLW     0x2                                                                                             
002622   6adb     CLRF      0xdb,0x0                                                                                        
002624   0efe     MOVLW     0xfe           	if (Inst >= Avg.b_form.high) {                                                  D:\work\midicontroller\x013x\hwcalls.c
002626   50db     MOVF      0xdb,0x0,0x0                                                                                    
002628   6ef3     MOVWF     0xf3,0x0                                                                                        
00262a   0efc     MOVLW     0xfc                                                                                            
00262c   cfdb     MOVFF     0xfdb,0xff4                                                                                     
00262e   fff4                                                                                                               
002630   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002632   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002634   e30e     BNC       0x2652                                                                                          
002636   0efc     MOVLW     0xfc           		diff.b_form.high = Inst - Avg.b_form.high;                                     D:\work\midicontroller\x013x\hwcalls.c
002638   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
00263a   ffe6                                                                                                               
00263c   0efe     MOVLW     0xfe                                                                                            
00263e   50db     MOVF      0xdb,0x0,0x0                                                                                    
002640   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002642   5ce7     SUBWF     0xe7,0x0,0x0                                                                                    
002644   6ee7     MOVWF     0xe7,0x0                                                                                        
002646   0e02     MOVLW     0x2                                                                                             
002648   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
00264a   ffdb                                                                                                               
00264c   0e00     MOVLW     0x0            		setbit(positive,0);                                                            D:\work\midicontroller\x013x\hwcalls.c
00264e   80df     BSF       0xdf,0x0,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\hwcalls.c
002650   d00d     BRA       0x266c         	else {                                                                          D:\work\midicontroller\x013x\hwcalls.c
002652   0efe     MOVLW     0xfe           		diff.b_form.high = Avg.b_form.high - Inst;                                     D:\work\midicontroller\x013x\hwcalls.c
002654   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
002656   ffe6                                                                                                               
002658   0efc     MOVLW     0xfc                                                                                            
00265a   50db     MOVF      0xdb,0x0,0x0                                                                                    
00265c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00265e   5ce7     SUBWF     0xe7,0x0,0x0                                                                                    
002660   6ee7     MOVWF     0xe7,0x0                                                                                        
002662   0e02     MOVLW     0x2                                                                                             
002664   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002666   ffdb                                                                                                               
002668   0e00     MOVLW     0x0            		clrbit(positive,0);                                                            D:\work\midicontroller\x013x\hwcalls.c
00266a   90df     BCF       0xdf,0x0,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
00266c   0efb     MOVLW     0xfb           	diff.s_form >>= Tau;                                                            D:\work\midicontroller\x013x\hwcalls.c
00266e   cfdb     MOVFF     0xfdb,0x10                                                                                      
002670   f010                                                                                                               
002672   50d9     MOVF      0xd9,0x0,0x0                                                                                    
002674   0f01     ADDLW     0x1                                                                                             
002676   6ee9     MOVWF     0xe9,0x0                                                                                        
002678   cfda     MOVFF     0xfda,0xfea                                                                                     
00267a   ffea                                                                                                               
00267c   5010     MOVF      0x10,0x0,0x0                                                                                    
00267e   0b0f     ANDLW     0xf                                                                                             
002680   e006     BZ        0x268e                                                                                          
002682   52ec     MOVF      0xec,0x1,0x0                                                                                    
002684   90d8     BCF       0xd8,0x0,0x0                                                                                    
002686   32ed     RRCF      0xed,0x1,0x0                                                                                    
002688   32ef     RRCF      0xef,0x1,0x0                                                                                    
00268a   06e8     DECF      0xe8,0x1,0x0                                                                                    
00268c   e1fa     BNZ       0x2682                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
00268e   a0df     BTFSS     0xdf,0x0,0x0   	if (chkbit(positive,0)) {                                                       D:\work\midicontroller\x013x\hwcalls.c
002690   d011     BRA       0x26b4                                                                                          
002692   0e01     MOVLW     0x1            		Avg.s_form += diff.s_form;                                                     D:\work\midicontroller\x013x\hwcalls.c
002694   cfdb     MOVFF     0xfdb,0x10                                                                                      
002696   f010                                                                                                               
002698   0e02     MOVLW     0x2                                                                                             
00269a   cfdb     MOVFF     0xfdb,0x11                                                                                      
00269c   f011                                                                                                               
00269e   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0026a0   0ffd     ADDLW     0xfd                                                                                            
0026a2   6ee9     MOVWF     0xe9,0x0                                                                                        
0026a4   0eff     MOVLW     0xff                                                                                            
0026a6   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0026a8   6eea     MOVWF     0xea,0x0                                                                                        
0026aa   5010     MOVF      0x10,0x0,0x0                                                                                    
0026ac   26ee     ADDWF     0xee,0x1,0x0                                                                                    
0026ae   5011     MOVF      0x11,0x0,0x0                                                                                    
0026b0   22ed     ADDWFC    0xed,0x1,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\hwcalls.c
0026b2   d010     BRA       0x26d4         	else {                                                                          D:\work\midicontroller\x013x\hwcalls.c
0026b4   0e01     MOVLW     0x1            		Avg.s_form -= diff.s_form;                                                     D:\work\midicontroller\x013x\hwcalls.c
0026b6   cfdb     MOVFF     0xfdb,0x10                                                                                      
0026b8   f010                                                                                                               
0026ba   0e02     MOVLW     0x2                                                                                             
0026bc   cfdb     MOVFF     0xfdb,0x11                                                                                      
0026be   f011                                                                                                               
0026c0   50d9     MOVF      0xd9,0x0,0x0                                                                                    
0026c2   0ffd     ADDLW     0xfd                                                                                            
0026c4   6ee9     MOVWF     0xe9,0x0                                                                                        
0026c6   0eff     MOVLW     0xff                                                                                            
0026c8   20da     ADDWFC    0xda,0x0,0x0                                                                                    
0026ca   6eea     MOVWF     0xea,0x0                                                                                        
0026cc   5010     MOVF      0x10,0x0,0x0                                                                                    
0026ce   5eee     SUBWF     0xee,0x1,0x0                                                                                    
0026d0   5011     MOVF      0x11,0x0,0x0                                                                                    
0026d2   5aed     SUBWFB    0xed,0x1,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\hwcalls.c
0026d4   0efd     MOVLW     0xfd           	return Avg;                                                                     D:\work\midicontroller\x013x\hwcalls.c
0026d6   cfdb     MOVFF     0xfdb,0x10                                                                                      
0026d8   f010                                                                                                               
0026da   0efe     MOVLW     0xfe                                                                                            
0026dc   cfdb     MOVFF     0xfdb,0x11                                                                                      
0026de   f011                                                                                                               
0026e0   c010     MOVFF     0x10,0xff3                                                                                      
0026e2   fff3                                                                                                               
0026e4   c011     MOVFF     0x11,0xff4                                                                                      
0026e6   fff4                                                                                                               
0026e8   0e03     MOVLW     0x3            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0026ea   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0026ec   e203     BC        0x26f4                                                                                          
0026ee   d000     BRA       0x26f0                                                                                          
0026f0   6ae1     CLRF      0xe1,0x0                                                                                        
0026f2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0026f4   6ee1     MOVWF     0xe1,0x0                                                                                        
0026f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0026f8   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0026fa   ffd9                                                                                                               
0026fc   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
0026fe   cfd9     MOVFF     0xfd9,0xfe6    void	Write64BytesProgMem(rom unsigned char *RomPtr, unsigned char *RamPtr) {     D:\work\midicontroller\x013x\hwcalls.c
002700   ffe6                                                                                                               
002702   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002704   ffd9                                                                                                               
002706   0efd     MOVLW     0xfd           	TBLPTR = (unsigned long)RomPtr;                                                 D:\work\midicontroller\x013x\hwcalls.c
002708   cfdb     MOVFF     0xfdb,0x10                                                                                      
00270a   f010                                                                                                               
00270c   0efe     MOVLW     0xfe                                                                                            
00270e   cfdb     MOVFF     0xfdb,0x11                                                                                      
002710   f011                                                                                                               
002712   6a12     CLRF      0x12,0x0                                                                                        
002714   6a13     CLRF      0x13,0x0                                                                                        
002716   c010     MOVFF     0x10,0xff6                                                                                      
002718   fff6                                                                                                               
00271a   c011     MOVFF     0x11,0xff7                                                                                      
00271c   fff7                                                                                                               
00271e   c012     MOVFF     0x12,0xff8                                                                                      
002720   fff8                                                                                                               
002722   0efb     MOVLW     0xfb           	FSR0 = (unsigned short)RamPtr;                                                  D:\work\midicontroller\x013x\hwcalls.c
002724   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002726   ffe9                                                                                                               
002728   0efc     MOVLW     0xfc                                                                                            
00272a   cfdb     MOVFF     0xfdb,0xfea                                                                                     
00272c   ffea                                                                                                               
00272e   ecd2     CALL      0x35a4,0x0     	WRITE_BLOCK_INTO_ROM();                                                         D:\work\midicontroller\x013x\hwcalls.c
002730   f01a                                                                                                               
002732   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
002734   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002736   ffd9                                                                                                               
002738   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
00273a   cfd9     MOVFF     0xfd9,0xfe6    void	SetDipAddress(unsigned char Address) {                                      D:\work\midicontroller\x013x\hwcalls.c
00273c   ffe6                                                                                                               
00273e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002740   ffd9                                                                                                               
002742   9889     BCF       0x89,0x4,0x0   	BTN_S0_LAT_BIT = false;                                                         D:\work\midicontroller\x013x\hwcalls.c
002744   9a89     BCF       0x89,0x5,0x0   	BTN_S1_LAT_BIT = false;                                                         D:\work\midicontroller\x013x\hwcalls.c
002746   908d     BCF       0x8d,0x0,0x0   	BTN_S2_LAT_BIT = false;                                                         D:\work\midicontroller\x013x\hwcalls.c
002748   0efe     MOVLW     0xfe           	if (chkbit(Address,0)) BTN_S0_LAT_BIT = true;                                   D:\work\midicontroller\x013x\hwcalls.c
00274a   b0db     BTFSC     0xdb,0x0,0x0                                                                                    
00274c   8889     BSF       0x89,0x4,0x0                                                                                    
00274e   b2db     BTFSC     0xdb,0x1,0x0   	if (chkbit(Address,1)) BTN_S1_LAT_BIT = true;                                   D:\work\midicontroller\x013x\hwcalls.c
002750   8a89     BSF       0x89,0x5,0x0                                                                                    
002752   b4db     BTFSC     0xdb,0x2,0x0   	if (chkbit(Address,2)) BTN_S2_LAT_BIT = true;                                   D:\work\midicontroller\x013x\hwcalls.c
002754   808d     BSF       0x8d,0x0,0x0                                                                                    
002756   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
002758   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00275a   ffd9                                                                                                               
00275c   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* --------------- LED read-out display functions: */                            D:\work\midicontroller\x013x\hwcalls.c
00275e   cfd9     MOVFF     0xfd9,0xfe6    u32 fsw_poll(){                                                                  D:\work\midicontroller\x013x\hwcalls.c
002760   ffe6                                                                                                               
002762   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002764   ffd9                                                                                                               
002766   0e04     MOVLW     0x4                                                                                             
002768   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	FourBytes TempButtons;                                                          D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
00276a   6ade     CLRF      0xde,0x0       	TempButtons.l_form = 0;                                                         D:\work\midicontroller\x013x\hwcalls.c
00276c   6ade     CLRF      0xde,0x0                                                                                        
00276e   6ade     CLRF      0xde,0x0                                                                                        
002770   6add     CLRF      0xdd,0x0                                                                                        
002772   52dd     MOVF      0xdd,0x1,0x0                                                                                    
002774   52dd     MOVF      0xdd,0x1,0x0                                                                                    
002776   c069     MOVFF     0x69,0x10      	TempButtons.b_form.byte3 = ButtonState&0xF0;                                    D:\work\midicontroller\x013x\hwcalls.c
002778   f010                                                                                                               
00277a   c06a     MOVFF     0x6a,0x11                                                                                       
00277c   f011                                                                                                               
00277e   c06b     MOVFF     0x6b,0x12                                                                                       
002780   f012                                                                                                               
002782   c06c     MOVFF     0x6c,0x13                                                                                       
002784   f013                                                                                                               
002786   0ef0     MOVLW     0xf0                                                                                            
002788   1610     ANDWF     0x10,0x1,0x0                                                                                    
00278a   6a11     CLRF      0x11,0x0                                                                                        
00278c   6a12     CLRF      0x12,0x0                                                                                        
00278e   6a13     CLRF      0x13,0x0                                                                                        
002790   0e03     MOVLW     0x3                                                                                             
002792   c010     MOVFF     0x10,0xfdb                                                                                      
002794   ffdb                                                                                                               
002796   c069     MOVFF     0x69,0x10      	TempButtons.b_form.byte0 = ButtonState&0x0F;                                    D:\work\midicontroller\x013x\hwcalls.c
002798   f010                                                                                                               
00279a   c06a     MOVFF     0x6a,0x11                                                                                       
00279c   f011                                                                                                               
00279e   c06b     MOVFF     0x6b,0x12                                                                                       
0027a0   f012                                                                                                               
0027a2   c06c     MOVFF     0x6c,0x13                                                                                       
0027a4   f013                                                                                                               
0027a6   0e0f     MOVLW     0xf                                                                                             
0027a8   1610     ANDWF     0x10,0x1,0x0                                                                                    
0027aa   6a11     CLRF      0x11,0x0                                                                                        
0027ac   6a12     CLRF      0x12,0x0                                                                                        
0027ae   6a13     CLRF      0x13,0x0                                                                                        
0027b0   5010     MOVF      0x10,0x0,0x0                                                                                    
0027b2   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
0027b4   cfdf     MOVFF     0xfdf,0x10     	return TempButtons.l_form;                                                      D:\work\midicontroller\x013x\hwcalls.c
0027b6   f010                                                                                                               
0027b8   0e01     MOVLW     0x1                                                                                             
0027ba   cfdb     MOVFF     0xfdb,0x11                                                                                      
0027bc   f011                                                                                                               
0027be   c010     MOVFF     0x10,0xff3                                                                                      
0027c0   fff3                                                                                                               
0027c2   c011     MOVFF     0x11,0xff4                                                                                      
0027c4   fff4                                                                                                               
0027c6   0e04     MOVLW     0x4            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0027c8   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
0027ca   e203     BC        0x27d2                                                                                          
0027cc   d000     BRA       0x27ce                                                                                          
0027ce   6ae1     CLRF      0xe1,0x0                                                                                        
0027d0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027d2   6ee1     MOVWF     0xe1,0x0                                                                                        
0027d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027d6   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0027d8   ffd9                                                                                                               
0027da   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           void	UpdateLeds(void) {                                                          D:\work\midicontroller\x013x\hwcalls.c
0027dc   c068     MOVFF     0x68,0xfe6     	SendDataToShiftReg(LedStates);                                                  D:\work\midicontroller\x013x\hwcalls.c
0027de   ffe6                                                                                                               
0027e0   de95     RCALL     0x250c                                                                                          
0027e2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0027e4   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
                                           /* Set currently active program foot-switch's LED indicator and disable all others */ D:\work\midicontroller\x013x\hwcalls.c
0027e6   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_set_active(int idx){                                                D:\work\midicontroller\x013x\hwcalls.c
0027e8   ffe6                                                                                                               
0027ea   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0027ec   ffd9                                                                                                               
0027ee   0100     MOVLB     0x0            	LedStates = 0;                                                                  D:\work\midicontroller\x013x\hwcalls.c
0027f0   6b68     CLRF      0x68,0x1                                                                                        
0027f2   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          D:\work\midicontroller\x013x\hwcalls.c
0027f4   6ef3     MOVWF     0xf3,0x0                                                                                        
0027f6   0efd     MOVLW     0xfd                                                                                            
0027f8   50db     MOVF      0xdb,0x0,0x0                                                                                    
0027fa   e004     BZ        0x2804                                                                                          
0027fc   90d8     BCF       0xd8,0x0,0x0                                                                                    
0027fe   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002800   06e8     DECF      0xe8,0x1,0x0                                                                                    
002802   e1fc     BNZ       0x27fc                                                                                          
002804   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002806   0100     MOVLB     0x0                                                                                             
002808   1368     IORWF     0x68,0x1,0x1                                                                                    
00280a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
00280c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00280e   ffd9                                                                                                               
002810   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Explicitly enable a single LED without affecting the others */                D:\work\midicontroller\x013x\hwcalls.c
002812   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_enable(int idx){                                                    D:\work\midicontroller\x013x\hwcalls.c
002814   ffe6                                                                                                               
002816   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002818   ffd9                                                                                                               
00281a   0e01     MOVLW     0x1            	setbit(LedStates,idx);                                                          D:\work\midicontroller\x013x\hwcalls.c
00281c   6ef3     MOVWF     0xf3,0x0                                                                                        
00281e   0efd     MOVLW     0xfd                                                                                            
002820   50db     MOVF      0xdb,0x0,0x0                                                                                    
002822   e004     BZ        0x282c                                                                                          
002824   90d8     BCF       0xd8,0x0,0x0                                                                                    
002826   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002828   06e8     DECF      0xe8,0x1,0x0                                                                                    
00282a   e1fc     BNZ       0x2824                                                                                          
00282c   50f3     MOVF      0xf3,0x0,0x0                                                                                    
00282e   0100     MOVLB     0x0                                                                                             
002830   1368     IORWF     0x68,0x1,0x1                                                                                    
002832   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
002834   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002836   ffd9                                                                                                               
002838   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Explicitly disable a single LED without affecting the others */               D:\work\midicontroller\x013x\hwcalls.c
00283a   cfd9     MOVFF     0xfd9,0xfe6    void fsw_led_disable(int idx){                                                   D:\work\midicontroller\x013x\hwcalls.c
00283c   ffe6                                                                                                               
00283e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002840   ffd9                                                                                                               
002842   0e01     MOVLW     0x1            	clrbit(LedStates,idx);                                                          D:\work\midicontroller\x013x\hwcalls.c
002844   6ef3     MOVWF     0xf3,0x0                                                                                        
002846   0efd     MOVLW     0xfd                                                                                            
002848   50db     MOVF      0xdb,0x0,0x0                                                                                    
00284a   e004     BZ        0x2854                                                                                          
00284c   90d8     BCF       0xd8,0x0,0x0                                                                                    
00284e   36f3     RLCF      0xf3,0x1,0x0                                                                                    
002850   06e8     DECF      0xe8,0x1,0x0                                                                                    
002852   e1fc     BNZ       0x284c                                                                                          
002854   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002856   6e10     MOVWF     0x10,0x0                                                                                        
002858   6a11     CLRF      0x11,0x0                                                                                        
00285a   be10     BTFSC     0x10,0x7,0x0                                                                                    
00285c   6811     SETF      0x11,0x0                                                                                        
00285e   0eff     MOVLW     0xff                                                                                            
002860   1810     XORWF     0x10,0x0,0x0                                                                                    
002862   0100     MOVLB     0x0                                                                                             
002864   1768     ANDWF     0x68,0x1,0x1                                                                                    
002866   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
002868   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00286a   ffd9                                                                                                               
00286c   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Poll the slider switch to see which mode we're in: */                         D:\work\midicontroller\x013x\hwcalls.c
                                           u8 slider_poll(){                                                                D:\work\midicontroller\x013x\hwcalls.c
00286e   0100     MOVLB     0x0            	return	ModeSwitchState;                                                         D:\work\midicontroller\x013x\hwcalls.c
002870   5161     MOVF      0x61,0x0,0x1                                                                                    
002872   0b01     ANDLW     0x1                                                                                             
002874   d000     BRA       0x2876                                                                                          
002876   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Poll the expression pedal's data (0-127): */                                  D:\work\midicontroller\x013x\hwcalls.c
                                           u8 expr_poll(){                                                                  D:\work\midicontroller\x013x\hwcalls.c
                                           	                                                                                D:\work\midicontroller\x013x\hwcalls.c
002878   0e01     MOVLW     0x1            	ADC_CONVERSION(EXP_PEDAL_CHANNEL);                                              D:\work\midicontroller\x013x\hwcalls.c
00287a   6ee6     MOVWF     0xe6,0x0                                                                                        
00287c   de1e     RCALL     0x24ba                                                                                          
00287e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002880   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* --------------- Data persistence functions: */                                D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Gets number of stored banks */                                                D:\work\midicontroller\x013x\hwcalls.c
                                           u16 banks_count(){                                                               D:\work\midicontroller\x013x\hwcalls.c
002882   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Loads a bank into the specified arrays: */                                    D:\work\midicontroller\x013x\hwcalls.c
002884   cfd9     MOVFF     0xfd9,0xfe6    void bank_load(u16 bank_index, char name[BANK_NAME_MAXLENGTH], u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 *bankmap_count){ D:\work\midicontroller\x013x\hwcalls.c
002886   ffe6                                                                                                               
002888   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00288a   ffd9                                                                                                               
00288c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
00288e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002890   ffd9                                                                                                               
002892   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Stores the programs back to the bank: */                                      D:\work\midicontroller\x013x\hwcalls.c
002894   cfd9     MOVFF     0xfd9,0xfe6    void bank_store(u16 bank_index, u8 bank[BANK_PRESET_COUNT], u8 bankcontroller[BANK_PRESET_COUNT], u8 bankmap[BANK_MAP_COUNT], u8 bankmap_count){ D:\work\midicontroller\x013x\hwcalls.c
002896   ffe6                                                                                                               
002898   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
00289a   ffd9                                                                                                               
00289c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
00289e   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028a0   ffd9                                                                                                               
0028a2   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Load bank name for browsing through banks: */                                 D:\work\midicontroller\x013x\hwcalls.c
0028a4   cfd9     MOVFF     0xfd9,0xfe6    void bank_loadname(u16 bank_index, char name[BANK_NAME_MAXLENGTH]){              D:\work\midicontroller\x013x\hwcalls.c
0028a6   ffe6                                                                                                               
0028a8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028aa   ffd9                                                                                                               
0028ac   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0028ae   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028b0   ffd9                                                                                                               
0028b2   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Get the alphabetically sorted bank index */                                   D:\work\midicontroller\x013x\hwcalls.c
0028b4   cfd9     MOVFF     0xfd9,0xfe6    u16 bank_getsortedindex(u16 sort_index){                                         D:\work\midicontroller\x013x\hwcalls.c
0028b6   ffe6                                                                                                               
0028b8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028ba   ffd9                                                                                                               
0028bc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0028be   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028c0   ffd9                                                                                                               
0028c2   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* --------------- MIDI I/O functions: */                                        D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /* Send formatted MIDI commands.                                                 D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                               0 <= cmd <= F       - MIDI command                                           D:\work\midicontroller\x013x\hwcalls.c
                                               0 <= channel <= F   - MIDI channel to send command to                        D:\work\midicontroller\x013x\hwcalls.c
                                               00 <= data1 <= FF   - first data byte of MIDI command                        D:\work\midicontroller\x013x\hwcalls.c
                                               00 <= data2 <= FF   - second (optional) data byte of MIDI command            D:\work\midicontroller\x013x\hwcalls.c
                                           */                                                                               D:\work\midicontroller\x013x\hwcalls.c
0028c4   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd1(u8 cmd, u8 channel, u8 data1){                               D:\work\midicontroller\x013x\hwcalls.c
0028c6   ffe6                                                                                                               
0028c8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028ca   ffd9                                                                                                               
0028cc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0028ce   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028d0   ffd9                                                                                                               
0028d2   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
0028d4   cfd9     MOVFF     0xfd9,0xfe6    void midi_send_cmd2(u8 cmd, u8 channel, u8 data1, u8 data2){                     D:\work\midicontroller\x013x\hwcalls.c
0028d6   ffe6                                                                                                               
0028d8   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
0028da   ffd9                                                                                                               
0028dc   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\hwcalls.c
0028de   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0028e0   ffd9                                                                                                               
0028e2   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                                                                                                            D:\work\midicontroller\x013x\hwcalls.c
                                           /*                                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	A programmable MIDI foot controller.                                            D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	Written by James S. Dunne                                                       D:\work\midicontroller\x013x\controller.c
                                           	04/05/2007                                                                      D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	Possible hardware layout diagram:                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	(o)     = SPST rugged foot-switch                                               D:\work\midicontroller\x013x\controller.c
                                           	(*)     = Single on/off LED                                                     D:\work\midicontroller\x013x\controller.c
                                           	[ ... ] = LED 7-segment (or more) display                                       D:\work\midicontroller\x013x\controller.c
                                           	{\}		= slider switch                                                            D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                            PWR  MIDI OUT EXPR IN (opt)                                                     D:\work\midicontroller\x013x\controller.c
                                             |      ||      ||                                                              D:\work\midicontroller\x013x\controller.c
                                           /--------------------\                                                           D:\work\midicontroller\x013x\controller.c
                                           |                    |                                                           D:\work\midicontroller\x013x\controller.c
                                           | [8 8 8 8] {\}  [8] |                                                           D:\work\midicontroller\x013x\controller.c
                                           |                    |                                                           D:\work\midicontroller\x013x\controller.c
                                           | (*)  (*)  (*)  (*) |                                                           D:\work\midicontroller\x013x\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           D:\work\midicontroller\x013x\controller.c
                                           |  1    2    3    4  |                                                           D:\work\midicontroller\x013x\controller.c
                                           |                    |                                                           D:\work\midicontroller\x013x\controller.c
                                           | (o)  (o)  (o)  (o) |                                                           D:\work\midicontroller\x013x\controller.c
                                           | DEC  INC  ENTR NEXT|                                                           D:\work\midicontroller\x013x\controller.c
                                           |                    |                                                           D:\work\midicontroller\x013x\controller.c
                                           \--------------------/                                                           D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           NOTE:   CONCERT mode: Implement hold-down of preset button to                    D:\work\midicontroller\x013x\controller.c
                                           quick-switch to said preset, but on release switch back to last                  D:\work\midicontroller\x013x\controller.c
                                           preset.                                                                          D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           */                                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           #include "types.h"                                                               D:\work\midicontroller\x013x\controller.c
                                           #include "hardware.h"                                                            D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           const u8 midi_channel = 0;                                                       D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           u8      bank[BANK_PRESET_COUNT];                                                 D:\work\midicontroller\x013x\controller.c
                                           u8		bankcontroller[BANK_PRESET_COUNT];                                           D:\work\midicontroller\x013x\controller.c
                                           u8		bankmap[BANK_MAP_COUNT];                                                     D:\work\midicontroller\x013x\controller.c
                                           u8		bankmap_count;                                                               D:\work\midicontroller\x013x\controller.c
                                           char	bankname[BANK_NAME_MAXLENGTH];                                              D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* current settings */                                                           D:\work\midicontroller\x013x\controller.c
                                           u8      curr_program;                                                            D:\work\midicontroller\x013x\controller.c
                                           u8      curr_preset;                                                             D:\work\midicontroller\x013x\controller.c
                                           u8      curr_mapindex;                                                           D:\work\midicontroller\x013x\controller.c
                                           u16     curr_bank, loaded_bank;                                                  D:\work\midicontroller\x013x\controller.c
                                           u16		curr_sortedbank;                                                            D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           u16		bank_count;                                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           u32		preset_held = 0;                                                            D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* decrement timer in ms: */                                                     D:\work\midicontroller\x013x\controller.c
                                           u16		accel_time;                                                                 D:\work\midicontroller\x013x\controller.c
                                           u8		accel_count;                                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           u16		cdtimer_value = 0;                                                          D:\work\midicontroller\x013x\controller.c
                                           u16		cdtimer_flash = 0;                                                          D:\work\midicontroller\x013x\controller.c
                                           u16		cdtimer_store = 0;                                                          D:\work\midicontroller\x013x\controller.c
                                           u16		cdtimer_incdec_held = 0;                                                    D:\work\midicontroller\x013x\controller.c
                                           u16		cdtimer_holdenter = 0;                                                      D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           enum acceleration_state {                                                        D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_NONE,                                                                     D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_INC_SLOW,                                                                 D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_INC_MEDIUM,                                                               D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_INC_FAST,                                                                 D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_DEC_SLOW,                                                                 D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_DEC_MEDIUM,                                                               D:\work\midicontroller\x013x\controller.c
                                           	ACCEL_DEC_FAST                                                                  D:\work\midicontroller\x013x\controller.c
                                           } accel_state = ACCEL_NONE;                                                      D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           enum flashing_led_state {                                                        D:\work\midicontroller\x013x\controller.c
                                           	FLASH_NONE,                                                                     D:\work\midicontroller\x013x\controller.c
                                           	FLASH_STORE,                                                                    D:\work\midicontroller\x013x\controller.c
                                           	FLASH_BANK_SELECT_MODE,                                                         D:\work\midicontroller\x013x\controller.c
                                           	FLASH_PRGM_SELECT_MODE                                                          D:\work\midicontroller\x013x\controller.c
                                           } flash_state = FLASH_NONE;                                                      D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           enum program_modes {                                                             D:\work\midicontroller\x013x\controller.c
                                           	PROGRAM_NONE,                                                                   D:\work\midicontroller\x013x\controller.c
                                           	PROGRAM_SEQUENCE,                                                               D:\work\midicontroller\x013x\controller.c
                                           	PROGRAM_COMPLETE                                                                D:\work\midicontroller\x013x\controller.c
                                           } program_mode = PROGRAM_NONE;                                                   D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           u8		flash_led = 0;                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* time period in ms before value is changed */                                  D:\work\midicontroller\x013x\controller.c
                                           const u16 accel_time_slow	= 15;                                                  D:\work\midicontroller\x013x\controller.c
                                           const u16 accel_time_medium	=  5;                                                D:\work\midicontroller\x013x\controller.c
                                           const u16 accel_time_fast	=  2;                                                  D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           const u16 value_flashtime	= 75;                                                  D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* concert/practice main mode switch */                                          D:\work\midicontroller\x013x\controller.c
                                           enum mainmode {                                                                  D:\work\midicontroller\x013x\controller.c
                                           	MODE_PRACTICE = 0,                                                              D:\work\midicontroller\x013x\controller.c
                                           	MODE_CONCERT = 1                                                                D:\work\midicontroller\x013x\controller.c
                                           } mode;                                                                          D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* convert integer to ASCII in fixed number of chars, right-aligned */           D:\work\midicontroller\x013x\controller.c
000b20   cfd9     MOVFF     0xfd9,0xfe6    void itoa_fixed(u8 n, char s[LEDS_MAX_ALPHAS]) {                                 D:\work\midicontroller\x013x\controller.c
000b22   ffe6                                                                                                               
000b24   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000b26   ffd9                                                                                                               
000b28   52e6     MOVF      0xe6,0x1,0x0                                                                                    
000b2a   0e03     MOVLW     0x3            	u8 i = LEDS_MAX_ALPHAS - 1;                                                     D:\work\midicontroller\x013x\controller.c
000b2c   6edf     MOVWF     0xdf,0x0                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	do {                                                                            D:\work\midicontroller\x013x\controller.c
000b2e   0e0a     MOVLW     0xa            		s[i--] = (n%10) + '0';                                                         D:\work\midicontroller\x013x\controller.c
000b30   6e10     MOVWF     0x10,0x0                                                                                        
000b32   c010     MOVFF     0x10,0xc                                                                                        
000b34   f00c                                                                                                               
000b36   0efe     MOVLW     0xfe                                                                                            
000b38   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b3a   f007                                                                                                               
000b3c   ec7f     CALL      0x36fe,0x0                                                                                      
000b3e   f01b                                                                                                               
000b40   5003     MOVF      0x3,0x0,0x0                                                                                     
000b42   0f30     ADDLW     0x30                                                                                            
000b44   6ee6     MOVWF     0xe6,0x0                                                                                        
000b46   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b48   06df     DECF      0xdf,0x1,0x0                                                                                    
000b4a   6ee7     MOVWF     0xe7,0x0                                                                                        
000b4c   0efc     MOVLW     0xfc                                                                                            
000b4e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b50   ffe9                                                                                                               
000b52   0efd     MOVLW     0xfd                                                                                            
000b54   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b56   ffea                                                                                                               
000b58   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b5a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b5c   0e00     MOVLW     0x0                                                                                             
000b5e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000b60   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000b62   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b64   6eef     MOVWF     0xef,0x0                                                                                        
000b66   0e0a     MOVLW     0xa            	} while ((n /= 10) > 0);                                                        D:\work\midicontroller\x013x\controller.c
000b68   6e10     MOVWF     0x10,0x0                                                                                        
000b6a   c010     MOVFF     0x10,0xc                                                                                        
000b6c   f00c                                                                                                               
000b6e   0efe     MOVLW     0xfe                                                                                            
000b70   cfdb     MOVFF     0xfdb,0x7                                                                                       
000b72   f007                                                                                                               
000b74   ec7f     CALL      0x36fe,0x0                                                                                      
000b76   f01b                                                                                                               
000b78   0efe     MOVLW     0xfe                                                                                            
000b7a   c007     MOVFF     0x7,0xfdb                                                                                       
000b7c   ffdb                                                                                                               
000b7e   5007     MOVF      0x7,0x0,0x0                                                                                     
000b80   0800     SUBLW     0x0                                                                                             
000b82   e3d5     BNC       0xb2e                                                                                           
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* pad the left chars with spaces: */                                           D:\work\midicontroller\x013x\controller.c
000b84   50df     MOVF      0xdf,0x0,0x0   	for (;i > 0;--i) s[i] = ' ';                                                    D:\work\midicontroller\x013x\controller.c
000b86   0800     SUBLW     0x0                                                                                             
000b88   e210     BC        0xbaa                                                                                           
000b8a   50df     MOVF      0xdf,0x0,0x0                                                                                    
000b8c   6ee7     MOVWF     0xe7,0x0                                                                                        
000b8e   0efc     MOVLW     0xfc                                                                                            
000b90   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000b92   ffe9                                                                                                               
000b94   0efd     MOVLW     0xfd                                                                                            
000b96   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000b98   ffea                                                                                                               
000b9a   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000b9c   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000b9e   0e00     MOVLW     0x0                                                                                             
000ba0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000ba2   0e20     MOVLW     0x20                                                                                            
000ba4   6eef     MOVWF     0xef,0x0                                                                                        
000ba6   06df     DECF      0xdf,0x1,0x0                                                                                    
000ba8   d7ed     BRA       0xb84                                                                                           
000baa   50df     MOVF      0xdf,0x0,0x0   	s[i] = ' ';                                                                     D:\work\midicontroller\x013x\controller.c
000bac   6ee7     MOVWF     0xe7,0x0                                                                                        
000bae   0efc     MOVLW     0xfc                                                                                            
000bb0   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
000bb2   ffe9                                                                                                               
000bb4   0efd     MOVLW     0xfd                                                                                            
000bb6   cfdb     MOVFF     0xfdb,0xfea                                                                                     
000bb8   ffea                                                                                                               
000bba   50e7     MOVF      0xe7,0x0,0x0                                                                                    
000bbc   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
000bbe   0e00     MOVLW     0x0                                                                                             
000bc0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000bc2   0e20     MOVLW     0x20                                                                                            
000bc4   6eef     MOVWF     0xef,0x0                                                                                        
000bc6   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000bc8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bca   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000bcc   ffd9                                                                                                               
000bce   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* display a program value in decimal with a leading 'P': */                     D:\work\midicontroller\x013x\controller.c
000bd0   cfd9     MOVFF     0xfd9,0xfe6    void show_program() {                                                            D:\work\midicontroller\x013x\controller.c
000bd2   ffe6                                                                                                               
000bd4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000bd6   ffd9                                                                                                               
000bd8   0e04     MOVLW     0x4                                                                                             
000bda   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	char	a[LEDS_MAX_ALPHAS];                                                        D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* convert curr_program to ASCII: */                                            D:\work\midicontroller\x013x\controller.c
000bdc   cfd9     MOVFF     0xfd9,0xfe6    	itoa_fixed(curr_program + 1, a);                                                D:\work\midicontroller\x013x\controller.c
000bde   ffe6                                                                                                               
000be0   cfda     MOVFF     0xfda,0xfe6                                                                                     
000be2   ffe6                                                                                                               
000be4   0101     MOVLB     0x1                                                                                             
000be6   2915     INCF      0x15,0x0,0x1                                                                                    
000be8   6ee6     MOVWF     0xe6,0x0                                                                                        
000bea   df9a     RCALL     0xb20                                                                                           
000bec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000bf0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* leading 'P' char: */                                                         D:\work\midicontroller\x013x\controller.c
000bf2   0e50     MOVLW     0x50           	a[0] = 'P';                                                                     D:\work\midicontroller\x013x\controller.c
000bf4   6edf     MOVWF     0xdf,0x0                                                                                        
000bf6   cfd9     MOVFF     0xfd9,0xfe6    	leds_show_4alphas(a);                                                           D:\work\midicontroller\x013x\controller.c
000bf8   ffe6                                                                                                               
000bfa   cfda     MOVFF     0xfda,0xfe6                                                                                     
000bfc   ffe6                                                                                                               
000bfe   ecc6     CALL      0x2d8c,0x0                                                                                      
000c00   f016                                                                                                               
000c02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c04   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* start timer to revert the display: */                                        D:\work\midicontroller\x013x\controller.c
000c06   c13b     MOVFF     0x13b,0x127    	cdtimer_value = value_flashtime;                                                D:\work\midicontroller\x013x\controller.c
000c08   f127                                                                                                               
000c0a   c13c     MOVFF     0x13c,0x128                                                                                     
000c0c   f128                                                                                                               
000c0e   0e04     MOVLW     0x4            }                                                                                D:\work\midicontroller\x013x\controller.c
000c10   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
000c12   e202     BC        0xc18                                                                                           
000c14   6ae1     CLRF      0xe1,0x0                                                                                        
000c16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c18   6ee1     MOVWF     0xe1,0x0                                                                                        
000c1a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c1c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c1e   ffd9                                                                                                               
000c20   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* send the MIDI program change message */                                       D:\work\midicontroller\x013x\controller.c
000c22   cfd9     MOVFF     0xfd9,0xfe6    void program_activate(u8 notify) {                                               D:\work\midicontroller\x013x\controller.c
000c24   ffe6                                                                                                               
000c26   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c28   ffd9                                                                                                               
000c2a   c115     MOVFF     0x115,0xfe6    	midi_send_cmd1(0xC, midi_channel, curr_program);                                D:\work\midicontroller\x013x\controller.c
000c2c   ffe6                                                                                                               
000c2e   c124     MOVFF     0x124,0xfe6                                                                                     
000c30   ffe6                                                                                                               
000c32   0e0c     MOVLW     0xc                                                                                             
000c34   6ee6     MOVWF     0xe6,0x0                                                                                        
000c36   ec62     CALL      0x28c4,0x0                                                                                      
000c38   f014                                                                                                               
000c3a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c3c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c40   0efe     MOVLW     0xfe           	if (notify) {                                                                   D:\work\midicontroller\x013x\controller.c
000c42   50db     MOVF      0xdb,0x0,0x0                                                                                    
000c44   e001     BZ        0xc48                                                                                           
                                           		/* show the program value: */                                                  D:\work\midicontroller\x013x\controller.c
000c46   dfc4     RCALL     0xbd0          		show_program();                                                                D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
000c48   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000c4a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c4c   ffd9                                                                                                               
000c4e   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* activate current preset */                                                    D:\work\midicontroller\x013x\controller.c
000c50   cfd9     MOVFF     0xfd9,0xfe6    void preset_activate(u8 notify) {                                                D:\work\midicontroller\x013x\controller.c
000c52   ffe6                                                                                                               
000c54   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000c56   ffd9                                                                                                               
                                           	/* grab the program # from the bank */                                          D:\work\midicontroller\x013x\controller.c
000c58   0101     MOVLB     0x1            	curr_program = bank[curr_preset];                                               D:\work\midicontroller\x013x\controller.c
000c5a   5116     MOVF      0x16,0x0,0x1                                                                                    
000c5c   6aea     CLRF      0xea,0x0                                                                                        
000c5e   0f00     ADDLW     0x0                                                                                             
000c60   6ee9     MOVWF     0xe9,0x0                                                                                        
000c62   0e01     MOVLW     0x1                                                                                             
000c64   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000c66   cfef     MOVFF     0xfef,0x115                                                                                     
000c68   f115                                                                                                               
000c6a   0efe     MOVLW     0xfe           	program_activate(notify);                                                       D:\work\midicontroller\x013x\controller.c
000c6c   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000c6e   ffe6                                                                                                               
000c70   dfd8     RCALL     0xc22                                                                                           
000c72   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* activate the footswitch LED: */                                              D:\work\midicontroller\x013x\controller.c
000c74   0101     MOVLB     0x1            	fsw_led_set_active(curr_preset);                                                D:\work\midicontroller\x013x\controller.c
000c76   5116     MOVF      0x16,0x0,0x1                                                                                    
000c78   6ee6     MOVWF     0xe6,0x0                                                                                        
000c7a   6ae6     CLRF      0xe6,0x0                                                                                        
000c7c   ecf3     CALL      0x27e6,0x0                                                                                      
000c7e   f013                                                                                                               
000c80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c82   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c84   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000c86   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000c88   ffd9                                                                                                               
000c8a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* display the sequence index on the 1-digit LED display: */                     D:\work\midicontroller\x013x\controller.c
                                           void bankmap_show() {                                                            D:\work\midicontroller\x013x\controller.c
000c8c   0101     MOVLB     0x1            	leds_show_1digit(curr_mapindex + 1);                                            D:\work\midicontroller\x013x\controller.c
000c8e   2917     INCF      0x17,0x0,0x1                                                                                    
000c90   6ee6     MOVWF     0xe6,0x0                                                                                        
000c92   ec01     CALL      0x2e02,0x0                                                                                      
000c94   f017                                                                                                               
000c96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000c98   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* activate the preset for the current bank map index */                         D:\work\midicontroller\x013x\controller.c
000c9a   cfd9     MOVFF     0xfd9,0xfe6    void bankmap_activate(u8 notify) {                                               D:\work\midicontroller\x013x\controller.c
000c9c   ffe6                                                                                                               
000c9e   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ca0   ffd9                                                                                                               
                                           	/* switch preset */                                                             D:\work\midicontroller\x013x\controller.c
000ca2   c118     MOVFF     0x118,0x11a    	loaded_bank = curr_bank;                                                        D:\work\midicontroller\x013x\controller.c
000ca4   f11a                                                                                                               
000ca6   c119     MOVFF     0x119,0x11b                                                                                     
000ca8   f11b                                                                                                               
000caa   0101     MOVLB     0x1            	curr_preset = bankmap[curr_mapindex];                                           D:\work\midicontroller\x013x\controller.c
000cac   5117     MOVF      0x17,0x0,0x1                                                                                    
000cae   6aea     CLRF      0xea,0x0                                                                                        
000cb0   0f08     ADDLW     0x8                                                                                             
000cb2   6ee9     MOVWF     0xe9,0x0                                                                                        
000cb4   0e01     MOVLW     0x1                                                                                             
000cb6   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
000cb8   cfef     MOVFF     0xfef,0x116                                                                                     
000cba   f116                                                                                                               
000cbc   0efe     MOVLW     0xfe           	preset_activate(notify);                                                        D:\work\midicontroller\x013x\controller.c
000cbe   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000cc0   ffe6                                                                                                               
000cc2   dfc6     RCALL     0xc50                                                                                           
000cc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	/* always show the bank map index */                                            D:\work\midicontroller\x013x\controller.c
000cc6   dfe2     RCALL     0xc8c          	bankmap_show();                                                                 D:\work\midicontroller\x013x\controller.c
000cc8   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000cca   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ccc   ffd9                                                                                                               
000cce   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* load current bank but do not switch to a preset */                            D:\work\midicontroller\x013x\controller.c
000cd0   cfd9     MOVFF     0xfd9,0xfe6    void bank_activate(u8 notify) {                                                  D:\work\midicontroller\x013x\controller.c
000cd2   ffe6                                                                                                               
000cd4   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000cd6   ffd9                                                                                                               
                                           	/* load up the selected bank: */                                                D:\work\midicontroller\x013x\controller.c
000cd8   0e10     MOVLW     0x10           	bank_load(curr_bank, bankname, bank, bankcontroller, bankmap, &bankmap_count);  D:\work\midicontroller\x013x\controller.c
000cda   6ee6     MOVWF     0xe6,0x0                                                                                        
000cdc   0e01     MOVLW     0x1                                                                                             
000cde   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce0   0e08     MOVLW     0x8                                                                                             
000ce2   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce4   0e01     MOVLW     0x1                                                                                             
000ce6   6ee6     MOVWF     0xe6,0x0                                                                                        
000ce8   0e04     MOVLW     0x4                                                                                             
000cea   6ee6     MOVWF     0xe6,0x0                                                                                        
000cec   0e01     MOVLW     0x1                                                                                             
000cee   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf0   0e00     MOVLW     0x0                                                                                             
000cf2   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf4   0e01     MOVLW     0x1                                                                                             
000cf6   6ee6     MOVWF     0xe6,0x0                                                                                        
000cf8   0e11     MOVLW     0x11                                                                                            
000cfa   6ee6     MOVWF     0xe6,0x0                                                                                        
000cfc   0e01     MOVLW     0x1                                                                                             
000cfe   6ee6     MOVWF     0xe6,0x0                                                                                        
000d00   c118     MOVFF     0x118,0xfe6                                                                                     
000d02   ffe6                                                                                                               
000d04   c119     MOVFF     0x119,0xfe6                                                                                     
000d06   ffe6                                                                                                               
000d08   ec42     CALL      0x2884,0x0                                                                                      
000d0a   f014                                                                                                               
000d0c   6e10     MOVWF     0x10,0x0                                                                                        
000d0e   0e0c     MOVLW     0xc                                                                                             
000d10   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
000d12   5010     MOVF      0x10,0x0,0x0                                                                                    
000d14   0101     MOVLB     0x1            	curr_mapindex = 0;                                                              D:\work\midicontroller\x013x\controller.c
000d16   6b17     CLRF      0x17,0x1                                                                                        
                                           	/* always show the bank map index */                                            D:\work\midicontroller\x013x\controller.c
000d18   2917     INCF      0x17,0x0,0x1   	leds_show_1digit(curr_mapindex + 1);                                            D:\work\midicontroller\x013x\controller.c
000d1a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d1c   ec01     CALL      0x2e02,0x0                                                                                      
000d1e   f017                                                                                                               
000d20   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d22   0efe     MOVLW     0xfe           	if (notify) {                                                                   D:\work\midicontroller\x013x\controller.c
000d24   50db     MOVF      0xdb,0x0,0x0                                                                                    
000d26   e008     BZ        0xd38                                                                                           
                                           		/* display bank name: */                                                       D:\work\midicontroller\x013x\controller.c
000d28   0e11     MOVLW     0x11           		leds_show_4alphas(bankname);                                                   D:\work\midicontroller\x013x\controller.c
000d2a   6ee6     MOVWF     0xe6,0x0                                                                                        
000d2c   0e01     MOVLW     0x1                                                                                             
000d2e   6ee6     MOVWF     0xe6,0x0                                                                                        
000d30   ecc6     CALL      0x2d8c,0x0                                                                                      
000d32   f016                                                                                                               
000d34   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d36   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
000d38   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000d3a   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d3c   ffd9                                                                                                               
000d3e   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* load the real bank # from the sorted index */                                 D:\work\midicontroller\x013x\controller.c
000d40   cfd9     MOVFF     0xfd9,0xfe6    void sortedbank_activate(u8 notify) {                                            D:\work\midicontroller\x013x\controller.c
000d42   ffe6                                                                                                               
000d44   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000d46   ffd9                                                                                                               
000d48   c11c     MOVFF     0x11c,0xfe6    	curr_bank = bank_getsortedindex(curr_sortedbank);                               D:\work\midicontroller\x013x\controller.c
000d4a   ffe6                                                                                                               
000d4c   c11d     MOVFF     0x11d,0xfe6                                                                                     
000d4e   ffe6                                                                                                               
000d50   ec5a     CALL      0x28b4,0x0                                                                                      
000d52   f014                                                                                                               
000d54   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d56   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d58   cff3     MOVFF     0xff3,0x118                                                                                     
000d5a   f118                                                                                                               
000d5c   cff4     MOVFF     0xff4,0x119                                                                                     
000d5e   f119                                                                                                               
000d60   0efe     MOVLW     0xfe           	bank_activate(notify);                                                          D:\work\midicontroller\x013x\controller.c
000d62   cfdb     MOVFF     0xfdb,0xfe6                                                                                     
000d64   ffe6                                                                                                               
000d66   dfb4     RCALL     0xcd0                                                                                           
000d68   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d6a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000d6c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000d6e   ffd9                                                                                                               
000d70   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* load only current bank name and display it on 4-digit display */              D:\work\midicontroller\x013x\controller.c
                                           void bank_showname() {                                                           D:\work\midicontroller\x013x\controller.c
000d72   0e11     MOVLW     0x11           	bank_loadname(curr_bank, bankname);                                             D:\work\midicontroller\x013x\controller.c
000d74   6ee6     MOVWF     0xe6,0x0                                                                                        
000d76   0e01     MOVLW     0x1                                                                                             
000d78   6ee6     MOVWF     0xe6,0x0                                                                                        
000d7a   c118     MOVFF     0x118,0xfe6                                                                                     
000d7c   ffe6                                                                                                               
000d7e   c119     MOVFF     0x119,0xfe6                                                                                     
000d80   ffe6                                                                                                               
000d82   ec52     CALL      0x28a4,0x0                                                                                      
000d84   f014                                                                                                               
000d86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d8e   0e11     MOVLW     0x11           	leds_show_4alphas(bankname);                                                    D:\work\midicontroller\x013x\controller.c
000d90   6ee6     MOVWF     0xe6,0x0                                                                                        
000d92   0e01     MOVLW     0x1                                                                                             
000d94   6ee6     MOVWF     0xe6,0x0                                                                                        
000d96   ecc6     CALL      0x2d8c,0x0                                                                                      
000d98   f016                                                                                                               
000d9a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000d9e   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* load only current bank name from the sorted index and display it on 4-digit display */ D:\work\midicontroller\x013x\controller.c
                                           void sortedbank_showname() {                                                     D:\work\midicontroller\x013x\controller.c
000da0   0101     MOVLB     0x1            	if (program_mode != PROGRAM_NONE) {                                             D:\work\midicontroller\x013x\controller.c
000da2   5133     MOVF      0x33,0x0,0x1                                                                                    
000da4   e009     BZ        0xdb8                                                                                           
000da6   0e2e     MOVLW     0x2e           		leds_show_4alphas("SEQ-");                                                     D:\work\midicontroller\x013x\controller.c
000da8   6ee6     MOVWF     0xe6,0x0                                                                                        
000daa   0e37     MOVLW     0x37                                                                                            
000dac   6ee6     MOVWF     0xe6,0x0                                                                                        
000dae   ecc6     CALL      0x2d8c,0x0                                                                                      
000db0   f016                                                                                                               
000db2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000db6   d022     BRA       0xdfc          	} else {                                                                        D:\work\midicontroller\x013x\controller.c
000db8   c11c     MOVFF     0x11c,0xfe6    		curr_bank = bank_getsortedindex(curr_sortedbank);                              D:\work\midicontroller\x013x\controller.c
000dba   ffe6                                                                                                               
000dbc   c11d     MOVFF     0x11d,0xfe6                                                                                     
000dbe   ffe6                                                                                                               
000dc0   ec5a     CALL      0x28b4,0x0                                                                                      
000dc2   f014                                                                                                               
000dc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dc6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dc8   cff3     MOVFF     0xff3,0x118                                                                                     
000dca   f118                                                                                                               
000dcc   cff4     MOVFF     0xff4,0x119                                                                                     
000dce   f119                                                                                                               
000dd0   0e11     MOVLW     0x11           		bank_loadname(curr_bank, bankname);                                            D:\work\midicontroller\x013x\controller.c
000dd2   6ee6     MOVWF     0xe6,0x0                                                                                        
000dd4   0e01     MOVLW     0x1                                                                                             
000dd6   6ee6     MOVWF     0xe6,0x0                                                                                        
000dd8   c118     MOVFF     0x118,0xfe6                                                                                     
000dda   ffe6                                                                                                               
000ddc   c119     MOVFF     0x119,0xfe6                                                                                     
000dde   ffe6                                                                                                               
000de0   ec52     CALL      0x28a4,0x0                                                                                      
000de2   f014                                                                                                               
000de4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000de6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000de8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dec   0e11     MOVLW     0x11           		leds_show_4alphas(bankname);                                                   D:\work\midicontroller\x013x\controller.c
000dee   6ee6     MOVWF     0xe6,0x0                                                                                        
000df0   0e01     MOVLW     0x1                                                                                             
000df2   6ee6     MOVWF     0xe6,0x0                                                                                        
000df4   ecc6     CALL      0x2d8c,0x0                                                                                      
000df6   f016                                                                                                               
000df8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000dfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
000dfc   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* current and previous foot-switch states: */                                   D:\work\midicontroller\x013x\controller.c
                                           u32		sw_curr = 0, sw_last = 0;                                                   D:\work\midicontroller\x013x\controller.c
                                           u8		cc_curr = 0, cc_last = 0;                                                    D:\work\midicontroller\x013x\controller.c
                                           u8		switch_state = 0, store_state = 0;                                           D:\work\midicontroller\x013x\controller.c
                                           u8		incdec_mode = 0;                                                             D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* determine if a footswitch was pressed: */                                     D:\work\midicontroller\x013x\controller.c
000dfe   cfd9     MOVFF     0xfd9,0xfe6    u8 button_pressed(u32 mask) {                                                    D:\work\midicontroller\x013x\controller.c
000e00   ffe6                                                                                                               
000e02   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e04   ffd9                                                                                                               
000e06   0efd     MOVLW     0xfd           	return ((sw_curr & mask) == mask) && ((sw_last & mask) == 0);                   D:\work\midicontroller\x013x\controller.c
000e08   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e0a   0101     MOVLB     0x1                                                                                             
000e0c   153d     ANDWF     0x3d,0x0,0x1                                                                                    
000e0e   0100     MOVLB     0x0                                                                                             
000e10   6e10     MOVWF     0x10,0x0                                                                                        
000e12   0efe     MOVLW     0xfe                                                                                            
000e14   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e16   0101     MOVLB     0x1                                                                                             
000e18   153e     ANDWF     0x3e,0x0,0x1                                                                                    
000e1a   0100     MOVLB     0x0                                                                                             
000e1c   6e11     MOVWF     0x11,0x0                                                                                        
000e1e   0efd     MOVLW     0xfd                                                                                            
000e20   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e22   1810     XORWF     0x10,0x0,0x0                                                                                    
000e24   e103     BNZ       0xe2c                                                                                           
000e26   0efe     MOVLW     0xfe                                                                                            
000e28   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e2a   1811     XORWF     0x11,0x0,0x0                                                                                    
000e2c   e10f     BNZ       0xe4c                                                                                           
000e2e   0efd     MOVLW     0xfd                                                                                            
000e30   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e32   0101     MOVLB     0x1                                                                                             
000e34   153f     ANDWF     0x3f,0x0,0x1                                                                                    
000e36   0100     MOVLB     0x0                                                                                             
000e38   6e12     MOVWF     0x12,0x0                                                                                        
000e3a   0efe     MOVLW     0xfe                                                                                            
000e3c   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e3e   0101     MOVLB     0x1                                                                                             
000e40   1540     ANDWF     0x40,0x0,0x1                                                                                    
000e42   0100     MOVLB     0x0                                                                                             
000e44   6e13     MOVWF     0x13,0x0                                                                                        
000e46   5012     MOVF      0x12,0x0,0x0                                                                                    
000e48   1013     IORWF     0x13,0x0,0x0                                                                                    
000e4a   e002     BZ        0xe50                                                                                           
000e4c   0e00     MOVLW     0x0                                                                                             
000e4e   d001     BRA       0xe52                                                                                           
000e50   0e01     MOVLW     0x1                                                                                             
000e52   d000     BRA       0xe54                                                                                           
000e54   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000e56   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e58   ffd9                                                                                                               
000e5a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* determine if still holding footswitch: */                                     D:\work\midicontroller\x013x\controller.c
000e5c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_held(u32 mask) {                                                       D:\work\midicontroller\x013x\controller.c
000e5e   ffe6                                                                                                               
000e60   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000e62   ffd9                                                                                                               
000e64   0efd     MOVLW     0xfd           	return (sw_curr & mask) == mask;                                                D:\work\midicontroller\x013x\controller.c
000e66   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e68   0101     MOVLB     0x1                                                                                             
000e6a   153d     ANDWF     0x3d,0x0,0x1                                                                                    
000e6c   0100     MOVLB     0x0                                                                                             
000e6e   6e10     MOVWF     0x10,0x0                                                                                        
000e70   0efe     MOVLW     0xfe                                                                                            
000e72   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e74   0101     MOVLB     0x1                                                                                             
000e76   153e     ANDWF     0x3e,0x0,0x1                                                                                    
000e78   0100     MOVLB     0x0                                                                                             
000e7a   6e11     MOVWF     0x11,0x0                                                                                        
000e7c   0efd     MOVLW     0xfd                                                                                            
000e7e   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e80   1810     XORWF     0x10,0x0,0x0                                                                                    
000e82   e103     BNZ       0xe8a                                                                                           
000e84   0efe     MOVLW     0xfe                                                                                            
000e86   50db     MOVF      0xdb,0x0,0x0                                                                                    
000e88   1811     XORWF     0x11,0x0,0x0                                                                                    
000e8a   e002     BZ        0xe90                                                                                           
000e8c   0e00     MOVLW     0x0                                                                                             
000e8e   d001     BRA       0xe92                                                                                           
000e90   0e01     MOVLW     0x1                                                                                             
000e92   d000     BRA       0xe94                                                                                           
000e94   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000e96   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000e98   ffd9                                                                                                               
000e9a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* determine if a footswitch was released: */                                    D:\work\midicontroller\x013x\controller.c
000e9c   cfd9     MOVFF     0xfd9,0xfe6    u8 button_released(u32 mask) {                                                   D:\work\midicontroller\x013x\controller.c
000e9e   ffe6                                                                                                               
000ea0   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
000ea2   ffd9                                                                                                               
000ea4   0efd     MOVLW     0xfd           	return ((sw_last & mask) == mask) && ((sw_curr & mask) == 0);                   D:\work\midicontroller\x013x\controller.c
000ea6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ea8   0101     MOVLB     0x1                                                                                             
000eaa   153f     ANDWF     0x3f,0x0,0x1                                                                                    
000eac   0100     MOVLB     0x0                                                                                             
000eae   6e10     MOVWF     0x10,0x0                                                                                        
000eb0   0efe     MOVLW     0xfe                                                                                            
000eb2   50db     MOVF      0xdb,0x0,0x0                                                                                    
000eb4   0101     MOVLB     0x1                                                                                             
000eb6   1540     ANDWF     0x40,0x0,0x1                                                                                    
000eb8   0100     MOVLB     0x0                                                                                             
000eba   6e11     MOVWF     0x11,0x0                                                                                        
000ebc   0efd     MOVLW     0xfd                                                                                            
000ebe   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ec0   1810     XORWF     0x10,0x0,0x0                                                                                    
000ec2   e103     BNZ       0xeca                                                                                           
000ec4   0efe     MOVLW     0xfe                                                                                            
000ec6   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ec8   1811     XORWF     0x11,0x0,0x0                                                                                    
000eca   e10f     BNZ       0xeea                                                                                           
000ecc   0efd     MOVLW     0xfd                                                                                            
000ece   50db     MOVF      0xdb,0x0,0x0                                                                                    
000ed0   0101     MOVLB     0x1                                                                                             
000ed2   153d     ANDWF     0x3d,0x0,0x1                                                                                    
000ed4   0100     MOVLB     0x0                                                                                             
000ed6   6e12     MOVWF     0x12,0x0                                                                                        
000ed8   0efe     MOVLW     0xfe                                                                                            
000eda   50db     MOVF      0xdb,0x0,0x0                                                                                    
000edc   0101     MOVLB     0x1                                                                                             
000ede   153e     ANDWF     0x3e,0x0,0x1                                                                                    
000ee0   0100     MOVLB     0x0                                                                                             
000ee2   6e13     MOVWF     0x13,0x0                                                                                        
000ee4   5012     MOVF      0x12,0x0,0x0                                                                                    
000ee6   1013     IORWF     0x13,0x0,0x0                                                                                    
000ee8   e002     BZ        0xeee                                                                                           
000eea   0e00     MOVLW     0x0                                                                                             
000eec   d001     BRA       0xef0                                                                                           
000eee   0e01     MOVLW     0x1                                                                                             
000ef0   d000     BRA       0xef2                                                                                           
000ef2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\controller.c
000ef4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
000ef6   ffd9                                                                                                               
000ef8   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* called every 10ms */                                                          D:\work\midicontroller\x013x\controller.c
                                           void controller_10msec_timer() {                                                 D:\work\midicontroller\x013x\controller.c
                                           	/* handle inc/dec acceleration: */                                              D:\work\midicontroller\x013x\controller.c
000efa   0101     MOVLB     0x1            	if (accel_state != ACCEL_NONE) {                                                D:\work\midicontroller\x013x\controller.c
000efc   5131     MOVF      0x31,0x0,0x1                                                                                    
000efe   e00a     BZ        0xf14                                                                                           
000f00   0101     MOVLB     0x1            		if (accel_time > 0) --accel_time;                                              D:\work\midicontroller\x013x\controller.c
000f02   0e00     MOVLW     0x0                                                                                             
000f04   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f06   5520     SUBFWB    0x20,0x0,0x1                                                                                    
000f08   0e00     MOVLW     0x0                                                                                             
000f0a   5521     SUBFWB    0x21,0x0,0x1                                                                                    
000f0c   e203     BC        0xf14                                                                                           
000f0e   0720     DECF      0x20,0x1,0x1                                                                                    
000f10   0e00     MOVLW     0x0                                                                                             
000f12   5b21     SUBWFB    0x21,0x1,0x1                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* handle simple count-down timers: */                                          D:\work\midicontroller\x013x\controller.c
000f14   0101     MOVLB     0x1            	if (cdtimer_store > 0) --cdtimer_store;                                         D:\work\midicontroller\x013x\controller.c
000f16   0e00     MOVLW     0x0                                                                                             
000f18   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f1a   552b     SUBFWB    0x2b,0x0,0x1                                                                                    
000f1c   0e00     MOVLW     0x0                                                                                             
000f1e   552c     SUBFWB    0x2c,0x0,0x1                                                                                    
000f20   e203     BC        0xf28                                                                                           
000f22   072b     DECF      0x2b,0x1,0x1                                                                                    
000f24   0e00     MOVLW     0x0                                                                                             
000f26   5b2c     SUBWFB    0x2c,0x1,0x1                                                                                    
000f28   0e00     MOVLW     0x0            	if (cdtimer_incdec_held > 0) --cdtimer_incdec_held;                             D:\work\midicontroller\x013x\controller.c
000f2a   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f2c   552d     SUBFWB    0x2d,0x0,0x1                                                                                    
000f2e   0e00     MOVLW     0x0                                                                                             
000f30   552e     SUBFWB    0x2e,0x0,0x1                                                                                    
000f32   e203     BC        0xf3a                                                                                           
000f34   072d     DECF      0x2d,0x1,0x1                                                                                    
000f36   0e00     MOVLW     0x0                                                                                             
000f38   5b2e     SUBWFB    0x2e,0x1,0x1                                                                                    
000f3a   0e00     MOVLW     0x0            	if (cdtimer_value > 0) {                                                        D:\work\midicontroller\x013x\controller.c
000f3c   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f3e   5527     SUBFWB    0x27,0x0,0x1                                                                                    
000f40   0e00     MOVLW     0x0                                                                                             
000f42   5528     SUBFWB    0x28,0x0,0x1                                                                                    
000f44   e20c     BC        0xf5e                                                                                           
000f46   0727     DECF      0x27,0x1,0x1   		--cdtimer_value;                                                               D:\work\midicontroller\x013x\controller.c
000f48   0e00     MOVLW     0x0                                                                                             
000f4a   5b28     SUBWFB    0x28,0x1,0x1                                                                                    
000f4c   5127     MOVF      0x27,0x0,0x1   		if (cdtimer_value == 0) {                                                      D:\work\midicontroller\x013x\controller.c
000f4e   1128     IORWF     0x28,0x0,0x1                                                                                    
000f50   e106     BNZ       0xf5e                                                                                           
000f52   0101     MOVLB     0x1            			if (mode == MODE_CONCERT) bank_showname();                                    D:\work\midicontroller\x013x\controller.c
000f54   0523     DECF      0x23,0x0,0x1                                                                                    
000f56   e102     BNZ       0xf5c                                                                                           
000f58   df0c     RCALL     0xd72                                                                                           
000f5a   d001     BRA       0xf5e          			else sortedbank_showname();                                                   D:\work\midicontroller\x013x\controller.c
000f5c   df21     RCALL     0xda0                                                                                           
                                           		}                                                                              D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
000f5e   0101     MOVLB     0x1            	if (cdtimer_holdenter > 0) --cdtimer_holdenter;                                 D:\work\midicontroller\x013x\controller.c
000f60   0e00     MOVLW     0x0                                                                                             
000f62   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f64   552f     SUBFWB    0x2f,0x0,0x1                                                                                    
000f66   0e00     MOVLW     0x0                                                                                             
000f68   5530     SUBFWB    0x30,0x0,0x1                                                                                    
000f6a   e203     BC        0xf72                                                                                           
000f6c   072f     DECF      0x2f,0x1,0x1                                                                                    
000f6e   0e00     MOVLW     0x0                                                                                             
000f70   5b30     SUBWFB    0x30,0x1,0x1                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* handle LED flashing states: */                                               D:\work\midicontroller\x013x\controller.c
000f72   0e00     MOVLW     0x0            	if (cdtimer_flash > 0) {                                                        D:\work\midicontroller\x013x\controller.c
000f74   80d8     BSF       0xd8,0x0,0x0                                                                                    
000f76   5529     SUBFWB    0x29,0x0,0x1                                                                                    
000f78   0e00     MOVLW     0x0                                                                                             
000f7a   552a     SUBFWB    0x2a,0x0,0x1                                                                                    
000f7c   e301     BNC       0xf80                                                                                           
000f7e   d0bf     BRA       0x10fe                                                                                          
000f80   5132     MOVF      0x32,0x0,0x1   		switch (flash_state) {                                                         D:\work\midicontroller\x013x\controller.c
000f82   0a03     XORLW     0x3                                                                                             
000f84   e067     BZ        0x1054                                                                                          
000f86   0a01     XORLW     0x1                                                                                             
000f88   e01f     BZ        0xfc8                                                                                           
000f8a   0a03     XORLW     0x3                                                                                             
000f8c   e001     BZ        0xf90                                                                                           
000f8e   d0a8     BRA       0x10e0                                                                                          
                                           			case FLASH_STORE:                                                             D:\work\midicontroller\x013x\controller.c
000f90   5129     MOVF      0x29,0x0,0x1   				if ((cdtimer_flash & 31) == 0) {                                             D:\work\midicontroller\x013x\controller.c
000f92   0b1f     ANDLW     0x1f                                                                                            
000f94   e108     BNZ       0xfa6                                                                                           
000f96   5134     MOVF      0x34,0x0,0x1   					fsw_led_enable(flash_led);                                                  D:\work\midicontroller\x013x\controller.c
000f98   6ee6     MOVWF     0xe6,0x0                                                                                        
000f9a   6ae6     CLRF      0xe6,0x0                                                                                        
000f9c   ec09     CALL      0x2812,0x0                                                                                      
000f9e   f014                                                                                                               
000fa0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fa4   d010     BRA       0xfc6          				} else if ((cdtimer_flash & 31) == 15) {                                     D:\work\midicontroller\x013x\controller.c
000fa6   0e1f     MOVLW     0x1f                                                                                            
000fa8   1529     ANDWF     0x29,0x0,0x1                                                                                    
000faa   6e10     MOVWF     0x10,0x0                                                                                        
000fac   6a11     CLRF      0x11,0x0                                                                                        
000fae   0e0f     MOVLW     0xf                                                                                             
000fb0   1810     XORWF     0x10,0x0,0x0                                                                                    
000fb2   e101     BNZ       0xfb6                                                                                           
000fb4   5011     MOVF      0x11,0x0,0x0                                                                                    
000fb6   e107     BNZ       0xfc6                                                                                           
000fb8   5134     MOVF      0x34,0x0,0x1   					fsw_led_disable(flash_led);                                                 D:\work\midicontroller\x013x\controller.c
000fba   6ee6     MOVWF     0xe6,0x0                                                                                        
000fbc   6ae6     CLRF      0xe6,0x0                                                                                        
000fbe   ec1d     CALL      0x283a,0x0                                                                                      
000fc0   f014                                                                                                               
000fc2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fc4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            D:\work\midicontroller\x013x\controller.c
000fc6   d08c     BRA       0x10e0         				break;                                                                       D:\work\midicontroller\x013x\controller.c
                                           			case FLASH_BANK_SELECT_MODE:                                                  D:\work\midicontroller\x013x\controller.c
000fc8   5129     MOVF      0x29,0x0,0x1   				if ((cdtimer_flash & 31) == 0) {                                             D:\work\midicontroller\x013x\controller.c
000fca   0b1f     ANDLW     0x1f                                                                                            
000fcc   e11d     BNZ       0x1008                                                                                          
000fce   0e00     MOVLW     0x0            					fsw_led_enable(0);                                                          D:\work\midicontroller\x013x\controller.c
000fd0   6ee6     MOVWF     0xe6,0x0                                                                                        
000fd2   6ae6     CLRF      0xe6,0x0                                                                                        
000fd4   ec09     CALL      0x2812,0x0                                                                                      
000fd6   f014                                                                                                               
000fd8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fda   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fdc   0e01     MOVLW     0x1            					fsw_led_enable(1);                                                          D:\work\midicontroller\x013x\controller.c
000fde   6ee6     MOVWF     0xe6,0x0                                                                                        
000fe0   6ae6     CLRF      0xe6,0x0                                                                                        
000fe2   ec09     CALL      0x2812,0x0                                                                                      
000fe4   f014                                                                                                               
000fe6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fe8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000fea   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         D:\work\midicontroller\x013x\controller.c
000fec   6ee6     MOVWF     0xe6,0x0                                                                                        
000fee   6ae6     CLRF      0xe6,0x0                                                                                        
000ff0   ec1d     CALL      0x283a,0x0                                                                                      
000ff2   f014                                                                                                               
000ff4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ff6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
000ff8   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         D:\work\midicontroller\x013x\controller.c
000ffa   6ee6     MOVWF     0xe6,0x0                                                                                        
000ffc   6ae6     CLRF      0xe6,0x0                                                                                        
000ffe   ec1d     CALL      0x283a,0x0                                                                                      
001000   f014                                                                                                               
001002   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001004   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001006   d025     BRA       0x1052         				} else if ((cdtimer_flash & 31) == 15) {                                     D:\work\midicontroller\x013x\controller.c
001008   0e1f     MOVLW     0x1f                                                                                            
00100a   1529     ANDWF     0x29,0x0,0x1                                                                                    
00100c   6e10     MOVWF     0x10,0x0                                                                                        
00100e   6a11     CLRF      0x11,0x0                                                                                        
001010   0e0f     MOVLW     0xf                                                                                             
001012   1810     XORWF     0x10,0x0,0x0                                                                                    
001014   e101     BNZ       0x1018                                                                                          
001016   5011     MOVF      0x11,0x0,0x0                                                                                    
001018   e11c     BNZ       0x1052                                                                                          
00101a   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         D:\work\midicontroller\x013x\controller.c
00101c   6ee6     MOVWF     0xe6,0x0                                                                                        
00101e   6ae6     CLRF      0xe6,0x0                                                                                        
001020   ec1d     CALL      0x283a,0x0                                                                                      
001022   f014                                                                                                               
001024   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001026   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001028   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         D:\work\midicontroller\x013x\controller.c
00102a   6ee6     MOVWF     0xe6,0x0                                                                                        
00102c   6ae6     CLRF      0xe6,0x0                                                                                        
00102e   ec1d     CALL      0x283a,0x0                                                                                      
001030   f014                                                                                                               
001032   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001034   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001036   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         D:\work\midicontroller\x013x\controller.c
001038   6ee6     MOVWF     0xe6,0x0                                                                                        
00103a   6ae6     CLRF      0xe6,0x0                                                                                        
00103c   ec1d     CALL      0x283a,0x0                                                                                      
00103e   f014                                                                                                               
001040   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001042   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001044   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         D:\work\midicontroller\x013x\controller.c
001046   6ee6     MOVWF     0xe6,0x0                                                                                        
001048   6ae6     CLRF      0xe6,0x0                                                                                        
00104a   ec1d     CALL      0x283a,0x0                                                                                      
00104c   f014                                                                                                               
00104e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001050   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            D:\work\midicontroller\x013x\controller.c
001052   d046     BRA       0x10e0         				break;                                                                       D:\work\midicontroller\x013x\controller.c
                                           			case FLASH_PRGM_SELECT_MODE:                                                  D:\work\midicontroller\x013x\controller.c
001054   5129     MOVF      0x29,0x0,0x1   				if ((cdtimer_flash & 31) == 0) {                                             D:\work\midicontroller\x013x\controller.c
001056   0b1f     ANDLW     0x1f                                                                                            
001058   e11d     BNZ       0x1094                                                                                          
00105a   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         D:\work\midicontroller\x013x\controller.c
00105c   6ee6     MOVWF     0xe6,0x0                                                                                        
00105e   6ae6     CLRF      0xe6,0x0                                                                                        
001060   ec1d     CALL      0x283a,0x0                                                                                      
001062   f014                                                                                                               
001064   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001066   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001068   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         D:\work\midicontroller\x013x\controller.c
00106a   6ee6     MOVWF     0xe6,0x0                                                                                        
00106c   6ae6     CLRF      0xe6,0x0                                                                                        
00106e   ec1d     CALL      0x283a,0x0                                                                                      
001070   f014                                                                                                               
001072   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001074   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001076   0e02     MOVLW     0x2            					fsw_led_enable(2);                                                          D:\work\midicontroller\x013x\controller.c
001078   6ee6     MOVWF     0xe6,0x0                                                                                        
00107a   6ae6     CLRF      0xe6,0x0                                                                                        
00107c   ec09     CALL      0x2812,0x0                                                                                      
00107e   f014                                                                                                               
001080   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001082   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001084   0e03     MOVLW     0x3            					fsw_led_enable(3);                                                          D:\work\midicontroller\x013x\controller.c
001086   6ee6     MOVWF     0xe6,0x0                                                                                        
001088   6ae6     CLRF      0xe6,0x0                                                                                        
00108a   ec09     CALL      0x2812,0x0                                                                                      
00108c   f014                                                                                                               
00108e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001090   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001092   d025     BRA       0x10de         				} else if ((cdtimer_flash & 31) == 15) {                                     D:\work\midicontroller\x013x\controller.c
001094   0e1f     MOVLW     0x1f                                                                                            
001096   1529     ANDWF     0x29,0x0,0x1                                                                                    
001098   6e10     MOVWF     0x10,0x0                                                                                        
00109a   6a11     CLRF      0x11,0x0                                                                                        
00109c   0e0f     MOVLW     0xf                                                                                             
00109e   1810     XORWF     0x10,0x0,0x0                                                                                    
0010a0   e101     BNZ       0x10a4                                                                                          
0010a2   5011     MOVF      0x11,0x0,0x0                                                                                    
0010a4   e11c     BNZ       0x10de                                                                                          
0010a6   0e00     MOVLW     0x0            					fsw_led_disable(0);                                                         D:\work\midicontroller\x013x\controller.c
0010a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0010aa   6ae6     CLRF      0xe6,0x0                                                                                        
0010ac   ec1d     CALL      0x283a,0x0                                                                                      
0010ae   f014                                                                                                               
0010b0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010b4   0e01     MOVLW     0x1            					fsw_led_disable(1);                                                         D:\work\midicontroller\x013x\controller.c
0010b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0010b8   6ae6     CLRF      0xe6,0x0                                                                                        
0010ba   ec1d     CALL      0x283a,0x0                                                                                      
0010bc   f014                                                                                                               
0010be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010c2   0e02     MOVLW     0x2            					fsw_led_disable(2);                                                         D:\work\midicontroller\x013x\controller.c
0010c4   6ee6     MOVWF     0xe6,0x0                                                                                        
0010c6   6ae6     CLRF      0xe6,0x0                                                                                        
0010c8   ec1d     CALL      0x283a,0x0                                                                                      
0010ca   f014                                                                                                               
0010cc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010ce   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010d0   0e03     MOVLW     0x3            					fsw_led_disable(3);                                                         D:\work\midicontroller\x013x\controller.c
0010d2   6ee6     MOVWF     0xe6,0x0                                                                                        
0010d4   6ae6     CLRF      0xe6,0x0                                                                                        
0010d6   ec1d     CALL      0x283a,0x0                                                                                      
0010d8   f014                                                                                                               
0010da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            D:\work\midicontroller\x013x\controller.c
0010de   d000     BRA       0x10e0         				break;                                                                       D:\work\midicontroller\x013x\controller.c
                                           		}                                                                              D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
0010e0   0101     MOVLB     0x1            		--cdtimer_flash;                                                               D:\work\midicontroller\x013x\controller.c
0010e2   0729     DECF      0x29,0x1,0x1                                                                                    
0010e4   0e00     MOVLW     0x0                                                                                             
0010e6   5b2a     SUBWFB    0x2a,0x1,0x1                                                                                    
0010e8   5129     MOVF      0x29,0x0,0x1   		if (cdtimer_flash == 0) {                                                      D:\work\midicontroller\x013x\controller.c
0010ea   112a     IORWF     0x2a,0x0,0x1                                                                                    
0010ec   e108     BNZ       0x10fe                                                                                          
                                           			/* reset LEDs to proper state */                                              D:\work\midicontroller\x013x\controller.c
0010ee   0101     MOVLB     0x1            			fsw_led_set_active(curr_preset);                                              D:\work\midicontroller\x013x\controller.c
0010f0   5116     MOVF      0x16,0x0,0x1                                                                                    
0010f2   6ee6     MOVWF     0xe6,0x0                                                                                        
0010f4   6ae6     CLRF      0xe6,0x0                                                                                        
0010f6   ecf3     CALL      0x27e6,0x0                                                                                      
0010f8   f013                                                                                                               
0010fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0010fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
0010fe   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           void inc_practice_value() {                                                      D:\work\midicontroller\x013x\controller.c
001100   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         D:\work\midicontroller\x013x\controller.c
001102   5145     MOVF      0x45,0x0,0x1                                                                                    
001104   e115     BNZ       0x1130                                                                                          
001106   c11e     MOVFF     0x11e,0x10     		if (curr_sortedbank == bank_count - 1) curr_sortedbank = 0;                    D:\work\midicontroller\x013x\controller.c
001108   f010                                                                                                               
00110a   c11f     MOVFF     0x11f,0x11                                                                                      
00110c   f011                                                                                                               
00110e   0610     DECF      0x10,0x1,0x0                                                                                    
001110   0e00     MOVLW     0x0                                                                                             
001112   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001114   5010     MOVF      0x10,0x0,0x0                                                                                    
001116   0101     MOVLB     0x1                                                                                             
001118   191c     XORWF     0x1c,0x0,0x1                                                                                    
00111a   e102     BNZ       0x1120                                                                                          
00111c   5011     MOVF      0x11,0x0,0x0                                                                                    
00111e   191d     XORWF     0x1d,0x0,0x1                                                                                    
001120   e103     BNZ       0x1128                                                                                          
001122   6b1c     CLRF      0x1c,0x1                                                                                        
001124   6b1d     CLRF      0x1d,0x1                                                                                        
001126   d003     BRA       0x112e         		else ++curr_sortedbank;                                                        D:\work\midicontroller\x013x\controller.c
001128   2b1c     INCF      0x1c,0x1,0x1                                                                                    
00112a   0e00     MOVLW     0x0                                                                                             
00112c   231d     ADDWFC    0x1d,0x1,0x1                                                                                    
00112e   d007     BRA       0x113e         	} else {                                                                        D:\work\midicontroller\x013x\controller.c
001130   0e7f     MOVLW     0x7f           		if (curr_program == 127) curr_program = 0;                                     D:\work\midicontroller\x013x\controller.c
001132   0101     MOVLB     0x1                                                                                             
001134   5d15     SUBWF     0x15,0x0,0x1                                                                                    
001136   e102     BNZ       0x113c                                                                                          
001138   6b15     CLRF      0x15,0x1                                                                                        
00113a   d001     BRA       0x113e         		else ++curr_program;                                                           D:\work\midicontroller\x013x\controller.c
00113c   2b15     INCF      0x15,0x1,0x1                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
00113e   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           void dec_practice_value() {                                                      D:\work\midicontroller\x013x\controller.c
001140   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         D:\work\midicontroller\x013x\controller.c
001142   5145     MOVF      0x45,0x0,0x1                                                                                    
001144   e111     BNZ       0x1168                                                                                          
001146   0101     MOVLB     0x1            		if (curr_sortedbank == 0) curr_sortedbank = bank_count - 1;                    D:\work\midicontroller\x013x\controller.c
001148   511c     MOVF      0x1c,0x0,0x1                                                                                    
00114a   111d     IORWF     0x1d,0x0,0x1                                                                                    
00114c   e109     BNZ       0x1160                                                                                          
00114e   c11e     MOVFF     0x11e,0x11c                                                                                     
001150   f11c                                                                                                               
001152   c11f     MOVFF     0x11f,0x11d                                                                                     
001154   f11d                                                                                                               
001156   0e01     MOVLW     0x1                                                                                             
001158   5f1c     SUBWF     0x1c,0x1,0x1                                                                                    
00115a   0e00     MOVLW     0x0                                                                                             
00115c   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
00115e   d003     BRA       0x1166         		else --curr_sortedbank;                                                        D:\work\midicontroller\x013x\controller.c
001160   071c     DECF      0x1c,0x1,0x1                                                                                    
001162   0e00     MOVLW     0x0                                                                                             
001164   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
001166   d007     BRA       0x1176         	} else {                                                                        D:\work\midicontroller\x013x\controller.c
001168   0101     MOVLB     0x1            		if (curr_program == 0) curr_program = 127;                                     D:\work\midicontroller\x013x\controller.c
00116a   5115     MOVF      0x15,0x0,0x1                                                                                    
00116c   e103     BNZ       0x1174                                                                                          
00116e   0e7f     MOVLW     0x7f                                                                                            
001170   6f15     MOVWF     0x15,0x1                                                                                        
001172   d001     BRA       0x1176         		else --curr_program;                                                           D:\work\midicontroller\x013x\controller.c
001174   0715     DECF      0x15,0x1,0x1                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
001176   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           void notify_practice_value() {                                                   D:\work\midicontroller\x013x\controller.c
001178   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         D:\work\midicontroller\x013x\controller.c
00117a   5145     MOVF      0x45,0x0,0x1                                                                                    
00117c   e102     BNZ       0x1182                                                                                          
00117e   de10     RCALL     0xda0          		sortedbank_showname();                                                         D:\work\midicontroller\x013x\controller.c
001180   d001     BRA       0x1184         	} else {                                                                        D:\work\midicontroller\x013x\controller.c
001182   dd26     RCALL     0xbd0          		show_program();                                                                D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
001184   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           void activate_practice_value() {                                                 D:\work\midicontroller\x013x\controller.c
001186   0101     MOVLB     0x1            	if (incdec_mode == 0) {                                                         D:\work\midicontroller\x013x\controller.c
001188   5145     MOVF      0x45,0x0,0x1                                                                                    
00118a   e104     BNZ       0x1194                                                                                          
00118c   6ae6     CLRF      0xe6,0x0       		sortedbank_activate(0);                                                        D:\work\midicontroller\x013x\controller.c
00118e   ddd8     RCALL     0xd40                                                                                           
001190   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001192   d004     BRA       0x119c         	} else {                                                                        D:\work\midicontroller\x013x\controller.c
001194   0e01     MOVLW     0x1            		program_activate(1);                                                           D:\work\midicontroller\x013x\controller.c
001196   6ee6     MOVWF     0xe6,0x0                                                                                        
001198   dd44     RCALL     0xc22                                                                                           
00119a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
00119c   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* sequence programming completed, set state to repeat the sequence back: */     D:\work\midicontroller\x013x\controller.c
                                           void sequence_complete() {                                                       D:\work\midicontroller\x013x\controller.c
                                           	/* set the sequence length and store to the ROM: */                             D:\work\midicontroller\x013x\controller.c
00119e   c117     MOVFF     0x117,0x110    	bankmap_count = curr_mapindex;                                                  D:\work\midicontroller\x013x\controller.c
0011a0   f110                                                                                                               
0011a2   c110     MOVFF     0x110,0xfe6    	bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);            D:\work\midicontroller\x013x\controller.c
0011a4   ffe6                                                                                                               
0011a6   0e08     MOVLW     0x8                                                                                             
0011a8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011aa   0e01     MOVLW     0x1                                                                                             
0011ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0011ae   0e04     MOVLW     0x4                                                                                             
0011b0   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b2   0e01     MOVLW     0x1                                                                                             
0011b4   6ee6     MOVWF     0xe6,0x0                                                                                        
0011b6   0e00     MOVLW     0x0                                                                                             
0011b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011ba   0e01     MOVLW     0x1                                                                                             
0011bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0011be   c118     MOVFF     0x118,0xfe6                                                                                     
0011c0   ffe6                                                                                                               
0011c2   c119     MOVFF     0x119,0xfe6                                                                                     
0011c4   ffe6                                                                                                               
0011c6   ec4a     CALL      0x2894,0x0                                                                                      
0011c8   f014                                                                                                               
0011ca   6e10     MOVWF     0x10,0x0                                                                                        
0011cc   0e09     MOVLW     0x9                                                                                             
0011ce   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0011d0   5010     MOVF      0x10,0x0,0x0                                                                                    
                                           	/* set up state to repeat the stored sequence back on the preset LEDs: */       D:\work\midicontroller\x013x\controller.c
0011d2   0101     MOVLB     0x1            	program_mode = PROGRAM_COMPLETE;                                                D:\work\midicontroller\x013x\controller.c
0011d4   0e02     MOVLW     0x2                                                                                             
0011d6   6f33     MOVWF     0x33,0x1                                                                                        
0011d8   0e32     MOVLW     0x32           	cdtimer_holdenter = 50;                                                         D:\work\midicontroller\x013x\controller.c
0011da   6f2f     MOVWF     0x2f,0x1                                                                                        
0011dc   6b30     CLRF      0x30,0x1                                                                                        
0011de   0101     MOVLB     0x1            	curr_mapindex = 0;                                                              D:\work\midicontroller\x013x\controller.c
0011e0   6b17     CLRF      0x17,0x1                                                                                        
0011e2   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* set the controller to an initial state */                                     D:\work\midicontroller\x013x\controller.c
                                           void controller_init() {                                                         D:\work\midicontroller\x013x\controller.c
0011e4   ec41     CALL      0x2882,0x0     	bank_count = banks_count();                                                     D:\work\midicontroller\x013x\controller.c
0011e6   f014                                                                                                               
0011e8   cff3     MOVFF     0xff3,0x11e                                                                                     
0011ea   f11e                                                                                                               
0011ec   cff4     MOVFF     0xff4,0x11f                                                                                     
0011ee   f11f                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
0011f0   0101     MOVLB     0x1            	curr_bank = 0;                                                                  D:\work\midicontroller\x013x\controller.c
0011f2   6b18     CLRF      0x18,0x1                                                                                        
0011f4   6b19     CLRF      0x19,0x1                                                                                        
0011f6   0e01     MOVLW     0x1            	bank_activate(1);                                                               D:\work\midicontroller\x013x\controller.c
0011f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0011fa   dd6a     RCALL     0xcd0                                                                                           
0011fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\controller.c
0011fe   0101     MOVLB     0x1            	curr_mapindex = 0;                                                              D:\work\midicontroller\x013x\controller.c
001200   6b17     CLRF      0x17,0x1                                                                                        
001202   0e01     MOVLW     0x1            	bankmap_activate(1);                                                            D:\work\midicontroller\x013x\controller.c
001204   6ee6     MOVWF     0xe6,0x0                                                                                        
001206   dd49     RCALL     0xc9a                                                                                           
001208   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                                                                                                            D:\work\midicontroller\x013x\controller.c
00120a   0e00     MOVLW     0x0            	sw_curr = sw_last = 0;                                                          D:\work\midicontroller\x013x\controller.c
00120c   0101     MOVLB     0x1                                                                                             
00120e   6f3f     MOVWF     0x3f,0x1                                                                                        
001210   6b40     CLRF      0x40,0x1                                                                                        
001212   6f3d     MOVWF     0x3d,0x1                                                                                        
001214   6b3e     CLRF      0x3e,0x1                                                                                        
001216   ec3c     CALL      0x2878,0x0     	cc_curr = cc_last = expr_poll();                                                D:\work\midicontroller\x013x\controller.c
001218   f014                                                                                                               
00121a   0101     MOVLB     0x1                                                                                             
00121c   6f42     MOVWF     0x42,0x1                                                                                        
00121e   6f41     MOVWF     0x41,0x1                                                                                        
001220   ec37     CALL      0x286e,0x0     	mode = slider_poll();                                                           D:\work\midicontroller\x013x\controller.c
001222   f014                                                                                                               
001224   0101     MOVLB     0x1                                                                                             
001226   6f23     MOVWF     0x23,0x1                                                                                        
001228   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           /* main control loop */                                                          D:\work\midicontroller\x013x\controller.c
                                           void controller_handle() {                                                       D:\work\midicontroller\x013x\controller.c
                                           	/* poll foot-switch depression status: */                                       D:\work\midicontroller\x013x\controller.c
00122a   ecaf     CALL      0x275e,0x0     	sw_curr = fsw_poll();                                                           D:\work\midicontroller\x013x\controller.c
00122c   f013                                                                                                               
00122e   cff3     MOVFF     0xff3,0x13d                                                                                     
001230   f13d                                                                                                               
001232   cff4     MOVFF     0xff4,0x13e                                                                                     
001234   f13e                                                                                                               
                                           	/* poll expression pedal value: */                                              D:\work\midicontroller\x013x\controller.c
001236   ec3c     CALL      0x2878,0x0     	cc_curr = expr_poll();                                                          D:\work\midicontroller\x013x\controller.c
001238   f014                                                                                                               
00123a   0101     MOVLB     0x1                                                                                             
00123c   6f41     MOVWF     0x41,0x1                                                                                        
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* send CC message only if changed: */                                          D:\work\midicontroller\x013x\controller.c
00123e   5142     MOVF      0x42,0x0,0x1   	if (cc_curr != cc_last) {                                                       D:\work\midicontroller\x013x\controller.c
001240   5d41     SUBWF     0x41,0x0,0x1                                                                                    
001242   e016     BZ        0x1270                                                                                          
001244   0e7f     MOVLW     0x7f           		midi_send_cmd2(0xB, midi_channel, bankcontroller[curr_preset], cc_curr & 0x7F); D:\work\midicontroller\x013x\controller.c
001246   1541     ANDWF     0x41,0x0,0x1                                                                                    
001248   6ee6     MOVWF     0xe6,0x0                                                                                        
00124a   0101     MOVLB     0x1                                                                                             
00124c   5116     MOVF      0x16,0x0,0x1                                                                                    
00124e   6aea     CLRF      0xea,0x0                                                                                        
001250   0f04     ADDLW     0x4                                                                                             
001252   6ee9     MOVWF     0xe9,0x0                                                                                        
001254   0e01     MOVLW     0x1                                                                                             
001256   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001258   50ef     MOVF      0xef,0x0,0x0                                                                                    
00125a   6ee6     MOVWF     0xe6,0x0                                                                                        
00125c   c124     MOVFF     0x124,0xfe6                                                                                     
00125e   ffe6                                                                                                               
001260   0e0b     MOVLW     0xb                                                                                             
001262   6ee6     MOVWF     0xe6,0x0                                                                                        
001264   ec6a     CALL      0x28d4,0x0                                                                                      
001266   f014                                                                                                               
001268   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00126e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* determine mode */                                                            D:\work\midicontroller\x013x\controller.c
001270   ec37     CALL      0x286e,0x0     	if (slider_poll() == 0) {                                                       D:\work\midicontroller\x013x\controller.c
001272   f014                                                                                                               
001274   0900     IORLW     0x0                                                                                             
001276   e110     BNZ       0x1298                                                                                          
001278   0101     MOVLB     0x1            		if (mode == MODE_CONCERT) {                                                    D:\work\midicontroller\x013x\controller.c
00127a   0523     DECF      0x23,0x0,0x1                                                                                    
00127c   e10c     BNZ       0x1296                                                                                          
                                           			/* switched from CONCERT to PRACTICE */                                       D:\work\midicontroller\x013x\controller.c
00127e   6b23     CLRF      0x23,0x1       			mode = MODE_PRACTICE;                                                         D:\work\midicontroller\x013x\controller.c
                                           			/* load the alphabetically first bank and start from the beginning of its program */ D:\work\midicontroller\x013x\controller.c
001280   6b1c     CLRF      0x1c,0x1       			curr_sortedbank = 0;                                                          D:\work\midicontroller\x013x\controller.c
001282   6b1d     CLRF      0x1d,0x1                                                                                        
001284   0e01     MOVLW     0x1            			sortedbank_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
001286   6ee6     MOVWF     0xe6,0x0                                                                                        
001288   dd5b     RCALL     0xd40                                                                                           
00128a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00128c   0101     MOVLB     0x1            			curr_mapindex = 0;                                                            D:\work\midicontroller\x013x\controller.c
00128e   6b17     CLRF      0x17,0x1                                                                                        
001290   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          D:\work\midicontroller\x013x\controller.c
001292   dd03     RCALL     0xc9a                                                                                           
001294   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              D:\work\midicontroller\x013x\controller.c
001296   d00f     BRA       0x12b6         	} else {                                                                        D:\work\midicontroller\x013x\controller.c
001298   0101     MOVLB     0x1            		if (mode == MODE_PRACTICE) {                                                   D:\work\midicontroller\x013x\controller.c
00129a   5123     MOVF      0x23,0x0,0x1                                                                                    
00129c   e10c     BNZ       0x12b6                                                                                          
                                           			/* switched from PRACTICE to CONCERT */                                       D:\work\midicontroller\x013x\controller.c
00129e   0e01     MOVLW     0x1            			mode = MODE_CONCERT;                                                          D:\work\midicontroller\x013x\controller.c
0012a0   6f23     MOVWF     0x23,0x1                                                                                        
                                           			/* load the sequentially first bank and start from the beginning of its program */ D:\work\midicontroller\x013x\controller.c
0012a2   6b18     CLRF      0x18,0x1       			curr_bank = 0;                                                                D:\work\midicontroller\x013x\controller.c
0012a4   6b19     CLRF      0x19,0x1                                                                                        
0012a6   6ee6     MOVWF     0xe6,0x0       			bank_activate(1);                                                             D:\work\midicontroller\x013x\controller.c
0012a8   dd13     RCALL     0xcd0                                                                                           
0012aa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012ac   0101     MOVLB     0x1            			curr_mapindex = 0;                                                            D:\work\midicontroller\x013x\controller.c
0012ae   6b17     CLRF      0x17,0x1                                                                                        
0012b0   6ae6     CLRF      0xe6,0x0       			bankmap_activate(0);                                                          D:\work\midicontroller\x013x\controller.c
0012b2   dcf3     RCALL     0xc9a                                                                                           
0012b4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           		}                                                                              D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* NEXT never changes function depending on mode */                             D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* NEXT pressed: */                                                             D:\work\midicontroller\x013x\controller.c
0012b6   0e00     MOVLW     0x0            	if (button_pressed(FSM_NEXT)) {                                                 D:\work\midicontroller\x013x\controller.c
0012b8   6ee6     MOVWF     0xe6,0x0                                                                                        
0012ba   6ae6     CLRF      0xe6,0x0                                                                                        
0012bc   dda0     RCALL     0xdfe                                                                                           
0012be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012c2   0900     IORLW     0x0                                                                                             
0012c4   e04b     BZ        0x135c                                                                                          
0012c6   0101     MOVLB     0x1            		if (loaded_bank != curr_bank) {                                                D:\work\midicontroller\x013x\controller.c
0012c8   5118     MOVF      0x18,0x0,0x1                                                                                    
0012ca   191a     XORWF     0x1a,0x0,0x1                                                                                    
0012cc   e102     BNZ       0x12d2                                                                                          
0012ce   5119     MOVF      0x19,0x0,0x1                                                                                    
0012d0   191b     XORWF     0x1b,0x0,0x1                                                                                    
0012d2   e005     BZ        0x12de                                                                                          
                                           			/* prepared to switch to a bank, but did not activate the first map */        D:\work\midicontroller\x013x\controller.c
0012d4   0e01     MOVLW     0x1            			bankmap_activate(1);                                                          D:\work\midicontroller\x013x\controller.c
0012d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0012d8   dce0     RCALL     0xc9a                                                                                           
0012da   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0012dc   d03f     BRA       0x135c         		} else {                                                                       D:\work\midicontroller\x013x\controller.c
0012de   0510     DECF      0x10,0x0,0x1   			if (curr_mapindex == bankmap_count - 1) {                                     D:\work\midicontroller\x013x\controller.c
0012e0   5d17     SUBWF     0x17,0x0,0x1                                                                                    
0012e2   e137     BNZ       0x1352                                                                                          
                                           				/* crossed the upper bank-map boundary, load the next bank */                D:\work\midicontroller\x013x\controller.c
0012e4   5123     MOVF      0x23,0x0,0x1   				if (mode == MODE_PRACTICE) {                                                 D:\work\midicontroller\x013x\controller.c
0012e6   e118     BNZ       0x1318                                                                                          
                                           					/* PRACTICE mode cycles through banks by sorted index #: */                 D:\work\midicontroller\x013x\controller.c
0012e8   c11e     MOVFF     0x11e,0x10     					if (curr_sortedbank == bank_count - 1) {                                    D:\work\midicontroller\x013x\controller.c
0012ea   f010                                                                                                               
0012ec   c11f     MOVFF     0x11f,0x11                                                                                      
0012ee   f011                                                                                                               
0012f0   0610     DECF      0x10,0x1,0x0                                                                                    
0012f2   0e00     MOVLW     0x0                                                                                             
0012f4   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
0012f6   5010     MOVF      0x10,0x0,0x0                                                                                    
0012f8   191c     XORWF     0x1c,0x0,0x1                                                                                    
0012fa   e102     BNZ       0x1300                                                                                          
0012fc   5011     MOVF      0x11,0x0,0x0                                                                                    
0012fe   191d     XORWF     0x1d,0x0,0x1                                                                                    
001300   e103     BNZ       0x1308                                                                                          
001302   6b1c     CLRF      0x1c,0x1       						curr_sortedbank = 0;                                                       D:\work\midicontroller\x013x\controller.c
001304   6b1d     CLRF      0x1d,0x1                                                                                        
001306   d003     BRA       0x130e         					} else {                                                                    D:\work\midicontroller\x013x\controller.c
001308   2b1c     INCF      0x1c,0x1,0x1   						++curr_sortedbank;                                                         D:\work\midicontroller\x013x\controller.c
00130a   0e00     MOVLW     0x0                                                                                             
00130c   231d     ADDWFC    0x1d,0x1,0x1                                                                                    
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* show the bank name */                                                    D:\work\midicontroller\x013x\controller.c
00130e   0e01     MOVLW     0x1            					sortedbank_activate(1);                                                     D:\work\midicontroller\x013x\controller.c
001310   6ee6     MOVWF     0xe6,0x0                                                                                        
001312   dd16     RCALL     0xd40                                                                                           
001314   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001316   d017     BRA       0x1346         				} else {                                                                     D:\work\midicontroller\x013x\controller.c
                                           					/* CONCERT mode cycles through banks by index #: */                         D:\work\midicontroller\x013x\controller.c
001318   c11e     MOVFF     0x11e,0x10     					if (curr_bank == bank_count - 1) {                                          D:\work\midicontroller\x013x\controller.c
00131a   f010                                                                                                               
00131c   c11f     MOVFF     0x11f,0x11                                                                                      
00131e   f011                                                                                                               
001320   0610     DECF      0x10,0x1,0x0                                                                                    
001322   0e00     MOVLW     0x0                                                                                             
001324   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001326   5010     MOVF      0x10,0x0,0x0                                                                                    
001328   1918     XORWF     0x18,0x0,0x1                                                                                    
00132a   e102     BNZ       0x1330                                                                                          
00132c   5011     MOVF      0x11,0x0,0x0                                                                                    
00132e   1919     XORWF     0x19,0x0,0x1                                                                                    
001330   e103     BNZ       0x1338                                                                                          
001332   6b18     CLRF      0x18,0x1       						curr_bank = 0;                                                             D:\work\midicontroller\x013x\controller.c
001334   6b19     CLRF      0x19,0x1                                                                                        
001336   d003     BRA       0x133e         					} else {                                                                    D:\work\midicontroller\x013x\controller.c
001338   2b18     INCF      0x18,0x1,0x1   						++curr_bank;                                                               D:\work\midicontroller\x013x\controller.c
00133a   0e00     MOVLW     0x0                                                                                             
00133c   2319     ADDWFC    0x19,0x1,0x1                                                                                    
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* show the bank name */                                                    D:\work\midicontroller\x013x\controller.c
00133e   0e01     MOVLW     0x1            					bank_activate(1);                                                           D:\work\midicontroller\x013x\controller.c
001340   6ee6     MOVWF     0xe6,0x0                                                                                        
001342   dcc6     RCALL     0xcd0                                                                                           
001344   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           				}                                                                            D:\work\midicontroller\x013x\controller.c
                                           				/* activate the first map for the new bank, but do not display the MIDI program # */ D:\work\midicontroller\x013x\controller.c
001346   0101     MOVLB     0x1            				curr_mapindex = 0;                                                           D:\work\midicontroller\x013x\controller.c
001348   6b17     CLRF      0x17,0x1                                                                                        
00134a   6ae6     CLRF      0xe6,0x0       				bankmap_activate(0);                                                         D:\work\midicontroller\x013x\controller.c
00134c   dca6     RCALL     0xc9a                                                                                           
00134e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001350   d005     BRA       0x135c         			} else {                                                                      D:\work\midicontroller\x013x\controller.c
                                           				/* activate the next map for the new bank, and display the MIDI program # */ D:\work\midicontroller\x013x\controller.c
001352   2b17     INCF      0x17,0x1,0x1   				++curr_mapindex;                                                             D:\work\midicontroller\x013x\controller.c
001354   0e01     MOVLW     0x1            				bankmap_activate(1);                                                         D:\work\midicontroller\x013x\controller.c
001356   6ee6     MOVWF     0xe6,0x0                                                                                        
001358   dca0     RCALL     0xc9a                                                                                           
00135a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                           		}                                                                              D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           	/* PRACTICE vs. CONCERT modes: */                                               D:\work\midicontroller\x013x\controller.c
00135c   0101     MOVLB     0x1            	switch (mode) {                                                                 D:\work\midicontroller\x013x\controller.c
00135e   5123     MOVF      0x23,0x0,0x1                                                                                    
001360   0a01     XORLW     0x1                                                                                             
001362   e101     BNZ       0x1366                                                                                          
001364   d317     BRA       0x1994                                                                                          
001366   0a01     XORLW     0x1                                                                                             
001368   e002     BZ        0x136e                                                                                          
00136a   efb4     GOTO      0x1d68                                                                                          
00136c   f00e                                                                                                               
                                           		case MODE_PRACTICE:                                                            D:\work\midicontroller\x013x\controller.c
                                           			/* PRACTICE mode has sub-modes of its own: */                                 D:\work\midicontroller\x013x\controller.c
00136e   0101     MOVLB     0x1            			switch (program_mode) {                                                       D:\work\midicontroller\x013x\controller.c
001370   5133     MOVF      0x33,0x0,0x1                                                                                    
001372   0a02     XORLW     0x2                                                                                             
001374   e101     BNZ       0x1378                                                                                          
001376   d2d8     BRA       0x1928                                                                                          
001378   0a03     XORLW     0x3                                                                                             
00137a   e101     BNZ       0x137e                                                                                          
00137c   d23a     BRA       0x17f2                                                                                          
00137e   0a01     XORLW     0x1                                                                                             
001380   e001     BZ        0x1384                                                                                          
001382   d307     BRA       0x1992                                                                                          
                                           				case PROGRAM_NONE:                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* one of preset 1-4 pressed: */                                            D:\work\midicontroller\x013x\controller.c
001384   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         D:\work\midicontroller\x013x\controller.c
001386   6ee6     MOVWF     0xe6,0x0                                                                                        
001388   6ae6     CLRF      0xe6,0x0                                                                                        
00138a   dd39     RCALL     0xdfe                                                                                           
00138c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00138e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001390   0900     IORLW     0x0                                                                                             
001392   e00e     BZ        0x13b0                                                                                          
001394   0101     MOVLB     0x1            						curr_preset = 0;                                                           D:\work\midicontroller\x013x\controller.c
001396   6b16     CLRF      0x16,0x1                                                                                        
001398   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    D:\work\midicontroller\x013x\controller.c
00139a   0545     DECF      0x45,0x0,0x1                                                                                    
00139c   e105     BNZ       0x13a8                                                                                          
                                           							/* check if held for ~300msec */                                          D:\work\midicontroller\x013x\controller.c
00139e   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       D:\work\midicontroller\x013x\controller.c
0013a0   6f2b     MOVWF     0x2b,0x1                                                                                        
0013a2   6b2c     CLRF      0x2c,0x1                                                                                        
0013a4   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          D:\work\midicontroller\x013x\controller.c
0013a6   d004     BRA       0x13b0         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
0013a8   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
0013aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0013ac   dc51     RCALL     0xc50                                                                                           
0013ae   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
0013b0   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         D:\work\midicontroller\x013x\controller.c
0013b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0013b4   6ae6     CLRF      0xe6,0x0                                                                                        
0013b6   dd23     RCALL     0xdfe                                                                                           
0013b8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013ba   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013bc   0900     IORLW     0x0                                                                                             
0013be   e00f     BZ        0x13de                                                                                          
0013c0   0101     MOVLB     0x1            						curr_preset = 1;                                                           D:\work\midicontroller\x013x\controller.c
0013c2   0e01     MOVLW     0x1                                                                                             
0013c4   6f16     MOVWF     0x16,0x1                                                                                        
0013c6   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    D:\work\midicontroller\x013x\controller.c
0013c8   0545     DECF      0x45,0x0,0x1                                                                                    
0013ca   e105     BNZ       0x13d6                                                                                          
                                           							/* check if held for ~300msec */                                          D:\work\midicontroller\x013x\controller.c
0013cc   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       D:\work\midicontroller\x013x\controller.c
0013ce   6f2b     MOVWF     0x2b,0x1                                                                                        
0013d0   6b2c     CLRF      0x2c,0x1                                                                                        
0013d2   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          D:\work\midicontroller\x013x\controller.c
0013d4   d004     BRA       0x13de         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
0013d6   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
0013d8   6ee6     MOVWF     0xe6,0x0                                                                                        
0013da   dc3a     RCALL     0xc50                                                                                           
0013dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
0013de   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         D:\work\midicontroller\x013x\controller.c
0013e0   6ee6     MOVWF     0xe6,0x0                                                                                        
0013e2   6ae6     CLRF      0xe6,0x0                                                                                        
0013e4   dd0c     RCALL     0xdfe                                                                                           
0013e6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013e8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0013ea   0900     IORLW     0x0                                                                                             
0013ec   e00f     BZ        0x140c                                                                                          
0013ee   0101     MOVLB     0x1            						curr_preset = 2;                                                           D:\work\midicontroller\x013x\controller.c
0013f0   0e02     MOVLW     0x2                                                                                             
0013f2   6f16     MOVWF     0x16,0x1                                                                                        
0013f4   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    D:\work\midicontroller\x013x\controller.c
0013f6   0545     DECF      0x45,0x0,0x1                                                                                    
0013f8   e105     BNZ       0x1404                                                                                          
                                           							/* check if held for ~300msec */                                          D:\work\midicontroller\x013x\controller.c
0013fa   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       D:\work\midicontroller\x013x\controller.c
0013fc   6f2b     MOVWF     0x2b,0x1                                                                                        
0013fe   6b2c     CLRF      0x2c,0x1                                                                                        
001400   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          D:\work\midicontroller\x013x\controller.c
001402   d004     BRA       0x140c         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
001404   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
001406   6ee6     MOVWF     0xe6,0x0                                                                                        
001408   dc23     RCALL     0xc50                                                                                           
00140a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
00140c   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         D:\work\midicontroller\x013x\controller.c
00140e   6ee6     MOVWF     0xe6,0x0                                                                                        
001410   6ae6     CLRF      0xe6,0x0                                                                                        
001412   dcf5     RCALL     0xdfe                                                                                           
001414   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001416   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001418   0900     IORLW     0x0                                                                                             
00141a   e00f     BZ        0x143a                                                                                          
00141c   0101     MOVLB     0x1            						curr_preset = 3;                                                           D:\work\midicontroller\x013x\controller.c
00141e   0e03     MOVLW     0x3                                                                                             
001420   6f16     MOVWF     0x16,0x1                                                                                        
001422   0101     MOVLB     0x1            						if (incdec_mode == 1) {                                                    D:\work\midicontroller\x013x\controller.c
001424   0545     DECF      0x45,0x0,0x1                                                                                    
001426   e105     BNZ       0x1432                                                                                          
                                           							/* check if held for ~300msec */                                          D:\work\midicontroller\x013x\controller.c
001428   0e1e     MOVLW     0x1e           							cdtimer_store = 30;                                                       D:\work\midicontroller\x013x\controller.c
00142a   6f2b     MOVWF     0x2b,0x1                                                                                        
00142c   6b2c     CLRF      0x2c,0x1                                                                                        
00142e   6b44     CLRF      0x44,0x1       							store_state = 0;                                                          D:\work\midicontroller\x013x\controller.c
001430   d004     BRA       0x143a         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
001432   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
001434   6ee6     MOVWF     0xe6,0x0                                                                                        
001436   dc0c     RCALL     0xc50                                                                                           
001438   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
00143a   0101     MOVLB     0x1            					if (incdec_mode == 1) {                                                     D:\work\midicontroller\x013x\controller.c
00143c   0545     DECF      0x45,0x0,0x1                                                                                    
00143e   e001     BZ        0x1442                                                                                          
001440   d087     BRA       0x1550                                                                                          
                                           						/* check if the store-timer ran out and we're able to store: */            D:\work\midicontroller\x013x\controller.c
001442   512b     MOVF      0x2b,0x0,0x1   						if ((cdtimer_store == 0) && (store_state == 0)) {                          D:\work\midicontroller\x013x\controller.c
001444   112c     IORWF     0x2c,0x0,0x1                                                                                    
001446   e153     BNZ       0x14ee                                                                                          
001448   5144     MOVF      0x44,0x0,0x1                                                                                    
00144a   e151     BNZ       0x14ee                                                                                          
                                           							/* still holding a button? */                                             D:\work\midicontroller\x013x\controller.c
00144c   0e01     MOVLW     0x1            							if (button_held(FSM_PRESET_1) || button_held(FSM_PRESET_2) || button_held(FSM_PRESET_3) || button_held(FSM_PRESET_4)) { D:\work\midicontroller\x013x\controller.c
00144e   6ee6     MOVWF     0xe6,0x0                                                                                        
001450   6ae6     CLRF      0xe6,0x0                                                                                        
001452   dd04     RCALL     0xe5c                                                                                           
001454   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001456   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001458   0900     IORLW     0x0                                                                                             
00145a   e118     BNZ       0x148c                                                                                          
00145c   0e02     MOVLW     0x2                                                                                             
00145e   6ee6     MOVWF     0xe6,0x0                                                                                        
001460   6ae6     CLRF      0xe6,0x0                                                                                        
001462   dcfc     RCALL     0xe5c                                                                                           
001464   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001466   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001468   0900     IORLW     0x0                                                                                             
00146a   e110     BNZ       0x148c                                                                                          
00146c   0e04     MOVLW     0x4                                                                                             
00146e   6ee6     MOVWF     0xe6,0x0                                                                                        
001470   6ae6     CLRF      0xe6,0x0                                                                                        
001472   dcf4     RCALL     0xe5c                                                                                           
001474   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001476   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001478   0900     IORLW     0x0                                                                                             
00147a   e108     BNZ       0x148c                                                                                          
00147c   0e08     MOVLW     0x8                                                                                             
00147e   6ee6     MOVWF     0xe6,0x0                                                                                        
001480   6ae6     CLRF      0xe6,0x0                                                                                        
001482   dcec     RCALL     0xe5c                                                                                           
001484   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001486   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001488   0900     IORLW     0x0                                                                                             
00148a   e031     BZ        0x14ee                                                                                          
                                           								/* store the program */                                                  D:\work\midicontroller\x013x\controller.c
00148c   0101     MOVLB     0x1            								store_state = 1;                                                         D:\work\midicontroller\x013x\controller.c
00148e   0e01     MOVLW     0x1                                                                                             
001490   6f44     MOVWF     0x44,0x1                                                                                        
001492   0101     MOVLB     0x1            								bank[curr_preset] = curr_program;                                        D:\work\midicontroller\x013x\controller.c
001494   5116     MOVF      0x16,0x0,0x1                                                                                    
001496   6aea     CLRF      0xea,0x0                                                                                        
001498   0f00     ADDLW     0x0                                                                                             
00149a   6ee9     MOVWF     0xe9,0x0                                                                                        
00149c   0e01     MOVLW     0x1                                                                                             
00149e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0014a0   c115     MOVFF     0x115,0xfef                                                                                     
0014a2   ffef                                                                                                               
0014a4   c110     MOVFF     0x110,0xfe6    								bank_store(curr_bank, bank, bankcontroller, bankmap, bankmap_count);     D:\work\midicontroller\x013x\controller.c
0014a6   ffe6                                                                                                               
0014a8   0e08     MOVLW     0x8                                                                                             
0014aa   6ee6     MOVWF     0xe6,0x0                                                                                        
0014ac   0e01     MOVLW     0x1                                                                                             
0014ae   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b0   0e04     MOVLW     0x4                                                                                             
0014b2   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b4   0e01     MOVLW     0x1                                                                                             
0014b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014b8   0e00     MOVLW     0x0                                                                                             
0014ba   6ee6     MOVWF     0xe6,0x0                                                                                        
0014bc   0e01     MOVLW     0x1                                                                                             
0014be   6ee6     MOVWF     0xe6,0x0                                                                                        
0014c0   c118     MOVFF     0x118,0xfe6                                                                                     
0014c2   ffe6                                                                                                               
0014c4   c119     MOVFF     0x119,0xfe6                                                                                     
0014c6   ffe6                                                                                                               
0014c8   ec4a     CALL      0x2894,0x0                                                                                      
0014ca   f014                                                                                                               
0014cc   6e10     MOVWF     0x10,0x0                                                                                        
0014ce   0e09     MOVLW     0x9                                                                                             
0014d0   5ee1     SUBWF     0xe1,0x1,0x0                                                                                    
0014d2   5010     MOVF      0x10,0x0,0x0                                                                                    
0014d4   0e01     MOVLW     0x1            								preset_activate(1);                                                      D:\work\midicontroller\x013x\controller.c
0014d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0014d8   ec28     CALL      0xc50,0x0                                                                                       
0014da   f006                                                                                                               
0014dc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           								/* flash the stored LED */                                               D:\work\midicontroller\x013x\controller.c
0014de   0101     MOVLB     0x1            								flash_state = FLASH_STORE;                                               D:\work\midicontroller\x013x\controller.c
0014e0   0e01     MOVLW     0x1                                                                                             
0014e2   6f32     MOVWF     0x32,0x1                                                                                        
0014e4   c116     MOVFF     0x116,0x134    								flash_led = curr_preset;                                                 D:\work\midicontroller\x013x\controller.c
0014e6   f134                                                                                                               
0014e8   0e64     MOVLW     0x64           								cdtimer_flash = 100;                                                     D:\work\midicontroller\x013x\controller.c
0014ea   6f29     MOVWF     0x29,0x1                                                                                        
0014ec   6b2a     CLRF      0x2a,0x1                                                                                        
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           						/* check if a button was released: */                                      D:\work\midicontroller\x013x\controller.c
0014ee   0e01     MOVLW     0x1            						if (button_released(FSM_PRESET_1) || button_released(FSM_PRESET_2) || button_released(FSM_PRESET_3) || button_released(FSM_PRESET_4)) { D:\work\midicontroller\x013x\controller.c
0014f0   6ee6     MOVWF     0xe6,0x0                                                                                        
0014f2   6ae6     CLRF      0xe6,0x0                                                                                        
0014f4   dcd3     RCALL     0xe9c                                                                                           
0014f6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014f8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0014fa   0900     IORLW     0x0                                                                                             
0014fc   e118     BNZ       0x152e                                                                                          
0014fe   0e02     MOVLW     0x2                                                                                             
001500   6ee6     MOVWF     0xe6,0x0                                                                                        
001502   6ae6     CLRF      0xe6,0x0                                                                                        
001504   dccb     RCALL     0xe9c                                                                                           
001506   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001508   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00150a   0900     IORLW     0x0                                                                                             
00150c   e110     BNZ       0x152e                                                                                          
00150e   0e04     MOVLW     0x4                                                                                             
001510   6ee6     MOVWF     0xe6,0x0                                                                                        
001512   6ae6     CLRF      0xe6,0x0                                                                                        
001514   dcc3     RCALL     0xe9c                                                                                           
001516   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001518   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00151a   0900     IORLW     0x0                                                                                             
00151c   e108     BNZ       0x152e                                                                                          
00151e   0e08     MOVLW     0x8                                                                                             
001520   6ee6     MOVWF     0xe6,0x0                                                                                        
001522   6ae6     CLRF      0xe6,0x0                                                                                        
001524   dcbb     RCALL     0xe9c                                                                                           
001526   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001528   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00152a   0900     IORLW     0x0                                                                                             
00152c   e011     BZ        0x1550                                                                                          
00152e   0101     MOVLB     0x1            							if ((cdtimer_store > 0) && (store_state == 0)) {                          D:\work\midicontroller\x013x\controller.c
001530   0e00     MOVLW     0x0                                                                                             
001532   80d8     BSF       0xd8,0x0,0x0                                                                                    
001534   552b     SUBFWB    0x2b,0x0,0x1                                                                                    
001536   0e00     MOVLW     0x0                                                                                             
001538   552c     SUBFWB    0x2c,0x0,0x1                                                                                    
00153a   e20a     BC        0x1550                                                                                          
00153c   5144     MOVF      0x44,0x0,0x1                                                                                    
00153e   e108     BNZ       0x1550                                                                                          
                                           								/* was only tapped (held less than ~300msec) */                          D:\work\midicontroller\x013x\controller.c
001540   0e01     MOVLW     0x1            								preset_activate(1);                                                      D:\work\midicontroller\x013x\controller.c
001542   6ee6     MOVWF     0xe6,0x0                                                                                        
001544   ec28     CALL      0xc50,0x0                                                                                       
001546   f006                                                                                                               
001548   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00154a   0101     MOVLB     0x1            								cdtimer_store = 0;                                                       D:\work\midicontroller\x013x\controller.c
00154c   6b2b     CLRF      0x2b,0x1                                                                                        
00154e   6b2c     CLRF      0x2c,0x1                                                                                        
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           					/* INC pressed: */                                                          D:\work\midicontroller\x013x\controller.c
001550   0e00     MOVLW     0x0            					if (button_pressed(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { D:\work\midicontroller\x013x\controller.c
001552   6ee6     MOVWF     0xe6,0x0                                                                                        
001554   6ae6     CLRF      0xe6,0x0                                                                                        
001556   dc53     RCALL     0xdfe                                                                                           
001558   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00155a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00155c   0900     IORLW     0x0                                                                                             
00155e   e00f     BZ        0x157e                                                                                          
001560   0e00     MOVLW     0x0                                                                                             
001562   6ee6     MOVWF     0xe6,0x0                                                                                        
001564   6ae6     CLRF      0xe6,0x0                                                                                        
001566   dc7a     RCALL     0xe5c                                                                                           
001568   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00156a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00156c   0900     IORLW     0x0                                                                                             
00156e   e107     BNZ       0x157e                                                                                          
001570   0101     MOVLB     0x1                                                                                             
001572   512d     MOVF      0x2d,0x0,0x1                                                                                    
001574   112e     IORWF     0x2e,0x0,0x1                                                                                    
001576   e103     BNZ       0x157e                                                                                          
                                           						/* INC pushed first */                                                     D:\work\midicontroller\x013x\controller.c
001578   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  D:\work\midicontroller\x013x\controller.c
00157a   6f2d     MOVWF     0x2d,0x1                                                                                        
00157c   6b2e     CLRF      0x2e,0x1                                                                                        
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* Still holding INC alone after ~300 ms: */                                D:\work\midicontroller\x013x\controller.c
00157e   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_INC) && !button_held(FSM_DEC) && (cdtimer_incdec_held == 0)) { D:\work\midicontroller\x013x\controller.c
001580   5131     MOVF      0x31,0x0,0x1                                                                                    
001582   e11b     BNZ       0x15ba                                                                                          
001584   0e00     MOVLW     0x0                                                                                             
001586   6ee6     MOVWF     0xe6,0x0                                                                                        
001588   6ae6     CLRF      0xe6,0x0                                                                                        
00158a   dc68     RCALL     0xe5c                                                                                           
00158c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00158e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001590   0900     IORLW     0x0                                                                                             
001592   e013     BZ        0x15ba                                                                                          
001594   0e00     MOVLW     0x0                                                                                             
001596   6ee6     MOVWF     0xe6,0x0                                                                                        
001598   6ae6     CLRF      0xe6,0x0                                                                                        
00159a   dc60     RCALL     0xe5c                                                                                           
00159c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00159e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015a0   0900     IORLW     0x0                                                                                             
0015a2   e10b     BNZ       0x15ba                                                                                          
0015a4   0101     MOVLB     0x1                                                                                             
0015a6   512d     MOVF      0x2d,0x0,0x1                                                                                    
0015a8   112e     IORWF     0x2e,0x0,0x1                                                                                    
0015aa   e107     BNZ       0x15ba                                                                                          
0015ac   0101     MOVLB     0x1            						accel_time = 0;                                                            D:\work\midicontroller\x013x\controller.c
0015ae   6b20     CLRF      0x20,0x1                                                                                        
0015b0   6b21     CLRF      0x21,0x1                                                                                        
0015b2   6b22     CLRF      0x22,0x1       						accel_count = 0;                                                           D:\work\midicontroller\x013x\controller.c
0015b4   0101     MOVLB     0x1            						accel_state = ACCEL_INC_SLOW;                                              D:\work\midicontroller\x013x\controller.c
0015b6   0e01     MOVLW     0x1                                                                                             
0015b8   6f31     MOVWF     0x31,0x1                                                                                        
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* INC released: */                                                         D:\work\midicontroller\x013x\controller.c
0015ba   0e00     MOVLW     0x0            					if (button_released(FSM_INC)) {                                             D:\work\midicontroller\x013x\controller.c
0015bc   6ee6     MOVWF     0xe6,0x0                                                                                        
0015be   6ae6     CLRF      0xe6,0x0                                                                                        
0015c0   dc6d     RCALL     0xe9c                                                                                           
0015c2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015c6   0900     IORLW     0x0                                                                                             
0015c8   e00c     BZ        0x15e2                                                                                          
0015ca   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             D:\work\midicontroller\x013x\controller.c
0015cc   0e00     MOVLW     0x0                                                                                             
0015ce   80d8     BSF       0xd8,0x0,0x0                                                                                    
0015d0   552d     SUBFWB    0x2d,0x0,0x1                                                                                    
0015d2   0e00     MOVLW     0x0                                                                                             
0015d4   552e     SUBFWB    0x2e,0x0,0x1                                                                                    
0015d6   e202     BC        0x15dc                                                                                          
0015d8   dd93     RCALL     0x1100         							inc_practice_value();                                                     D:\work\midicontroller\x013x\controller.c
0015da   ddce     RCALL     0x1178         							notify_practice_value();                                                  D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
0015dc   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  D:\work\midicontroller\x013x\controller.c
0015de   6b31     CLRF      0x31,0x1                                                                                        
0015e0   ddd2     RCALL     0x1186         						activate_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           					/* DEC pressed: */                                                          D:\work\midicontroller\x013x\controller.c
0015e2   0e00     MOVLW     0x0            					if (button_pressed(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { D:\work\midicontroller\x013x\controller.c
0015e4   6ee6     MOVWF     0xe6,0x0                                                                                        
0015e6   6ae6     CLRF      0xe6,0x0                                                                                        
0015e8   dc0a     RCALL     0xdfe                                                                                           
0015ea   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ec   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015ee   0900     IORLW     0x0                                                                                             
0015f0   e00f     BZ        0x1610                                                                                          
0015f2   0e00     MOVLW     0x0                                                                                             
0015f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0015f6   6ae6     CLRF      0xe6,0x0                                                                                        
0015f8   dc31     RCALL     0xe5c                                                                                           
0015fa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0015fe   0900     IORLW     0x0                                                                                             
001600   e107     BNZ       0x1610                                                                                          
001602   0101     MOVLB     0x1                                                                                             
001604   512d     MOVF      0x2d,0x0,0x1                                                                                    
001606   112e     IORWF     0x2e,0x0,0x1                                                                                    
001608   e103     BNZ       0x1610                                                                                          
                                           						/* DEC pushed first */                                                     D:\work\midicontroller\x013x\controller.c
00160a   0e1e     MOVLW     0x1e           						cdtimer_incdec_held = 30;                                                  D:\work\midicontroller\x013x\controller.c
00160c   6f2d     MOVWF     0x2d,0x1                                                                                        
00160e   6b2e     CLRF      0x2e,0x1                                                                                        
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* Still holding DEC alone after ~300 ms: */                                D:\work\midicontroller\x013x\controller.c
001610   0101     MOVLB     0x1            					if ((accel_state == ACCEL_NONE) && button_held(FSM_DEC) && !button_held(FSM_INC) && (cdtimer_incdec_held == 0)) { D:\work\midicontroller\x013x\controller.c
001612   5131     MOVF      0x31,0x0,0x1                                                                                    
001614   e11b     BNZ       0x164c                                                                                          
001616   0e00     MOVLW     0x0                                                                                             
001618   6ee6     MOVWF     0xe6,0x0                                                                                        
00161a   6ae6     CLRF      0xe6,0x0                                                                                        
00161c   dc1f     RCALL     0xe5c                                                                                           
00161e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001620   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001622   0900     IORLW     0x0                                                                                             
001624   e013     BZ        0x164c                                                                                          
001626   0e00     MOVLW     0x0                                                                                             
001628   6ee6     MOVWF     0xe6,0x0                                                                                        
00162a   6ae6     CLRF      0xe6,0x0                                                                                        
00162c   dc17     RCALL     0xe5c                                                                                           
00162e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001630   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001632   0900     IORLW     0x0                                                                                             
001634   e10b     BNZ       0x164c                                                                                          
001636   0101     MOVLB     0x1                                                                                             
001638   512d     MOVF      0x2d,0x0,0x1                                                                                    
00163a   112e     IORWF     0x2e,0x0,0x1                                                                                    
00163c   e107     BNZ       0x164c                                                                                          
00163e   0101     MOVLB     0x1            						accel_time = 0;                                                            D:\work\midicontroller\x013x\controller.c
001640   6b20     CLRF      0x20,0x1                                                                                        
001642   6b21     CLRF      0x21,0x1                                                                                        
001644   6b22     CLRF      0x22,0x1       						accel_count = 0;                                                           D:\work\midicontroller\x013x\controller.c
001646   0101     MOVLB     0x1            						accel_state = ACCEL_DEC_SLOW;                                              D:\work\midicontroller\x013x\controller.c
001648   0e04     MOVLW     0x4                                                                                             
00164a   6f31     MOVWF     0x31,0x1                                                                                        
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* DEC released: */                                                         D:\work\midicontroller\x013x\controller.c
00164c   0e00     MOVLW     0x0            					if (button_released(FSM_DEC)) {                                             D:\work\midicontroller\x013x\controller.c
00164e   6ee6     MOVWF     0xe6,0x0                                                                                        
001650   6ae6     CLRF      0xe6,0x0                                                                                        
001652   dc24     RCALL     0xe9c                                                                                           
001654   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001656   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001658   0900     IORLW     0x0                                                                                             
00165a   e00c     BZ        0x1674                                                                                          
00165c   0101     MOVLB     0x1            						if (cdtimer_incdec_held > 0) {                                             D:\work\midicontroller\x013x\controller.c
00165e   0e00     MOVLW     0x0                                                                                             
001660   80d8     BSF       0xd8,0x0,0x0                                                                                    
001662   552d     SUBFWB    0x2d,0x0,0x1                                                                                    
001664   0e00     MOVLW     0x0                                                                                             
001666   552e     SUBFWB    0x2e,0x0,0x1                                                                                    
001668   e202     BC        0x166e                                                                                          
00166a   dd6a     RCALL     0x1140         							dec_practice_value();                                                     D:\work\midicontroller\x013x\controller.c
00166c   dd85     RCALL     0x1178         							notify_practice_value();                                                  D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
00166e   0101     MOVLB     0x1            						accel_state = ACCEL_NONE;                                                  D:\work\midicontroller\x013x\controller.c
001670   6b31     CLRF      0x31,0x1                                                                                        
001672   dd89     RCALL     0x1186         						activate_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           					/* ENTER pressed */                                                         D:\work\midicontroller\x013x\controller.c
001674   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            D:\work\midicontroller\x013x\controller.c
001676   6ee6     MOVWF     0xe6,0x0                                                                                        
001678   6ae6     CLRF      0xe6,0x0                                                                                        
00167a   ecff     CALL      0xdfe,0x0                                                                                       
00167c   f006                                                                                                               
00167e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001680   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001682   0900     IORLW     0x0                                                                                             
001684   e004     BZ        0x168e                                                                                          
001686   0e1e     MOVLW     0x1e           						cdtimer_holdenter = 30;                                                    D:\work\midicontroller\x013x\controller.c
001688   0101     MOVLB     0x1                                                                                             
00168a   6f2f     MOVWF     0x2f,0x1                                                                                        
00168c   6b30     CLRF      0x30,0x1                                                                                        
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* ENTER held at least ~300msec: */                                         D:\work\midicontroller\x013x\controller.c
00168e   0e00     MOVLW     0x0            					if (button_held(FSM_ENTER) && (cdtimer_holdenter == 0) && (program_mode == PROGRAM_NONE)) { D:\work\midicontroller\x013x\controller.c
001690   6ee6     MOVWF     0xe6,0x0                                                                                        
001692   6ae6     CLRF      0xe6,0x0                                                                                        
001694   ec2e     CALL      0xe5c,0x0                                                                                       
001696   f007                                                                                                               
001698   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00169a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00169c   0900     IORLW     0x0                                                                                             
00169e   e00e     BZ        0x16bc                                                                                          
0016a0   0101     MOVLB     0x1                                                                                             
0016a2   512f     MOVF      0x2f,0x0,0x1                                                                                    
0016a4   1130     IORWF     0x30,0x0,0x1                                                                                    
0016a6   e10a     BNZ       0x16bc                                                                                          
0016a8   5133     MOVF      0x33,0x0,0x1                                                                                    
0016aa   e108     BNZ       0x16bc                                                                                          
                                           						/* enter sequence program mode */                                          D:\work\midicontroller\x013x\controller.c
0016ac   0e01     MOVLW     0x1            						program_mode = PROGRAM_SEQUENCE;                                           D:\work\midicontroller\x013x\controller.c
0016ae   6f33     MOVWF     0x33,0x1                                                                                        
0016b0   0101     MOVLB     0x1            						curr_mapindex = 0;                                                         D:\work\midicontroller\x013x\controller.c
0016b2   6b17     CLRF      0x17,0x1                                                                                        
0016b4   0e04     MOVLW     0x4            						curr_preset = 4;                                                           D:\work\midicontroller\x013x\controller.c
0016b6   6f16     MOVWF     0x16,0x1                                                                                        
0016b8   ecd0     CALL      0xda0,0x0      						sortedbank_showname();                                                     D:\work\midicontroller\x013x\controller.c
0016ba   f006                                                                                                               
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           					/* ENTER released before ~300msec was up: */                                D:\work\midicontroller\x013x\controller.c
0016bc   0e00     MOVLW     0x0            					if (button_released(FSM_ENTER) && (cdtimer_holdenter > 0)) {                D:\work\midicontroller\x013x\controller.c
0016be   6ee6     MOVWF     0xe6,0x0                                                                                        
0016c0   6ae6     CLRF      0xe6,0x0                                                                                        
0016c2   ec4e     CALL      0xe9c,0x0                                                                                       
0016c4   f007                                                                                                               
0016c6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016c8   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0016ca   0900     IORLW     0x0                                                                                             
0016cc   e019     BZ        0x1700                                                                                          
0016ce   0101     MOVLB     0x1                                                                                             
0016d0   0e00     MOVLW     0x0                                                                                             
0016d2   80d8     BSF       0xd8,0x0,0x0                                                                                    
0016d4   552f     SUBFWB    0x2f,0x0,0x1                                                                                    
0016d6   0e00     MOVLW     0x0                                                                                             
0016d8   5530     SUBFWB    0x30,0x0,0x1                                                                                    
0016da   e212     BC        0x1700                                                                                          
0016dc   5145     MOVF      0x45,0x0,0x1   						if (incdec_mode == 0) {                                                    D:\work\midicontroller\x013x\controller.c
0016de   e109     BNZ       0x16f2                                                                                          
                                           							/* program-select mode */                                                 D:\work\midicontroller\x013x\controller.c
0016e0   0e01     MOVLW     0x1            							incdec_mode = 1;                                                          D:\work\midicontroller\x013x\controller.c
0016e2   6f45     MOVWF     0x45,0x1                                                                                        
0016e4   0e03     MOVLW     0x3            							flash_state = FLASH_PRGM_SELECT_MODE;                                     D:\work\midicontroller\x013x\controller.c
0016e6   6f32     MOVWF     0x32,0x1                                                                                        
0016e8   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      D:\work\midicontroller\x013x\controller.c
0016ea   6f29     MOVWF     0x29,0x1                                                                                        
0016ec   6b2a     CLRF      0x2a,0x1                                                                                        
0016ee   dd44     RCALL     0x1178         							notify_practice_value();                                                  D:\work\midicontroller\x013x\controller.c
0016f0   d007     BRA       0x1700         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
                                           							/* bank-select mode by alphabetical order */                              D:\work\midicontroller\x013x\controller.c
0016f2   6b45     CLRF      0x45,0x1       							incdec_mode = 0;                                                          D:\work\midicontroller\x013x\controller.c
0016f4   0e02     MOVLW     0x2            							flash_state = FLASH_BANK_SELECT_MODE;                                     D:\work\midicontroller\x013x\controller.c
0016f6   6f32     MOVWF     0x32,0x1                                                                                        
0016f8   0e64     MOVLW     0x64           							cdtimer_flash = 100;                                                      D:\work\midicontroller\x013x\controller.c
0016fa   6f29     MOVWF     0x29,0x1                                                                                        
0016fc   6b2a     CLRF      0x2a,0x1                                                                                        
0016fe   dd3c     RCALL     0x1178         							notify_practice_value();                                                  D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           					/* acceleration countdown timer hit 0 and we're incrementing slowly */      D:\work\midicontroller\x013x\controller.c
001700   0101     MOVLB     0x1            					if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                     D:\work\midicontroller\x013x\controller.c
001702   5131     MOVF      0x31,0x0,0x1                                                                                    
001704   e075     BZ        0x17f0                                                                                          
001706   0101     MOVLB     0x1                                                                                             
001708   5120     MOVF      0x20,0x0,0x1                                                                                    
00170a   1121     IORWF     0x21,0x0,0x1                                                                                    
00170c   e171     BNZ       0x17f0                                                                                          
00170e   0101     MOVLB     0x1            						switch (accel_state) {                                                     D:\work\midicontroller\x013x\controller.c
001710   5131     MOVF      0x31,0x0,0x1                                                                                    
001712   0a06     XORLW     0x6                                                                                             
001714   e066     BZ        0x17e2                                                                                          
001716   0a03     XORLW     0x3                                                                                             
001718   e04f     BZ        0x17b8                                                                                          
00171a   0a01     XORLW     0x1                                                                                             
00171c   e038     BZ        0x178e                                                                                          
00171e   0a07     XORLW     0x7                                                                                             
001720   e02f     BZ        0x1780                                                                                          
001722   0a01     XORLW     0x1                                                                                             
001724   e018     BZ        0x1756                                                                                          
001726   0a03     XORLW     0x3                                                                                             
001728   e001     BZ        0x172c                                                                                          
00172a   d062     BRA       0x17f0                                                                                          
                                           							case ACCEL_INC_SLOW:                                                      D:\work\midicontroller\x013x\controller.c
00172c   dce9     RCALL     0x1100         								inc_practice_value();                                                    D:\work\midicontroller\x013x\controller.c
00172e   dd24     RCALL     0x1178         								notify_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             D:\work\midicontroller\x013x\controller.c
001730   0101     MOVLB     0x1            								if (accel_count++ == 5) {                                                D:\work\midicontroller\x013x\controller.c
001732   5122     MOVF      0x22,0x0,0x1                                                                                    
001734   2b22     INCF      0x22,0x1,0x1                                                                                    
001736   0805     SUBLW     0x5                                                                                             
001738   e109     BNZ       0x174c                                                                                          
00173a   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        D:\work\midicontroller\x013x\controller.c
00173c   0101     MOVLB     0x1            									accel_state = ACCEL_INC_MEDIUM;                                         D:\work\midicontroller\x013x\controller.c
00173e   0e02     MOVLW     0x2                                                                                             
001740   6f31     MOVWF     0x31,0x1                                                                                        
001742   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         D:\work\midicontroller\x013x\controller.c
001744   f120                                                                                                               
001746   c138     MOVFF     0x138,0x121                                                                                     
001748   f121                                                                                                               
00174a   d004     BRA       0x1754         								} else {                                                                 D:\work\midicontroller\x013x\controller.c
00174c   c135     MOVFF     0x135,0x120    									accel_time = accel_time_slow;                                           D:\work\midicontroller\x013x\controller.c
00174e   f120                                                                                                               
001750   c136     MOVFF     0x136,0x121                                                                                     
001752   f121                                                                                                               
                                           								}                                                                        D:\work\midicontroller\x013x\controller.c
001754   d04d     BRA       0x17f0         								break;                                                                   D:\work\midicontroller\x013x\controller.c
                                           							case ACCEL_INC_MEDIUM:                                                    D:\work\midicontroller\x013x\controller.c
001756   dcd4     RCALL     0x1100         								inc_practice_value();                                                    D:\work\midicontroller\x013x\controller.c
001758   dd0f     RCALL     0x1178         								notify_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             D:\work\midicontroller\x013x\controller.c
00175a   0101     MOVLB     0x1            								if (accel_count++ == 20) {                                               D:\work\midicontroller\x013x\controller.c
00175c   5122     MOVF      0x22,0x0,0x1                                                                                    
00175e   2b22     INCF      0x22,0x1,0x1                                                                                    
001760   0814     SUBLW     0x14                                                                                            
001762   e109     BNZ       0x1776                                                                                          
001764   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        D:\work\midicontroller\x013x\controller.c
001766   0101     MOVLB     0x1            									accel_state = ACCEL_INC_FAST;                                           D:\work\midicontroller\x013x\controller.c
001768   0e03     MOVLW     0x3                                                                                             
00176a   6f31     MOVWF     0x31,0x1                                                                                        
00176c   c139     MOVFF     0x139,0x120    									accel_time = accel_time_fast;                                           D:\work\midicontroller\x013x\controller.c
00176e   f120                                                                                                               
001770   c13a     MOVFF     0x13a,0x121                                                                                     
001772   f121                                                                                                               
001774   d004     BRA       0x177e         								} else {                                                                 D:\work\midicontroller\x013x\controller.c
001776   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         D:\work\midicontroller\x013x\controller.c
001778   f120                                                                                                               
00177a   c138     MOVFF     0x138,0x121                                                                                     
00177c   f121                                                                                                               
                                           								}                                                                        D:\work\midicontroller\x013x\controller.c
00177e   d038     BRA       0x17f0         								break;                                                                   D:\work\midicontroller\x013x\controller.c
                                           							case ACCEL_INC_FAST:                                                      D:\work\midicontroller\x013x\controller.c
001780   dcbf     RCALL     0x1100         								inc_practice_value();                                                    D:\work\midicontroller\x013x\controller.c
001782   dcfa     RCALL     0x1178         								notify_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
001784   c139     MOVFF     0x139,0x120    								accel_time = accel_time_fast;                                            D:\work\midicontroller\x013x\controller.c
001786   f120                                                                                                               
001788   c13a     MOVFF     0x13a,0x121                                                                                     
00178a   f121                                                                                                               
00178c   d031     BRA       0x17f0         								break;                                                                   D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           							case ACCEL_DEC_SLOW:                                                      D:\work\midicontroller\x013x\controller.c
00178e   dcd8     RCALL     0x1140         								dec_practice_value();                                                    D:\work\midicontroller\x013x\controller.c
001790   dcf3     RCALL     0x1178         								notify_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             D:\work\midicontroller\x013x\controller.c
001792   0101     MOVLB     0x1            								if (accel_count++ == 5) {                                                D:\work\midicontroller\x013x\controller.c
001794   5122     MOVF      0x22,0x0,0x1                                                                                    
001796   2b22     INCF      0x22,0x1,0x1                                                                                    
001798   0805     SUBLW     0x5                                                                                             
00179a   e109     BNZ       0x17ae                                                                                          
00179c   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        D:\work\midicontroller\x013x\controller.c
00179e   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_MEDIUM;                                         D:\work\midicontroller\x013x\controller.c
0017a0   0e05     MOVLW     0x5                                                                                             
0017a2   6f31     MOVWF     0x31,0x1                                                                                        
0017a4   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         D:\work\midicontroller\x013x\controller.c
0017a6   f120                                                                                                               
0017a8   c138     MOVFF     0x138,0x121                                                                                     
0017aa   f121                                                                                                               
0017ac   d004     BRA       0x17b6         								} else {                                                                 D:\work\midicontroller\x013x\controller.c
0017ae   c135     MOVFF     0x135,0x120    									accel_time = accel_time_slow;                                           D:\work\midicontroller\x013x\controller.c
0017b0   f120                                                                                                               
0017b2   c136     MOVFF     0x136,0x121                                                                                     
0017b4   f121                                                                                                               
                                           								}                                                                        D:\work\midicontroller\x013x\controller.c
0017b6   d01c     BRA       0x17f0         								break;                                                                   D:\work\midicontroller\x013x\controller.c
                                           							case ACCEL_DEC_MEDIUM:                                                    D:\work\midicontroller\x013x\controller.c
0017b8   dcc3     RCALL     0x1140         								dec_practice_value();                                                    D:\work\midicontroller\x013x\controller.c
0017ba   dcde     RCALL     0x1178         								notify_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           								/* if we cycled more than 5 values, ramp up to next speed */             D:\work\midicontroller\x013x\controller.c
0017bc   0101     MOVLB     0x1            								if (accel_count++ == 20) {                                               D:\work\midicontroller\x013x\controller.c
0017be   5122     MOVF      0x22,0x0,0x1                                                                                    
0017c0   2b22     INCF      0x22,0x1,0x1                                                                                    
0017c2   0814     SUBLW     0x14                                                                                            
0017c4   e109     BNZ       0x17d8                                                                                          
0017c6   6b22     CLRF      0x22,0x1       									accel_count = 0;                                                        D:\work\midicontroller\x013x\controller.c
0017c8   0101     MOVLB     0x1            									accel_state = ACCEL_DEC_FAST;                                           D:\work\midicontroller\x013x\controller.c
0017ca   0e06     MOVLW     0x6                                                                                             
0017cc   6f31     MOVWF     0x31,0x1                                                                                        
0017ce   c139     MOVFF     0x139,0x120    									accel_time = accel_time_fast;                                           D:\work\midicontroller\x013x\controller.c
0017d0   f120                                                                                                               
0017d2   c13a     MOVFF     0x13a,0x121                                                                                     
0017d4   f121                                                                                                               
0017d6   d004     BRA       0x17e0         								} else {                                                                 D:\work\midicontroller\x013x\controller.c
0017d8   c137     MOVFF     0x137,0x120    									accel_time = accel_time_medium;                                         D:\work\midicontroller\x013x\controller.c
0017da   f120                                                                                                               
0017dc   c138     MOVFF     0x138,0x121                                                                                     
0017de   f121                                                                                                               
                                           								}                                                                        D:\work\midicontroller\x013x\controller.c
0017e0   d007     BRA       0x17f0         								break;                                                                   D:\work\midicontroller\x013x\controller.c
                                           							case ACCEL_DEC_FAST:                                                      D:\work\midicontroller\x013x\controller.c
0017e2   dcae     RCALL     0x1140         								dec_practice_value();                                                    D:\work\midicontroller\x013x\controller.c
0017e4   dcc9     RCALL     0x1178         								notify_practice_value();                                                 D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
0017e6   c139     MOVFF     0x139,0x120    								accel_time = accel_time_fast;                                            D:\work\midicontroller\x013x\controller.c
0017e8   f120                                                                                                               
0017ea   c13a     MOVFF     0x13a,0x121                                                                                     
0017ec   f121                                                                                                               
0017ee   d000     BRA       0x17f0         								break;                                                                   D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
0017f0   d0d0     BRA       0x1992         					break;                                                                      D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           				/* sequence programming mode: */                                             D:\work\midicontroller\x013x\controller.c
                                           				case PROGRAM_SEQUENCE:                                                       D:\work\midicontroller\x013x\controller.c
                                           					/* one of preset 1-4 pressed: */                                            D:\work\midicontroller\x013x\controller.c
0017f2   0e01     MOVLW     0x1            					if (button_pressed(FSM_PRESET_1)) {                                         D:\work\midicontroller\x013x\controller.c
0017f4   6ee6     MOVWF     0xe6,0x0                                                                                        
0017f6   6ae6     CLRF      0xe6,0x0                                                                                        
0017f8   ecff     CALL      0xdfe,0x0                                                                                       
0017fa   f006                                                                                                               
0017fc   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0017fe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001800   0900     IORLW     0x0                                                                                             
001802   e01a     BZ        0x1838                                                                                          
001804   0101     MOVLB     0x1            						if (curr_preset != 0) {                                                    D:\work\midicontroller\x013x\controller.c
001806   5116     MOVF      0x16,0x0,0x1                                                                                    
001808   e017     BZ        0x1838                                                                                          
00180a   6b16     CLRF      0x16,0x1       							curr_preset = 0;                                                          D:\work\midicontroller\x013x\controller.c
00180c   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
00180e   6ee6     MOVWF     0xe6,0x0                                                                                        
001810   ec28     CALL      0xc50,0x0                                                                                       
001812   f006                                                                                                               
001814   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001816   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   D:\work\midicontroller\x013x\controller.c
001818   5117     MOVF      0x17,0x0,0x1                                                                                    
00181a   2b17     INCF      0x17,0x1,0x1                                                                                    
00181c   6aea     CLRF      0xea,0x0                                                                                        
00181e   0f08     ADDLW     0x8                                                                                             
001820   6ee9     MOVWF     0xe9,0x0                                                                                        
001822   0e01     MOVLW     0x1                                                                                             
001824   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001826   c116     MOVFF     0x116,0xfef                                                                                     
001828   ffef                                                                                                               
00182a   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           D:\work\midicontroller\x013x\controller.c
00182c   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      D:\work\midicontroller\x013x\controller.c
00182e   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 D:\work\midicontroller\x013x\controller.c
001830   0101     MOVLB     0x1                                                                                             
001832   5d17     SUBWF     0x17,0x0,0x1                                                                                    
001834   e101     BNZ       0x1838                                                                                          
001836   dcb3     RCALL     0x119e         								sequence_complete();                                                     D:\work\midicontroller\x013x\controller.c
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
001838   0e02     MOVLW     0x2            					if (button_pressed(FSM_PRESET_2)) {                                         D:\work\midicontroller\x013x\controller.c
00183a   6ee6     MOVWF     0xe6,0x0                                                                                        
00183c   6ae6     CLRF      0xe6,0x0                                                                                        
00183e   ecff     CALL      0xdfe,0x0                                                                                       
001840   f006                                                                                                               
001842   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001844   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001846   0900     IORLW     0x0                                                                                             
001848   e01a     BZ        0x187e                                                                                          
00184a   0101     MOVLB     0x1            						if (curr_preset != 1) {                                                    D:\work\midicontroller\x013x\controller.c
00184c   0516     DECF      0x16,0x0,0x1                                                                                    
00184e   e017     BZ        0x187e                                                                                          
001850   0e01     MOVLW     0x1            							curr_preset = 1;                                                          D:\work\midicontroller\x013x\controller.c
001852   6f16     MOVWF     0x16,0x1                                                                                        
001854   6ee6     MOVWF     0xe6,0x0       							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
001856   ec28     CALL      0xc50,0x0                                                                                       
001858   f006                                                                                                               
00185a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00185c   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   D:\work\midicontroller\x013x\controller.c
00185e   5117     MOVF      0x17,0x0,0x1                                                                                    
001860   2b17     INCF      0x17,0x1,0x1                                                                                    
001862   6aea     CLRF      0xea,0x0                                                                                        
001864   0f08     ADDLW     0x8                                                                                             
001866   6ee9     MOVWF     0xe9,0x0                                                                                        
001868   0e01     MOVLW     0x1                                                                                             
00186a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00186c   c116     MOVFF     0x116,0xfef                                                                                     
00186e   ffef                                                                                                               
001870   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           D:\work\midicontroller\x013x\controller.c
001872   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      D:\work\midicontroller\x013x\controller.c
001874   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 D:\work\midicontroller\x013x\controller.c
001876   0101     MOVLB     0x1                                                                                             
001878   5d17     SUBWF     0x17,0x0,0x1                                                                                    
00187a   e101     BNZ       0x187e                                                                                          
00187c   dc90     RCALL     0x119e         								sequence_complete();                                                     D:\work\midicontroller\x013x\controller.c
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
00187e   0e04     MOVLW     0x4            					if (button_pressed(FSM_PRESET_3)) {                                         D:\work\midicontroller\x013x\controller.c
001880   6ee6     MOVWF     0xe6,0x0                                                                                        
001882   6ae6     CLRF      0xe6,0x0                                                                                        
001884   ecff     CALL      0xdfe,0x0                                                                                       
001886   f006                                                                                                               
001888   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00188c   0900     IORLW     0x0                                                                                             
00188e   e01c     BZ        0x18c8                                                                                          
001890   0e02     MOVLW     0x2            						if (curr_preset != 2) {                                                    D:\work\midicontroller\x013x\controller.c
001892   0101     MOVLB     0x1                                                                                             
001894   5d16     SUBWF     0x16,0x0,0x1                                                                                    
001896   e018     BZ        0x18c8                                                                                          
001898   0e02     MOVLW     0x2            							curr_preset = 2;                                                          D:\work\midicontroller\x013x\controller.c
00189a   6f16     MOVWF     0x16,0x1                                                                                        
00189c   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
00189e   6ee6     MOVWF     0xe6,0x0                                                                                        
0018a0   ec28     CALL      0xc50,0x0                                                                                       
0018a2   f006                                                                                                               
0018a4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018a6   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   D:\work\midicontroller\x013x\controller.c
0018a8   5117     MOVF      0x17,0x0,0x1                                                                                    
0018aa   2b17     INCF      0x17,0x1,0x1                                                                                    
0018ac   6aea     CLRF      0xea,0x0                                                                                        
0018ae   0f08     ADDLW     0x8                                                                                             
0018b0   6ee9     MOVWF     0xe9,0x0                                                                                        
0018b2   0e01     MOVLW     0x1                                                                                             
0018b4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
0018b6   c116     MOVFF     0x116,0xfef                                                                                     
0018b8   ffef                                                                                                               
0018ba   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           D:\work\midicontroller\x013x\controller.c
0018bc   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      D:\work\midicontroller\x013x\controller.c
0018be   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 D:\work\midicontroller\x013x\controller.c
0018c0   0101     MOVLB     0x1                                                                                             
0018c2   5d17     SUBWF     0x17,0x0,0x1                                                                                    
0018c4   e101     BNZ       0x18c8                                                                                          
0018c6   dc6b     RCALL     0x119e         								sequence_complete();                                                     D:\work\midicontroller\x013x\controller.c
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
0018c8   0e08     MOVLW     0x8            					if (button_pressed(FSM_PRESET_4)) {                                         D:\work\midicontroller\x013x\controller.c
0018ca   6ee6     MOVWF     0xe6,0x0                                                                                        
0018cc   6ae6     CLRF      0xe6,0x0                                                                                        
0018ce   ecff     CALL      0xdfe,0x0                                                                                       
0018d0   f006                                                                                                               
0018d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018d4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018d6   0900     IORLW     0x0                                                                                             
0018d8   e01c     BZ        0x1912                                                                                          
0018da   0e03     MOVLW     0x3            						if (curr_preset != 3) {                                                    D:\work\midicontroller\x013x\controller.c
0018dc   0101     MOVLB     0x1                                                                                             
0018de   5d16     SUBWF     0x16,0x0,0x1                                                                                    
0018e0   e018     BZ        0x1912                                                                                          
0018e2   0e03     MOVLW     0x3            							curr_preset = 3;                                                          D:\work\midicontroller\x013x\controller.c
0018e4   6f16     MOVWF     0x16,0x1                                                                                        
0018e6   0e01     MOVLW     0x1            							preset_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
0018e8   6ee6     MOVWF     0xe6,0x0                                                                                        
0018ea   ec28     CALL      0xc50,0x0                                                                                       
0018ec   f006                                                                                                               
0018ee   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0018f0   0101     MOVLB     0x1            							bankmap[curr_mapindex++] = curr_preset;                                   D:\work\midicontroller\x013x\controller.c
0018f2   5117     MOVF      0x17,0x0,0x1                                                                                    
0018f4   2b17     INCF      0x17,0x1,0x1                                                                                    
0018f6   6aea     CLRF      0xea,0x0                                                                                        
0018f8   0f08     ADDLW     0x8                                                                                             
0018fa   6ee9     MOVWF     0xe9,0x0                                                                                        
0018fc   0e01     MOVLW     0x1                                                                                             
0018fe   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
001900   c116     MOVFF     0x116,0xfef                                                                                     
001902   ffef                                                                                                               
001904   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           D:\work\midicontroller\x013x\controller.c
001906   f006                                                                                                               
                                           							/* just stored our last sequence: */                                      D:\work\midicontroller\x013x\controller.c
001908   0e08     MOVLW     0x8            							if (curr_mapindex == 8) {                                                 D:\work\midicontroller\x013x\controller.c
00190a   0101     MOVLB     0x1                                                                                             
00190c   5d17     SUBWF     0x17,0x0,0x1                                                                                    
00190e   e101     BNZ       0x1912                                                                                          
001910   dc46     RCALL     0x119e         								sequence_complete();                                                     D:\work\midicontroller\x013x\controller.c
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           					/* ENTER pressed */                                                         D:\work\midicontroller\x013x\controller.c
001912   0e00     MOVLW     0x0            					if (button_pressed(FSM_ENTER)) {                                            D:\work\midicontroller\x013x\controller.c
001914   6ee6     MOVWF     0xe6,0x0                                                                                        
001916   6ae6     CLRF      0xe6,0x0                                                                                        
001918   ecff     CALL      0xdfe,0x0                                                                                       
00191a   f006                                                                                                               
00191c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00191e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001920   0900     IORLW     0x0                                                                                             
001922   e001     BZ        0x1926                                                                                          
                                           						/* stop programming early and save the sequence: */                        D:\work\midicontroller\x013x\controller.c
001924   dc3c     RCALL     0x119e         						sequence_complete();                                                       D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
001926   d035     BRA       0x1992         					break;                                                                      D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           				/* sequence repeat mode: */                                                  D:\work\midicontroller\x013x\controller.c
                                           				case PROGRAM_COMPLETE:                                                       D:\work\midicontroller\x013x\controller.c
001928   512f     MOVF      0x2f,0x0,0x1   					if (cdtimer_holdenter == 0) {                                               D:\work\midicontroller\x013x\controller.c
00192a   1130     IORWF     0x30,0x0,0x1                                                                                    
00192c   e131     BNZ       0x1990                                                                                          
00192e   0101     MOVLB     0x1            						if (curr_mapindex == bankmap_count) {                                      D:\work\midicontroller\x013x\controller.c
001930   5110     MOVF      0x10,0x0,0x1                                                                                    
001932   5d17     SUBWF     0x17,0x0,0x1                                                                                    
001934   e10a     BNZ       0x194a                                                                                          
                                           							/* we're done! */                                                         D:\work\midicontroller\x013x\controller.c
001936   0101     MOVLB     0x1            							program_mode = PROGRAM_NONE;                                              D:\work\midicontroller\x013x\controller.c
001938   6b33     CLRF      0x33,0x1                                                                                        
00193a   0101     MOVLB     0x1            							curr_mapindex = 0;                                                        D:\work\midicontroller\x013x\controller.c
00193c   6b17     CLRF      0x17,0x1                                                                                        
00193e   0e01     MOVLW     0x1            							bankmap_activate(1);                                                      D:\work\midicontroller\x013x\controller.c
001940   6ee6     MOVWF     0xe6,0x0                                                                                        
001942   ec4d     CALL      0xc9a,0x0                                                                                       
001944   f006                                                                                                               
001946   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001948   d023     BRA       0x1990         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
                                           							/* set the next LED active */                                             D:\work\midicontroller\x013x\controller.c
00194a   ec46     CALL      0xc8c,0x0      							bankmap_show();                                                           D:\work\midicontroller\x013x\controller.c
00194c   f006                                                                                                               
00194e   0101     MOVLB     0x1            							curr_preset = bankmap[curr_mapindex];                                     D:\work\midicontroller\x013x\controller.c
001950   5117     MOVF      0x17,0x0,0x1                                                                                    
001952   6aea     CLRF      0xea,0x0                                                                                        
001954   0f08     ADDLW     0x8                                                                                             
001956   6ee9     MOVWF     0xe9,0x0                                                                                        
001958   0e01     MOVLW     0x1                                                                                             
00195a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00195c   cfef     MOVFF     0xfef,0x116                                                                                     
00195e   f116                                                                                                               
001960   5116     MOVF      0x16,0x0,0x1   							fsw_led_set_active(curr_preset);                                          D:\work\midicontroller\x013x\controller.c
001962   6ee6     MOVWF     0xe6,0x0                                                                                        
001964   6ae6     CLRF      0xe6,0x0                                                                                        
001966   ecf3     CALL      0x27e6,0x0                                                                                      
001968   f013                                                                                                               
00196a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00196c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
00196e   0101     MOVLB     0x1            							curr_program = bank[curr_preset];                                         D:\work\midicontroller\x013x\controller.c
001970   5116     MOVF      0x16,0x0,0x1                                                                                    
001972   6aea     CLRF      0xea,0x0                                                                                        
001974   0f00     ADDLW     0x0                                                                                             
001976   6ee9     MOVWF     0xe9,0x0                                                                                        
001978   0e01     MOVLW     0x1                                                                                             
00197a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
00197c   cfef     MOVFF     0xfef,0x115                                                                                     
00197e   f115                                                                                                               
001980   ece8     CALL      0xbd0,0x0      							show_program();                                                           D:\work\midicontroller\x013x\controller.c
001982   f005                                                                                                               
001984   0101     MOVLB     0x1            							++curr_mapindex;                                                          D:\work\midicontroller\x013x\controller.c
001986   2b17     INCF      0x17,0x1,0x1                                                                                    
001988   0e32     MOVLW     0x32           							cdtimer_holdenter = 50;                                                   D:\work\midicontroller\x013x\controller.c
00198a   0101     MOVLB     0x1                                                                                             
00198c   6f2f     MOVWF     0x2f,0x1                                                                                        
00198e   6b30     CLRF      0x30,0x1                                                                                        
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
001990   d000     BRA       0x1992         					break;                                                                      D:\work\midicontroller\x013x\controller.c
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
001992   d1ea     BRA       0x1d68         			break;                                                                        D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           		case MODE_CONCERT:                                                             D:\work\midicontroller\x013x\controller.c
                                           			/*                                                                            D:\work\midicontroller\x013x\controller.c
                                           				next/prev buttons move bank map index pointer up/down by 1, cycling up/down bank # when bank D:\work\midicontroller\x013x\controller.c
                                           				map boundaries are crossed.  Single-digit 7-segment display shows map index # as 1-8. D:\work\midicontroller\x013x\controller.c
                                           				inc/dec buttons move through banks, resetting bank map index to 0.  Bank name displays on 4-digit display. D:\work\midicontroller\x013x\controller.c
                                           				preset button 1-4: change program # immediately, showing program # on 4-digit display for .5 sec, D:\work\midicontroller\x013x\controller.c
                                           				reverting display back to bank name.                                         D:\work\midicontroller\x013x\controller.c
                                           			*/                                                                            D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           			/* one of preset 1-4 pressed: */                                              D:\work\midicontroller\x013x\controller.c
001994   0e01     MOVLW     0x1            			if (button_pressed(FSM_PRESET_1)) {                                           D:\work\midicontroller\x013x\controller.c
001996   6ee6     MOVWF     0xe6,0x0                                                                                        
001998   6ae6     CLRF      0xe6,0x0                                                                                        
00199a   ecff     CALL      0xdfe,0x0                                                                                       
00199c   f006                                                                                                               
00199e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019a2   0900     IORLW     0x0                                                                                             
0019a4   e007     BZ        0x19b4                                                                                          
0019a6   0101     MOVLB     0x1            				curr_preset = 0;                                                             D:\work\midicontroller\x013x\controller.c
0019a8   6b16     CLRF      0x16,0x1                                                                                        
0019aa   0e01     MOVLW     0x1            				preset_activate(1);                                                          D:\work\midicontroller\x013x\controller.c
0019ac   6ee6     MOVWF     0xe6,0x0                                                                                        
0019ae   ec28     CALL      0xc50,0x0                                                                                       
0019b0   f006                                                                                                               
0019b2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
0019b4   0e02     MOVLW     0x2            			if (button_pressed(FSM_PRESET_2)) {                                           D:\work\midicontroller\x013x\controller.c
0019b6   6ee6     MOVWF     0xe6,0x0                                                                                        
0019b8   6ae6     CLRF      0xe6,0x0                                                                                        
0019ba   ecff     CALL      0xdfe,0x0                                                                                       
0019bc   f006                                                                                                               
0019be   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019c2   0900     IORLW     0x0                                                                                             
0019c4   e007     BZ        0x19d4                                                                                          
0019c6   0101     MOVLB     0x1            				curr_preset = 1;                                                             D:\work\midicontroller\x013x\controller.c
0019c8   0e01     MOVLW     0x1                                                                                             
0019ca   6f16     MOVWF     0x16,0x1                                                                                        
0019cc   6ee6     MOVWF     0xe6,0x0       				preset_activate(1);                                                          D:\work\midicontroller\x013x\controller.c
0019ce   ec28     CALL      0xc50,0x0                                                                                       
0019d0   f006                                                                                                               
0019d2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
0019d4   0e04     MOVLW     0x4            			if (button_pressed(FSM_PRESET_3)) {                                           D:\work\midicontroller\x013x\controller.c
0019d6   6ee6     MOVWF     0xe6,0x0                                                                                        
0019d8   6ae6     CLRF      0xe6,0x0                                                                                        
0019da   ecff     CALL      0xdfe,0x0                                                                                       
0019dc   f006                                                                                                               
0019de   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019e0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
0019e2   0900     IORLW     0x0                                                                                             
0019e4   e008     BZ        0x19f6                                                                                          
0019e6   0101     MOVLB     0x1            				curr_preset = 2;                                                             D:\work\midicontroller\x013x\controller.c
0019e8   0e02     MOVLW     0x2                                                                                             
0019ea   6f16     MOVWF     0x16,0x1                                                                                        
0019ec   0e01     MOVLW     0x1            				preset_activate(1);                                                          D:\work\midicontroller\x013x\controller.c
0019ee   6ee6     MOVWF     0xe6,0x0                                                                                        
0019f0   ec28     CALL      0xc50,0x0                                                                                       
0019f2   f006                                                                                                               
0019f4   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
0019f6   0e08     MOVLW     0x8            			if (button_pressed(FSM_PRESET_4)) {                                           D:\work\midicontroller\x013x\controller.c
0019f8   6ee6     MOVWF     0xe6,0x0                                                                                        
0019fa   6ae6     CLRF      0xe6,0x0                                                                                        
0019fc   ecff     CALL      0xdfe,0x0                                                                                       
0019fe   f006                                                                                                               
001a00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a02   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a04   0900     IORLW     0x0                                                                                             
001a06   e008     BZ        0x1a18                                                                                          
001a08   0101     MOVLB     0x1            				curr_preset = 3;                                                             D:\work\midicontroller\x013x\controller.c
001a0a   0e03     MOVLW     0x3                                                                                             
001a0c   6f16     MOVWF     0x16,0x1                                                                                        
001a0e   0e01     MOVLW     0x1            				preset_activate(1);                                                          D:\work\midicontroller\x013x\controller.c
001a10   6ee6     MOVWF     0xe6,0x0                                                                                        
001a12   ec28     CALL      0xc50,0x0                                                                                       
001a14   f006                                                                                                               
001a16   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           			/* INC pressed: */                                                            D:\work\midicontroller\x013x\controller.c
001a18   0e00     MOVLW     0x0            			if (button_pressed(FSM_INC)) {                                                D:\work\midicontroller\x013x\controller.c
001a1a   6ee6     MOVWF     0xe6,0x0                                                                                        
001a1c   6ae6     CLRF      0xe6,0x0                                                                                        
001a1e   ecff     CALL      0xdfe,0x0                                                                                       
001a20   f006                                                                                                               
001a22   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a24   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a26   0900     IORLW     0x0                                                                                             
001a28   e021     BZ        0x1a6c                                                                                          
001a2a   c11e     MOVFF     0x11e,0x10     				if (curr_bank == bank_count - 1) curr_bank = 0;                              D:\work\midicontroller\x013x\controller.c
001a2c   f010                                                                                                               
001a2e   c11f     MOVFF     0x11f,0x11                                                                                      
001a30   f011                                                                                                               
001a32   0610     DECF      0x10,0x1,0x0                                                                                    
001a34   0e00     MOVLW     0x0                                                                                             
001a36   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001a38   5010     MOVF      0x10,0x0,0x0                                                                                    
001a3a   0101     MOVLB     0x1                                                                                             
001a3c   1918     XORWF     0x18,0x0,0x1                                                                                    
001a3e   e102     BNZ       0x1a44                                                                                          
001a40   5011     MOVF      0x11,0x0,0x0                                                                                    
001a42   1919     XORWF     0x19,0x0,0x1                                                                                    
001a44   e103     BNZ       0x1a4c                                                                                          
001a46   6b18     CLRF      0x18,0x1                                                                                        
001a48   6b19     CLRF      0x19,0x1                                                                                        
001a4a   d003     BRA       0x1a52         				else ++curr_bank;                                                            D:\work\midicontroller\x013x\controller.c
001a4c   2b18     INCF      0x18,0x1,0x1                                                                                    
001a4e   0e00     MOVLW     0x0                                                                                             
001a50   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001a52   ecb9     CALL      0xd72,0x0      				bank_showname();                                                             D:\work\midicontroller\x013x\controller.c
001a54   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
001a56   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    D:\work\midicontroller\x013x\controller.c
001a58   6b31     CLRF      0x31,0x1                                                                                        
001a5a   c135     MOVFF     0x135,0x120    				accel_time = accel_time_slow;                                                D:\work\midicontroller\x013x\controller.c
001a5c   f120                                                                                                               
001a5e   c136     MOVFF     0x136,0x121                                                                                     
001a60   f121                                                                                                               
001a62   0101     MOVLB     0x1            				accel_count = 0;                                                             D:\work\midicontroller\x013x\controller.c
001a64   6b22     CLRF      0x22,0x1                                                                                        
001a66   0101     MOVLB     0x1            				accel_state = ACCEL_INC_SLOW;                                                D:\work\midicontroller\x013x\controller.c
001a68   0e01     MOVLW     0x1                                                                                             
001a6a   6f31     MOVWF     0x31,0x1                                                                                        
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                           			/* INC released: */                                                           D:\work\midicontroller\x013x\controller.c
001a6c   0e00     MOVLW     0x0            			if (button_released(FSM_INC)) {                                               D:\work\midicontroller\x013x\controller.c
001a6e   6ee6     MOVWF     0xe6,0x0                                                                                        
001a70   6ae6     CLRF      0xe6,0x0                                                                                        
001a72   ec4e     CALL      0xe9c,0x0                                                                                       
001a74   f007                                                                                                               
001a76   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a7a   0900     IORLW     0x0                                                                                             
001a7c   e006     BZ        0x1a8a                                                                                          
001a7e   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    D:\work\midicontroller\x013x\controller.c
001a80   6b31     CLRF      0x31,0x1                                                                                        
                                           				/* load the bank, but don't change program # */                              D:\work\midicontroller\x013x\controller.c
001a82   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            D:\work\midicontroller\x013x\controller.c
001a84   ec68     CALL      0xcd0,0x0                                                                                       
001a86   f006                                                                                                               
001a88   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           			/* DEC pressed: */                                                            D:\work\midicontroller\x013x\controller.c
001a8a   0e00     MOVLW     0x0            			if (button_pressed(FSM_DEC)) {                                                D:\work\midicontroller\x013x\controller.c
001a8c   6ee6     MOVWF     0xe6,0x0                                                                                        
001a8e   6ae6     CLRF      0xe6,0x0                                                                                        
001a90   ecff     CALL      0xdfe,0x0                                                                                       
001a92   f006                                                                                                               
001a94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a96   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001a98   0900     IORLW     0x0                                                                                             
001a9a   e01d     BZ        0x1ad6                                                                                          
001a9c   0101     MOVLB     0x1            				if (curr_bank == 0) curr_bank = bank_count - 1;                              D:\work\midicontroller\x013x\controller.c
001a9e   5118     MOVF      0x18,0x0,0x1                                                                                    
001aa0   1119     IORWF     0x19,0x0,0x1                                                                                    
001aa2   e109     BNZ       0x1ab6                                                                                          
001aa4   c11e     MOVFF     0x11e,0x118                                                                                     
001aa6   f118                                                                                                               
001aa8   c11f     MOVFF     0x11f,0x119                                                                                     
001aaa   f119                                                                                                               
001aac   0e01     MOVLW     0x1                                                                                             
001aae   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001ab0   0e00     MOVLW     0x0                                                                                             
001ab2   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001ab4   d003     BRA       0x1abc         				else --curr_bank;                                                            D:\work\midicontroller\x013x\controller.c
001ab6   0718     DECF      0x18,0x1,0x1                                                                                    
001ab8   0e00     MOVLW     0x0                                                                                             
001aba   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001abc   ecb9     CALL      0xd72,0x0      				bank_showname();                                                             D:\work\midicontroller\x013x\controller.c
001abe   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
001ac0   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    D:\work\midicontroller\x013x\controller.c
001ac2   6b31     CLRF      0x31,0x1                                                                                        
001ac4   c135     MOVFF     0x135,0x120    				accel_time = accel_time_slow;                                                D:\work\midicontroller\x013x\controller.c
001ac6   f120                                                                                                               
001ac8   c136     MOVFF     0x136,0x121                                                                                     
001aca   f121                                                                                                               
001acc   0101     MOVLB     0x1            				accel_count = 0;                                                             D:\work\midicontroller\x013x\controller.c
001ace   6b22     CLRF      0x22,0x1                                                                                        
001ad0   0101     MOVLB     0x1            				accel_state = ACCEL_DEC_SLOW;                                                D:\work\midicontroller\x013x\controller.c
001ad2   0e04     MOVLW     0x4                                                                                             
001ad4   6f31     MOVWF     0x31,0x1                                                                                        
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                           			/* DEC released: */                                                           D:\work\midicontroller\x013x\controller.c
001ad6   0e00     MOVLW     0x0            			if (button_released(FSM_DEC)) {                                               D:\work\midicontroller\x013x\controller.c
001ad8   6ee6     MOVWF     0xe6,0x0                                                                                        
001ada   6ae6     CLRF      0xe6,0x0                                                                                        
001adc   ec4e     CALL      0xe9c,0x0                                                                                       
001ade   f007                                                                                                               
001ae0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ae2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001ae4   0900     IORLW     0x0                                                                                             
001ae6   e006     BZ        0x1af4                                                                                          
001ae8   0101     MOVLB     0x1            				accel_state = ACCEL_NONE;                                                    D:\work\midicontroller\x013x\controller.c
001aea   6b31     CLRF      0x31,0x1                                                                                        
                                           				/* load the bank, but don't change program # */                              D:\work\midicontroller\x013x\controller.c
001aec   6ae6     CLRF      0xe6,0x0       				bank_activate(0);                                                            D:\work\midicontroller\x013x\controller.c
001aee   ec68     CALL      0xcd0,0x0                                                                                       
001af0   f006                                                                                                               
001af2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           			/* PREV/ENTER pressed: */                                                     D:\work\midicontroller\x013x\controller.c
001af4   0e00     MOVLW     0x0            			if (button_pressed(FSM_ENTER)) {                                              D:\work\midicontroller\x013x\controller.c
001af6   6ee6     MOVWF     0xe6,0x0                                                                                        
001af8   6ae6     CLRF      0xe6,0x0                                                                                        
001afa   ecff     CALL      0xdfe,0x0                                                                                       
001afc   f006                                                                                                               
001afe   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b00   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b02   0900     IORLW     0x0                                                                                             
001b04   e048     BZ        0x1b96                                                                                          
001b06   0101     MOVLB     0x1            				if (loaded_bank != curr_bank) {                                              D:\work\midicontroller\x013x\controller.c
001b08   5118     MOVF      0x18,0x0,0x1                                                                                    
001b0a   191a     XORWF     0x1a,0x0,0x1                                                                                    
001b0c   e102     BNZ       0x1b12                                                                                          
001b0e   5119     MOVF      0x19,0x0,0x1                                                                                    
001b10   191b     XORWF     0x1b,0x0,0x1                                                                                    
001b12   e006     BZ        0x1b20                                                                                          
                                           					/* prepared to switch to a bank, but did not activate the first map */      D:\work\midicontroller\x013x\controller.c
001b14   0e01     MOVLW     0x1            					bankmap_activate(1);                                                        D:\work\midicontroller\x013x\controller.c
001b16   6ee6     MOVWF     0xe6,0x0                                                                                        
001b18   ec4d     CALL      0xc9a,0x0                                                                                       
001b1a   f006                                                                                                               
001b1c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b1e   d03b     BRA       0x1b96         				} else {                                                                     D:\work\midicontroller\x013x\controller.c
001b20   5117     MOVF      0x17,0x0,0x1   					if (curr_mapindex == 0) {                                                   D:\work\midicontroller\x013x\controller.c
001b22   e133     BNZ       0x1b8a                                                                                          
                                           						/* crossed the lower bank-map boundary, load the previous bank */          D:\work\midicontroller\x013x\controller.c
001b24   5123     MOVF      0x23,0x0,0x1   						if (mode == MODE_PRACTICE) {                                               D:\work\midicontroller\x013x\controller.c
001b26   e115     BNZ       0x1b52                                                                                          
                                           							/* PRACTICE mode cycles through banks by sorted index #: */               D:\work\midicontroller\x013x\controller.c
001b28   511c     MOVF      0x1c,0x0,0x1   							if (curr_sortedbank == 0) {                                               D:\work\midicontroller\x013x\controller.c
001b2a   111d     IORWF     0x1d,0x0,0x1                                                                                    
001b2c   e109     BNZ       0x1b40                                                                                          
001b2e   c11e     MOVFF     0x11e,0x11c    								curr_sortedbank = bank_count - 1;                                        D:\work\midicontroller\x013x\controller.c
001b30   f11c                                                                                                               
001b32   c11f     MOVFF     0x11f,0x11d                                                                                     
001b34   f11d                                                                                                               
001b36   0e01     MOVLW     0x1                                                                                             
001b38   5f1c     SUBWF     0x1c,0x1,0x1                                                                                    
001b3a   0e00     MOVLW     0x0                                                                                             
001b3c   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
001b3e   d003     BRA       0x1b46         							} else {                                                                  D:\work\midicontroller\x013x\controller.c
001b40   071c     DECF      0x1c,0x1,0x1   								--curr_sortedbank;                                                       D:\work\midicontroller\x013x\controller.c
001b42   0e00     MOVLW     0x0                                                                                             
001b44   5b1d     SUBWFB    0x1d,0x1,0x1                                                                                    
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           							/* show the bank name */                                                  D:\work\midicontroller\x013x\controller.c
001b46   0e01     MOVLW     0x1            							sortedbank_activate(1);                                                   D:\work\midicontroller\x013x\controller.c
001b48   6ee6     MOVWF     0xe6,0x0                                                                                        
001b4a   eca0     CALL      0xd40,0x0                                                                                       
001b4c   f006                                                                                                               
001b4e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b50   d014     BRA       0x1b7a         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
                                           							/* CONCERT mode cycles through banks by index #: */                       D:\work\midicontroller\x013x\controller.c
001b52   5118     MOVF      0x18,0x0,0x1   							if (curr_bank == 0) {                                                     D:\work\midicontroller\x013x\controller.c
001b54   1119     IORWF     0x19,0x0,0x1                                                                                    
001b56   e109     BNZ       0x1b6a                                                                                          
001b58   c11e     MOVFF     0x11e,0x118    								curr_bank = bank_count - 1;                                              D:\work\midicontroller\x013x\controller.c
001b5a   f118                                                                                                               
001b5c   c11f     MOVFF     0x11f,0x119                                                                                     
001b5e   f119                                                                                                               
001b60   0e01     MOVLW     0x1                                                                                             
001b62   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001b64   0e00     MOVLW     0x0                                                                                             
001b66   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001b68   d003     BRA       0x1b70         							} else {                                                                  D:\work\midicontroller\x013x\controller.c
001b6a   0718     DECF      0x18,0x1,0x1   								--curr_bank;                                                             D:\work\midicontroller\x013x\controller.c
001b6c   0e00     MOVLW     0x0                                                                                             
001b6e   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
                                           							}                                                                         D:\work\midicontroller\x013x\controller.c
                                           							/* show the bank name */                                                  D:\work\midicontroller\x013x\controller.c
001b70   0e01     MOVLW     0x1            							bank_activate(1);                                                         D:\work\midicontroller\x013x\controller.c
001b72   6ee6     MOVWF     0xe6,0x0                                                                                        
001b74   ec68     CALL      0xcd0,0x0                                                                                       
001b76   f006                                                                                                               
001b78   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
                                           						/* activate the last map for the new bank, but do not display the MIDI program # */ D:\work\midicontroller\x013x\controller.c
001b7a   0101     MOVLB     0x1            						curr_mapindex = bankmap_count - 1;                                         D:\work\midicontroller\x013x\controller.c
001b7c   0510     DECF      0x10,0x0,0x1                                                                                    
001b7e   6f17     MOVWF     0x17,0x1                                                                                        
001b80   6ae6     CLRF      0xe6,0x0       						bankmap_activate(0);                                                       D:\work\midicontroller\x013x\controller.c
001b82   ec4d     CALL      0xc9a,0x0                                                                                       
001b84   f006                                                                                                               
001b86   52e5     MOVF      0xe5,0x1,0x0                                                                                    
001b88   d006     BRA       0x1b96         					} else {                                                                    D:\work\midicontroller\x013x\controller.c
                                           						/* activate the previous map for the new bank, and display the MIDI program # */ D:\work\midicontroller\x013x\controller.c
001b8a   0717     DECF      0x17,0x1,0x1   						--curr_mapindex;                                                           D:\work\midicontroller\x013x\controller.c
001b8c   0e01     MOVLW     0x1            						bankmap_activate(1);                                                       D:\work\midicontroller\x013x\controller.c
001b8e   6ee6     MOVWF     0xe6,0x0                                                                                        
001b90   ec4d     CALL      0xc9a,0x0                                                                                       
001b92   f006                                                                                                               
001b94   52e5     MOVF      0xe5,0x1,0x0                                                                                    
                                           					}                                                                           D:\work\midicontroller\x013x\controller.c
                                           				}                                                                            D:\work\midicontroller\x013x\controller.c
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           			/* acceleration countdown timer hit 0 and we're incrementing slowly */        D:\work\midicontroller\x013x\controller.c
001b96   0101     MOVLB     0x1            			if ((accel_state != ACCEL_NONE) && (accel_time == 0)) {                       D:\work\midicontroller\x013x\controller.c
001b98   5131     MOVF      0x31,0x0,0x1                                                                                    
001b9a   e101     BNZ       0x1b9e                                                                                          
001b9c   d0e4     BRA       0x1d66                                                                                          
001b9e   0101     MOVLB     0x1                                                                                             
001ba0   5120     MOVF      0x20,0x0,0x1                                                                                    
001ba2   1121     IORWF     0x21,0x0,0x1                                                                                    
001ba4   e001     BZ        0x1ba8                                                                                          
001ba6   d0df     BRA       0x1d66                                                                                          
001ba8   0101     MOVLB     0x1            				switch (accel_state) {                                                       D:\work\midicontroller\x013x\controller.c
001baa   5131     MOVF      0x31,0x0,0x1                                                                                    
001bac   0a06     XORLW     0x6                                                                                             
001bae   e101     BNZ       0x1bb2                                                                                          
001bb0   d0c3     BRA       0x1d38                                                                                          
001bb2   0a03     XORLW     0x3                                                                                             
001bb4   e101     BNZ       0x1bb8                                                                                          
001bb6   d09b     BRA       0x1cee                                                                                          
001bb8   0a01     XORLW     0x1                                                                                             
001bba   e074     BZ        0x1ca4                                                                                          
001bbc   0a07     XORLW     0x7                                                                                             
001bbe   e057     BZ        0x1c6e                                                                                          
001bc0   0a01     XORLW     0x1                                                                                             
001bc2   e02c     BZ        0x1c1c                                                                                          
001bc4   0a03     XORLW     0x3                                                                                             
001bc6   e001     BZ        0x1bca                                                                                          
001bc8   d0ce     BRA       0x1d66                                                                                          
                                           					case ACCEL_INC_SLOW:                                                        D:\work\midicontroller\x013x\controller.c
001bca   c11e     MOVFF     0x11e,0x10     						if (curr_bank == bank_count - 1) curr_bank = 0;                            D:\work\midicontroller\x013x\controller.c
001bcc   f010                                                                                                               
001bce   c11f     MOVFF     0x11f,0x11                                                                                      
001bd0   f011                                                                                                               
001bd2   0610     DECF      0x10,0x1,0x0                                                                                    
001bd4   0e00     MOVLW     0x0                                                                                             
001bd6   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001bd8   5010     MOVF      0x10,0x0,0x0                                                                                    
001bda   0101     MOVLB     0x1                                                                                             
001bdc   1918     XORWF     0x18,0x0,0x1                                                                                    
001bde   e102     BNZ       0x1be4                                                                                          
001be0   5011     MOVF      0x11,0x0,0x0                                                                                    
001be2   1919     XORWF     0x19,0x0,0x1                                                                                    
001be4   e103     BNZ       0x1bec                                                                                          
001be6   6b18     CLRF      0x18,0x1                                                                                        
001be8   6b19     CLRF      0x19,0x1                                                                                        
001bea   d003     BRA       0x1bf2         						else ++curr_bank;                                                          D:\work\midicontroller\x013x\controller.c
001bec   2b18     INCF      0x18,0x1,0x1                                                                                    
001bee   0e00     MOVLW     0x0                                                                                             
001bf0   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001bf2   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           D:\work\midicontroller\x013x\controller.c
001bf4   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               D:\work\midicontroller\x013x\controller.c
001bf6   0101     MOVLB     0x1            						if (accel_count++ == 5) {                                                  D:\work\midicontroller\x013x\controller.c
001bf8   5122     MOVF      0x22,0x0,0x1                                                                                    
001bfa   2b22     INCF      0x22,0x1,0x1                                                                                    
001bfc   0805     SUBLW     0x5                                                                                             
001bfe   e109     BNZ       0x1c12                                                                                          
001c00   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          D:\work\midicontroller\x013x\controller.c
001c02   0101     MOVLB     0x1            							accel_state = ACCEL_INC_MEDIUM;                                           D:\work\midicontroller\x013x\controller.c
001c04   0e02     MOVLW     0x2                                                                                             
001c06   6f31     MOVWF     0x31,0x1                                                                                        
001c08   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           D:\work\midicontroller\x013x\controller.c
001c0a   f120                                                                                                               
001c0c   c138     MOVFF     0x138,0x121                                                                                     
001c0e   f121                                                                                                               
001c10   d004     BRA       0x1c1a         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
001c12   c135     MOVFF     0x135,0x120    							accel_time = accel_time_slow;                                             D:\work\midicontroller\x013x\controller.c
001c14   f120                                                                                                               
001c16   c136     MOVFF     0x136,0x121                                                                                     
001c18   f121                                                                                                               
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
001c1a   d0a5     BRA       0x1d66         						break;                                                                     D:\work\midicontroller\x013x\controller.c
                                           					case ACCEL_INC_MEDIUM:                                                      D:\work\midicontroller\x013x\controller.c
001c1c   c11e     MOVFF     0x11e,0x10     						if (curr_bank == bank_count - 1) curr_bank = 0;                            D:\work\midicontroller\x013x\controller.c
001c1e   f010                                                                                                               
001c20   c11f     MOVFF     0x11f,0x11                                                                                      
001c22   f011                                                                                                               
001c24   0610     DECF      0x10,0x1,0x0                                                                                    
001c26   0e00     MOVLW     0x0                                                                                             
001c28   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c2a   5010     MOVF      0x10,0x0,0x0                                                                                    
001c2c   0101     MOVLB     0x1                                                                                             
001c2e   1918     XORWF     0x18,0x0,0x1                                                                                    
001c30   e102     BNZ       0x1c36                                                                                          
001c32   5011     MOVF      0x11,0x0,0x0                                                                                    
001c34   1919     XORWF     0x19,0x0,0x1                                                                                    
001c36   e103     BNZ       0x1c3e                                                                                          
001c38   6b18     CLRF      0x18,0x1                                                                                        
001c3a   6b19     CLRF      0x19,0x1                                                                                        
001c3c   d003     BRA       0x1c44         						else ++curr_bank;                                                          D:\work\midicontroller\x013x\controller.c
001c3e   2b18     INCF      0x18,0x1,0x1                                                                                    
001c40   0e00     MOVLW     0x0                                                                                             
001c42   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001c44   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           D:\work\midicontroller\x013x\controller.c
001c46   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               D:\work\midicontroller\x013x\controller.c
001c48   0101     MOVLB     0x1            						if (accel_count++ == 20) {                                                 D:\work\midicontroller\x013x\controller.c
001c4a   5122     MOVF      0x22,0x0,0x1                                                                                    
001c4c   2b22     INCF      0x22,0x1,0x1                                                                                    
001c4e   0814     SUBLW     0x14                                                                                            
001c50   e109     BNZ       0x1c64                                                                                          
001c52   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          D:\work\midicontroller\x013x\controller.c
001c54   0101     MOVLB     0x1            							accel_state = ACCEL_INC_FAST;                                             D:\work\midicontroller\x013x\controller.c
001c56   0e03     MOVLW     0x3                                                                                             
001c58   6f31     MOVWF     0x31,0x1                                                                                        
001c5a   c139     MOVFF     0x139,0x120    							accel_time = accel_time_fast;                                             D:\work\midicontroller\x013x\controller.c
001c5c   f120                                                                                                               
001c5e   c13a     MOVFF     0x13a,0x121                                                                                     
001c60   f121                                                                                                               
001c62   d004     BRA       0x1c6c         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
001c64   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           D:\work\midicontroller\x013x\controller.c
001c66   f120                                                                                                               
001c68   c138     MOVFF     0x138,0x121                                                                                     
001c6a   f121                                                                                                               
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
001c6c   d07c     BRA       0x1d66         						break;                                                                     D:\work\midicontroller\x013x\controller.c
                                           					case ACCEL_INC_FAST:                                                        D:\work\midicontroller\x013x\controller.c
001c6e   c11e     MOVFF     0x11e,0x10     						if (curr_bank == bank_count - 1) curr_bank = 0;                            D:\work\midicontroller\x013x\controller.c
001c70   f010                                                                                                               
001c72   c11f     MOVFF     0x11f,0x11                                                                                      
001c74   f011                                                                                                               
001c76   0610     DECF      0x10,0x1,0x0                                                                                    
001c78   0e00     MOVLW     0x0                                                                                             
001c7a   5a11     SUBWFB    0x11,0x1,0x0                                                                                    
001c7c   5010     MOVF      0x10,0x0,0x0                                                                                    
001c7e   0101     MOVLB     0x1                                                                                             
001c80   1918     XORWF     0x18,0x0,0x1                                                                                    
001c82   e102     BNZ       0x1c88                                                                                          
001c84   5011     MOVF      0x11,0x0,0x0                                                                                    
001c86   1919     XORWF     0x19,0x0,0x1                                                                                    
001c88   e103     BNZ       0x1c90                                                                                          
001c8a   6b18     CLRF      0x18,0x1                                                                                        
001c8c   6b19     CLRF      0x19,0x1                                                                                        
001c8e   d003     BRA       0x1c96         						else ++curr_bank;                                                          D:\work\midicontroller\x013x\controller.c
001c90   2b18     INCF      0x18,0x1,0x1                                                                                    
001c92   0e00     MOVLW     0x0                                                                                             
001c94   2319     ADDWFC    0x19,0x1,0x1                                                                                    
001c96   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           D:\work\midicontroller\x013x\controller.c
001c98   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
001c9a   c139     MOVFF     0x139,0x120    						accel_time = accel_time_fast;                                              D:\work\midicontroller\x013x\controller.c
001c9c   f120                                                                                                               
001c9e   c13a     MOVFF     0x13a,0x121                                                                                     
001ca0   f121                                                                                                               
001ca2   d061     BRA       0x1d66         						break;                                                                     D:\work\midicontroller\x013x\controller.c
                                           					case ACCEL_DEC_SLOW:                                                        D:\work\midicontroller\x013x\controller.c
001ca4   0101     MOVLB     0x1            						if (curr_bank == 0) curr_bank = bank_count - 1;                            D:\work\midicontroller\x013x\controller.c
001ca6   5118     MOVF      0x18,0x0,0x1                                                                                    
001ca8   1119     IORWF     0x19,0x0,0x1                                                                                    
001caa   e109     BNZ       0x1cbe                                                                                          
001cac   c11e     MOVFF     0x11e,0x118                                                                                     
001cae   f118                                                                                                               
001cb0   c11f     MOVFF     0x11f,0x119                                                                                     
001cb2   f119                                                                                                               
001cb4   0e01     MOVLW     0x1                                                                                             
001cb6   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001cb8   0e00     MOVLW     0x0                                                                                             
001cba   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001cbc   d003     BRA       0x1cc4         						else --curr_bank;                                                          D:\work\midicontroller\x013x\controller.c
001cbe   0718     DECF      0x18,0x1,0x1                                                                                    
001cc0   0e00     MOVLW     0x0                                                                                             
001cc2   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001cc4   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           D:\work\midicontroller\x013x\controller.c
001cc6   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               D:\work\midicontroller\x013x\controller.c
001cc8   0101     MOVLB     0x1            						if (accel_count++ == 5) {                                                  D:\work\midicontroller\x013x\controller.c
001cca   5122     MOVF      0x22,0x0,0x1                                                                                    
001ccc   2b22     INCF      0x22,0x1,0x1                                                                                    
001cce   0805     SUBLW     0x5                                                                                             
001cd0   e109     BNZ       0x1ce4                                                                                          
001cd2   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          D:\work\midicontroller\x013x\controller.c
001cd4   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_MEDIUM;                                           D:\work\midicontroller\x013x\controller.c
001cd6   0e05     MOVLW     0x5                                                                                             
001cd8   6f31     MOVWF     0x31,0x1                                                                                        
001cda   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           D:\work\midicontroller\x013x\controller.c
001cdc   f120                                                                                                               
001cde   c138     MOVFF     0x138,0x121                                                                                     
001ce0   f121                                                                                                               
001ce2   d004     BRA       0x1cec         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
001ce4   c135     MOVFF     0x135,0x120    							accel_time = accel_time_slow;                                             D:\work\midicontroller\x013x\controller.c
001ce6   f120                                                                                                               
001ce8   c136     MOVFF     0x136,0x121                                                                                     
001cea   f121                                                                                                               
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
001cec   d03c     BRA       0x1d66         						break;                                                                     D:\work\midicontroller\x013x\controller.c
                                           					case ACCEL_DEC_MEDIUM:                                                      D:\work\midicontroller\x013x\controller.c
001cee   0101     MOVLB     0x1            						if (curr_bank == 0) curr_bank = bank_count - 1;                            D:\work\midicontroller\x013x\controller.c
001cf0   5118     MOVF      0x18,0x0,0x1                                                                                    
001cf2   1119     IORWF     0x19,0x0,0x1                                                                                    
001cf4   e109     BNZ       0x1d08                                                                                          
001cf6   c11e     MOVFF     0x11e,0x118                                                                                     
001cf8   f118                                                                                                               
001cfa   c11f     MOVFF     0x11f,0x119                                                                                     
001cfc   f119                                                                                                               
001cfe   0e01     MOVLW     0x1                                                                                             
001d00   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001d02   0e00     MOVLW     0x0                                                                                             
001d04   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d06   d003     BRA       0x1d0e         						else --curr_bank;                                                          D:\work\midicontroller\x013x\controller.c
001d08   0718     DECF      0x18,0x1,0x1                                                                                    
001d0a   0e00     MOVLW     0x0                                                                                             
001d0c   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d0e   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           D:\work\midicontroller\x013x\controller.c
001d10   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
                                           						/* if we cycled more than 5 values, ramp up to next speed */               D:\work\midicontroller\x013x\controller.c
001d12   0101     MOVLB     0x1            						if (accel_count++ == 20) {                                                 D:\work\midicontroller\x013x\controller.c
001d14   5122     MOVF      0x22,0x0,0x1                                                                                    
001d16   2b22     INCF      0x22,0x1,0x1                                                                                    
001d18   0814     SUBLW     0x14                                                                                            
001d1a   e109     BNZ       0x1d2e                                                                                          
001d1c   6b22     CLRF      0x22,0x1       							accel_count = 0;                                                          D:\work\midicontroller\x013x\controller.c
001d1e   0101     MOVLB     0x1            							accel_state = ACCEL_DEC_FAST;                                             D:\work\midicontroller\x013x\controller.c
001d20   0e06     MOVLW     0x6                                                                                             
001d22   6f31     MOVWF     0x31,0x1                                                                                        
001d24   c139     MOVFF     0x139,0x120    							accel_time = accel_time_fast;                                             D:\work\midicontroller\x013x\controller.c
001d26   f120                                                                                                               
001d28   c13a     MOVFF     0x13a,0x121                                                                                     
001d2a   f121                                                                                                               
001d2c   d004     BRA       0x1d36         						} else {                                                                   D:\work\midicontroller\x013x\controller.c
001d2e   c137     MOVFF     0x137,0x120    							accel_time = accel_time_medium;                                           D:\work\midicontroller\x013x\controller.c
001d30   f120                                                                                                               
001d32   c138     MOVFF     0x138,0x121                                                                                     
001d34   f121                                                                                                               
                                           						}                                                                          D:\work\midicontroller\x013x\controller.c
001d36   d017     BRA       0x1d66         						break;                                                                     D:\work\midicontroller\x013x\controller.c
                                           					case ACCEL_DEC_FAST:                                                        D:\work\midicontroller\x013x\controller.c
001d38   0101     MOVLB     0x1            						if (curr_bank == 0) curr_bank = bank_count - 1;                            D:\work\midicontroller\x013x\controller.c
001d3a   5118     MOVF      0x18,0x0,0x1                                                                                    
001d3c   1119     IORWF     0x19,0x0,0x1                                                                                    
001d3e   e109     BNZ       0x1d52                                                                                          
001d40   c11e     MOVFF     0x11e,0x118                                                                                     
001d42   f118                                                                                                               
001d44   c11f     MOVFF     0x11f,0x119                                                                                     
001d46   f119                                                                                                               
001d48   0e01     MOVLW     0x1                                                                                             
001d4a   5f18     SUBWF     0x18,0x1,0x1                                                                                    
001d4c   0e00     MOVLW     0x0                                                                                             
001d4e   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d50   d003     BRA       0x1d58         						else --curr_bank;                                                          D:\work\midicontroller\x013x\controller.c
001d52   0718     DECF      0x18,0x1,0x1                                                                                    
001d54   0e00     MOVLW     0x0                                                                                             
001d56   5b19     SUBWFB    0x19,0x1,0x1                                                                                    
001d58   ecb9     CALL      0xd72,0x0      						bank_showname();                                                           D:\work\midicontroller\x013x\controller.c
001d5a   f006                                                                                                               
                                                                                                                            D:\work\midicontroller\x013x\controller.c
001d5c   c139     MOVFF     0x139,0x120    						accel_time = accel_time_fast;                                              D:\work\midicontroller\x013x\controller.c
001d5e   f120                                                                                                               
001d60   c13a     MOVFF     0x13a,0x121                                                                                     
001d62   f121                                                                                                               
001d64   d000     BRA       0x1d66         						break;                                                                     D:\work\midicontroller\x013x\controller.c
                                           				}                                                                            D:\work\midicontroller\x013x\controller.c
                                           			}                                                                             D:\work\midicontroller\x013x\controller.c
001d66   d000     BRA       0x1d68         			break;                                                                        D:\work\midicontroller\x013x\controller.c
                                           	}                                                                               D:\work\midicontroller\x013x\controller.c
001d68   c13d     MOVFF     0x13d,0x13f    	sw_last = sw_curr;                                                              D:\work\midicontroller\x013x\controller.c
001d6a   f13f                                                                                                               
001d6c   c13e     MOVFF     0x13e,0x140                                                                                     
001d6e   f140                                                                                                               
001d70   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\controller.c
                                           ;###########################################################################     D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;#			Author: Joe Dunne											  #                                             D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;#			Date 4/06/07					      						  #                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;#			This file handles writing to the FLASH  (ROM).				  #                       D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;#			File Name: writeprogmem.asm   										  #                                 D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;#														 				  #                                                         D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;############################################################################    D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           	INCLUDE "p18F4455.inc"                                                          D:\work\midicontroller\x013x\writeprogmem.asm
                                                   LIST                                                                     D:\work\midicontroller\x013x\p18F4455.inc
                                                                                                                            D:\work\midicontroller\x013x\p18F4455.inc
                                           ;==========================================================================      D:\work\midicontroller\x013x\p18F4455.inc
                                           ;  $Id: P18F4455.INC,v 1.9 2006/10/25 17:47:56 nairnj Exp $                      D:\work\midicontroller\x013x\p18F4455.inc
                                           ;  MPASM PIC18F4455 processor include                                            D:\work\midicontroller\x013x\p18F4455.inc
                                           ;                                                                                D:\work\midicontroller\x013x\p18F4455.inc
                                           ;  (c) Copyright 1999-2006 Microchip Technology, All rights reserved             D:\work\midicontroller\x013x\p18F4455.inc
                                           ;==========================================================================      D:\work\midicontroller\x013x\p18F4455.inc
                                                                                                                            D:\work\midicontroller\x013x\p18F4455.inc
                                                   LIST                                                                     D:\work\midicontroller\x013x\p18F4455.inc
                                           	LIST R=DEC                                                                      D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           	extern	WpmCounter, WpmCounter1                                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           	global	READ_BLOCK_FROM_ROM, WRITE_BLOCK_INTO_ROM                                D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           	code                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;void	Read64BytesFromRom(                                                        D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;;READ_BLOCK_FROM_ROM                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;Before calling, set FSR0 = address of RAM buffer                                D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;Also, set TLPTR = address of ROM to read into RAM.                              D:\work\midicontroller\x013x\writeprogmem.asm
                                           READ_BLOCK_FROM_ROM                                                              D:\work\midicontroller\x013x\writeprogmem.asm
003592   0100     MOVLB     0x0            	movlb	high(WpmCounter)	;set appropriate bank.                                   D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
003594   0e40     MOVLW     0x40           	MOVLW	64			; number of bytes in erase block                                     D:\work\midicontroller\x013x\writeprogmem.asm
003596   6fb9     MOVWF     0xb9,0x1       	MOVWF	WpmCounter                                                                D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW BUFFER_ADDR_HIGH 		; point to buffer                                     D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF FSR0H                                                                    D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW BUFFER_ADDR_LOW                                                          D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF FSR0L                                                                    D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_UPPER		; Load TBLPTR with the base                             D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF TBLPTRU			; address of the memory block                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_HIGH                                                           D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF TBLPTRH                                                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_LOW                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF TBLPTRL                                                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           READ_BLOCK                                                                       D:\work\midicontroller\x013x\writeprogmem.asm
003598   0009     TBLRDPOSTINC             	TBLRD*+				; read into TABLAT, and inc                                          D:\work\midicontroller\x013x\writeprogmem.asm
00359a   50f5     MOVF      0xf5,0x0,0x0   	MOVF	TABLAT, W		; get data                                                      D:\work\midicontroller\x013x\writeprogmem.asm
00359c   6eee     MOVWF     0xee,0x0       	MOVWF	POSTINC0		; store data                                                    D:\work\midicontroller\x013x\writeprogmem.asm
00359e   2fb9     DECFSZ    0xb9,0x1,0x1   	DECFSZ	WpmCounter			; done?                                                     D:\work\midicontroller\x013x\writeprogmem.asm
0035a0   d7fb     BRA       0x3598         	BRA	READ_BLOCK		; repeat                                                        D:\work\midicontroller\x013x\writeprogmem.asm
0035a2   0012     RETURN    0x0            	return                                                                          D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;;WRITE_BLOCK_INTO_ROM                                                           D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;Before calling, set FSR0 = address of RAM buffer                                D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;Also, set TBLPTR = address of ROM to write to  (must be on 64 byte boundary).   D:\work\midicontroller\x013x\writeprogmem.asm
                                           WRITE_BLOCK_INTO_ROM                                                             D:\work\midicontroller\x013x\writeprogmem.asm
0035a4   0100     MOVLB     0x0            	movlb	high(WpmCounter)	;set appropriate bank.                                   D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_UPPER 	                                                        D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF TBLPTRU                                                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_HIGH                                                           D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF TBLPTRH                                                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW CODE_ADDR_LOW                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF TBLPTRL                                                                  D:\work\midicontroller\x013x\writeprogmem.asm
0035a6   8ea6     BSF       0xa6,0x7,0x0   	BSF	EECON1, EEPGD		; point to Flash program memory                              D:\work\midicontroller\x013x\writeprogmem.asm
0035a8   9ca6     BCF       0xa6,0x6,0x0   	BCF	EECON1, CFGS		; access Flash program memory                                 D:\work\midicontroller\x013x\writeprogmem.asm
0035aa   84a6     BSF       0xa6,0x2,0x0   	BSF	EECON1, WREN		; enable write to memory                                      D:\work\midicontroller\x013x\writeprogmem.asm
0035ac   88a6     BSF       0xa6,0x4,0x0   	BSF	EECON1, FREE		; enable Row Erase operation                                  D:\work\midicontroller\x013x\writeprogmem.asm
0035ae   9ef2     BCF       0xf2,0x7,0x0   	BCF	INTCON, GIE 		; disable interrupts                                          D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;perform erase opration:                                                         D:\work\midicontroller\x013x\writeprogmem.asm
0035b0   0e55     MOVLW     0x55           	MOVLW	55h                                                                       D:\work\midicontroller\x013x\writeprogmem.asm
0035b2   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 55h                                                      D:\work\midicontroller\x013x\writeprogmem.asm
0035b4   0eaa     MOVLW     0xaa           	MOVLW	0AAh                                                                      D:\work\midicontroller\x013x\writeprogmem.asm
0035b6   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 0AAh                                                     D:\work\midicontroller\x013x\writeprogmem.asm
0035b8   82a6     BSF       0xa6,0x1,0x0   	BSF	EECON1, WR		; start erase (CPU stall)                                       D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
0035ba   8ef2     BSF       0xf2,0x7,0x0   	BSF	INTCON, GIE 		; re-enable interrupts                                        D:\work\midicontroller\x013x\writeprogmem.asm
0035bc   000a     TBLRDPOSTDEC             	TBLRD*- 			; dummy read decrement                                               D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW	BUFFER_ADDR_HIGH	; point to buffer                                       D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF	FSR0H                                                                    D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVLW	BUFFER_ADDR_LOW                                                          D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;	MOVWF	FSR0L                                                                    D:\work\midicontroller\x013x\writeprogmem.asm
0035be   0e02     MOVLW     0x2            	MOVLW	2                                                                         D:\work\midicontroller\x013x\writeprogmem.asm
0035c0   6fba     MOVWF     0xba,0x1       	MOVWF	WpmCounter1                                                               D:\work\midicontroller\x013x\writeprogmem.asm
                                           WRITE_BUFFER_BACK                                                                D:\work\midicontroller\x013x\writeprogmem.asm
0035c2   0e20     MOVLW     0x20           	MOVLW	32	 		; number of bytes in holding register                               D:\work\midicontroller\x013x\writeprogmem.asm
0035c4   6fb9     MOVWF     0xb9,0x1       	MOVWF	WpmCounter                                                                D:\work\midicontroller\x013x\writeprogmem.asm
                                           WRITE_BYTE_TO_HREGS                                                              D:\work\midicontroller\x013x\writeprogmem.asm
0035c6   50ee     MOVF      0xee,0x0,0x0   	MOVF	POSTINC0, W 		; get low byte of buffer data                                D:\work\midicontroller\x013x\writeprogmem.asm
0035c8   6ef5     MOVWF     0xf5,0x0       	MOVWF	TABLAT 			; present data to table latch                                   D:\work\midicontroller\x013x\writeprogmem.asm
0035ca   000f     TBLWTPREINC              	TBLWT+* 			; write data, perform a short write                                  D:\work\midicontroller\x013x\writeprogmem.asm
                                           					; to internal TBLWT holding register.                                       D:\work\midicontroller\x013x\writeprogmem.asm
0035cc   2fb9     DECFSZ    0xb9,0x1,0x1   	DECFSZ	WpmCounter 		; loop until buffers are full                               D:\work\midicontroller\x013x\writeprogmem.asm
0035ce   d7fb     BRA       0x35c6         	BRA	WRITE_BYTE_TO_HREGS                                                         D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           PROGRAM_MEMORY                                                                   D:\work\midicontroller\x013x\writeprogmem.asm
0035d0   8ea6     BSF       0xa6,0x7,0x0   	BSF	EECON1, EEPGD		; point to Flash program memory                              D:\work\midicontroller\x013x\writeprogmem.asm
0035d2   9ca6     BCF       0xa6,0x6,0x0   	BCF	EECON1, CFGS		; access Flash program memory                                 D:\work\midicontroller\x013x\writeprogmem.asm
0035d4   84a6     BSF       0xa6,0x2,0x0   	BSF	EECON1, WREN		; enable write to memory                                      D:\work\midicontroller\x013x\writeprogmem.asm
0035d6   9ef2     BCF       0xf2,0x7,0x0   	BCF	INTCON, GIE		; disable interrupts                                           D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           ;Write to program memmory:                                                       D:\work\midicontroller\x013x\writeprogmem.asm
0035d8   0e55     MOVLW     0x55           	MOVLW	55h                                                                       D:\work\midicontroller\x013x\writeprogmem.asm
0035da   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 55h                                                      D:\work\midicontroller\x013x\writeprogmem.asm
0035dc   0eaa     MOVLW     0xaa           	MOVLW	0AAh                                                                      D:\work\midicontroller\x013x\writeprogmem.asm
0035de   6ea7     MOVWF     0xa7,0x0       	MOVWF	EECON2			; write 0AAh                                                     D:\work\midicontroller\x013x\writeprogmem.asm
0035e0   82a6     BSF       0xa6,0x1,0x0   	BSF	EECON1, WR		; start program (CPU stall)                                     D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
0035e2   2fba     DECFSZ    0xba,0x1,0x1   	DECFSZ	WpmCounter1                                                              D:\work\midicontroller\x013x\writeprogmem.asm
0035e4   d7ee     BRA       0x35c2         	BRA	WRITE_BUFFER_BACK                                                           D:\work\midicontroller\x013x\writeprogmem.asm
0035e6   8ef2     BSF       0xf2,0x7,0x0   	BSF	INTCON, GIE		; re-enable interrupts                                         D:\work\midicontroller\x013x\writeprogmem.asm
0035e8   94a6     BCF       0xa6,0x2,0x0   	BCF	EECON1, WREN		; disable write to memory                                     D:\work\midicontroller\x013x\writeprogmem.asm
0035ea   0012     RETURN    0x0            	return                                                                          D:\work\midicontroller\x013x\writeprogmem.asm
                                                                                                                            D:\work\midicontroller\x013x\writeprogmem.asm
                                           	END                                                                             D:\work\midicontroller\x013x\writeprogmem.asm
                                           //*;###########################################################################  D:\work\midicontroller\x013x\vectors.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\vectors.c
                                           //;#			Date 4/06/07					      						  #                                          D:\work\midicontroller\x013x\vectors.c
                                           //;#			vectors									  			  #                                                  D:\work\midicontroller\x013x\vectors.c
                                           //;#			File Name: vectors.c   										  #                                      D:\work\midicontroller\x013x\vectors.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\vectors.c
                                           //;############################################################################  D:\work\midicontroller\x013x\vectors.c
                                                                                                                            D:\work\midicontroller\x013x\vectors.c
                                                                                                                            D:\work\midicontroller\x013x\vectors.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\vectors.c
                                                                                                                            D:\work\midicontroller\x013x\vectors.c
                                           void main(void);                                                                 D:\work\midicontroller\x013x\vectors.c
                                                                                                                            D:\work\midicontroller\x013x\vectors.c
                                           #pragma code RealInitVector = 0x00                                               D:\work\midicontroller\x013x\vectors.c
                                           void                                                                             D:\work\midicontroller\x013x\vectors.c
                                           RealInitVector (void)                                                            D:\work\midicontroller\x013x\vectors.c
                                           {                                                                                D:\work\midicontroller\x013x\vectors.c
                                             _asm                                                                           D:\work\midicontroller\x013x\vectors.c
000000   ef15     GOTO      0xa2a          	goto main //jump to interrupt routine                                           D:\work\midicontroller\x013x\vectors.c
000002   f005                                                                                                               
                                             _endasm                                                                        D:\work\midicontroller\x013x\vectors.c
000004   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\vectors.c
                                                                                                                            D:\work\midicontroller\x013x\vectors.c
                                           #pragma code RealInterruptVectorHigh = 0x08                                      D:\work\midicontroller\x013x\vectors.c
                                           void                                                                             D:\work\midicontroller\x013x\vectors.c
                                           RealInterruptVectorHigh (void)                                                   D:\work\midicontroller\x013x\vectors.c
                                           {                                                                                D:\work\midicontroller\x013x\vectors.c
                                             _asm                                                                           D:\work\midicontroller\x013x\vectors.c
000008   ef55     GOTO      0x36aa         	goto InterruptHandlerHigh //jump to interrupt routine                           D:\work\midicontroller\x013x\vectors.c
00000a   f01b                                                                                                               
                                             _endasm                                                                        D:\work\midicontroller\x013x\vectors.c
00000c   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\vectors.c
                                                                                                                            D:\work\midicontroller\x013x\vectors.c
                                           //*;###########################################################################  D:\work\midicontroller\x013x\eeprom.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\eeprom.c
                                           //;#			Date 4/06/07					      						  #                                          D:\work\midicontroller\x013x\eeprom.c
                                           //;#			EEProm access functions							  			  #                                    D:\work\midicontroller\x013x\eeprom.c
                                           //;#			File Name: eeprom.c   										  #                                       D:\work\midicontroller\x013x\eeprom.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\eeprom.c
                                           //;############################################################################  D:\work\midicontroller\x013x\eeprom.c
                                                                                                                            D:\work\midicontroller\x013x\eeprom.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\eeprom.c
                                                                                                                            D:\work\midicontroller\x013x\eeprom.c
003652   cfd9     MOVFF     0xfd9,0xfe6    unsigned char EERead(unsigned char addr) {                                       D:\work\midicontroller\x013x\eeprom.c
003654   ffe6                                                                                                               
003656   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003658   ffd9                                                                                                               
00365a   0efe     MOVLW     0xfe           	EEADR=(unsigned char)addr;	// Address to read                                   D:\work\midicontroller\x013x\eeprom.c
00365c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00365e   6ea9     MOVWF     0xa9,0x0                                                                                        
003660   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   D:\work\midicontroller\x013x\eeprom.c
003662   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           D:\work\midicontroller\x013x\eeprom.c
003664   80a6     BSF       0xa6,0x0,0x0   	EECON1bits.RD=1;			// EE Read                                                   D:\work\midicontroller\x013x\eeprom.c
003666   50a8     MOVF      0xa8,0x0,0x0   	return EEDATA;				// W = EEDATA                                                 D:\work\midicontroller\x013x\eeprom.c
003668   d000     BRA       0x366a                                                                                          
00366a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\eeprom.c
00366c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
00366e   ffd9                                                                                                               
003670   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\eeprom.c
                                           //blocking write that takes approximately 4mS ??                                 D:\work\midicontroller\x013x\eeprom.c
003672   cfd9     MOVFF     0xfd9,0xfe6    void EEWrite(unsigned char addr,unsigned char data) {                            D:\work\midicontroller\x013x\eeprom.c
003674   ffe6                                                                                                               
003676   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
003678   ffd9                                                                                                               
00367a   0efe     MOVLW     0xfe           	EEADR = (unsigned char)addr;                                                    D:\work\midicontroller\x013x\eeprom.c
00367c   50db     MOVF      0xdb,0x0,0x0                                                                                    
00367e   6ea9     MOVWF     0xa9,0x0                                                                                        
003680   0efd     MOVLW     0xfd           	EEDATA=data;                                                                    D:\work\midicontroller\x013x\eeprom.c
003682   50db     MOVF      0xdb,0x0,0x0                                                                                    
003684   6ea8     MOVWF     0xa8,0x0                                                                                        
                                           	                                                                                D:\work\midicontroller\x013x\eeprom.c
003686   9ea6     BCF       0xa6,0x7,0x0   	EECON1bits.EEPGD=0;			// Point to Data Memory                                   D:\work\midicontroller\x013x\eeprom.c
003688   9ca6     BCF       0xa6,0x6,0x0   	EECON1bits.CFGS=0;			// Access EEPROM                                           D:\work\midicontroller\x013x\eeprom.c
00368a   84a6     BSF       0xa6,0x2,0x0   	EECON1bits.WREN=1;                                                              D:\work\midicontroller\x013x\eeprom.c
                                                                                                                            D:\work\midicontroller\x013x\eeprom.c
00368c   9ef2     BCF       0xf2,0x7,0x0   	INTCONbits.GIE = 0;			// Disable global interrupts                              D:\work\midicontroller\x013x\eeprom.c
00368e   0e55     MOVLW     0x55           	EECON2=0x55;				// Required                                                     D:\work\midicontroller\x013x\eeprom.c
003690   6ea7     MOVWF     0xa7,0x0                                                                                        
003692   0eaa     MOVLW     0xaa           	EECON2=0xAA;				// Required                                                     D:\work\midicontroller\x013x\eeprom.c
003694   6ea7     MOVWF     0xa7,0x0                                                                                        
003696   82a6     BSF       0xa6,0x1,0x0   	EECON1bits.WR=1;			// Enable writes                                             D:\work\midicontroller\x013x\eeprom.c
                                           	do {                                                                            D:\work\midicontroller\x013x\eeprom.c
003698   0004     CLRWDT                   		ClrWdt();                                                                      D:\work\midicontroller\x013x\eeprom.c
00369a   b2a6     BTFSC     0xa6,0x1,0x0   	} while(EECON1bits.WR);		// block until write complete                          D:\work\midicontroller\x013x\eeprom.c
00369c   d7fd     BRA       0x3698                                                                                          
                                                                                                                            D:\work\midicontroller\x013x\eeprom.c
00369e   8ef2     BSF       0xf2,0x7,0x0   	INTCONbits.GIE = 1;			// Enable global interrupts                               D:\work\midicontroller\x013x\eeprom.c
0036a0   94a6     BCF       0xa6,0x2,0x0   	EECON1bits.WREN=0;			// Disable writes                                          D:\work\midicontroller\x013x\eeprom.c
0036a2   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\eeprom.c
0036a4   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
0036a6   ffd9                                                                                                               
0036a8   0012     RETURN    0x0                                                                                             
                                           //*;###########################################################################  D:\work\midicontroller\x013x\leds.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\leds.c
                                           //;#			Date 4/06/07					      						  #                                          D:\work\midicontroller\x013x\leds.c
                                           //;#			Main arbitrator									  			  #                                          D:\work\midicontroller\x013x\leds.c
                                           //;#			File Name: main.c   										  #                                         D:\work\midicontroller\x013x\leds.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\leds.c
                                           //;############################################################################  D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\leds.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\leds.c
                                           #include "hardware.h"                                                            D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           void	ProcessLeds(void) {                                                         D:\work\midicontroller\x013x\leds.c
                                           	static unsigned char ComPointer;                                                D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002bea   d834     RCALL     0x2c54         	AllDigitsOff();                                                                 D:\work\midicontroller\x013x\leds.c
002bec   0100     MOVLB     0x0            	switch (ComPointer) {                                                           D:\work\midicontroller\x013x\leds.c
002bee   51fb     MOVF      0xfb,0x0,0x1                                                                                    
002bf0   0a04     XORLW     0x4                                                                                             
002bf2   e021     BZ        0x2c36                                                                                          
002bf4   0a07     XORLW     0x7                                                                                             
002bf6   e019     BZ        0x2c2a                                                                                          
002bf8   0a01     XORLW     0x1                                                                                             
002bfa   e011     BZ        0x2c1e                                                                                          
002bfc   0a03     XORLW     0x3                                                                                             
002bfe   e009     BZ        0x2c12                                                                                          
002c00   0a01     XORLW     0x1                                                                                             
002c02   e001     BZ        0x2c06                                                                                          
                                           		case 0:                                                                        D:\work\midicontroller\x013x\leds.c
002c06   9a8a     BCF       0x8a,0x5,0x0   			DISP_COM0_LAT_BIT = false;                                                    D:\work\midicontroller\x013x\leds.c
002c08   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      D:\work\midicontroller\x013x\leds.c
002c0a   ffe6                                                                                                               
002c0c   d831     RCALL     0x2c70                                                                                          
002c0e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c10   d018     BRA       0x2c42         			break;                                                                        D:\work\midicontroller\x013x\leds.c
                                           		case 1:                                                                        D:\work\midicontroller\x013x\leds.c
002c12   908b     BCF       0x8b,0x0,0x0   			DISP_COM1_LAT_BIT = false;                                                    D:\work\midicontroller\x013x\leds.c
002c14   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      D:\work\midicontroller\x013x\leds.c
002c16   ffe6                                                                                                               
002c18   d82b     RCALL     0x2c70                                                                                          
002c1a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c1c   d012     BRA       0x2c42         			break;                                                                        D:\work\midicontroller\x013x\leds.c
                                           		case 2:                                                                        D:\work\midicontroller\x013x\leds.c
002c1e   968a     BCF       0x8a,0x3,0x0   			DISP_COM2_LAT_BIT = false;                                                    D:\work\midicontroller\x013x\leds.c
002c20   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      D:\work\midicontroller\x013x\leds.c
002c22   ffe6                                                                                                               
002c24   d825     RCALL     0x2c70                                                                                          
002c26   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c28   d00c     BRA       0x2c42         			break;                                                                        D:\work\midicontroller\x013x\leds.c
                                           		case 3:                                                                        D:\work\midicontroller\x013x\leds.c
002c2a   948a     BCF       0x8a,0x2,0x0   			DISP_COM3_LAT_BIT = false;                                                    D:\work\midicontroller\x013x\leds.c
002c2c   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      D:\work\midicontroller\x013x\leds.c
002c2e   ffe6                                                                                                               
002c30   d81f     RCALL     0x2c70                                                                                          
002c32   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c34   d006     BRA       0x2c42         			break;                                                                        D:\work\midicontroller\x013x\leds.c
                                           		case 4:                                                                        D:\work\midicontroller\x013x\leds.c
002c36   928a     BCF       0x8a,0x1,0x0   			DISP_COM4_LAT_BIT = false;                                                    D:\work\midicontroller\x013x\leds.c
002c38   c0fb     MOVFF     0xfb,0xfe6     			HandleDigit(ComPointer);                                                      D:\work\midicontroller\x013x\leds.c
002c3a   ffe6                                                                                                               
002c3c   d819     RCALL     0x2c70                                                                                          
002c3e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002c40   d000     BRA       0x2c42         			break;                                                                        D:\work\midicontroller\x013x\leds.c
                                           		default:                                                                       D:\work\midicontroller\x013x\leds.c
                                           			//do nothing                                                                  D:\work\midicontroller\x013x\leds.c
002c04   d01e     BRA       0x2c42         			break;                                                                        D:\work\midicontroller\x013x\leds.c
                                           	}                                                                               D:\work\midicontroller\x013x\leds.c
002c42   0100     MOVLB     0x0            	if (++ComPointer >= DispNumOfCommons) ComPointer = 0;                           D:\work\midicontroller\x013x\leds.c
002c44   2bfb     INCF      0xfb,0x1,0x1                                                                                    
002c46   0100     MOVLB     0x0                                                                                             
002c48   5167     MOVF      0x67,0x0,0x1                                                                                    
002c4a   0100     MOVLB     0x0                                                                                             
002c4c   5dfb     SUBWF     0xfb,0x0,0x1                                                                                    
002c4e   e301     BNC       0x2c52                                                                                          
002c50   6bfb     CLRF      0xfb,0x1                                                                                        
002c52   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           void	AllDigitsOff(void) {                                                        D:\work\midicontroller\x013x\leds.c
002c54   908a     BCF       0x8a,0x0,0x0   	DISP_SEG0_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c56   9e8c     BCF       0x8c,0x7,0x0   	DISP_SEG1_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c58   9c8c     BCF       0x8c,0x6,0x0   	DISP_SEG2_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c5a   9a8c     BCF       0x8c,0x5,0x0   	DISP_SEG3_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c5c   988c     BCF       0x8c,0x4,0x0   	DISP_SEG4_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c5e   948b     BCF       0x8b,0x2,0x0   	DISP_SEG5_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c60   968c     BCF       0x8c,0x3,0x0   	DISP_SEG6_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
002c62   948c     BCF       0x8c,0x2,0x0   	DISP_SEG7_LAT_BIT = false;                                                      D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002c64   8a8a     BSF       0x8a,0x5,0x0   	DISP_COM0_LAT_BIT = true;                                                       D:\work\midicontroller\x013x\leds.c
002c66   808b     BSF       0x8b,0x0,0x0   	DISP_COM1_LAT_BIT = true;                                                       D:\work\midicontroller\x013x\leds.c
002c68   868a     BSF       0x8a,0x3,0x0   	DISP_COM2_LAT_BIT = true;                                                       D:\work\midicontroller\x013x\leds.c
002c6a   848a     BSF       0x8a,0x2,0x0   	DISP_COM3_LAT_BIT = true;                                                       D:\work\midicontroller\x013x\leds.c
002c6c   828a     BSF       0x8a,0x1,0x0   	DISP_COM4_LAT_BIT = true;                                                       D:\work\midicontroller\x013x\leds.c
002c6e   0012     RETURN    0x0            }                                                                                D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002c70   cfd9     MOVFF     0xfd9,0xfe6    void	HandleDigit(unsigned char ComPointer) {                                     D:\work\midicontroller\x013x\leds.c
002c72   ffe6                                                                                                               
002c74   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002c76   ffd9                                                                                                               
002c78   52e6     MOVF      0xe6,0x1,0x0                                                                                    
                                           	BitField x;                                                                     D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002c7a   0efe     MOVLW     0xfe           	x.byte = DispSegData[ComPointer].byte;                                          D:\work\midicontroller\x013x\leds.c
002c7c   50db     MOVF      0xdb,0x0,0x0                                                                                    
002c7e   6aea     CLRF      0xea,0x0                                                                                        
002c80   0f62     ADDLW     0x62                                                                                            
002c82   6ee9     MOVWF     0xe9,0x0                                                                                        
002c84   0e00     MOVLW     0x0                                                                                             
002c86   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002c88   cfef     MOVFF     0xfef,0xfdf                                                                                     
002c8a   ffdf                                                                                                               
002c8c   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit0) DISP_SEG0_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002c8e   ffe9                                                                                                               
002c90   cfda     MOVFF     0xfda,0xfea                                                                                     
002c92   ffea                                                                                                               
002c94   50ef     MOVF      0xef,0x0,0x0                                                                                    
002c96   0b01     ANDLW     0x1                                                                                             
002c98   e001     BZ        0x2c9c                                                                                          
002c9a   808a     BSF       0x8a,0x0,0x0                                                                                    
002c9c   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit1) DISP_SEG1_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002c9e   ffe9                                                                                                               
002ca0   cfda     MOVFF     0xfda,0xfea                                                                                     
002ca2   ffea                                                                                                               
002ca4   50ef     MOVF      0xef,0x0,0x0                                                                                    
002ca6   0b02     ANDLW     0x2                                                                                             
002ca8   e001     BZ        0x2cac                                                                                          
002caa   8e8c     BSF       0x8c,0x7,0x0                                                                                    
002cac   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit2) DISP_SEG2_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002cae   ffe9                                                                                                               
002cb0   cfda     MOVFF     0xfda,0xfea                                                                                     
002cb2   ffea                                                                                                               
002cb4   50ef     MOVF      0xef,0x0,0x0                                                                                    
002cb6   0b04     ANDLW     0x4                                                                                             
002cb8   e001     BZ        0x2cbc                                                                                          
002cba   8c8c     BSF       0x8c,0x6,0x0                                                                                    
002cbc   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit3) DISP_SEG3_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002cbe   ffe9                                                                                                               
002cc0   cfda     MOVFF     0xfda,0xfea                                                                                     
002cc2   ffea                                                                                                               
002cc4   50ef     MOVF      0xef,0x0,0x0                                                                                    
002cc6   0b08     ANDLW     0x8                                                                                             
002cc8   e001     BZ        0x2ccc                                                                                          
002cca   8a8c     BSF       0x8c,0x5,0x0                                                                                    
002ccc   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit4) DISP_SEG4_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002cce   ffe9                                                                                                               
002cd0   cfda     MOVFF     0xfda,0xfea                                                                                     
002cd2   ffea                                                                                                               
002cd4   50ef     MOVF      0xef,0x0,0x0                                                                                    
002cd6   0b10     ANDLW     0x10                                                                                            
002cd8   e001     BZ        0x2cdc                                                                                          
002cda   888c     BSF       0x8c,0x4,0x0                                                                                    
002cdc   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit5) DISP_SEG5_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002cde   ffe9                                                                                                               
002ce0   cfda     MOVFF     0xfda,0xfea                                                                                     
002ce2   ffea                                                                                                               
002ce4   50ef     MOVF      0xef,0x0,0x0                                                                                    
002ce6   0b20     ANDLW     0x20                                                                                            
002ce8   e001     BZ        0x2cec                                                                                          
002cea   848b     BSF       0x8b,0x2,0x0                                                                                    
002cec   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit6) DISP_SEG6_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002cee   ffe9                                                                                                               
002cf0   cfda     MOVFF     0xfda,0xfea                                                                                     
002cf2   ffea                                                                                                               
002cf4   50ef     MOVF      0xef,0x0,0x0                                                                                    
002cf6   0b40     ANDLW     0x40                                                                                            
002cf8   e001     BZ        0x2cfc                                                                                          
002cfa   868c     BSF       0x8c,0x3,0x0                                                                                    
002cfc   cfd9     MOVFF     0xfd9,0xfe9    	if (x.bit7) DISP_SEG7_LAT_BIT = true;                                           D:\work\midicontroller\x013x\leds.c
002cfe   ffe9                                                                                                               
002d00   cfda     MOVFF     0xfda,0xfea                                                                                     
002d02   ffea                                                                                                               
002d04   50ef     MOVF      0xef,0x0,0x0                                                                                    
002d06   0b80     ANDLW     0x80                                                                                            
002d08   e001     BZ        0x2d0c                                                                                          
002d0a   848c     BSF       0x8c,0x2,0x0                                                                                    
002d0c   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\leds.c
002d0e   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d10   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002d12   ffd9                                                                                                               
002d14   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002d16   cfd9     MOVFF     0xfd9,0xfe6    void	SetDispAscii(unsigned char chars[]) {                                       D:\work\midicontroller\x013x\leds.c
002d18   ffe6                                                                                                               
002d1a   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002d1c   ffd9                                                                                                               
002d1e   0e02     MOVLW     0x2                                                                                             
002d20   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002d22   0e01     MOVLW     0x1            	for (i = 0;i<5;i++) {                                                           D:\work\midicontroller\x013x\leds.c
002d24   6adb     CLRF      0xdb,0x0                                                                                        
002d26   0e05     MOVLW     0x5                                                                                             
002d28   6ef3     MOVWF     0xf3,0x0                                                                                        
002d2a   0e01     MOVLW     0x1                                                                                             
002d2c   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002d2e   fff4                                                                                                               
002d30   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002d32   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002d34   e221     BC        0x2d78                                                                                          
002d72   0e01     MOVLW     0x1                                                                                             
002d74   2adb     INCF      0xdb,0x1,0x0                                                                                    
002d76   d7d7     BRA       0x2d26                                                                                          
002d36   0e01     MOVLW     0x1            		x = chars[i];                                                                  D:\work\midicontroller\x013x\leds.c
002d38   50db     MOVF      0xdb,0x0,0x0                                                                                    
002d3a   6ee7     MOVWF     0xe7,0x0                                                                                        
002d3c   0efd     MOVLW     0xfd                                                                                            
002d3e   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002d40   ffe9                                                                                                               
002d42   0efe     MOVLW     0xfe                                                                                            
002d44   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002d46   ffea                                                                                                               
002d48   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002d4a   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002d4c   0e00     MOVLW     0x0                                                                                             
002d4e   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002d50   cfef     MOVFF     0xfef,0xfdf                                                                                     
002d52   ffdf                                                                                                               
002d54   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          D:\work\midicontroller\x013x\leds.c
002d56   ffe6                                                                                                               
002d58   d864     RCALL     0x2e22                                                                                          
002d5a   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d5c   6ee6     MOVWF     0xe6,0x0                                                                                        
002d5e   0e01     MOVLW     0x1                                                                                             
002d60   50db     MOVF      0xdb,0x0,0x0                                                                                    
002d62   6aea     CLRF      0xea,0x0                                                                                        
002d64   0f62     ADDLW     0x62                                                                                            
002d66   6ee9     MOVWF     0xe9,0x0                                                                                        
002d68   0e00     MOVLW     0x0                                                                                             
002d6a   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002d6c   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d6e   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002d70   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               D:\work\midicontroller\x013x\leds.c
002d78   0e02     MOVLW     0x2            }                                                                                D:\work\midicontroller\x013x\leds.c
002d7a   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002d7c   e202     BC        0x2d82                                                                                          
002d7e   6ae1     CLRF      0xe1,0x0                                                                                        
002d80   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d82   6ee1     MOVWF     0xe1,0x0                                                                                        
002d84   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002d86   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002d88   ffd9                                                                                                               
002d8a   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           /* show 4 alphas on the 4-digit display */                                       D:\work\midicontroller\x013x\leds.c
002d8c   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_4alphas(char text[LEDS_MAX_ALPHAS]){                              D:\work\midicontroller\x013x\leds.c
002d8e   ffe6                                                                                                               
002d90   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002d92   ffd9                                                                                                               
002d94   0e02     MOVLW     0x2                                                                                             
002d96   26e1     ADDWF     0xe1,0x1,0x0                                                                                    
                                           	unsigned char x,i;                                                              D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002d98   0e01     MOVLW     0x1            	for (i = 0;i<4;i++) {                                                           D:\work\midicontroller\x013x\leds.c
002d9a   6adb     CLRF      0xdb,0x0                                                                                        
002d9c   0e04     MOVLW     0x4                                                                                             
002d9e   6ef3     MOVWF     0xf3,0x0                                                                                        
002da0   0e01     MOVLW     0x1                                                                                             
002da2   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002da4   fff4                                                                                                               
002da6   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002da8   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002daa   e221     BC        0x2dee                                                                                          
002de8   0e01     MOVLW     0x1                                                                                             
002dea   2adb     INCF      0xdb,0x1,0x0                                                                                    
002dec   d7d7     BRA       0x2d9c                                                                                          
002dac   0e01     MOVLW     0x1            		x = text[i];                                                                   D:\work\midicontroller\x013x\leds.c
002dae   50db     MOVF      0xdb,0x0,0x0                                                                                    
002db0   6ee7     MOVWF     0xe7,0x0                                                                                        
002db2   0efd     MOVLW     0xfd                                                                                            
002db4   cfdb     MOVFF     0xfdb,0xfe9                                                                                     
002db6   ffe9                                                                                                               
002db8   0efe     MOVLW     0xfe                                                                                            
002dba   cfdb     MOVFF     0xfdb,0xfea                                                                                     
002dbc   ffea                                                                                                               
002dbe   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002dc0   26e9     ADDWF     0xe9,0x1,0x0                                                                                    
002dc2   0e00     MOVLW     0x0                                                                                             
002dc4   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002dc6   cfef     MOVFF     0xfef,0xfdf                                                                                     
002dc8   ffdf                                                                                                               
002dca   cfdf     MOVFF     0xfdf,0xfe6    		DispSegData[i].byte = AsciiTo7Seg(x);                                          D:\work\midicontroller\x013x\leds.c
002dcc   ffe6                                                                                                               
002dce   d829     RCALL     0x2e22                                                                                          
002dd0   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002dd2   6ee6     MOVWF     0xe6,0x0                                                                                        
002dd4   0e01     MOVLW     0x1                                                                                             
002dd6   50db     MOVF      0xdb,0x0,0x0                                                                                    
002dd8   6aea     CLRF      0xea,0x0                                                                                        
002dda   0f62     ADDLW     0x62                                                                                            
002ddc   6ee9     MOVWF     0xe9,0x0                                                                                        
002dde   0e00     MOVLW     0x0                                                                                             
002de0   22ea     ADDWFC    0xea,0x1,0x0                                                                                    
002de2   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002de4   50e7     MOVF      0xe7,0x0,0x0                                                                                    
002de6   6eef     MOVWF     0xef,0x0                                                                                        
                                           	}                                                                               D:\work\midicontroller\x013x\leds.c
002dee   0e02     MOVLW     0x2            }                                                                                D:\work\midicontroller\x013x\leds.c
002df0   5ce1     SUBWF     0xe1,0x0,0x0                                                                                    
002df2   e202     BC        0x2df8                                                                                          
002df4   6ae1     CLRF      0xe1,0x0                                                                                        
002df6   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002df8   6ee1     MOVWF     0xe1,0x0                                                                                        
002dfa   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002dfc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002dfe   ffd9                                                                                                               
002e00   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           /* show single digit on the single digit display */                              D:\work\midicontroller\x013x\leds.c
002e02   cfd9     MOVFF     0xfd9,0xfe6    void leds_show_1digit(u8 value){                                                 D:\work\midicontroller\x013x\leds.c
002e04   ffe6                                                                                                               
002e06   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002e08   ffd9                                                                                                               
002e0a   0efe     MOVLW     0xfe           	DispSegData[4].byte = AsciiTo7Seg(value+'0');                                   D:\work\midicontroller\x013x\leds.c
002e0c   50db     MOVF      0xdb,0x0,0x0                                                                                    
002e0e   0f30     ADDLW     0x30                                                                                            
002e10   6ee6     MOVWF     0xe6,0x0                                                                                        
002e12   d807     RCALL     0x2e22                                                                                          
002e14   52e5     MOVF      0xe5,0x1,0x0                                                                                    
002e16   0100     MOVLB     0x0                                                                                             
002e18   6f66     MOVWF     0x66,0x1                                                                                        
002e1a   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\leds.c
002e1c   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002e1e   ffd9                                                                                                               
002e20   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\leds.c
002e22   cfd9     MOVFF     0xfd9,0xfe6    unsigned char AsciiTo7Seg(unsigned char chr) {                                   D:\work\midicontroller\x013x\leds.c
002e24   ffe6                                                                                                               
002e26   cfe1     MOVFF     0xfe1,0xfd9                                                                                     
002e28   ffd9                                                                                                               
                                           	                                                                                D:\work\midicontroller\x013x\leds.c
002e2a   0e41     MOVLW     0x41           	if (chr >= 'A') {                                                               D:\work\midicontroller\x013x\leds.c
002e2c   6ef3     MOVWF     0xf3,0x0                                                                                        
002e2e   0efe     MOVLW     0xfe                                                                                            
002e30   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002e32   fff4                                                                                                               
002e34   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002e36   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002e38   e328     BNC       0x2e8a                                                                                          
002e3a   0e61     MOVLW     0x61           		if (chr >= 'a') chr -= 'a';	//lower case                                       D:\work\midicontroller\x013x\leds.c
002e3c   6ef3     MOVWF     0xf3,0x0                                                                                        
002e3e   0efe     MOVLW     0xfe                                                                                            
002e40   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002e42   fff4                                                                                                               
002e44   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002e46   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002e48   e30b     BNC       0x2e60                                                                                          
002e4a   0e61     MOVLW     0x61                                                                                            
002e4c   6e10     MOVWF     0x10,0x0                                                                                        
002e4e   0efe     MOVLW     0xfe                                                                                            
002e50   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002e52   ffe7                                                                                                               
002e54   5010     MOVF      0x10,0x0,0x0                                                                                    
002e56   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002e58   0efe     MOVLW     0xfe                                                                                            
002e5a   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002e5c   ffdb                                                                                                               
002e5e   d00a     BRA       0x2e74         		else chr-='A';			//capital                                                     D:\work\midicontroller\x013x\leds.c
002e60   0e41     MOVLW     0x41                                                                                            
002e62   6e10     MOVWF     0x10,0x0                                                                                        
002e64   0efe     MOVLW     0xfe                                                                                            
002e66   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002e68   ffe7                                                                                                               
002e6a   5010     MOVF      0x10,0x0,0x0                                                                                    
002e6c   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002e6e   0efe     MOVLW     0xfe                                                                                            
002e70   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002e72   ffdb                                                                                                               
002e74   50db     MOVF      0xdb,0x0,0x0   		chr=LettersSegTable[chr];                                                      D:\work\midicontroller\x013x\leds.c
002e76   6af7     CLRF      0xf7,0x0                                                                                        
002e78   0fe4     ADDLW     0xe4                                                                                            
002e7a   6ef6     MOVWF     0xf6,0x0                                                                                        
002e7c   0e36     MOVLW     0x36                                                                                            
002e7e   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002e80   0008     TBLRD                                                                                                     
002e82   0efe     MOVLW     0xfe                                                                                            
002e84   cff5     MOVFF     0xff5,0xfdb                                                                                     
002e86   ffdb                                                                                                               
                                           	}                                                                               D:\work\midicontroller\x013x\leds.c
002e88   d026     BRA       0x2ed6         	else if (chr >= '0') {                                                          D:\work\midicontroller\x013x\leds.c
002e8a   0e30     MOVLW     0x30                                                                                            
002e8c   6ef3     MOVWF     0xf3,0x0                                                                                        
002e8e   0efe     MOVLW     0xfe                                                                                            
002e90   cfdb     MOVFF     0xfdb,0xff4                                                                                     
002e92   fff4                                                                                                               
002e94   50f3     MOVF      0xf3,0x0,0x0                                                                                    
002e96   5cf4     SUBWF     0xf4,0x0,0x0                                                                                    
002e98   e315     BNC       0x2ec4                                                                                          
002e9a   0e30     MOVLW     0x30           		chr -= '0';	//numbers                                                          D:\work\midicontroller\x013x\leds.c
002e9c   6e10     MOVWF     0x10,0x0                                                                                        
002e9e   0efe     MOVLW     0xfe                                                                                            
002ea0   cfdb     MOVFF     0xfdb,0xfe7                                                                                     
002ea2   ffe7                                                                                                               
002ea4   5010     MOVF      0x10,0x0,0x0                                                                                    
002ea6   5ee7     SUBWF     0xe7,0x1,0x0                                                                                    
002ea8   0efe     MOVLW     0xfe                                                                                            
002eaa   cfe7     MOVFF     0xfe7,0xfdb                                                                                     
002eac   ffdb                                                                                                               
002eae   50db     MOVF      0xdb,0x0,0x0   		chr=NumbersSegTable[chr];                                                      D:\work\midicontroller\x013x\leds.c
002eb0   6af7     CLRF      0xf7,0x0                                                                                        
002eb2   0fda     ADDLW     0xda                                                                                            
002eb4   6ef6     MOVWF     0xf6,0x0                                                                                        
002eb6   0e36     MOVLW     0x36                                                                                            
002eb8   22f7     ADDWFC    0xf7,0x1,0x0                                                                                    
002eba   0008     TBLRD                                                                                                     
002ebc   0efe     MOVLW     0xfe                                                                                            
002ebe   cff5     MOVFF     0xff5,0xfdb                                                                                     
002ec0   ffdb                                                                                                               
                                           	}                                                                               D:\work\midicontroller\x013x\leds.c
002ec2   d009     BRA       0x2ed6         	else if (chr == ' ') chr = 0;		//space characters                               D:\work\midicontroller\x013x\leds.c
002ec4   0efe     MOVLW     0xfe                                                                                            
002ec6   50db     MOVF      0xdb,0x0,0x0                                                                                    
002ec8   0820     SUBLW     0x20                                                                                            
002eca   e103     BNZ       0x2ed2                                                                                          
002ecc   0efe     MOVLW     0xfe                                                                                            
002ece   6adb     CLRF      0xdb,0x0                                                                                        
002ed0   d002     BRA       0x2ed6         	else chr = 0;				//all other characters are spaces                              D:\work\midicontroller\x013x\leds.c
002ed2   0efe     MOVLW     0xfe                                                                                            
002ed4   6adb     CLRF      0xdb,0x0                                                                                        
002ed6   50db     MOVF      0xdb,0x0,0x0   	return chr;                                                                     D:\work\midicontroller\x013x\leds.c
002ed8   d000     BRA       0x2eda                                                                                          
002eda   52e5     MOVF      0xe5,0x1,0x0   }                                                                                D:\work\midicontroller\x013x\leds.c
002edc   cfe7     MOVFF     0xfe7,0xfd9                                                                                     
002ede   ffd9                                                                                                               
002ee0   0012     RETURN    0x0                                                                                             
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           rom unsigned char NumbersSegTable[10] = {                                        D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<4)|(1<<2)|(1<<3),			//0                                D:\work\midicontroller\x013x\leds.c
                                           	(1<<1)|(1<<2),										//1                                                     D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3),					//2                                     D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<2)|(1<<3),					//3                                     D:\work\midicontroller\x013x\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2),						//4                                           D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<2)|(1<<3),					//5                                     D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<2)|(1<<3),			//6                                D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),								//7                                                D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<3)|(1<<4)|(1<<5)|(1<<6),	//8                           D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)					//9                                      D:\work\midicontroller\x013x\leds.c
                                           };                                                                               D:\work\midicontroller\x013x\leds.c
                                                                                                                            D:\work\midicontroller\x013x\leds.c
                                           rom unsigned char LettersSegTable[26] = {                                        D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<2)|(1<<4)|(1<<5)|(1<<6),	//A                                  D:\work\midicontroller\x013x\leds.c
                                           	(1<<4)|(1<<6)|(1<<5)|(1<<2)|(1<<3),			//b                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<6)|(1<<4)|(1<<3),						//c                                                  D:\work\midicontroller\x013x\leds.c
                                           	(1<<6)|(1<<4)|(1<<3)|(1<<2)|(1<<1),			//d                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4)|(1<<3),			//E                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<6)|(1<<4),				//F                                             D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),	//g                                  D:\work\midicontroller\x013x\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4),				//h                                             D:\work\midicontroller\x013x\leds.c
                                           	(1<<1)|(1<<2),								//I                                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<1)|(1<<2)|(1<<3)|(1<<4),				//J                                             D:\work\midicontroller\x013x\leds.c
                                           	0,											//K                                                                D:\work\midicontroller\x013x\leds.c
                                           	(1<<5)|(1<<4)|(1<<3),						//L                                                  D:\work\midicontroller\x013x\leds.c
                                           	0,											//m                                                                D:\work\midicontroller\x013x\leds.c
                                           	(1<<4)|(1<<6)|(1<<2),						//n                                                  D:\work\midicontroller\x013x\leds.c
                                           	(1<<6)|(1<<4)|(1<<2)|(1<<3),				//o                                             D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<4),			//P                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<5)|(1<<1)|(1<<6)|(1<<2),			//q                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<4)|(1<<6),								//r                                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<3)|(1<<2)|(1<<6)|(1<<5)|(1<<0),			//S                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<2),						//T                                                  D:\work\midicontroller\x013x\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//u                                                  D:\work\midicontroller\x013x\leds.c
                                           	(1<<4)|(1<<3)|(1<<2),						//v                                                  D:\work\midicontroller\x013x\leds.c
                                           	0,											//w                                                                D:\work\midicontroller\x013x\leds.c
                                           	(1<<5)|(1<<6)|(1<<2)|(1<<4)|(1<<1),			//x                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<5)|(1<<1)|(1<<6)|(1<<2)|(1<<3),			//y                                       D:\work\midicontroller\x013x\leds.c
                                           	(1<<0)|(1<<1)|(1<<6)|(1<<4)|(1<<3)			//z                                        D:\work\midicontroller\x013x\leds.c
                                           };                                                                               D:\work\midicontroller\x013x\leds.c
                                           //*;###########################################################################  D:\work\midicontroller\x013x\tables.c
                                           //;#			Author: Joe Dunne											  #                                           D:\work\midicontroller\x013x\tables.c
                                           //;#			Date 5/28/07					      						  #                                          D:\work\midicontroller\x013x\tables.c
                                           //;#			Tables in the code								  			  #                                        D:\work\midicontroller\x013x\tables.c
                                           //;#			File Name: tables.c   										  #                                       D:\work\midicontroller\x013x\tables.c
                                           //;#																		  #                                                        D:\work\midicontroller\x013x\tables.c
                                           //;############################################################################  D:\work\midicontroller\x013x\tables.c
                                                                                                                            D:\work\midicontroller\x013x\tables.c
                                                                                                                            D:\work\midicontroller\x013x\tables.c
                                           #include "c_system.h"                                                            D:\work\midicontroller\x013x\tables.c
                                           #include "usb.h"                                                                 D:\work\midicontroller\x013x\tables.c
                                           #include "hardware.h"                                                            D:\work\midicontroller\x013x\tables.c
                                                                                                                            D:\work\midicontroller\x013x\tables.c
                                           #pragma romdata                                                                  D:\work\midicontroller\x013x\tables.c
                                                                                                                            D:\work\midicontroller\x013x\tables.c
                                           rom unsigned char EXPP_PEDAL_LINEAR_CONV_TABLE[256] =                            D:\work\midicontroller\x013x\tables.c
                                           {                                                                                D:\work\midicontroller\x013x\tables.c
                                           	0                                                                               D:\work\midicontroller\x013x\tables.c
                                           };                                                                               D:\work\midicontroller\x013x\tables.c
                                                                                                                            D:\work\midicontroller\x013x\tables.c
                                           #pragma romdata ROMSAVEDATA=0x4000                                               D:\work\midicontroller\x013x\tables.c
                                           rom unsigned char ROM_SAVEDATA[8191] = {                                         D:\work\midicontroller\x013x\tables.c
                                           	0                                                                               D:\work\midicontroller\x013x\tables.c
                                           };                                                                               D:\work\midicontroller\x013x\tables.c
                                                                                                                            D:\work\midicontroller\x013x\tables.c
                                           #pragma code                                                                     D:\work\midicontroller\x013x\tables.c
